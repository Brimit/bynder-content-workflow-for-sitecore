ManagedPoolThread #3 12:21:19 WARN  Failed to create counter 'Sitecore.System\Logging | Errors Logged / sec'. Sitecore has no necessary permissions for reading/creating counters
ManagedPoolThread #2 12:21:19 WARN  Failed to create counter 'Sitecore.System\IO | File Watcher Events / sec'. Sitecore has no necessary permissions for reading/creating counters
ManagedPoolThread #4 12:21:19 WARN  Failed to create counter 'Sitecore.System\Logging | Fatals Logged / sec'. Sitecore has no necessary permissions for reading/creating counters
ManagedPoolThread #5 12:21:19 WARN  Failed to create counter 'Sitecore.System\Logging | Informations Logged / sec'. Sitecore has no necessary permissions for reading/creating counters
ManagedPoolThread #13 12:21:19 WARN  Failed to create counter 'Sitecore.System\Threading | Background Threads Started / sec'. Sitecore has no necessary permissions for reading/creating counters
ManagedPoolThread #9 12:21:19 WARN  Failed to create counter 'Sitecore.System\Reflection | Objects Created / sec'. Sitecore has no necessary permissions for reading/creating counters
ManagedPoolThread #10 12:21:19 WARN  Failed to create counter 'Sitecore.System\Reflection | Types Not Resolved / sec'. Sitecore has no necessary permissions for reading/creating counters
ManagedPoolThread #8 12:21:19 WARN  Failed to create counter 'Sitecore.System\Reflection | Methods Invoked / sec'. Sitecore has no necessary permissions for reading/creating counters
ManagedPoolThread #7 12:21:19 WARN  Failed to create counter 'Sitecore.System\Logging | Audits Logged / sec'. Sitecore has no necessary permissions for reading/creating counters
ManagedPoolThread #6 12:21:19 WARN  Failed to create counter 'Sitecore.System\Logging | Warnings Logged / sec'. Sitecore has no necessary permissions for reading/creating counters
ManagedPoolThread #16 12:21:19 WARN  Failed to create counter 'Sitecore.System\Reflection | Types Resolved / sec'. Sitecore has no necessary permissions for reading/creating counters
ManagedPoolThread #11 12:21:19 WARN  Failed to create counter 'Sitecore.System\Events | Events Raised / sec'. Sitecore has no necessary permissions for reading/creating counters
ManagedPoolThread #14 12:21:19 WARN  Failed to create counter 'Sitecore.System\Reflection | Objects Not Created / sec'. Sitecore has no necessary permissions for reading/creating counters
1824 12:21:19 INFO  HttpModule is being initialized
ManagedPoolThread #12 12:21:19 WARN  Failed to create counter 'Sitecore.System\Xml | Packets Created / sec'. Sitecore has no necessary permissions for reading/creating counters
1824 12:21:19 INFO  
1824 12:21:19 INFO  **********************************************************************
1824 12:21:19 INFO  **********************************************************************
1824 12:21:19 INFO  Sitecore started
1824 12:21:19 INFO  Sitecore.NET 8.1 (rev. 151003)
1824 12:21:19 INFO  
1824 12:21:19 INFO  d:\projects\gathercontent\sitecore\website\bin\antlr3.runtime.dll (Antlr3.Runtime)
1824 12:21:19 INFO  d:\projects\gathercontent\sitecore\website\bin\componentart.web.ui.dll ()
1824 12:21:19 INFO  d:\projects\gathercontent\sitecore\website\bin\csquery.dll (CsQuery, CsQuery is a CSS selector engine and jQuery port for .NET 4 and C#)
1824 12:21:19 INFO  d:\projects\gathercontent\sitecore\website\bin\customfields.accountselector.dll (AccountSelectorAssembly)
1824 12:21:19 INFO  d:\projects\gathercontent\sitecore\website\bin\dotnetopenauth.dll (DotNetOpenAuth, 1c99bf16c5b570cadcf27d0b9ce3d598d06b34ca)
1824 12:21:19 INFO  d:\projects\gathercontent\sitecore\website\bin\ecmascript.net.dll (Modified version of the EcmaScript.NET assembly)
1824 12:21:19 INFO  d:\projects\gathercontent\sitecore\website\bin\facebook.dll (Facebook C# SDK, Facebook C# SDK)
1824 12:21:19 INFO  d:\projects\gathercontent\sitecore\website\bin\facebookapi.dll (FacebookAPI)
1824 12:21:19 INFO  d:\projects\gathercontent\sitecore\website\bin\gathercontent.connector.service.dll (GatherContent.Connector.Service)
1824 12:21:19 INFO  d:\projects\gathercontent\sitecore\website\bin\gathercontent.connector.website.dll (GatherContent.Connector.Website)
1824 12:21:19 INFO  d:\projects\gathercontent\sitecore\website\bin\google.apis.authentication.oauth2.dll (OAuth2 Authentication Library)
1824 12:21:19 INFO  d:\projects\gathercontent\sitecore\website\bin\google.apis.dll ()
1824 12:21:19 INFO  d:\projects\gathercontent\sitecore\website\bin\google.apis.plus.v1.dll (Google.Apis.Plus.v1)
1824 12:21:19 INFO  d:\projects\gathercontent\sitecore\website\bin\hammock.clientprofile.dll (Hammock)
1824 12:21:19 INFO  d:\projects\gathercontent\sitecore\website\bin\htmlagilitypack.dll (Html Agility Pack, 1.4.6.0)
1824 12:21:19 INFO  d:\projects\gathercontent\sitecore\website\bin\iesi.collections.dll (Iesi.Collections, Enhanced Collections for .NET.  Code was published at http://www.codeproject.com/csharp/sets.asp, 1.0)
1824 12:21:19 INFO  d:\projects\gathercontent\sitecore\website\bin\ithit.webdav.server.dll (WebDav Server .Net v2, IT Hit WebDAV Server .Net v2)
1824 12:21:19 INFO  d:\projects\gathercontent\sitecore\website\bin\lucene.net.contrib.analyzers.dll (Lucene.Net.Contrib.Analyzers)
1824 12:21:19 INFO  d:\projects\gathercontent\sitecore\website\bin\lucene.net.contrib.core.dll (Lucene.Net.Contrib.Core, Contributions to the Lucene.Net core library)
1824 12:21:19 INFO  d:\projects\gathercontent\sitecore\website\bin\lucene.net.contrib.fastvectorhighlighter.dll (Lucene.Net.Contrib.FastVectorHighlighter, FastVectorHighlighter for Lucene.Net)
1824 12:21:19 INFO  d:\projects\gathercontent\sitecore\website\bin\lucene.net.contrib.highlighter.dll (Lucene.Net.Contrib.Highlighter, The Apache Software Foundation Lucene.Net a full-text search engine library, 2.3.2)
1824 12:21:19 INFO  d:\projects\gathercontent\sitecore\website\bin\lucene.net.contrib.memory.dll (Contrib.Memory)
1824 12:21:19 INFO  d:\projects\gathercontent\sitecore\website\bin\lucene.net.contrib.queries.dll (Lucene.Net.Contrib.Queries)
1824 12:21:19 INFO  d:\projects\gathercontent\sitecore\website\bin\lucene.net.contrib.regex.dll (Lucene.Net.Contrib.Regex)
1824 12:21:19 INFO  d:\projects\gathercontent\sitecore\website\bin\lucene.net.contrib.simplefacetedsearch.dll (Lucene.Net.SimpleFacetedSearch, SimpleFacetedSearch for Lucene.Net)
1824 12:21:19 INFO  d:\projects\gathercontent\sitecore\website\bin\lucene.net.contrib.snowball.dll (Lucene.Net.Contrib.Snowball, The Apache Software Foundation Lucene.Net a full-text search engine library, 2.0)
1824 12:21:19 INFO  d:\projects\gathercontent\sitecore\website\bin\lucene.net.contrib.spellchecker.dll (SpellChecker.Net, The Apache Software Foundation Lucene.Net a full-text search engine library, 3.0.3)
1824 12:21:19 INFO  d:\projects\gathercontent\sitecore\website\bin\lucene.net.dll (Lucene.Net, The Apache Software Foundation Lucene.Net a full-text search engine library, 3.0.3)
1824 12:21:19 INFO  d:\projects\gathercontent\sitecore\website\bin\microsoft.web.infrastructure.dll (Microsoft ASP.Net WebPages)
1824 12:21:19 INFO  d:\projects\gathercontent\sitecore\website\bin\mongodb.bson.dll (MongoDB.Bson, Official MongoDB supported BSON library. See http://www.mongodb.org/display/DOCS/CSharp+Language+Center for more details, { version: '1.10.0.62', semver: '1.10.0', commit: '2df664a15859899b9bb0a457e237ec32c7d31e48', commitDate: '2015-01-29 15:41:46' })
1824 12:21:19 INFO  d:\projects\gathercontent\sitecore\website\bin\mongodb.driver.dll (MongoDB.Driver, Official MongoDB supported driver for MongoDB.  See http://www.mongodb.org/display/DOCS/CSharp+Language+Center for more details, { version: '1.10.0.62', semver: '1.10.0', commit: '2df664a15859899b9bb0a457e237ec32c7d31e48', commitDate: '2015-01-29 15:41:46' })
1824 12:21:19 INFO  d:\projects\gathercontent\sitecore\website\bin\mvp.xml.dll (MVP XML Library)
1824 12:21:19 INFO  d:\projects\gathercontent\sitecore\website\bin\netbiscuits.onpremise.dll (OnPremise)
1824 12:21:19 INFO  d:\projects\gathercontent\sitecore\website\bin\newtonsoft.json.dll (Json.NET, Json.NET is a popular high-performance JSON framework for .NET)
1824 12:21:19 INFO  d:\projects\gathercontent\sitecore\website\bin\oauthlinkedin.dll (OAuthLinkedIn)
1824 12:21:19 INFO  d:\projects\gathercontent\sitecore\website\bin\protobuf-net.dll (protobuf-net, Protocol Buffers for .NET)
1824 12:21:19 INFO  d:\projects\gathercontent\sitecore\website\bin\radeditor.net2.dll (RadEditor, Telerik RadEditor)
1824 12:21:19 INFO  d:\projects\gathercontent\sitecore\website\bin\sitecore.abstractions.dll (Sitecore CMS, 8.1.0 rev. 151003)
1824 12:21:19 INFO  d:\projects\gathercontent\sitecore\website\bin\sitecore.analytics.aggregation.dll (Sitecore DMS, 8.1.0 rev. 151003)
1824 12:21:19 INFO  d:\projects\gathercontent\sitecore\website\bin\sitecore.analytics.automation.aggregation.dll (Sitecore DMS, 8.1.0 rev. 151003)
1824 12:21:19 INFO  d:\projects\gathercontent\sitecore\website\bin\sitecore.analytics.automation.dll (Sitecore EAS, Sitecore Engagement Automation Suite, 8.1.0 rev. 151003)
1824 12:21:19 INFO  d:\projects\gathercontent\sitecore\website\bin\sitecore.analytics.automation.mongodb.dll (Sitecore DMS, 8.1.0 rev. 151003)
1824 12:21:19 INFO  d:\projects\gathercontent\sitecore\website\bin\sitecore.analytics.core.dll (Sitecore DMS, 8.1.0 rev. 151003)
1824 12:21:19 INFO  d:\projects\gathercontent\sitecore\website\bin\sitecore.analytics.dataaccess.dll (Sitecore DMS, 8.1.0 rev. 151003)
1824 12:21:19 INFO  d:\projects\gathercontent\sitecore\website\bin\sitecore.analytics.dll (Sitecore DMS, Sitecore Digital Marketing System, 8.1.0 rev. 151003)
1824 12:21:19 INFO  d:\projects\gathercontent\sitecore\website\bin\sitecore.analytics.model.dll (Sitecore DMS, 8.1.0 rev. 151003)
1824 12:21:19 INFO  d:\projects\gathercontent\sitecore\website\bin\sitecore.analytics.mongodb.dll (Sitecore DMS, Sitecore Digital Marketing System MongoDB Connector, 8.1.0 rev. 151003)
1824 12:21:19 INFO  d:\projects\gathercontent\sitecore\website\bin\sitecore.analytics.omnichannel.dll (Sitecore DMS, 8.1.0 rev. 151003)
1824 12:21:19 INFO  d:\projects\gathercontent\sitecore\website\bin\sitecore.analytics.outcome.dll (Sitecore DMS, 8.1.0 rev. 151003)
1824 12:21:19 INFO  d:\projects\gathercontent\sitecore\website\bin\sitecore.analytics.processing.dll (Sitecore DMS, 8.1.0 rev. 151003)
1824 12:21:19 INFO  d:\projects\gathercontent\sitecore\website\bin\sitecore.analytics.robotdetection.dll (Sitecore Robot Detection, 1.0.0 rev. 150922)
1824 12:21:19 INFO  d:\projects\gathercontent\sitecore\website\bin\sitecore.analytics.sql.dll (Sitecore DMS, 8.1.0 rev. 151003)
1824 12:21:19 INFO  d:\projects\gathercontent\sitecore\website\bin\sitecore.apps.loader.dll (Sitecore.Apps.Loader, Sitecore.Apps.Loader, 1.0.0 rev. 150907)
1824 12:21:19 INFO  d:\projects\gathercontent\sitecore\website\bin\sitecore.apps.taginjection.dll (Sitecore Tag Management, 1.0.0 rev. 140814)
1824 12:21:19 INFO  d:\projects\gathercontent\sitecore\website\bin\sitecore.buckets.client.dll (Sitecore Buckets, The assembly can be used to have Sitecore queries driven via a query, 1.0.0 rev. 150924)
1824 12:21:19 INFO  d:\projects\gathercontent\sitecore\website\bin\sitecore.buckets.dll (Sitecore Buckets, The assembly can be used to have Sitecore queries driven via search providers, 1.0.0 rev. 150924)
1824 12:21:19 INFO  d:\projects\gathercontent\sitecore\website\bin\sitecore.ces.devicedetection.dll (Sitecore Device Detection Client, 1.0.0 rev. 150803)
1824 12:21:19 INFO  d:\projects\gathercontent\sitecore\website\bin\sitecore.ces.devicedetection.rules.dll (Sitecore Device Detection Client, 1.0.0 rev. 150803)
1824 12:21:19 INFO  d:\projects\gathercontent\sitecore\website\bin\sitecore.ces.dll (Sitecore IP Geolocation Service Client, 1.3 rev. 150626)
1824 12:21:19 INFO  d:\projects\gathercontent\sitecore\website\bin\sitecore.ces.geoip.dll (Sitecore IP Geolocation Service Client, 1.3 rev. 150626)
1824 12:21:19 INFO  d:\projects\gathercontent\sitecore\website\bin\sitecore.ces.geoip.legacylocation.dll (Sitecore IP Geolocation Service Client, 1.3 rev. 150626)
1824 12:21:19 INFO  d:\projects\gathercontent\sitecore\website\bin\sitecore.cintel.client.dll (Sitecore Experience Profile, 1.0.0 rev. 150925)
1824 12:21:19 INFO  d:\projects\gathercontent\sitecore\website\bin\sitecore.cintel.dll (Sitecore Experience Profile, 1.0.0 rev. 150925)
1824 12:21:19 INFO  d:\projects\gathercontent\sitecore\website\bin\sitecore.client.dll (Sitecore CMS, Sitecore Client Application, 8.1.0 rev. 151003)
1824 12:21:19 INFO  d:\projects\gathercontent\sitecore\website\bin\sitecore.client.licenseoptions.dll (Sitecore Speak Applications, 1.3.1 rev. 150924)
1824 12:21:19 INFO  d:\projects\gathercontent\sitecore\website\bin\sitecore.cloud.contentsearch.dll (Sitecore Cloud ContentSearch, 8.1.0 rev. 150925)
1824 12:21:19 INFO  d:\projects\gathercontent\sitecore\website\bin\sitecore.cloud.nexus.dll (Sitecore Cloud Services)
1824 12:21:19 INFO  d:\projects\gathercontent\sitecore\website\bin\sitecore.cloud.restclient.dll (Sitecore Cloud Services)
1824 12:21:19 INFO  d:\projects\gathercontent\sitecore\website\bin\sitecore.cloud.servicemodel.dll (Sitecore Cloud Services)
1824 12:21:19 INFO  d:\projects\gathercontent\sitecore\website\bin\sitecore.cloud.xdb.dll (Sitecore Cloud Xdb, 8.1.0 rev. 150911)
1824 12:21:19 INFO  d:\projects\gathercontent\sitecore\website\bin\sitecore.contentsearch.analytics.client.dll (Sitecore Buckets, 1.0.0 rev. 150924)
1824 12:21:19 INFO  d:\projects\gathercontent\sitecore\website\bin\sitecore.contentsearch.analytics.dll (Sitecore Buckets, 1.0.0 rev. 150924)
1824 12:21:19 INFO  d:\projects\gathercontent\sitecore\website\bin\sitecore.contentsearch.client.dll (Sitecore Buckets, 1.0.0 rev. 150924)
1824 12:21:19 INFO  d:\projects\gathercontent\sitecore\website\bin\sitecore.contentsearch.dll (Sitecore Buckets, Sitecore CMS Search, 1.0.0 rev. 150924)
1824 12:21:19 INFO  d:\projects\gathercontent\sitecore\website\bin\sitecore.contentsearch.linq.dll (Sitecore Buckets, Sitecore CMS Search, 1.0.0 rev. 150924)
1824 12:21:19 INFO  d:\projects\gathercontent\sitecore\website\bin\sitecore.contentsearch.linq.lucene.dll (Sitecore Buckets, 1.0.0 rev. 150924)
1824 12:21:19 INFO  d:\projects\gathercontent\sitecore\website\bin\sitecore.contentsearch.luceneprovider.dll (Sitecore Buckets, Sitecore CMS Search, 1.0.0 rev. 150924)
1824 12:21:19 INFO  d:\projects\gathercontent\sitecore\website\bin\sitecore.contenttesting.dll (Sitecore Content Testing, 8.1.0 rev. 150924)
1824 12:21:19 INFO  d:\projects\gathercontent\sitecore\website\bin\sitecore.contenttesting.intelligence.dll (Sitecore Content Testing, 8.1.0 rev. 150924)
1824 12:21:19 INFO  d:\projects\gathercontent\sitecore\website\bin\sitecore.contenttesting.model.dll (Sitecore Content Testing, 8.1.0 rev. 150924)
1824 12:21:19 INFO  d:\projects\gathercontent\sitecore\website\bin\sitecore.contenttesting.mvc.dll (Sitecore Content Testing, 8.1.0 rev. 150924)
1824 12:21:19 INFO  d:\projects\gathercontent\sitecore\website\bin\sitecore.controlpanel.dll (Sitecore Speak Applications, 1.3.1 rev. 150924)
1824 12:21:19 INFO  d:\projects\gathercontent\sitecore\website\bin\sitecore.experienceanalytics.client.dll (Sitecore Experience Analytics, 1.1.0 rev. 151001)
1824 12:21:19 INFO  d:\projects\gathercontent\sitecore\website\bin\sitecore.experienceanalytics.dll (Sitecore Experience Analytics, 1.1.0 rev. 151001)
1824 12:21:19 INFO  d:\projects\gathercontent\sitecore\website\bin\sitecore.experienceeditor.dll (Sitecore Experience Editor, 2.0.0 rev. 150914)
1824 12:21:19 INFO  d:\projects\gathercontent\sitecore\website\bin\sitecore.experienceeditor.speak.dll (Sitecore Experience Editor, 2.0.0 rev. 150914)
1824 12:21:19 INFO  d:\projects\gathercontent\sitecore\website\bin\sitecore.experienceeditor.speak.ribbon.dll (Sitecore Experience Editor, 2.0.0 rev. 150914)
1824 12:21:19 INFO  d:\projects\gathercontent\sitecore\website\bin\sitecore.experienceexplorer.business.dll (Sitecore Experience Explorer, 2.0.0 rev. 150930)
1824 12:21:19 INFO  d:\projects\gathercontent\sitecore\website\bin\sitecore.experienceexplorer.web.dll (Sitecore Experience Explorer, 2.0.0 rev. 150930)
1824 12:21:19 INFO  d:\projects\gathercontent\sitecore\website\bin\sitecore.fxm.client.dll (Sitecore Federated Experience Manager, 2.0.0 rev. 150928 )
1824 12:21:19 INFO  d:\projects\gathercontent\sitecore\website\bin\sitecore.fxm.dll (Sitecore Federated Experience Manager, 2.0.0 rev. 150928 )
1824 12:21:19 INFO  d:\projects\gathercontent\sitecore\website\bin\sitecore.fxm.service.dll (Sitecore Federated Experience Manager, 2.0.0 rev. 150928 )
1824 12:21:19 INFO  d:\projects\gathercontent\sitecore\website\bin\sitecore.fxm.speak.dll (Sitecore Federated Experience Manager, 2.0.0 rev. 150928 )
1824 12:21:19 INFO  d:\projects\gathercontent\sitecore\website\bin\sitecore.itemwebapi.dll (Sitecore Item Web API, 1.2.0 rev. 141016)
1824 12:21:19 INFO  d:\projects\gathercontent\sitecore\website\bin\sitecore.kernel.dll (Sitecore CMS, Sitecore CMS Kernel Library, 8.1.0 rev. 151003)
1824 12:21:19 INFO  d:\projects\gathercontent\sitecore\website\bin\sitecore.launchpad.dll (Sitecore LaunchPad, 1.0 rev. 150925)
1824 12:21:19 INFO  d:\projects\gathercontent\sitecore\website\bin\sitecore.listmanagement.analytics.dll (Sitecore List Manager, 1.1.0 rev. 150925)
1824 12:21:19 INFO  d:\projects\gathercontent\sitecore\website\bin\sitecore.listmanagement.client.dll (Sitecore List Manager, 1.1.0 rev. 150925)
1824 12:21:19 INFO  d:\projects\gathercontent\sitecore\website\bin\sitecore.listmanagement.contentsearch.dll (Sitecore List Manager, 1.1.0 rev. 150925)
1824 12:21:19 INFO  d:\projects\gathercontent\sitecore\website\bin\sitecore.listmanagement.dll (Sitecore List Manager, 1.1.0 rev. 150925)
1824 12:21:19 INFO  d:\projects\gathercontent\sitecore\website\bin\sitecore.listmanagement.services.dll (Sitecore List Manager, 1.1.0 rev. 150925)
1824 12:21:19 INFO  d:\projects\gathercontent\sitecore\website\bin\sitecore.logging.client.dll (Sitecore CMS, Lets you insert loggers in your JavaScript, and automatically sends the log messages to a server side component that stores them in your existing server side logs. Interfaces with Sitecore.Logging.

Ideal for logging JavaScript exceptions to the server, including a stack trace. Documentation and examples are at jsnlog.com)
1824 12:21:19 INFO  d:\projects\gathercontent\sitecore\website\bin\sitecore.logging.dll (Sitecore CMS, Sitecore Logging Framework, 8.0 rev. 141020)
1824 12:21:19 INFO  d:\projects\gathercontent\sitecore\website\bin\sitecore.marketing.campaigns.client.dll (Sitecore Campaign Manager, 1.1 rev. 150925)
1824 12:21:19 INFO  d:\projects\gathercontent\sitecore\website\bin\sitecore.marketing.campaigns.services.dll (Sitecore Campaign Manager, 1.1 rev. 150925)
1824 12:21:19 INFO  d:\projects\gathercontent\sitecore\website\bin\sitecore.marketing.client.dll (Sitecore Marketing Client, 1.0.0 rev. 150915)
1824 12:21:19 INFO  d:\projects\gathercontent\sitecore\website\bin\sitecore.marketing.core.dll (Sitecore Marketing Operations API, 8.1.0 rev. 151003)
1824 12:21:19 INFO  d:\projects\gathercontent\sitecore\website\bin\sitecore.marketing.definitions.marketingassets.repositories.dll (Sitecore Marketing Asset Repositories, 1.0.0 rev. 150701)
1824 12:21:19 INFO  d:\projects\gathercontent\sitecore\website\bin\sitecore.marketing.dll (Sitecore Marketing Operations API, 8.1.0 rev. 151003)
1824 12:21:19 INFO  d:\projects\gathercontent\sitecore\website\bin\sitecore.marketing.search.dll (Sitecore Marketing Operations, 1.0.0 rev. 150928)
1824 12:21:19 INFO  d:\projects\gathercontent\sitecore\website\bin\sitecore.marketing.taxonomy.dll (Sitecore Marketing Operations API, 8.1.0 rev. 151003)
1824 12:21:19 INFO  d:\projects\gathercontent\sitecore\website\bin\sitecore.mvc.analytics.dll (Sitecore Mvc Analytics, 1.1.0 rev. 150618)
1824 12:21:19 INFO  d:\projects\gathercontent\sitecore\website\bin\sitecore.mvc.devicesimulator.dll (Sitecore Mvc Device Simulators, 1.0.0 rev. 150909)
1824 12:21:19 INFO  d:\projects\gathercontent\sitecore\website\bin\sitecore.mvc.dll (Sitecore Mvc, 1.0.0 rev. 150625)
1824 12:21:19 INFO  d:\projects\gathercontent\sitecore\website\bin\sitecore.mvc.experienceeditor.dll (Sitecore Mvc Experience Editor, 2.0.0 rev. 150710)
1824 12:21:19 INFO  d:\projects\gathercontent\sitecore\website\bin\sitecore.nexus.dll (Sitecore.Nexus)
1824 12:21:19 INFO  d:\projects\gathercontent\sitecore\website\bin\sitecore.nvelocity.dll (Sitecore CMS, Sitecore Macro Expansion Library, 6.6.0 rev. 120918)
1824 12:21:19 INFO  d:\projects\gathercontent\sitecore\website\bin\sitecore.oracle.dll (Sitecore CMS, Oracle Data Provider for Sitecore, 8.1.0 rev. 151003)
1824 12:21:19 INFO  d:\projects\gathercontent\sitecore\website\bin\sitecore.pathanalyzer.client.dll (Sitecore Path Analyzer, 1.1.0 rev. 150828)
1824 12:21:19 INFO  d:\projects\gathercontent\sitecore\website\bin\sitecore.pathanalyzer.dll (Sitecore Path Analyzer, 1.1.0 rev. 150828)
1824 12:21:19 INFO  d:\projects\gathercontent\sitecore\website\bin\sitecore.pathanalyzer.services.dll (Sitecore Path Analyzer, 1.1.0 rev. 150828)
1824 12:21:19 INFO  d:\projects\gathercontent\sitecore\website\bin\sitecore.publishing.webdeploy.dll (Sitecore CMS, Sitecore publishing infrastructure based on Web Deployment Tool, 8.1.0 rev. 151003)
1824 12:21:19 INFO  d:\projects\gathercontent\sitecore\website\bin\sitecore.security.anticsrf.dll (Sitecore AntiCSRF Module, 1.0.0 rev. 150806)
1824 12:21:19 INFO  d:\projects\gathercontent\sitecore\website\bin\sitecore.segmentbuilder.dll (Sitecore Segment Builder, 1.0.0 rev. 150625)
1824 12:21:19 INFO  d:\projects\gathercontent\sitecore\website\bin\sitecore.sequenceanalyzer.dll (Sitecore Path Analyzer, 1.1.0 rev. 150828)
1824 12:21:19 INFO  d:\projects\gathercontent\sitecore\website\bin\sitecore.services.client.dll (Sitecore Services 1.0.0, Sitecore Services, 1.0.0)
1824 12:21:19 INFO  d:\projects\gathercontent\sitecore\website\bin\sitecore.services.core.dll (Sitecore Services 1.0.0, Sitecore Services, 1.0 rev. 141114)
1824 12:21:19 INFO  d:\projects\gathercontent\sitecore\website\bin\sitecore.services.infrastructure.dll (Sitecore Services 1.0.0, Sitecore Services, 1.0 rev. 141114)
1824 12:21:19 INFO  d:\projects\gathercontent\sitecore\website\bin\sitecore.services.infrastructure.sitecore.dll (Sitecore Services 1.0.0, Sitecore Services, 1.0 rev. 141114)
1824 12:21:19 INFO  d:\projects\gathercontent\sitecore\website\bin\sitecore.sessionprovider.dll (Sitecore CMS, 8.1.0 rev. 151003)
1824 12:21:19 INFO  d:\projects\gathercontent\sitecore\website\bin\sitecore.sessionprovider.memory.dll (Sitecore CMS, 8.1.0 rev. 151003)
1824 12:21:19 INFO  d:\projects\gathercontent\sitecore\website\bin\sitecore.sessionprovider.mongodb.dll (Sitecore CMS, 8.1.0 rev. 151003)
1824 12:21:19 INFO  d:\projects\gathercontent\sitecore\website\bin\sitecore.sessionprovider.sql.dll (Sitecore CMS, 8.1.0 rev. 151003)
1824 12:21:19 INFO  d:\projects\gathercontent\sitecore\website\bin\sitecore.shell.marketingautomation.dll (Sitecore Engagement Automation Suite, 1.0.0 rev. 150731)
1824 12:21:19 INFO  d:\projects\gathercontent\sitecore\website\bin\sitecore.social.api.dll (Social Connected Module, 8.1 rev. 150720)
1824 12:21:19 INFO  d:\projects\gathercontent\sitecore\website\bin\sitecore.social.client.api.dll (Social Connected Module, 8.1 rev. 150720)
1824 12:21:19 INFO  d:\projects\gathercontent\sitecore\website\bin\sitecore.social.client.common.dll (Social Connected Module, 8.1 rev. 150720)
1824 12:21:19 INFO  d:\projects\gathercontent\sitecore\website\bin\sitecore.social.client.dll (Social Connected Module, 8.1 rev. 150720)
1824 12:21:19 INFO  d:\projects\gathercontent\sitecore\website\bin\sitecore.social.client.domain.dll (Social Connected Module, 8.1 rev. 150720)
1824 12:21:19 INFO  d:\projects\gathercontent\sitecore\website\bin\sitecore.social.client.mvc.dll (Social Connected Module, 8.1 rev. 150720)
1824 12:21:19 INFO  d:\projects\gathercontent\sitecore\website\bin\sitecore.social.client.speak.dll (Social Connected Module, 8.1 rev. 150720)
1824 12:21:19 INFO  d:\projects\gathercontent\sitecore\website\bin\sitecore.social.configuration.dll (Social Connected Module, 8.1 rev. 150720)
1824 12:21:19 INFO  d:\projects\gathercontent\sitecore\website\bin\sitecore.social.dll (Social Connected Module, 8.1 rev. 150720)
1824 12:21:19 INFO  d:\projects\gathercontent\sitecore\website\bin\sitecore.social.domain.dll (Social Connected Module, 8.1 rev. 150720)
1824 12:21:19 INFO  d:\projects\gathercontent\sitecore\website\bin\sitecore.social.experienceprofile.client.dll (Social Connected Module, 8.1 rev. 150720)
1824 12:21:19 INFO  d:\projects\gathercontent\sitecore\website\bin\sitecore.social.facebook.api.dll (Social Connected Module, 8.1 rev. 150720)
1824 12:21:19 INFO  d:\projects\gathercontent\sitecore\website\bin\sitecore.social.facebook.client.dll (Social Connected Module, 8.1 rev. 150720)
1824 12:21:19 INFO  d:\projects\gathercontent\sitecore\website\bin\sitecore.social.facebook.client.mvc.dll (Social Connected Module, 8.1 rev. 150720)
1824 12:21:19 INFO  d:\projects\gathercontent\sitecore\website\bin\sitecore.social.facebook.dll (Social Connected Module, 8.1 rev. 150720)
1824 12:21:19 INFO  d:\projects\gathercontent\sitecore\website\bin\sitecore.social.googleplus.client.dll (Social Connected Module, 8.1 rev. 150720)
1824 12:21:19 INFO  d:\projects\gathercontent\sitecore\website\bin\sitecore.social.googleplus.client.mvc.dll (Social Connected Module, 8.1 rev. 150720)
1824 12:21:19 INFO  d:\projects\gathercontent\sitecore\website\bin\sitecore.social.googleplus.dll (Social Connected Module, 8.1 rev. 150720)
1824 12:21:19 INFO  d:\projects\gathercontent\sitecore\website\bin\sitecore.social.infrastructure.dll (Social Connected Module, 8.1 rev. 150720)
1824 12:21:19 INFO  d:\projects\gathercontent\sitecore\website\bin\sitecore.social.infrastructure.logging.dll (Social Connected Module, 8.1 rev. 150720)
1824 12:21:19 INFO  d:\projects\gathercontent\sitecore\website\bin\sitecore.social.installation.dll (Social Connected Module, 8.1 rev. 150720)
1824 12:21:19 INFO  d:\projects\gathercontent\sitecore\website\bin\sitecore.social.klout.api.dll (Social Connected Module, 8.1 rev. 150720)
1824 12:21:19 INFO  d:\projects\gathercontent\sitecore\website\bin\sitecore.social.klout.client.dll (Social Connected Module, 8.1 rev. 150720)
1824 12:21:19 INFO  d:\projects\gathercontent\sitecore\website\bin\sitecore.social.linkedin.client.dll (Social Connected Module, 8.1 rev. 150720)
1824 12:21:19 INFO  d:\projects\gathercontent\sitecore\website\bin\sitecore.social.linkedin.client.mvc.dll (Social Connected Module, 8.1 rev. 150720)
1824 12:21:19 INFO  d:\projects\gathercontent\sitecore\website\bin\sitecore.social.linkedin.dll (Social Connected Module, 8.1 rev. 150720)
1824 12:21:19 INFO  d:\projects\gathercontent\sitecore\website\bin\sitecore.social.networkproviders.dll (Social Connected Module, 8.1 rev. 150720)
1824 12:21:19 INFO  d:\projects\gathercontent\sitecore\website\bin\sitecore.social.sitecoreaccess.dll (Social Connected Module, 8.1 rev. 150720)
1824 12:21:19 INFO  d:\projects\gathercontent\sitecore\website\bin\sitecore.social.socialmarketer.api.dll (Social Connected Module, 8.1 rev. 150720)
1824 12:21:19 INFO  d:\projects\gathercontent\sitecore\website\bin\sitecore.social.socialmarketer.client.dll (Social Connected Module, 8.1 rev. 150720)
1824 12:21:19 INFO  d:\projects\gathercontent\sitecore\website\bin\sitecore.social.socialmarketer.dll (Social Connected Module, 8.1 rev. 150720)
1824 12:21:19 INFO  d:\projects\gathercontent\sitecore\website\bin\sitecore.social.twitter.api.dll (Social Connected Module, 8.1 rev. 150720)
1824 12:21:19 INFO  d:\projects\gathercontent\sitecore\website\bin\sitecore.social.twitter.client.dll (Social Connected Module, 8.1 rev. 150720)
1824 12:21:19 INFO  d:\projects\gathercontent\sitecore\website\bin\sitecore.social.twitter.client.mvc.dll (Social Connected Module, 8.1 rev. 150720)
1824 12:21:19 INFO  d:\projects\gathercontent\sitecore\website\bin\sitecore.social.twitter.dll (Social Connected Module, 8.1 rev. 150720)
1824 12:21:19 INFO  d:\projects\gathercontent\sitecore\website\bin\sitecore.speak.applications.dll (Sitecore Speak Applications, 1.3.1 rev. 150924)
1824 12:21:19 INFO  d:\projects\gathercontent\sitecore\website\bin\sitecore.speak.charting.dll (Sitecore Speak Charting, 1.1.0 rev. 150820)
1824 12:21:19 INFO  d:\projects\gathercontent\sitecore\website\bin\sitecore.speak.client.dll (Sitecore Speak, 2.0.0 rev. 150715)
1824 12:21:19 INFO  d:\projects\gathercontent\sitecore\website\bin\sitecore.speak.components.dll (Sitecore Speak Components, 2.0.0 rev. 150715)
1824 12:21:19 INFO  d:\projects\gathercontent\sitecore\website\bin\sitecore.speak.components.guidance.dll (Sitecore Speak Components, 2.0.0 rev. 150715)
1824 12:21:19 INFO  d:\projects\gathercontent\sitecore\website\bin\sitecore.speak.components.web.dll (Sitecore Speak Components, 2.0.0 rev. 150715)
1824 12:21:19 INFO  d:\projects\gathercontent\sitecore\website\bin\sitecore.speak.itemwebapi.dll (Sitecore Speak, 2.0.0 rev. 150715)
1824 12:21:19 INFO  d:\projects\gathercontent\sitecore\website\bin\sitecore.speak.mvc.dll (Sitecore Speak, 2.0.0 rev. 150715)
1824 12:21:19 INFO  d:\projects\gathercontent\sitecore\website\bin\sitecore.speak.web.dll (Sitecore Speak, 2.0.0 rev. 150715)
1824 12:21:19 INFO  d:\projects\gathercontent\sitecore\website\bin\sitecore.update.dll (Sitecore Update Installation Wizard, 1.0.0 rev. 150930)
1824 12:21:19 INFO  d:\projects\gathercontent\sitecore\website\bin\sitecore.web.dll (Sitecore.Web 1.1.0, 1.1.0 rev. 150708)
1824 12:21:19 INFO  d:\projects\gathercontent\sitecore\website\bin\sitecore.xdb.configuration.dll (Sitecore DMS, 8.1.0 rev. 151003)
1824 12:21:19 INFO  d:\projects\gathercontent\sitecore\website\bin\sitecore.zip.dll (Sitecore CMS, ZIP support for Sitecore, 8.1.0 rev. 150714)
1824 12:21:19 INFO  d:\projects\gathercontent\sitecore\website\bin\stimulsoft.base.dll (Stimulsoft Reports, Stimulsoft Base)
1824 12:21:19 INFO  d:\projects\gathercontent\sitecore\website\bin\stimulsoft.database.dll (Stimulsoft Reports, Stimulsoft Reports Database Helper)
1824 12:21:19 INFO  d:\projects\gathercontent\sitecore\website\bin\stimulsoft.report.dll (Stimulsoft Reports, Stimulsoft Reports Engine)
1824 12:21:19 INFO  d:\projects\gathercontent\sitecore\website\bin\stimulsoft.report.web.dll (Stimulsoft Reports.Web, Stimulsoft Reports.Web Viewer)
1824 12:21:19 INFO  d:\projects\gathercontent\sitecore\website\bin\stimulsoft.report.webdesign.dll (Stimulsoft Reports Designer.Web, Stimulsoft Reports Designer.Web)
1824 12:21:19 INFO  d:\projects\gathercontent\sitecore\website\bin\system.net.http.dll (Microsoft® .NET Framework, System.Net.Http.dll, 4.0.30319.33440)
1824 12:21:19 INFO  d:\projects\gathercontent\sitecore\website\bin\system.net.http.formatting.dll (Microsoft ASP.NET MVC, 5.2.3-30128 (0e974218e12a67d4b1f25422119e40cfe6953e46))
1824 12:21:19 INFO  d:\projects\gathercontent\sitecore\website\bin\system.net.http.webrequest.dll (Microsoft® .NET Framework, System.Net.Http.WebRequest.dll, 4.0.30319.33440)
1824 12:21:19 INFO  d:\projects\gathercontent\sitecore\website\bin\system.web.cors.dll (Microsoft ASP.NET MVC, 5.1.0-20110)
1824 12:21:19 INFO  d:\projects\gathercontent\sitecore\website\bin\system.web.helpers.dll (Microsoft ASP.NET Web Pages, 3.0.3-30128 (0e974218e12a67d4b1f25422119e40cfe6953e46))
1824 12:21:19 INFO  d:\projects\gathercontent\sitecore\website\bin\system.web.http.cors.dll (Microsoft ASP.NET MVC, 5.1.0-20110)
1824 12:21:19 INFO  d:\projects\gathercontent\sitecore\website\bin\system.web.http.dll (Microsoft ASP.NET MVC, 5.2.3-30128 (0e974218e12a67d4b1f25422119e40cfe6953e46))
1824 12:21:19 INFO  d:\projects\gathercontent\sitecore\website\bin\system.web.http.webhost.dll (Microsoft ASP.NET MVC, 5.2.3-30128 (0e974218e12a67d4b1f25422119e40cfe6953e46))
1824 12:21:19 INFO  d:\projects\gathercontent\sitecore\website\bin\system.web.mvc.dll (Microsoft ASP.NET MVC, System.Web.Mvc.dll, 5.2.3-30128 (0e974218e12a67d4b1f25422119e40cfe6953e46))
1824 12:21:19 INFO  d:\projects\gathercontent\sitecore\website\bin\system.web.optimization.dll (System.Web.Optimization)
1824 12:21:19 INFO  d:\projects\gathercontent\sitecore\website\bin\system.web.razor.dll (Microsoft ASP.NET Web Pages, 3.0.3-30128 (0e974218e12a67d4b1f25422119e40cfe6953e46))
1824 12:21:19 INFO  d:\projects\gathercontent\sitecore\website\bin\system.web.webpages.deployment.dll (Microsoft ASP.NET Web Pages, 3.0.3-30128 (0e974218e12a67d4b1f25422119e40cfe6953e46))
1824 12:21:19 INFO  d:\projects\gathercontent\sitecore\website\bin\system.web.webpages.dll (Microsoft ASP.NET Web Pages, 3.0.3-30128 (0e974218e12a67d4b1f25422119e40cfe6953e46))
1824 12:21:19 INFO  d:\projects\gathercontent\sitecore\website\bin\system.web.webpages.razor.dll (Microsoft ASP.NET Web Pages, 3.0.3-30128 (0e974218e12a67d4b1f25422119e40cfe6953e46))
1824 12:21:19 INFO  d:\projects\gathercontent\sitecore\website\bin\telerik.web.ui.dll (Telerik.Web.UI, Telerik UI for ASP.NET AJAX)
1824 12:21:19 INFO  d:\projects\gathercontent\sitecore\website\bin\telerik.web.ui.skins.dll (Telerik.Web.UI.Skins, Telerik UI for ASP.NET AJAX Ajax Skins)
1824 12:21:19 INFO  d:\projects\gathercontent\sitecore\website\bin\tweetsharp.dll (TweetSharp)
1824 12:21:19 INFO  d:\projects\gathercontent\sitecore\website\bin\webgrease.dll (WebGrease)
1824 12:21:19 INFO  d:\projects\gathercontent\sitecore\website\bin\yahoo.yui.compressor.dll (YUI Compressor, A .NET port of the Yahoo! YUI Compressor project)
1824 12:21:19 INFO  
1824 12:21:19 INFO  Operating system Microsoft Windows NT 6.3.9600.0
1824 12:21:19 INFO  
1824 12:21:19 INFO  Microsoft.NET version 4.0.30319.34209
1824 12:21:19 INFO  
1824 12:21:19 INFO  UTC offset: 03:00:00
1824 12:21:19 INFO  Machine name: brimit-dpa
1824 12:21:19 INFO  App pool ID: GatherContent.dev
1824 12:21:19 INFO  
1824 12:21:19 INFO  Process ID: 6140
1824 12:21:19 INFO  Windows identity used by the process: IIS APPPOOL\GatherContent.dev. Impersonation: False
1824 12:21:19 INFO  Managed pipeline mode: Integrated
1824 12:21:19 INFO  
1824 12:21:19 INFO  EventQueues enabled: True
1824 12:21:19 INFO  Instance Name:BRIMIT-DPA-GatherContent.dev
1824 12:21:19 INFO  
1824 12:21:19 INFO  Threshold settings
1824 12:21:19 INFO    Show threshold warnings: False
1824 12:21:19 INFO  
1824 12:21:19 INFO  Databases
1824 12:21:19 INFO    core
1824 12:21:19 INFO    master
1824 12:21:19 INFO    web
1824 12:21:19 INFO    filesystem
1824 12:21:19 INFO  
1824 12:21:19 INFO  Domains
1824 12:21:19 INFO  Heartbeat - Initializing
1824 12:21:19 INFO  Heartbeat - Interval set to: 00:00:02
1824 12:21:19 INFO  Heartbeat - Worker thread started
1824 12:21:19 INFO  Trying to load XML configuration /App_Config/Security/Domains.config
1824 12:21:19 INFO    sitecore
1824 12:21:19 INFO    extranet
1824 12:21:19 INFO    default
1824 12:21:19 INFO  **********************************************************************
1824 12:21:19 INFO  **********************************************************************
ManagedPoolThread #15 12:21:19 WARN  Failed to create counter 'Sitecore.Jobs\Jobs | Jobs Executed / sec'. Sitecore has no necessary permissions for reading/creating counters
ManagedPoolThread #19 12:21:19 WARN  Failed to create counter 'Sitecore.Jobs\Pipelines | Pipelines Aborted / sec'. Sitecore has no necessary permissions for reading/creating counters
ManagedPoolThread #18 12:21:19 WARN  Failed to create counter 'Sitecore.Jobs\Pipelines | Processors Executed / sec'. Sitecore has no necessary permissions for reading/creating counters
ManagedPoolThread #0 12:21:19 WARN  Failed to create counter 'Sitecore.Jobs\Pipelines | Pipelines Executed / sec'. Sitecore has no necessary permissions for reading/creating counters
ManagedPoolThread #17 12:21:19 WARN  Failed to create counter 'Sitecore.Jobs\Publishing | Items Queued / sec'. Sitecore has no necessary permissions for reading/creating counters
ManagedPoolThread #3 12:21:19 WARN  Failed to create counter 'Sitecore.Jobs\Tasks | File Cleanups / sec'. Sitecore has no necessary permissions for reading/creating counters
ManagedPoolThread #1 12:21:19 WARN  Failed to create counter 'Sitecore.Jobs\Publishing | Replacements / sec'. Sitecore has no necessary permissions for reading/creating counters
ManagedPoolThread #4 12:21:19 WARN  Failed to create counter 'Sitecore.Jobs\Tasks | Html Cache Clearings / sec'. Sitecore has no necessary permissions for reading/creating counters
ManagedPoolThread #5 12:21:19 WARN  Failed to create counter 'Sitecore.Jobs\Tasks | Reminders Sent / sec'. Sitecore has no necessary permissions for reading/creating counters
ManagedPoolThread #13 12:21:19 WARN  Failed to create counter 'Sitecore.Jobs\Tasks | Publishings / sec'. Sitecore has no necessary permissions for reading/creating counters
ManagedPoolThread #9 12:21:19 WARN  Failed to create counter 'Sitecore.Jobs\Tasks | Tasks Executed / sec'. Sitecore has no necessary permissions for reading/creating counters
1824 12:21:19 INFO  
1824 12:21:19 INFO  **********************************************************************
1824 12:21:19 INFO  **********************************************************************
1824 12:21:19 INFO  
1824 12:21:19 INFO  xDB is enabled.
1824 12:21:19 INFO  
1824 12:21:19 INFO  Tracking is enabled.
1824 12:21:19 INFO  
1824 12:21:19 INFO  **********************************************************************
1824 12:21:19 INFO  **********************************************************************
1824 12:21:19 INFO  Attempting to get ASP.NET process history
1824 12:21:19 WARN  No process history available
1824 12:21:19 INFO  Cache created: 'LanguageProvider - Languages' (max size: 100KB, running total: 100KB)
1824 12:21:20 INFO  Cache created: 'DeviceItemsCache' (max size: 50MB, running total: 50MB)
1824 12:21:20 INFO  Cache created: 'core[data]' (max size: 100MB, running total: 150MB)
ManagedPoolThread #10 12:21:20 WARN  Failed to create counter 'Sitecore.Caching\Cache Clearings / sec'. Sitecore has no necessary permissions for reading/creating counters
ManagedPoolThread #8 12:21:20 WARN  Failed to create counter 'Sitecore.Caching\Cache Hits / sec'. Sitecore has no necessary permissions for reading/creating counters
ManagedPoolThread #7 12:21:20 WARN  Failed to create counter 'Sitecore.Caching\Cache Misses / sec'. Sitecore has no necessary permissions for reading/creating counters
ManagedPoolThread #6 12:21:20 WARN  Failed to create counter 'Sitecore.Caching\Data Cache Clearings / sec'. Sitecore has no necessary permissions for reading/creating counters
ManagedPoolThread #16 12:21:20 WARN  Failed to create counter 'Sitecore.Caching\Data Cache Hits / sec'. Sitecore has no necessary permissions for reading/creating counters
ManagedPoolThread #11 12:21:20 WARN  Failed to create counter 'Sitecore.Caching\Data Cache Misses / sec'. Sitecore has no necessary permissions for reading/creating counters
ManagedPoolThread #14 12:21:20 WARN  Failed to create counter 'Sitecore.Caching\Html Cache Clearings / sec'. Sitecore has no necessary permissions for reading/creating counters
ManagedPoolThread #12 12:21:20 WARN  Failed to create counter 'Sitecore.Caching\Html Cache Hits / sec'. Sitecore has no necessary permissions for reading/creating counters
ManagedPoolThread #2 12:21:20 WARN  Failed to create counter 'Sitecore.Caching\Html Cache Misses / sec'. Sitecore has no necessary permissions for reading/creating counters
ManagedPoolThread #15 12:21:20 WARN  Failed to create counter 'Sitecore.Caching\Path Cache Clearings / sec'. Sitecore has no necessary permissions for reading/creating counters
ManagedPoolThread #19 12:21:20 WARN  Failed to create counter 'Sitecore.Caching\Path Cache Hits / sec'. Sitecore has no necessary permissions for reading/creating counters
ManagedPoolThread #18 12:21:20 WARN  Failed to create counter 'Sitecore.Caching\Path Cache Misses / sec'. Sitecore has no necessary permissions for reading/creating counters
ManagedPoolThread #0 12:21:20 WARN  Failed to create counter 'Sitecore.Caching\Registry Cache Clearings / sec'. Sitecore has no necessary permissions for reading/creating counters
ManagedPoolThread #17 12:21:20 WARN  Failed to create counter 'Sitecore.Caching\Registry Cache Hits / sec'. Sitecore has no necessary permissions for reading/creating counters
ManagedPoolThread #3 12:21:20 WARN  Failed to create counter 'Sitecore.Caching\Registry Cache Misses / sec'. Sitecore has no necessary permissions for reading/creating counters
ManagedPoolThread #1 12:21:20 WARN  Failed to create counter 'Sitecore.Caching\View State Cache Clearings / sec'. Sitecore has no necessary permissions for reading/creating counters
ManagedPoolThread #4 12:21:20 WARN  Failed to create counter 'Sitecore.Caching\View State Cache Hits / sec'. Sitecore has no necessary permissions for reading/creating counters
ManagedPoolThread #5 12:21:20 WARN  Failed to create counter 'Sitecore.Caching\View State Cache Misses / sec'. Sitecore has no necessary permissions for reading/creating counters
ManagedPoolThread #13 12:21:20 WARN  Failed to create counter 'Sitecore.Caching\XslCache Clearings / sec'. Sitecore has no necessary permissions for reading/creating counters
ManagedPoolThread #9 12:21:20 WARN  Failed to create counter 'Sitecore.Caching\XslCache Hits / sec'. Sitecore has no necessary permissions for reading/creating counters
ManagedPoolThread #10 12:21:20 WARN  Failed to create counter 'Sitecore.Caching\XslCache Misses / sec'. Sitecore has no necessary permissions for reading/creating counters
1824 12:21:20 INFO  Cache created: 'core[items]' (max size: 50MB, running total: 200MB)
1824 12:21:20 INFO  Cache created: 'core[paths]' (max size: 2MB, running total: 202MB)
1824 12:21:20 INFO  Cache created: 'core[standardValues]' (max size: 2MB, running total: 204MB)
1824 12:21:20 INFO  Cache created: 'core[languageFallback]' (max size: 20MB, running total: 224MB)
1824 12:21:20 INFO  Cache created: 'core[isLanguageFallbackValid]' (max size: 100KB, running total: 225MB)
1824 12:21:20 INFO  Cache created: 'core[itempaths]' (max size: 50MB, running total: 275MB)
1824 12:21:20 INFO  Cache created: 'core[blobIDs]' (max size: 500KB, running total: 275MB)
1824 12:21:20 INFO  Cache created: 'master[data]' (max size: 100MB, running total: 375MB)
1824 12:21:20 INFO  Cache created: 'master[items]' (max size: 50MB, running total: 425MB)
1824 12:21:20 INFO  Cache created: 'master[paths]' (max size: 2MB, running total: 428MB)
1824 12:21:20 INFO  Cache created: 'master[standardValues]' (max size: 2MB, running total: 430MB)
1824 12:21:20 INFO  Cache created: 'master[languageFallback]' (max size: 20MB, running total: 450MB)
1824 12:21:20 INFO  Cache created: 'master[isLanguageFallbackValid]' (max size: 100KB, running total: 450MB)
1824 12:21:20 INFO  Cache created: 'master[itempaths]' (max size: 50MB, running total: 500MB)
1824 12:21:20 INFO  Cache created: 'master[blobIDs]' (max size: 500KB, running total: 501MB)
1824 12:21:20 INFO  Cache created: 'web[data]' (max size: 100MB, running total: 601MB)
1824 12:21:20 INFO  Cache created: 'web[items]' (max size: 50MB, running total: 651MB)
1824 12:21:20 INFO  Cache created: 'web[paths]' (max size: 2MB, running total: 653MB)
1824 12:21:20 INFO  Cache created: 'web[standardValues]' (max size: 2MB, running total: 655MB)
1824 12:21:20 INFO  Cache created: 'web[languageFallback]' (max size: 20MB, running total: 675MB)
1824 12:21:20 INFO  Cache created: 'web[isLanguageFallbackValid]' (max size: 100KB, running total: 676MB)
1824 12:21:20 INFO  Cache created: 'web[itempaths]' (max size: 50MB, running total: 726MB)
1824 12:21:20 INFO  Cache created: 'web[blobIDs]' (max size: 500KB, running total: 726MB)
1824 12:21:20 INFO  Cache created: 'filesystem[data]' (max size: 0 bytes, running total: 726MB)
1824 12:21:20 INFO  Cache created: 'filesystem[items]' (max size: 0 bytes, running total: 726MB)
1824 12:21:20 INFO  Cache created: 'filesystem[paths]' (max size: 0 bytes, running total: 726MB)
1824 12:21:20 INFO  Cache created: 'filesystem[standardValues]' (max size: 0 bytes, running total: 726MB)
1824 12:21:20 INFO  Cache created: 'filesystem[languageFallback]' (max size: 20MB, running total: 746MB)
1824 12:21:20 INFO  Cache created: 'filesystem[isLanguageFallbackValid]' (max size: 100KB, running total: 746MB)
1824 12:21:20 INFO  Cache created: 'filesystem[itempaths]' (max size: 50MB, running total: 796MB)
1824 12:21:20 INFO  Cache created: 'filesystem[blobIDs]' (max size: 500KB, running total: 797MB)
ManagedPoolThread #8 12:21:20 WARN  Failed to create counter 'Sitecore.Data\Data.ClientDataReads'. Sitecore has no necessary permissions for reading/creating counters
ManagedPoolThread #7 12:21:20 WARN  Failed to create counter 'Sitecore.Data\Data.ClientDataWrites'. Sitecore has no necessary permissions for reading/creating counters
ManagedPoolThread #16 12:21:20 WARN  Failed to create counter 'Sitecore.Data\Data.PhysicalReads'. Sitecore has no necessary permissions for reading/creating counters
ManagedPoolThread #8 12:21:20 WARN  Failed to create counter 'Sitecore.Data\Data.PhysicalWrites'. Sitecore has no necessary permissions for reading/creating counters
ManagedPoolThread #14 12:21:20 WARN  Failed to create counter 'Sitecore.Data\StreamSharer.OpenStreams'. Sitecore has no necessary permissions for reading/creating counters
ManagedPoolThread #12 12:21:20 WARN  Failed to create counter 'Sitecore.Data\SqlServerStream.OpenStreams'. Sitecore has no necessary permissions for reading/creating counters
ManagedPoolThread #6 12:21:20 WARN  Failed to create counter 'Sitecore.Data\Data.ItemsAccessed'. Sitecore has no necessary permissions for reading/creating counters
ManagedPoolThread #2 12:21:20 WARN  Failed to create counter 'Sitecore.Data\Data | Client Data Reads / sec'. Sitecore has no necessary permissions for reading/creating counters
ManagedPoolThread #15 12:21:20 WARN  Failed to create counter 'Sitecore.Data\Data | Client Data Writes / sec'. Sitecore has no necessary permissions for reading/creating counters
ManagedPoolThread #2 12:21:20 WARN  Failed to create counter 'Sitecore.Data\Data | Items Accessed / sec'. Sitecore has no necessary permissions for reading/creating counters
ManagedPoolThread #15 12:21:20 WARN  Failed to create counter 'Sitecore.Data\Data | Physical Reads / sec'. Sitecore has no necessary permissions for reading/creating counters
ManagedPoolThread #0 12:21:20 WARN  Failed to create counter 'Sitecore.Data\Data | Physical Writes / sec'. Sitecore has no necessary permissions for reading/creating counters
ManagedPoolThread #17 12:21:20 WARN  Failed to create counter 'Sitecore.Data\Globalization | Texts Translated / sec'. Sitecore has no necessary permissions for reading/creating counters
ManagedPoolThread #3 12:21:20 WARN  Failed to create counter 'Sitecore.Data\Globalization | Translate Failed / sec'. Sitecore has no necessary permissions for reading/creating counters
ManagedPoolThread #1 12:21:20 WARN  Failed to create counter 'Sitecore.Data\Links | Fields Examined / sec'. Sitecore has no necessary permissions for reading/creating counters
ManagedPoolThread #4 12:21:20 WARN  Failed to create counter 'Sitecore.Data\Links | Data Read / sec'. Sitecore has no necessary permissions for reading/creating counters
ManagedPoolThread #5 12:21:20 WARN  Failed to create counter 'Sitecore.Data\Links | Data Updated / sec'. Sitecore has no necessary permissions for reading/creating counters
ManagedPoolThread #13 12:21:20 WARN  Failed to create counter 'Sitecore.Data\SqlServerStream | Open Streams / sec'. Sitecore has no necessary permissions for reading/creating counters
ManagedPoolThread #9 12:21:20 WARN  Failed to create counter 'Sitecore.Data\StreamSharer | Open Streams / sec'. Sitecore has no necessary permissions for reading/creating counters
ManagedPoolThread #10 12:21:20 WARN  Failed to create counter 'Sitecore.Data\Workflow | Actions Executed / sec'. Sitecore has no necessary permissions for reading/creating counters
ManagedPoolThread #11 12:21:20 WARN  Failed to create counter 'Sitecore.Data\Workflow | Security Resolved / sec'. Sitecore has no necessary permissions for reading/creating counters
ManagedPoolThread #16 12:21:20 WARN  Failed to create counter 'Sitecore.Data\Workflow | State Changes / sec'. Sitecore has no necessary permissions for reading/creating counters
ManagedPoolThread #8 12:21:21 INFO  Trying to load XML configuration /App_Config/Security/Domains.config
1824 12:21:22 INFO  Cache created: 'SqlDataProvider - Prefetch data(core)' (max size: 50MB, running total: 847MB)
1824 12:21:23 INFO  Cache created: 'ItemCloningRelations' (max size: 50MB, running total: 897MB)
1824 12:21:23 INFO  Cache created: 'AccessResultCache' (max size: 10MB, running total: 907MB)
ManagedPoolThread #7 12:21:23 WARN  Failed to create counter 'Sitecore.Security\Access Denied / sec'. Sitecore has no necessary permissions for reading/creating counters
ManagedPoolThread #14 12:21:23 WARN  Failed to create counter 'Sitecore.Security\Access Granted / sec'. Sitecore has no necessary permissions for reading/creating counters
ManagedPoolThread #7 12:21:23 WARN  Failed to create counter 'Sitecore.Security\Access Resolved / sec'. Sitecore has no necessary permissions for reading/creating counters
ManagedPoolThread #6 12:21:23 WARN  Failed to create counter 'Sitecore.Security\Modify Requests / sec'. Sitecore has no necessary permissions for reading/creating counters
ManagedPoolThread #19 12:21:23 WARN  Failed to create counter 'Sitecore.Security\Programmatic Disabling / sec'. Sitecore has no necessary permissions for reading/creating counters
ManagedPoolThread #18 12:21:23 WARN  Failed to create counter 'Sitecore.Security\Programmatic Enabling / sec'. Sitecore has no necessary permissions for reading/creating counters
ManagedPoolThread #2 12:21:23 WARN  Failed to create counter 'Sitecore.Security\Programmatic User Switch / sec'. Sitecore has no necessary permissions for reading/creating counters
ManagedPoolThread #15 12:21:23 WARN  Failed to create counter 'Sitecore.Security\Read Requests / sec'. Sitecore has no necessary permissions for reading/creating counters
ManagedPoolThread #0 12:21:23 WARN  Failed to create counter 'Sitecore.Security\Virtual Users Built / sec'. Sitecore has no necessary permissions for reading/creating counters
1824 12:21:23 INFO  Cache created: 'ProxyProvider' (max size: 500KB, running total: 907MB)
1824 12:21:23 INFO  Loading Dictionary from cache
1824 12:21:23 INFO  MemoryMonitor initialized. Threshold: 2 GB. Interval: 00:00:05
1824 12:21:23 INFO  [Analytics]: Started background service for 'maintenanceService'.
1824 12:21:23 INFO  Cache created: 'taxonomy.campaigngroups' (max size: 20MB, running total: 927MB)
1824 12:21:23 INFO  Cache created: 'taxonomy.channels' (max size: 20MB, running total: 947MB)
1824 12:21:23 INFO  Cache created: 'taxonomy.venues' (max size: 20MB, running total: 967MB)
1824 12:21:23 INFO  Cache created: 'taxonomy.assets' (max size: 20MB, running total: 987MB)
1824 12:21:23 INFO  Cache created: 'taxonomy.outcomeGroups' (max size: 20MB, running total: 1007MB)
1824 12:21:23 INFO  [Analytics]: Started background service for 'aggregation/aggregator'.
1824 12:21:23 INFO  [Analytics]: Started background service for 'aggregation/contactProcessing'.
1824 12:21:23 INFO  [Analytics]: Started background service for 'aggregation/cleanup'.
1824 12:21:23 INFO  [Analytics]: Started background service for 'aggregation/recovery'.
1824 12:21:23 INFO  [Analytics]: Started background service for 'aggregation/rebuildAgent'.
1824 12:21:23 INFO  [Analytics]: Started background service for 'aggregation/historyWorker'.
1824 12:21:23 INFO  [Analytics]: Started background service for 'aggregation/historyCompletionCheck'.
1824 12:21:23 INFO  [Analytics]: Started background service for 'aggregation/automationAggregator'.
1824 12:21:23 INFO  [Analytics]: Started background service for 'aggregation/automationRangeManager'.
1824 12:21:23 INFO  [Analytics]: Started background service for 'aggregation/automationCleanupService'.
1824 12:21:23 INFO  [Analytics]: Automation aggregation SubsystemLoader hook initialized.
1824 12:21:23 INFO  [Analytics]: Started background service for 'processing/taskAgent'.
1824 12:21:23 INFO  Cache created: 'rules' (max size: 800KB, running total: 1008MB)
1824 12:21:23 INFO  Cache created: '[FieldReaderCache]' (max size: 5MB, running total: 1013MB)
4076 12:21:23 INFO  Cache created: 'SqlDataProvider - Property data(core)' (max size: 500KB, running total: 1013MB)
4076 12:21:23 INFO  Cache created: 'SqlDataProvider - Property data(master)' (max size: 500KB, running total: 1014MB)
4076 12:21:23 INFO  Cache created: 'SqlDataProvider - Property data(web)' (max size: 500KB, running total: 1014MB)
1824 12:21:23 INFO  [Analytics]: Started background service for 'pathAnalyzer/newMapAgent'.
1824 12:21:23 INFO  [Analytics]: Started background service for 'pathAnalyzer/smartMergeAgent'.
1824 12:21:23 INFO  [Analytics]: Started background service for 'aggregation/pathAnalyzerLiveAgent'.
1824 12:21:23 INFO  [Analytics]: Started background service for 'aggregation/pathAnalyzerHistoryAgent'.
1824 12:21:23 INFO  [Analytics]: Started background service for 'pathAnalyzer/trailCleanupAgent'.
1824 12:21:23 INFO  [Analytics]: Started background service for 'pathAnalyzer/mapRebuildStatusCheckerAgent'.
1824 12:21:23 INFO  [Path Analyzer](.) Path Analyzer subsystem hook initialized.
1824 12:21:23 INFO  [Analytics]: Started background service for 'experienceAnalytics/reduce/agent'.
1824 12:21:23 INFO  [Experience Analytics]: ExperienceAnalytics reduce subsystem initialized.
1824 12:21:23 INFO  Scheduler - Initializing
1824 12:21:23 INFO  Cache created: 'UserProfileCache' (max size: 5MB, running total: 1019MB)
1824 12:21:23 INFO  Cache created: 'clientData' (max size: 25MB, running total: 1044MB)
1824 12:21:23 INFO  Scheduler - Interval set to: 00:00:05
1824 12:21:23 INFO  Scheduler - Worker thread started
1824 12:21:23 ERROR WebDAV License file 'D:\projects\GatherContent\Sitecore\Website\data\webdav.lic' not found.
ManagedPoolThread #9 12:21:24 WARN  Failed to create counter 'Sitecore.Automation\State Transitions / sec'. Sitecore has no necessary permissions for reading/creating counters
ManagedPoolThread #10 12:21:24 WARN  Failed to create counter 'Sitecore.Automation\State Evaluations - Total / sec'. Sitecore has no necessary permissions for reading/creating counters
ManagedPoolThread #11 12:21:24 WARN  Failed to create counter 'Sitecore.Automation\State Evaluations - Page Events / sec'. Sitecore has no necessary permissions for reading/creating counters
ManagedPoolThread #16 12:21:24 WARN  Failed to create counter 'Sitecore.Automation\State Evaluations - Timeouts / sec'. Sitecore has no necessary permissions for reading/creating counters
ManagedPoolThread #8 12:21:24 WARN  Failed to create counter 'Sitecore.Automation\Emails Sent / sec'. Sitecore has no necessary permissions for reading/creating counters
ManagedPoolThread #14 12:21:24 WARN  Failed to create counter 'Sitecore.Automation\Average Evaluation Time Average Base'. Sitecore has no necessary permissions for reading/creating counters
ManagedPoolThread #7 12:21:24 WARN  Failed to create counter 'Sitecore.Automation\Average State Load Time - Contact'. Sitecore has no necessary permissions for reading/creating counters
ManagedPoolThread #6 12:21:24 WARN  Failed to create counter 'Sitecore.Automation\Average State Load Time - Contact Average Base'. Sitecore has no necessary permissions for reading/creating counters
ManagedPoolThread #18 12:21:24 WARN  Failed to create counter 'Sitecore.Automation\Monitor - Average Time to Load Data - ms Average Base'. Sitecore has no necessary permissions for reading/creating counters
ManagedPoolThread #19 12:21:24 WARN  Failed to create counter 'Sitecore.Automation\Monitor - Average Time to Load Data - ms'. Sitecore has no necessary permissions for reading/creating counters
ManagedPoolThread #2 12:21:24 WARN  Failed to create counter 'Sitecore.Automation\Aggregation | Automation Transitions Aggregated / sec'. Sitecore has no necessary permissions for reading/creating counters
ManagedPoolThread #15 12:21:24 WARN  Failed to create counter 'Sitecore.Automation\Aggregation | Contact States Aggregated / sec'. Sitecore has no necessary permissions for reading/creating counters
ManagedPoolThread #0 12:21:24 WARN  Failed to create counter 'Sitecore.Automation\Aggregation | Transition Aggregation Errors / sec'. Sitecore has no necessary permissions for reading/creating counters
ManagedPoolThread #9 12:21:24 WARN  Failed to create counter 'Sitecore.Automation\Aggregation | Contact State Aggregation Errors / sec'. Sitecore has no necessary permissions for reading/creating counters
ManagedPoolThread #10 12:21:24 WARN  Failed to create counter 'Sitecore.Automation\Aggregation | Average Automation Aggregation Pipeline Time / sec'. Sitecore has no necessary permissions for reading/creating counters
ManagedPoolThread #11 12:21:24 WARN  Failed to create counter 'Sitecore.Automation\Aggregation | Average Automation Aggregation Pipeline Time / sec Average Base'. Sitecore has no necessary permissions for reading/creating counters
ManagedPoolThread #8 12:21:24 WARN  Failed to create counter 'Sitecore.Automation\Aggregation | Average Transition Store In Reporting / sec'. Sitecore has no necessary permissions for reading/creating counters
ManagedPoolThread #16 12:21:24 WARN  Failed to create counter 'Sitecore.Automation\Aggregation | Average Transition Store In Reporting / sec Average Base'. Sitecore has no necessary permissions for reading/creating counters
ManagedPoolThread #14 12:21:24 WARN  Failed to create counter 'Sitecore.Automation\Aggregation | Average Contact States Store In Reporting / sec'. Sitecore has no necessary permissions for reading/creating counters
ManagedPoolThread #7 12:21:24 WARN  Failed to create counter 'Sitecore.Automation\Aggregation | Average Contact States Store In Reporting / sec Average Base'. Sitecore has no necessary permissions for reading/creating counters
ManagedPoolThread #6 12:21:24 WARN  Failed to create counter 'Sitecore.Automation\Data | Average Delete Aggregated Transitions Time / sec'. Sitecore has no necessary permissions for reading/creating counters
ManagedPoolThread #19 12:21:24 WARN  Failed to create counter 'Sitecore.Automation\Data | Average Merge Transition Time/ sec'. Sitecore has no necessary permissions for reading/creating counters
ManagedPoolThread #2 12:21:24 WARN  Failed to create counter 'Sitecore.Automation\Data | Average Merge Transition Time/ sec Average Base'. Sitecore has no necessary permissions for reading/creating counters
1824 12:21:24 INFO  Sitecore.Analytics.Automation.Diagnostics.PerformanceCounters are initialized
ManagedPoolThread #12 12:21:24 WARN  Failed to create counter 'Sitecore.Automation\Average Evaluation Time'. Sitecore has no necessary permissions for reading/creating counters
ManagedPoolThread #18 12:21:24 WARN  Failed to create counter 'Sitecore.Automation\Data | Average Delete Aggregated Transitions Time / sec Average Base'. Sitecore has no necessary permissions for reading/creating counters
ManagedPoolThread #15 12:21:24 WARN  Failed to create counter 'Sitecore.Analytics.Tracking\Collection | Total Requests / sec'. Sitecore has no necessary permissions for reading/creating counters
ManagedPoolThread #0 12:21:24 WARN  Failed to create counter 'Sitecore.Analytics.Tracking\Collection | Requests Tracked / sec'. Sitecore has no necessary permissions for reading/creating counters
ManagedPoolThread #9 12:21:24 WARN  Failed to create counter 'Sitecore.Analytics.Tracking\Collection | Requests Ignored / sec'. Sitecore has no necessary permissions for reading/creating counters
ManagedPoolThread #10 12:21:24 WARN  Failed to create counter 'Sitecore.Analytics.Tracking\Collection | Malicious Robot Requests / sec'. Sitecore has no necessary permissions for reading/creating counters
ManagedPoolThread #11 12:21:24 WARN  Failed to create counter 'Sitecore.Analytics.Tracking\Collection | Robot Requests / sec'. Sitecore has no necessary permissions for reading/creating counters
ManagedPoolThread #8 12:21:24 WARN  Failed to create counter 'Sitecore.Analytics.Tracking\Collection | Human Requests / sec'. Sitecore has no necessary permissions for reading/creating counters
ManagedPoolThread #16 12:21:24 WARN  Failed to create counter 'Sitecore.Analytics.Tracking\Collection | Total Visits / sec'. Sitecore has no necessary permissions for reading/creating counters
ManagedPoolThread #14 12:21:24 WARN  Failed to create counter 'Sitecore.Analytics.Tracking\Collection | Unique Visitors / sec'. Sitecore has no necessary permissions for reading/creating counters
ManagedPoolThread #7 12:21:24 WARN  Failed to create counter 'Sitecore.Analytics.Tracking\Data | Dictionaries - Locations Reads / sec'. Sitecore has no necessary permissions for reading/creating counters
ManagedPoolThread #6 12:21:24 WARN  Failed to create counter 'Sitecore.Analytics.Tracking\Data | Dictionaries - Locations Cache Hits / sec'. Sitecore has no necessary permissions for reading/creating counters
ManagedPoolThread #19 12:21:24 WARN  Failed to create counter 'Sitecore.Analytics.Tracking\Data | Dictionaries - Locations Database Reads / sec'. Sitecore has no necessary permissions for reading/creating counters
ManagedPoolThread #2 12:21:24 WARN  Failed to create counter 'Sitecore.Analytics.Tracking\Data | Dictionaries - Locations Writes / sec'. Sitecore has no necessary permissions for reading/creating counters
ManagedPoolThread #12 12:21:24 WARN  Failed to create counter 'Sitecore.Analytics.Tracking\Data | Dictionaries - ReferringSites Reads / sec'. Sitecore has no necessary permissions for reading/creating counters
ManagedPoolThread #18 12:21:24 WARN  Failed to create counter 'Sitecore.Analytics.Tracking\Data | Dictionaries - ReferringSites Cache Hits / sec'. Sitecore has no necessary permissions for reading/creating counters
ManagedPoolThread #15 12:21:24 WARN  Failed to create counter 'Sitecore.Analytics.Tracking\Data | Dictionaries - ReferringSites Database Reads / sec'. Sitecore has no necessary permissions for reading/creating counters
ManagedPoolThread #15 12:21:24 WARN  Failed to create counter 'Sitecore.Analytics.Tracking\Data | Dictionaries - ReferringSites Writes / sec'. Sitecore has no necessary permissions for reading/creating counters
ManagedPoolThread #9 12:21:24 WARN  Failed to create counter 'Sitecore.Analytics.Tracking\Data | Dictionaries - UserAgents Reads / sec'. Sitecore has no necessary permissions for reading/creating counters
ManagedPoolThread #10 12:21:24 WARN  Failed to create counter 'Sitecore.Analytics.Tracking\Data | Dictionaries - UserAgents Cache Hits / sec'. Sitecore has no necessary permissions for reading/creating counters
ManagedPoolThread #11 12:21:24 WARN  Failed to create counter 'Sitecore.Analytics.Tracking\Data | Dictionaries - UserAgents Database Reads / sec'. Sitecore has no necessary permissions for reading/creating counters
ManagedPoolThread #8 12:21:24 WARN  Failed to create counter 'Sitecore.Analytics.Tracking\Data | Dictionaries - UserAgents Writes / sec'. Sitecore has no necessary permissions for reading/creating counters
ManagedPoolThread #16 12:21:24 WARN  Failed to create counter 'Sitecore.Analytics.Tracking\Data | Dictionaries - GeoIps Reads / sec'. Sitecore has no necessary permissions for reading/creating counters
ManagedPoolThread #14 12:21:24 WARN  Failed to create counter 'Sitecore.Analytics.Tracking\Data | Dictionaries - GeoIps Cache Hits / sec'. Sitecore has no necessary permissions for reading/creating counters
ManagedPoolThread #7 12:21:24 WARN  Failed to create counter 'Sitecore.Analytics.Tracking\Data | Dictionaries - GeoIps Database Reads / sec'. Sitecore has no necessary permissions for reading/creating counters
ManagedPoolThread #6 12:21:24 WARN  Failed to create counter 'Sitecore.Analytics.Tracking\Data | Dictionaries - GeoIps Writes / sec'. Sitecore has no necessary permissions for reading/creating counters
ManagedPoolThread #19 12:21:24 WARN  Failed to create counter 'Sitecore.Analytics.Tracking\GeoIP | Requests - Total / sec'. Sitecore has no necessary permissions for reading/creating counters
ManagedPoolThread #2 12:21:24 WARN  Failed to create counter 'Sitecore.Analytics.Tracking\GeoIP | Requests - Pages / sec'. Sitecore has no necessary permissions for reading/creating counters
ManagedPoolThread #12 12:21:24 WARN  Failed to create counter 'Sitecore.Analytics.Tracking\GeoIP | Requests - Background / sec'. Sitecore has no necessary permissions for reading/creating counters
ManagedPoolThread #18 12:21:24 WARN  Failed to create counter 'Sitecore.Analytics.Tracking\GeoIP | Memory Lookups / sec'. Sitecore has no necessary permissions for reading/creating counters
ManagedPoolThread #0 12:21:24 WARN  Failed to create counter 'Sitecore.Analytics.Tracking\GeoIP | Database Lookups / sec'. Sitecore has no necessary permissions for reading/creating counters
ManagedPoolThread #15 12:21:24 WARN  Failed to create counter 'Sitecore.Analytics.Tracking\GeoIP | Provider Lookups / sec'. Sitecore has no necessary permissions for reading/creating counters
ManagedPoolThread #9 12:21:24 WARN  Failed to create counter 'Sitecore.Analytics.Tracking\GeoIP | Failed Lookups / sec'. Sitecore has no necessary permissions for reading/creating counters
ManagedPoolThread #9 12:21:24 WARN  Failed to create counter 'Sitecore.Analytics.Tracking\GeoIP | Unknown IPs / sec'. Sitecore has no necessary permissions for reading/creating counters
ManagedPoolThread #11 12:21:24 WARN  Failed to create counter 'Sitecore.Analytics.Tracking\GeoIP | Average Resolve Time'. Sitecore has no necessary permissions for reading/creating counters
ManagedPoolThread #8 12:21:24 WARN  Failed to create counter 'Sitecore.Analytics.Tracking\GeoIP | Average Resolve Time Average Base'. Sitecore has no necessary permissions for reading/creating counters
ManagedPoolThread #16 12:21:24 WARN  Failed to create counter 'Sitecore.Analytics.Tracking\GeoIP | Cache Size'. Sitecore has no necessary permissions for reading/creating counters
ManagedPoolThread #14 12:21:24 WARN  Failed to create counter 'Sitecore.Analytics.Tracking\GeoIP | Visits Updated / sec'. Sitecore has no necessary permissions for reading/creating counters
ManagedPoolThread #7 12:21:24 WARN  Failed to create counter 'Sitecore.Analytics.Tracking\GeoIP | Average Calls Before IP Resolved'. Sitecore has no necessary permissions for reading/creating counters
1824 12:21:24 INFO  Sitecore.Analytics.Tracking.Diagnostics.PerformanceCounters are initialized
ManagedPoolThread #14 12:21:24 WARN  Failed to create counter 'Sitecore.Analytics.Tracking\GeoIP | Average Calls Before IP Resolved Average Base'. Sitecore has no necessary permissions for reading/creating counters
ManagedPoolThread #19 12:21:24 WARN  Failed to create counter 'Sitecore.Analytics\Data | Rows Saved - Total / sec'. Sitecore has no necessary permissions for reading/creating counters
ManagedPoolThread #2 12:21:24 WARN  Failed to create counter 'Sitecore.Analytics\Data | Rows Saved - Bulk Copy / sec'. Sitecore has no necessary permissions for reading/creating counters
ManagedPoolThread #12 12:21:24 WARN  Failed to create counter 'Sitecore.Analytics\Data | Rows Saved - Batch / sec'. Sitecore has no necessary permissions for reading/creating counters
ManagedPoolThread #18 12:21:24 WARN  Failed to create counter 'Sitecore.Analytics\Data | Rows Saved - Row By Row / sec'. Sitecore has no necessary permissions for reading/creating counters
ManagedPoolThread #0 12:21:24 WARN  Failed to create counter 'Sitecore.Analytics\Data | Rows Failed to Save / sec'. Sitecore has no necessary permissions for reading/creating counters
ManagedPoolThread #15 12:21:24 WARN  Failed to create counter 'Sitecore.Analytics\Data | Commit Queue Length'. Sitecore has no necessary permissions for reading/creating counters
ManagedPoolThread #15 12:21:24 WARN  Failed to create counter 'Sitecore.Analytics\Data | Commit Queue Flush Length'. Sitecore has no necessary permissions for reading/creating counters
ManagedPoolThread #9 12:21:24 WARN  Failed to create counter 'Sitecore.Analytics\Data | Tracker Flushes - Total / sec'. Sitecore has no necessary permissions for reading/creating counters
ManagedPoolThread #11 12:21:24 WARN  Failed to create counter 'Sitecore.Analytics\Data | Tracker Flushes - Explicit / sec'. Sitecore has no necessary permissions for reading/creating counters
ManagedPoolThread #8 12:21:24 WARN  Failed to create counter 'Sitecore.Analytics\Data | Tracker Flushes - Inline / sec'. Sitecore has no necessary permissions for reading/creating counters
ManagedPoolThread #16 12:21:24 WARN  Failed to create counter 'Sitecore.Analytics\Data | Tracker Flushes - Timeout / sec'. Sitecore has no necessary permissions for reading/creating counters
ManagedPoolThread #6 12:21:24 WARN  Failed to create counter 'Sitecore.Analytics\Data | Tracker Flushes - Capacity Overflow'. Sitecore has no necessary permissions for reading/creating counters
ManagedPoolThread #14 12:21:24 WARN  Failed to create counter 'Sitecore.Analytics\Data | Average Tracker Flush Time Average Base'. Sitecore has no necessary permissions for reading/creating counters
ManagedPoolThread #19 12:21:24 WARN  Failed to create counter 'Sitecore.Analytics\Data | Last Tracker Flush Time'. Sitecore has no necessary permissions for reading/creating counters
ManagedPoolThread #7 12:21:24 WARN  Failed to create counter 'Sitecore.Analytics\Data | Average Tracker Flush Time'. Sitecore has no necessary permissions for reading/creating counters
ManagedPoolThread #2 12:21:24 WARN  Failed to create counter 'Sitecore.Analytics\Data | Aggregation - Visits saved to reporting database / sec'. Sitecore has no necessary permissions for reading/creating counters
ManagedPoolThread #12 12:21:24 WARN  Failed to create counter 'Sitecore.Analytics\Aggregation | Live Interactions Processed / sec'. Sitecore has no necessary permissions for reading/creating counters
ManagedPoolThread #18 12:21:24 WARN  Failed to create counter 'Sitecore.Analytics\Aggregation | History Interactions Processed / sec'. Sitecore has no necessary permissions for reading/creating counters
ManagedPoolThread #0 12:21:24 WARN  Failed to create counter 'Sitecore.Analytics\Aggregation | Total Interactions Processed / sec'. Sitecore has no necessary permissions for reading/creating counters
ManagedPoolThread #10 12:21:24 WARN  Failed to create counter 'Sitecore.Analytics\Aggregation | Live Aggregation Errors / sec'. Sitecore has no necessary permissions for reading/creating counters
ManagedPoolThread #15 12:21:24 WARN  Failed to create counter 'Sitecore.Analytics\Aggregation | History Aggregation Errors / sec'. Sitecore has no necessary permissions for reading/creating counters
ManagedPoolThread #9 12:21:24 WARN  Failed to create counter 'Sitecore.Analytics\Aggregation | Total Aggregation Errors / sec'. Sitecore has no necessary permissions for reading/creating counters
ManagedPoolThread #11 12:21:24 WARN  Failed to create counter 'Sitecore.Analytics\Aggregation | Contacts Processed / sec'. Sitecore has no necessary permissions for reading/creating counters
ManagedPoolThread #8 12:21:24 WARN  Failed to create counter 'Sitecore.Analytics\Aggregation | Contact Processing Errors / sec'. Sitecore has no necessary permissions for reading/creating counters
ManagedPoolThread #6 12:21:24 WARN  Failed to create counter 'Sitecore.Analytics\Aggregation | Average Batch Size - Live Average Base'. Sitecore has no necessary permissions for reading/creating counters
ManagedPoolThread #14 12:21:24 WARN  Failed to create counter 'Sitecore.Analytics\Aggregation | Average Batch Size - History'. Sitecore has no necessary permissions for reading/creating counters
ManagedPoolThread #19 12:21:24 WARN  Failed to create counter 'Sitecore.Analytics\Aggregation | Average Batch Size - History Average Base'. Sitecore has no necessary permissions for reading/creating counters
ManagedPoolThread #7 12:21:24 WARN  Failed to create counter 'Sitecore.Analytics\Aggregation | Number of Batches Containing Failing Items - Live'. Sitecore has no necessary permissions for reading/creating counters
ManagedPoolThread #16 12:21:24 WARN  Failed to create counter 'Sitecore.Analytics\Aggregation | Average Batch Size - Live'. Sitecore has no necessary permissions for reading/creating counters
ManagedPoolThread #2 12:21:24 WARN  Failed to create counter 'Sitecore.Analytics\Aggregation | Number of Batches Containing Failing Items - History'. Sitecore has no necessary permissions for reading/creating counters
ManagedPoolThread #18 12:21:24 WARN  Failed to create counter 'Sitecore.Analytics\Aggregation | Average Aggregation Pipeline Time (ms) Average Base'. Sitecore has no necessary permissions for reading/creating counters
ManagedPoolThread #0 12:21:24 WARN  Failed to create counter 'Sitecore.Analytics\Aggregation | Average Write Time (ms)'. Sitecore has no necessary permissions for reading/creating counters
ManagedPoolThread #12 12:21:24 WARN  Failed to create counter 'Sitecore.Analytics\Aggregation | Average Aggregation Pipeline Time (ms)'. Sitecore has no necessary permissions for reading/creating counters
ManagedPoolThread #10 12:21:24 WARN  Failed to create counter 'Sitecore.Analytics\Aggregation | Average Write Time (ms) Average Base'. Sitecore has no necessary permissions for reading/creating counters
ManagedPoolThread #9 12:21:24 WARN  Failed to create counter 'Sitecore.Analytics\Aggregation | Average Contact Processing Pipeline Time (ms) Average Base'. Sitecore has no necessary permissions for reading/creating counters
ManagedPoolThread #8 12:21:24 WARN  Failed to create counter 'Sitecore.Analytics\Aggregation | Average Write Time - Primary (ms) Average Base'. Sitecore has no necessary permissions for reading/creating counters
ManagedPoolThread #15 12:21:24 WARN  Failed to create counter 'Sitecore.Analytics\Aggregation | Average Contact Processing Pipeline Time (ms)'. Sitecore has no necessary permissions for reading/creating counters
ManagedPoolThread #6 12:21:24 WARN  Failed to create counter 'Sitecore.Analytics\Aggregation | Average Write Time - Secondary, Live (ms)'. Sitecore has no necessary permissions for reading/creating counters
ManagedPoolThread #11 12:21:24 WARN  Failed to create counter 'Sitecore.Analytics\Aggregation | Average Write Time - Primary (ms)'. Sitecore has no necessary permissions for reading/creating counters
ManagedPoolThread #14 12:21:24 WARN  Failed to create counter 'Sitecore.Analytics\Aggregation | Average Write Time - Secondary, Live (ms) Average Base'. Sitecore has no necessary permissions for reading/creating counters
ManagedPoolThread #7 12:21:24 WARN  Failed to create counter 'Sitecore.Analytics\Aggregation | Average Write Time - Secondary, History (ms) Average Base'. Sitecore has no necessary permissions for reading/creating counters
ManagedPoolThread #19 12:21:24 WARN  Failed to create counter 'Sitecore.Analytics\Aggregation | Average Write Time - Secondary, History (ms)'. Sitecore has no necessary permissions for reading/creating counters
ManagedPoolThread #16 12:21:24 WARN  Failed to create counter 'Sitecore.Analytics\Aggregation | Active Interaction Aggregators'. Sitecore has no necessary permissions for reading/creating counters
ManagedPoolThread #18 12:21:24 WARN  Failed to create counter 'Sitecore.Analytics\Aggregation | Average Check Out Time - Live (ms) Average Base'. Sitecore has no necessary permissions for reading/creating counters
ManagedPoolThread #12 12:21:24 WARN  Failed to create counter 'Sitecore.Analytics\Aggregation | Average Check In Time - Live (ms) Average Base'. Sitecore has no necessary permissions for reading/creating counters
ManagedPoolThread #0 12:21:24 WARN  Failed to create counter 'Sitecore.Analytics\Aggregation | Average Check In Time - Live (ms)'. Sitecore has no necessary permissions for reading/creating counters
ManagedPoolThread #2 12:21:24 WARN  Failed to create counter 'Sitecore.Analytics\Aggregation | Average Check Out Time - Live (ms)'. Sitecore has no necessary permissions for reading/creating counters
ManagedPoolThread #9 12:21:24 WARN  Failed to create counter 'Sitecore.Analytics\Aggregation | Average Check Out Time - History (ms) Average Base'. Sitecore has no necessary permissions for reading/creating counters
ManagedPoolThread #10 12:21:24 WARN  Failed to create counter 'Sitecore.Analytics\Aggregation | Average Check Out Time - History (ms)'. Sitecore has no necessary permissions for reading/creating counters
ManagedPoolThread #8 12:21:24 WARN  Failed to create counter 'Sitecore.Analytics\Aggregation | Average Check In Time - History (ms)'. Sitecore has no necessary permissions for reading/creating counters
ManagedPoolThread #15 12:21:24 WARN  Failed to create counter 'Sitecore.Analytics\Aggregation | Average Check In Time - History (ms) Average Base'. Sitecore has no necessary permissions for reading/creating counters
1824 12:21:24 INFO  Sitecore.Analytics.Diagnostics.PerformanceCounters are initialized
1824 12:21:24 INFO  DumpConfigurationFiles: Started
8180 12:21:24 INFO  DumpConfigurationFiles: Dump folder is D:\projects\GatherContent\Sitecore\Website\data\diagnostics\configuration_history\20151113Z.092124Z
8180 12:21:25 INFO  DumpConfigurationFiles: D:\projects\GatherContent\Sitecore\Website\App_Config has been dumped
8180 12:21:25 INFO  DumpConfigurationFiles: D:\projects\GatherContent\Sitecore\Website\Web.config has been dumped
8180 12:21:25 INFO  DumpConfigurationFiles: D:\projects\GatherContent\Sitecore\Website\Global.asax has been dumped
8180 12:21:25 INFO  DumpConfigurationFiles: D:\projects\GatherContent\Sitecore\Website\sitecore\shell\sitecore.version.xml has been dumped
8180 12:21:25 INFO  DumpConfigurationFiles: Zipping of the dumped configuration files is enabled
1824 12:21:25 INFO  Sitecore.Social: The Social MVC area is registered.
8180 12:21:25 INFO  DumpConfigurationFiles: D:\projects\GatherContent\Sitecore\Website\data\diagnostics\configuration_history\20151113Z.092124Z.zip has been created
8180 12:21:25 INFO  DumpConfigurationFiles: D:\projects\GatherContent\Sitecore\Website\data\diagnostics\configuration_history\20151113Z.092124Z has been removed
8180 12:21:25 INFO  DumpConfigurationFiles: Completed
ManagedPoolThread #3 12:21:25 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
1824 12:21:26 INFO  [Sitecore Mvc]: Registered area : AppCenter
ManagedPoolThread #13 12:21:26 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
1824 12:21:26 INFO  Filter (Sitecore.Services.Infrastructure.Web.Http.Filters.AnonymousUserFilter) instance created
1824 12:21:26 INFO  Filter (Sitecore.Services.Infrastructure.Web.Http.Filters.LoggingExceptionFilter) instance created
1824 12:21:26 INFO  Filter (Sitecore.Services.Infrastructure.Web.Http.Filters.SecurityPolicyAuthorisationFilter) instance created
1824 12:21:26 INFO  [Path Analyzer](ApplicationContainer.RegisterType) Sitecore.SequenceAnalyzer.Data.ITreeStorage
1824 12:21:26 INFO  [Path Analyzer](ApplicationContainer.RegisterType) Sitecore.PathAnalyzer.Data.Storage.ITreeDefinitionStorage
1824 12:21:26 INFO  [Path Analyzer](ApplicationContainer.RegisterType) Sitecore.PathAnalyzer.Contracts.ITreeDefinitionService
1824 12:21:26 INFO  [Path Analyzer](ApplicationContainer.RegisterType) Sitecore.PathAnalyzer.Contracts.IMapItemRepository
1824 12:21:26 INFO  [Path Analyzer](ApplicationContainer.RegisterType) Sitecore.PathAnalyzer.Contracts.IMapStatusService
1824 12:21:26 INFO  [Path Analyzer](ApplicationContainer.RegisterType) Sitecore.PathAnalyzer.Contracts.IConfiguration
1824 12:21:26 INFO  [Path Analyzer](ApplicationContainer.RegisterType) Sitecore.SequenceAnalyzer.Configuration.IPruningConfig
1824 12:21:26 INFO  [Path Analyzer](ApplicationContainer.RegisterType) Sitecore.PathAnalyzer.Contracts.IContactReader
1824 12:21:26 INFO  [Path Analyzer](ApplicationContainer.RegisterType) Sitecore.PathAnalyzer.Contracts.IWebRequestFactory
1824 12:21:26 WARN  [Path Analyzer](ApplicationContainer.RegisterType) Failed for Sitecore.PathAnalyzer.Contracts.IWebRequestFactory. Config entry pathAnalyzer/webRequestFactory doesn't exist
1824 12:21:26 INFO  [Path Analyzer](ApplicationContainer.RegisterType) Sitecore.PathAnalyzer.Localization.IResourceManager
1824 12:21:26 INFO  [Path Analyzer](ApplicationContainer.RegisterType) Sitecore.PathAnalyzer.Data.Caching.ITreeCache
1824 12:21:26 INFO  [Path Analyzer](ApplicationContainer.RegisterType) Sitecore.PathAnalyzer.Contracts.ITreeProvider
1824 12:21:26 INFO  [Path Analyzer](ApplicationContainer.RegisterType) Sitecore.PathAnalyzer.Data.SitecoreData.IItemRepository
1824 12:21:26 INFO  [Path Analyzer](ApplicationContainer.RegisterType) Sitecore.PathAnalyzer.Contracts.IMapItemDeploymentManager
1824 12:21:26 INFO  [Path Analyzer](ApplicationContainer.RegisterType) Sitecore.PathAnalyzer.Data.Storage.ITreeStorageManager
1824 12:21:26 INFO  [Path Analyzer](ApplicationContainer.RegisterModelsForSerialization) Setting serialization info
1824 12:21:26 INFO  [Path Analyzer](ApplicationContainer.RegisterModelsForSerialization) Type 'Sitecore.PathAnalyzer.Data.Models.ExperienceNode, Sitecore.PathAnalyzer' was registered succesfully.
1824 12:21:26 INFO  [Path Analyzer](ApplicationContainer.RegisterModelsForSerialization) Type 'Sitecore.PathAnalyzer.Data.Models.ExperienceTree, Sitecore.PathAnalyzer' was registered succesfully.
1824 12:21:26 INFO  [Path Analyzer](ApplicationContainer.RegisterModelsForSerialization) Type 'Sitecore.PathAnalyzer.Data.Models.PageNode, Sitecore.PathAnalyzer' was registered succesfully.
1824 12:21:26 INFO  [Experience Analytics]: ExperienceAnalytics SyncSegmentsProcessor
8244 12:21:26 INFO  [Experience Analytics]: Segment Deploy started.
1824 12:21:26 INFO  [Experience Analytics]: WebApiInitializer
1824 12:21:26 INFO  [Experience Analytics]: Filter (Sitecore.ExperienceAnalytics.Api.Http.Filters.CacheHeaderFilterAttribute) added
1428 12:21:26 INFO  Precompiling SPEAK Views: 60
1428 12:21:26 INFO  Precompiling SPEAK View: ~\sitecore\shell\client\Applications\ContentTesting\Components\Behaviours\MultiSelectListExtended.cshtml
1824 12:21:26 INFO  Sitecore.Social: The Social remote events are initialized.
5872 12:21:26 INFO  Precompiling SPEAK Views: 188
5872 12:21:26 INFO  Precompiling SPEAK View: ~\sitecore\shell\client\Business Component Library\Layouts\Renderings\Authentications\AccountInformation\AccountInformation.cshtml
8180 12:21:26 INFO  HttpModule is being initialized
ManagedPoolThread #1 12:21:27 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
8180 12:21:27 INFO  Cache created: 'SqlDataProvider - Prefetch data(web)' (max size: 50MB, running total: 1094MB)
8180 12:21:27 INFO  Cache created: 'shell[html]' (max size: 0 bytes, running total: 1094MB)
8244 12:21:27 INFO  Cache created: 'SqlDataProvider - Prefetch data(master)' (max size: 100MB, running total: 1194MB)
ManagedPoolThread #17 12:21:28 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
8244 12:21:28 INFO  Cache created: 'IsUserInRoleCache' (max size: 5MB, running total: 1199MB)
8244 12:21:28 INFO  Trying to load XML configuration /App_Config/Security/GlobalRoles.config
1428 12:21:28 INFO  Precompiling SPEAK View: ~\sitecore\shell\client\Applications\ContentTesting\Components\Behaviours\StateChangeListBehavior.cshtml
1428 12:21:28 INFO  Precompiling SPEAK View: ~\sitecore\shell\client\Applications\ContentTesting\Components\ButtonGroup\ButtonGroup.cshtml
4716 12:21:28 INFO  Scheduler - Adding agents
4716 12:21:28 INFO  Scheduler - Adding agent: Sitecore.Tasks.UrlAgent (interval: 00:15:00)
4716 12:21:28 INFO  Scheduler - Adding agent: Sitecore.Tasks.TaskDatabaseAgent (interval: 00:10:00)
4716 12:21:28 INFO  Scheduler - Adding agent: Sitecore.Tasks.CompactClientDataAgent (interval: 04:00:00)
4716 12:21:28 INFO  Scheduler - Adding agent: Sitecore.Tasks.CleanupHistory (interval: 04:00:00)
4716 12:21:28 INFO  Scheduler - Adding agent: Sitecore.Tasks.CleanupPublishQueue (interval: 04:00:00)
4716 12:21:28 INFO  Scheduler - Adding agent: Sitecore.Tasks.CleanupEventQueue (interval: 04:00:00)
4716 12:21:28 INFO  Scheduler - Skipping inactive agent: Sitecore.Tasks.HtmlCacheClearAgent
4716 12:21:28 INFO  Scheduler - Adding agent: Sitecore.Tasks.CleanupAuthenticationTicketsAgent (interval: 04:00:00)
4716 12:21:28 INFO  Scheduler - Skipping inactive agent: Sitecore.Tasks.PublishAgent
4716 12:21:28 INFO  Scheduler - Adding agent: Sitecore.Tasks.CleanupAgent (interval: 06:00:00)
4716 12:21:28 INFO  Scheduler - Adding agent: Sitecore.Tasks.CounterDumpAgent (interval: 01:00:00)
4716 12:21:28 INFO  Scheduler - Adding agent: Sitecore.Tasks.CloneNotificationsCleanupAgent (interval: 1.00:00:00)
4716 12:21:28 INFO  Scheduler - Adding agent: Sitecore.Analytics.Tasks.EmailReportsTask (interval: 01:00:00)
4716 12:21:28 INFO  Scheduler - Adding agent: Sitecore.ContentSearch.Tasks.Optimize (interval: 12:00:00)
4716 12:21:28 INFO  Scheduler - Adding agent: Core_Database_Agent (interval: 00:10:00)
4716 12:21:28 INFO  Scheduler - Adding agent: Master_Database_Agent (interval: 00:10:00)
4716 12:21:28 INFO  Scheduler - Adding agent: Sitecore.Tasks.CleanupFDAObsoleteMediaData (interval: 1.00:00:00)
4716 12:21:29 INFO  Scheduler - Adding agent: Sitecore.Tasks.WebDAVOptionsCleanupAgent (interval: 1.00:00:00)
4716 12:21:29 INFO  Scheduler - Adding agent: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (interval: 00:00:10)
4716 12:21:29 INFO  Scheduler - Skipping inactive agent: Sitecore.Social.Client.Tasks.ManagePreExpiredAccounts
4716 12:21:29 INFO  Scheduler - Skipping inactive agent: Sitecore.Social.Client.Tasks.SynchronizeSocialMediaInfo
4716 12:21:29 INFO  Scheduler - Adding agent: Sitecore.Social.Client.Tasks.PostFlaggedMessages (interval: 01:00:00)
4716 12:21:29 INFO  Scheduler - Adding agent: Sitecore.Social.Client.Tasks.UpdateMessagesStatistics (interval: 01:00:00)
4716 12:21:29 INFO  Scheduler - Agents added
ManagedPoolThread #5 12:21:29 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
8244 12:21:29 INFO  Cache created: 'ReportDataCache' (max size: 50MB, running total: 1249MB)
8244 12:21:29 INFO  Cache created: 'ExperienceAnalytics.Segments' (max size: 20MB, running total: 1269MB)
8244 12:21:29 INFO  [Experience Analytics]: Segment Deploy complete.
8180 12:21:29 INFO  Cache created: 'shell[registry]' (max size: 15MB, running total: 1284MB)
8180 12:21:29 INFO  Cache created: 'shell[viewstate]' (max size: 1MB, running total: 1285MB)
8180 12:21:29 INFO  Cache created: 'shell[xsl]' (max size: 25MB, running total: 1310MB)
8180 12:21:29 INFO  Cache created: 'shell[filtered items]' (max size: 10MB, running total: 1320MB)
8180 12:21:29 INFO  Cache created: 'login[html]' (max size: 0 bytes, running total: 1320MB)
8180 12:21:29 INFO  Cache created: 'login[registry]' (max size: 25MB, running total: 1345MB)
8180 12:21:29 INFO  Cache created: 'login[viewstate]' (max size: 25MB, running total: 1370MB)
8180 12:21:29 INFO  Cache created: 'login[xsl]' (max size: 50MB, running total: 1420MB)
8180 12:21:29 INFO  Cache created: 'login[filtered items]' (max size: 10MB, running total: 1430MB)
8180 12:21:29 INFO  Cache created: 'admin[html]' (max size: 0 bytes, running total: 1430MB)
8180 12:21:29 INFO  Cache created: 'admin[registry]' (max size: 25MB, running total: 1455MB)
8180 12:21:29 INFO  Cache created: 'admin[viewstate]' (max size: 25MB, running total: 1480MB)
8180 12:21:29 INFO  Cache created: 'admin[xsl]' (max size: 50MB, running total: 1530MB)
8180 12:21:29 INFO  Cache created: 'admin[filtered items]' (max size: 10MB, running total: 1540MB)
8180 12:21:29 INFO  Cache created: 'service[html]' (max size: 0 bytes, running total: 1540MB)
8180 12:21:29 INFO  Cache created: 'service[registry]' (max size: 25MB, running total: 1565MB)
8180 12:21:29 INFO  Cache created: 'service[viewstate]' (max size: 25MB, running total: 1590MB)
8180 12:21:29 INFO  Cache created: 'service[xsl]' (max size: 50MB, running total: 1640MB)
8180 12:21:29 INFO  Cache created: 'service[filtered items]' (max size: 10MB, running total: 1650MB)
8180 12:21:29 INFO  Cache created: 'modules_shell[html]' (max size: 0 bytes, running total: 1650MB)
8180 12:21:29 INFO  Cache created: 'modules_shell[registry]' (max size: 25MB, running total: 1675MB)
8180 12:21:29 INFO  Cache created: 'modules_shell[viewstate]' (max size: 25MB, running total: 1700MB)
8180 12:21:29 INFO  Cache created: 'modules_shell[xsl]' (max size: 50MB, running total: 1750MB)
8180 12:21:29 INFO  Cache created: 'modules_shell[filtered items]' (max size: 10MB, running total: 1760MB)
8180 12:21:29 INFO  Cache created: 'modules_website[html]' (max size: 25MB, running total: 1785MB)
8180 12:21:29 INFO  Cache created: 'modules_website[registry]' (max size: 25MB, running total: 1810MB)
8180 12:21:29 INFO  Cache created: 'modules_website[viewstate]' (max size: 25MB, running total: 1835MB)
8180 12:21:29 INFO  Cache created: 'modules_website[xsl]' (max size: 50MB, running total: 1885MB)
8180 12:21:29 INFO  Cache created: 'modules_website[filtered items]' (max size: 10MB, running total: 1895MB)
8180 12:21:29 INFO  Cache created: 'website[html]' (max size: 50MB, running total: 1945MB)
8180 12:21:29 INFO  Cache created: 'website[registry]' (max size: 0 bytes, running total: 1945MB)
8180 12:21:29 INFO  Cache created: 'website[viewstate]' (max size: 0 bytes, running total: 1945MB)
8180 12:21:29 INFO  Cache created: 'website[xsl]' (max size: 25MB, running total: 1970MB)
8180 12:21:29 INFO  Cache created: 'website[filtered items]' (max size: 10MB, running total: 1980MB)
8180 12:21:29 INFO  Cache created: 'website[renderingParameters]' (max size: 10MB, running total: 1990MB)
8180 12:21:29 INFO  Cache created: 'scheduler[html]' (max size: 0 bytes, running total: 1990MB)
8180 12:21:29 INFO  Cache created: 'scheduler[registry]' (max size: 25MB, running total: 2015MB)
8180 12:21:29 INFO  Cache created: 'scheduler[viewstate]' (max size: 25MB, running total: 2040MB)
8180 12:21:29 INFO  Cache created: 'scheduler[xsl]' (max size: 50MB, running total: 2090MB)
8180 12:21:29 INFO  Cache created: 'scheduler[filtered items]' (max size: 10MB, running total: 2100MB)
8180 12:21:29 INFO  Cache created: 'system[html]' (max size: 0 bytes, running total: 2100MB)
8180 12:21:29 INFO  Cache created: 'system[registry]' (max size: 25MB, running total: 2125MB)
8180 12:21:29 INFO  Cache created: 'system[viewstate]' (max size: 25MB, running total: 2150MB)
8180 12:21:29 INFO  Cache created: 'system[xsl]' (max size: 50MB, running total: 2200MB)
8180 12:21:29 INFO  Cache created: 'system[filtered items]' (max size: 10MB, running total: 2210MB)
8180 12:21:29 INFO  Cache created: 'publisher[html]' (max size: 0 bytes, running total: 2210MB)
8180 12:21:29 INFO  Cache created: 'publisher[registry]' (max size: 25MB, running total: 2235MB)
8180 12:21:29 INFO  Cache created: 'publisher[viewstate]' (max size: 25MB, running total: 2260MB)
8180 12:21:29 INFO  Cache created: 'publisher[xsl]' (max size: 50MB, running total: 2310MB)
8180 12:21:29 INFO  Cache created: 'publisher[filtered items]' (max size: 10MB, running total: 2320MB)
ManagedPoolThread #4 12:21:30 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
5872 12:21:30 INFO  Precompiling SPEAK View: ~\sitecore\shell\client\Business Component Library\Layouts\Renderings\Behaviors\Behavior.cshtml
1428 12:21:31 INFO  Precompiling SPEAK View: ~\sitecore\shell\client\Applications\ContentTesting\Components\CarouselImage\CarouselImage.cshtml
ManagedPoolThread #18 12:21:31 INFO  Trying to load XML configuration /App_Config/Security/GlobalRoles.config
ManagedPoolThread #12 12:21:34 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #0 12:21:34 WARN  Failed to create counter 'Sitecore.Presentation\Context | Site Changed / sec'. Sitecore has no necessary permissions for reading/creating counters
ManagedPoolThread #2 12:21:34 WARN  Failed to create counter 'Sitecore.Presentation\Rendering | Controls Rendered / sec'. Sitecore has no necessary permissions for reading/creating counters
ManagedPoolThread #9 12:21:34 WARN  Failed to create counter 'Sitecore.Presentation\Rendering | Controls Rendered From Cache / sec'. Sitecore has no necessary permissions for reading/creating counters
ManagedPoolThread #10 12:21:34 WARN  Failed to create counter 'Sitecore.Presentation\Rendering | Pages Generated / sec'. Sitecore has no necessary permissions for reading/creating counters
ManagedPoolThread #8 12:21:34 WARN  Failed to create counter 'Sitecore.Presentation\Rendering | Renderings Rendered / sec'. Sitecore has no necessary permissions for reading/creating counters
ManagedPoolThread #15 12:21:34 WARN  Failed to create counter 'Sitecore.Presentation\Rendering | Sublayouts Rendered / sec'. Sitecore has no necessary permissions for reading/creating counters
ManagedPoolThread #7 12:21:34 WARN  Failed to create counter 'Sitecore.Presentation\Rendering | XmlControls Compiled / sec'. Sitecore has no necessary permissions for reading/creating counters
ManagedPoolThread #4 12:21:34 WARN  Failed to create counter 'Sitecore.Presentation\Rendering | Xsl Transforms Rendered / sec'. Sitecore has no necessary permissions for reading/creating counters
ManagedPoolThread #18 12:21:34 WARN  Failed to create counter 'Sitecore.Presentation\Rendering | Xaml Controls Compiled / sec'. Sitecore has no necessary permissions for reading/creating counters
ManagedPoolThread #12 12:21:34 INFO  Cache created: '[IDTable]' (max size: 2MB, running total: 2323MB)
ManagedPoolThread #12 12:21:34 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
8180 12:21:34 INFO  Cache created: 'Log singles' (max size: 100KB, running total: 2323MB)
8180 12:21:34 WARN  No session Id managers were found to manage the session Id for the current request. Default asp.net session manager will be used.
5872 12:21:36 INFO  Precompiling SPEAK View: ~\sitecore\shell\client\Business Component Library\Layouts\Renderings\Charts\FusionChartsAreaChart.cshtml
ManagedPoolThread #9 12:21:37 WARN  Failed to create counter 'Sitecore.Jobs\Pipelines.PipelinesAborted'. Sitecore has no necessary permissions for reading/creating counters
ManagedPoolThread #8 12:21:37 WARN  Failed to create counter 'Sitecore.Jobs\Pipelines.ProcessorsExecuted'. Sitecore has no necessary permissions for reading/creating counters
ManagedPoolThread #10 12:21:37 WARN  Failed to create counter 'Sitecore.Jobs\Pipelines.PipelinesExecuted'. Sitecore has no necessary permissions for reading/creating counters
1428 12:21:37 INFO  Precompiling SPEAK View: ~\sitecore\shell\client\Applications\ContentTesting\Components\CompareImage\CompareImage.cshtml
7092 12:21:38 INFO  Cache created: 'Task Manager - tasks' (max size: 100 bytes, running total: 2323MB)
6160 12:21:38 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #0 12:21:38 WARN  Failed to create counter 'Sitecore.Analytics.MongoDb\Reads / sec'. Sitecore has no necessary permissions for reading/creating counters
ManagedPoolThread #9 12:21:38 WARN  Failed to create counter 'Sitecore.Analytics.MongoDb\Writes / sec'. Sitecore has no necessary permissions for reading/creating counters
ManagedPoolThread #0 12:21:38 WARN  Failed to create counter 'Sitecore.Analytics.MongoDb\Documents fetched / sec'. Sitecore has no necessary permissions for reading/creating counters
ManagedPoolThread #9 12:21:38 WARN  Failed to create counter 'Sitecore.Analytics.MongoDb\Data | Aggregation - Add (Visits scheduled for aggregation) / sec'. Sitecore has no necessary permissions for reading/creating counters
ManagedPoolThread #0 12:21:38 WARN  Failed to create counter 'Sitecore.Analytics.MongoDb\Data | Aggregation - Check out calls / sec'. Sitecore has no necessary permissions for reading/creating counters
ManagedPoolThread #9 12:21:38 WARN  Failed to create counter 'Sitecore.Analytics.MongoDb\Data | Aggregation - Check out (Visits checked out) / sec'. Sitecore has no necessary permissions for reading/creating counters
ManagedPoolThread #0 12:21:38 WARN  Failed to create counter 'Sitecore.Analytics.MongoDb\Data | Aggregation - Check in (Visits checked in) / sec'. Sitecore has no necessary permissions for reading/creating counters
ManagedPoolThread #9 12:21:38 WARN  Failed to create counter 'Sitecore.Analytics.MongoDb\Data | Aggregation - Pool cleanup calls / sec'. Sitecore has no necessary permissions for reading/creating counters
ManagedPoolThread #0 12:21:38 WARN  Failed to create counter 'Sitecore.Analytics.MongoDb\Data | Aggregation - Visits cleaned up / sec'. Sitecore has no necessary permissions for reading/creating counters
ManagedPoolThread #9 12:21:38 WARN  Failed to create counter 'Sitecore.Analytics.MongoDb\Data | Aggregation - Visits recovered / sec'. Sitecore has no necessary permissions for reading/creating counters
ManagedPoolThread #8 12:21:38 WARN  Failed to create counter 'Sitecore.Analytics.MongoDb\Data | Aggregation - Pool Recovery calls / sec'. Sitecore has no necessary permissions for reading/creating counters
2472 12:21:38 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Core.BackgroundService.Run()

 424 12:21:38 INFO  Cache created: 'ReportingStorageProviderProperties.Properties' (max size: 100 bytes, running total: 2323MB)
 424 12:21:38 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

9120 12:21:38 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

3600 12:21:38 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

4424 12:21:38 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #15 12:21:39 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
5872 12:21:39 INFO  Precompiling SPEAK View: ~\sitecore\shell\client\Business Component Library\Layouts\Renderings\Charts\FusionChartsBarChart.cshtml
5872 12:21:39 INFO  Precompiling SPEAK View: ~\sitecore\shell\client\Business Component Library\Layouts\Renderings\Charts\FusionChartsColumnChart.cshtml
5872 12:21:39 INFO  Precompiling SPEAK View: ~\sitecore\shell\client\Business Component Library\Layouts\Renderings\Charts\FusionChartsDoughnutChart.cshtml
5872 12:21:39 INFO  Precompiling SPEAK View: ~\sitecore\shell\client\Business Component Library\Layouts\Renderings\Charts\FusionChartsJourneyChart.cshtml
5872 12:21:39 INFO  Precompiling SPEAK View: ~\sitecore\shell\client\Business Component Library\Layouts\Renderings\Charts\FusionChartsLineChart.cshtml
5872 12:21:39 INFO  Precompiling SPEAK View: ~\sitecore\shell\client\Business Component Library\Layouts\Renderings\Charts\FusionChartsPieChart.cshtml
5872 12:21:39 INFO  Precompiling SPEAK View: ~\sitecore\shell\client\Business Component Library\Layouts\Renderings\Charts\FusionChartsRadarChart.cshtml
5872 12:21:39 INFO  Precompiling SPEAK View: ~\sitecore\shell\client\Business Component Library\Layouts\Renderings\Common\ActionControl\ActionControl.cshtml
ManagedPoolThread #4 12:21:40 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #18 12:21:41 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #7 12:21:42 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
1428 12:21:42 INFO  Precompiling SPEAK View: ~\sitecore\shell\client\Applications\ContentTesting\Components\DataRepeater\ContentTestingDataRepeater.cshtml
7520 12:21:43 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
7520 12:21:43 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.HandleDatabaseException(ExceptionBehavior exceptionBehavior, Exception ex)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

Nested Exception

Exception: MongoDB.Driver.MongoConnectionException
Message: Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
Source: MongoDB.Driver
   at MongoDB.Driver.Internal.DirectMongoServerProxy.Connect(TimeSpan timeout, ReadPreference readPreference)
   at MongoDB.Driver.Internal.DirectMongoServerProxy.ChooseServerInstance(ReadPreference readPreference)
   at MongoDB.Driver.MongoServer.AcquireConnection(ReadPreference readPreference)
   at MongoDB.Driver.MongoCollection.RunCommandAs[TCommandResult](IMongoCommand command, ReadPreference readPreference, IBsonSerializer resultSerializer, IBsonSerializationOptions resultSerializationOptions)
   at MongoDB.Driver.MongoCollection.RunCommandAs[TCommandResult](IMongoCommand command, ReadPreference readPreference)
   at MongoDB.Driver.MongoCollection.FindAndModify(FindAndModifyArgs args)
   at MongoDB.Driver.MongoCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.<>c__DisplayClass2c.<FindAndModify>b__2b()
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)

Nested Exception

Exception: System.Net.Sockets.SocketException
Message: No connection could be made because the target machine actively refused it 127.0.0.1:27017
Source: System
   at System.Net.Sockets.Socket.DoConnect(EndPoint endPointSnapshot, SocketAddress socketAddress)
   at System.Net.Sockets.Socket.Connect(EndPoint remoteEP)
   at System.Net.Sockets.TcpClient.Connect(IPEndPoint remoteEP)
   at MongoDB.Driver.Internal.MongoConnection.Open()
   at MongoDB.Driver.Internal.MongoConnection.SendMessage(BsonBuffer buffer, Int32 requestId)
   at MongoDB.Driver.Internal.MongoConnection.SendMessage(MongoRequestMessage message)
   at MongoDB.Driver.Operations.CommandOperation`1.Execute(MongoConnection connection)
   at MongoDB.Driver.MongoServerInstance.Ping(MongoConnection connection)
   at MongoDB.Driver.MongoServerInstance.Connect()
   at MongoDB.Driver.Internal.DirectMongoServerProxy.Connect(TimeSpan timeout, ReadPreference readPreference)



5872 12:21:44 INFO  Precompiling SPEAK View: ~\sitecore\shell\client\Business Component Library\Layouts\Renderings\Common\Buttons\BackButton.cshtml
ManagedPoolThread #10 12:21:44 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #0 12:21:44 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #0 12:21:44 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
1428 12:21:45 INFO  Precompiling SPEAK View: ~\sitecore\shell\client\Applications\ContentTesting\Components\DataSource\ActivityDataSource\ActivityDataSource.cshtml
5872 12:21:46 INFO  Precompiling SPEAK View: ~\sitecore\shell\client\Business Component Library\Layouts\Renderings\Common\Buttons\Button.cshtml
5872 12:21:46 INFO  Precompiling SPEAK View: ~\sitecore\shell\client\Business Component Library\Layouts\Renderings\Common\Buttons\DropDownButton.cshtml
5872 12:21:46 INFO  Precompiling SPEAK View: ~\sitecore\shell\client\Business Component Library\Layouts\Renderings\Common\Buttons\ToggleButton.cshtml
5872 12:21:46 INFO  Precompiling SPEAK View: ~\sitecore\shell\client\Business Component Library\Layouts\Renderings\Common\CheckBoxes\CheckBox.cshtml
1428 12:21:47 INFO  Precompiling SPEAK View: ~\sitecore\shell\client\Applications\ContentTesting\Components\DataSource\BaseDataSource\OptimizationBaseDataSource.cshtml
5872 12:21:49 INFO  Precompiling SPEAK View: ~\sitecore\shell\client\Business Component Library\Layouts\Renderings\Common\ComboBoxes\AdvancedComboBox.cshtml
1428 12:21:50 INFO  Precompiling SPEAK View: ~\sitecore\shell\client\Applications\ContentTesting\Components\DataSource\BaseDataSource\OptimizationEntriesBaseDataSource.cshtml
1428 12:21:50 INFO  Precompiling SPEAK View: ~\sitecore\shell\client\Applications\ContentTesting\Components\DataSource\BestGuessDataSource\BestGuessingDataSource.cshtml
5872 12:21:51 INFO  Precompiling SPEAK View: ~\sitecore\shell\client\Business Component Library\Layouts\Renderings\Common\ComboBoxes\ComboBox.cshtml
5872 12:21:51 INFO  Precompiling SPEAK View: ~\sitecore\shell\client\Business Component Library\Layouts\Renderings\Common\ContextSwitcher\ContextSwitcher.cshtml
1428 12:21:53 INFO  Precompiling SPEAK View: ~\sitecore\shell\client\Applications\ContentTesting\Components\DataSource\ConversionRateDataSource\ConversionRateDataSource.cshtml
6160 12:21:53 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

2472 12:21:53 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Core.BackgroundService.Run()

 424 12:21:53 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

4424 12:21:53 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

9120 12:21:53 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

3600 12:21:53 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

5296 12:21:53 INFO  [Experience Analytics]: Reduce agent found zero sites to process
5872 12:21:54 INFO  Precompiling SPEAK View: ~\sitecore\shell\client\Business Component Library\Layouts\Renderings\Common\ControlRenderers\ControlRenderer.cshtml
ManagedPoolThread #8 12:21:54 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #8 12:21:54 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
1428 12:21:55 INFO  Precompiling SPEAK View: ~\sitecore\shell\client\Applications\ContentTesting\Components\DataSource\ExperienceEngagementDataSource\ExperienceEngagementDataSource.cshtml
5872 12:21:56 INFO  Precompiling SPEAK View: ~\sitecore\shell\client\Business Component Library\Layouts\Renderings\Common\DatePickers\DatePicker.cshtml
1428 12:21:58 INFO  Precompiling SPEAK View: ~\sitecore\shell\client\Applications\ContentTesting\Components\DataSource\ExperienceKPIDataSource\ExperienceKPIDataSource.cshtml
7520 12:21:58 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

1428 12:21:59 INFO  Precompiling SPEAK View: ~\sitecore\shell\client\Applications\ContentTesting\Components\DataSource\HighestEffectDataSource\HighestEffectDataSource.cshtml
5872 12:22:00 INFO  Precompiling SPEAK View: ~\sitecore\shell\client\Business Component Library\Layouts\Renderings\Common\GlobalLogos\GlobalLogo.cshtml
1428 12:22:01 INFO  Precompiling SPEAK View: ~\sitecore\shell\client\Applications\ContentTesting\Components\DataSource\ItemFromQueryString\ItemFromQueryString.cshtml
5872 12:22:03 INFO  Precompiling SPEAK View: ~\sitecore\shell\client\Business Component Library\Layouts\Renderings\Common\HyperlinkButtons\HyperlinkButton.cshtml
ManagedPoolThread #4 12:22:04 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #4 12:22:04 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
1428 12:22:04 INFO  Precompiling SPEAK View: ~\sitecore\shell\client\Applications\ContentTesting\Components\DataSource\ItemInfoDataSource\ItemInfoDataSource.cshtml
5872 12:22:05 INFO  Precompiling SPEAK View: ~\sitecore\shell\client\Business Component Library\Layouts\Renderings\Common\HyperlinkButtons\IconHyperlinkButton.cshtml
5872 12:22:05 INFO  Precompiling SPEAK View: ~\sitecore\shell\client\Business Component Library\Layouts\Renderings\Common\IconButtons\IconButton.cshtml
1428 12:22:07 INFO  Precompiling SPEAK View: ~\sitecore\shell\client\Applications\ContentTesting\Components\DataSource\KPIDataSource\KPIDataSource.cshtml
6160 12:22:08 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

5872 12:22:08 INFO  Precompiling SPEAK View: ~\sitecore\shell\client\Business Component Library\Layouts\Renderings\Common\Images\Image.cshtml
2472 12:22:08 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Core.BackgroundService.Run()

 424 12:22:08 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

4424 12:22:08 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

3600 12:22:08 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

9120 12:22:08 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

1428 12:22:09 INFO  Precompiling SPEAK View: ~\sitecore\shell\client\Applications\ContentTesting\Components\DataSource\MostActiveUserDataSource\MostActiveUserDataSource.cshtml
5872 12:22:10 INFO  Precompiling SPEAK View: ~\sitecore\shell\client\Business Component Library\Layouts\Renderings\Common\Labels\Label.cshtml
1428 12:22:12 INFO  Precompiling SPEAK View: ~\sitecore\shell\client\Applications\ContentTesting\Components\DataSource\OverallPerformanceDataSource\OverallPerformanceDataSource.cshtml
7520 12:22:13 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

5872 12:22:13 INFO  Precompiling SPEAK View: ~\sitecore\shell\client\Business Component Library\Layouts\Renderings\Common\ListBoxes\ListBox.cshtml
ManagedPoolThread #9 12:22:14 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #9 12:22:14 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
1428 12:22:14 INFO  Precompiling SPEAK View: ~\sitecore\shell\client\Applications\ContentTesting\Components\DataSource\PersonalizationRuleDataSource\PersonalizationRuleDataSource.cshtml
5872 12:22:15 INFO  Precompiling SPEAK View: ~\sitecore\shell\client\Business Component Library\Layouts\Renderings\Common\MessageBars\MessageBar.cshtml
1428 12:22:17 INFO  Precompiling SPEAK View: ~\sitecore\shell\client\Applications\ContentTesting\Components\DataSource\ReachDataSource\ReachDataSource.cshtml
5872 12:22:18 INFO  Precompiling SPEAK View: ~\sitecore\shell\client\Business Component Library\Layouts\Renderings\Common\ProgressBars\ProgressBar.cshtml
1428 12:22:19 INFO  Precompiling SPEAK View: ~\sitecore\shell\client\Applications\ContentTesting\Components\DataSource\ReportingDatesDataSource\ReportingDatesDataSource.cshtml
5872 12:22:20 INFO  Precompiling SPEAK View: ~\sitecore\shell\client\Business Component Library\Layouts\Renderings\Common\ProgressIndicators\ProgressIndicator.cshtml
1428 12:22:22 INFO  Precompiling SPEAK View: ~\sitecore\shell\client\Applications\ContentTesting\Components\DataSource\RulePerformanceDataSource\RulePerformanceDataSource.cshtml
6160 12:22:23 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

2472 12:22:23 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Core.BackgroundService.Run()

9120 12:22:23 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

4424 12:22:23 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

 424 12:22:23 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

3600 12:22:23 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

5872 12:22:23 INFO  Precompiling SPEAK View: ~\sitecore\shell\client\Business Component Library\Layouts\Renderings\Common\RadioButtons\RadioButton.cshtml
5296 12:22:23 INFO  [Experience Analytics]: Reduce agent found zero sites to process
ManagedPoolThread #0 12:22:24 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #0 12:22:24 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
1428 12:22:24 INFO  Precompiling SPEAK View: ~\sitecore\shell\client\Applications\ContentTesting\Components\DataSource\RulesDataSource\RulesDataSource.cshtml
5872 12:22:26 INFO  Precompiling SPEAK View: ~\sitecore\shell\client\Business Component Library\Layouts\Renderings\Common\Separators\Separator.cshtml
1428 12:22:27 INFO  Precompiling SPEAK View: ~\sitecore\shell\client\Applications\ContentTesting\Components\DataSource\RuleSetPerformanceDataSource\RuleSetPerformanceDataSource.cshtml
7520 12:22:28 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

5872 12:22:28 INFO  Precompiling SPEAK View: ~\sitecore\shell\client\Business Component Library\Layouts\Renderings\Common\SheerUI\SheerUI.cshtml
1428 12:22:29 INFO  Precompiling SPEAK View: ~\sitecore\shell\client\Applications\ContentTesting\Components\DataSource\SitecoreQueryDataSource\SitecoreQueryDataSource.cshtml
ManagedPoolThread #13 12:22:32 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
5872 12:22:32 INFO  Precompiling SPEAK View: ~\sitecore\shell\client\Business Component Library\Layouts\Renderings\Common\Slider\Slider.cshtml
ManagedPoolThread #17 12:22:33 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
1428 12:22:33 INFO  Precompiling SPEAK View: ~\sitecore\shell\client\Applications\ContentTesting\Components\DataSource\SiteUsageDataSource\SiteUsageDataSource.cshtml
ManagedPoolThread #1 12:22:34 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #8 12:22:34 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #8 12:22:34 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
5872 12:22:34 INFO  Precompiling SPEAK View: ~\sitecore\shell\client\Business Component Library\Layouts\Renderings\Common\SubAppRenderes\SubAppRenderer.cshtml
ManagedPoolThread #5 12:22:35 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #3 12:22:36 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
1428 12:22:36 INFO  Precompiling SPEAK View: ~\sitecore\shell\client\Applications\ContentTesting\Components\DataSource\TestCandidatesDataSource\TestCandidatesDataSource.cshtml
ManagedPoolThread #11 12:22:37 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
5872 12:22:37 INFO  Precompiling SPEAK View: ~\sitecore\shell\client\Business Component Library\Layouts\Renderings\Common\TextAreas\TextArea.cshtml
ManagedPoolThread #6 12:22:38 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
6160 12:22:38 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

2472 12:22:38 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Core.BackgroundService.Run()

4424 12:22:38 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

9120 12:22:38 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

 424 12:22:38 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

3600 12:22:38 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

1428 12:22:38 INFO  Precompiling SPEAK View: ~\sitecore\shell\client\Applications\ContentTesting\Components\DataSource\TestDefinitionDataSource\TestDefinitionDataSource.cshtml
ManagedPoolThread #14 12:22:39 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
5872 12:22:39 INFO  Precompiling SPEAK View: ~\sitecore\shell\client\Business Component Library\Layouts\Renderings\Common\TextBoxes\ButtonTextBox.cshtml
ManagedPoolThread #16 12:22:40 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #19 12:22:41 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
1428 12:22:41 INFO  Precompiling SPEAK View: ~\sitecore\shell\client\Applications\ContentTesting\Components\DataSource\TestDurationDataSource\TestDurationDataSource.cshtml
ManagedPoolThread #15 12:22:42 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
5872 12:22:42 INFO  Precompiling SPEAK View: ~\sitecore\shell\client\Business Component Library\Layouts\Renderings\Common\TextBoxes\TextBox.cshtml
5872 12:22:42 INFO  Precompiling SPEAK View: ~\sitecore\shell\client\Business Component Library\Layouts\Renderings\Common\Texts\Text.cshtml
ManagedPoolThread #18 12:22:43 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
7520 12:22:43 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

1428 12:22:43 INFO  Precompiling SPEAK View: ~\sitecore\shell\client\Applications\ContentTesting\Components\DataSource\TestExpectationsDataSource\TestExpectationsDataSource.cshtml
ManagedPoolThread #0 12:22:44 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #0 12:22:44 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
5872 12:22:45 INFO  Precompiling SPEAK View: ~\sitecore\shell\client\Business Component Library\Layouts\Renderings\Common\Timelines\Timeline.cshtml
ManagedPoolThread #10 12:22:45 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
1428 12:22:46 INFO  Precompiling SPEAK View: ~\sitecore\shell\client\Applications\ContentTesting\Components\DataSource\TestObjectivesDataSource\TestObjectivesDataSource.cshtml
5872 12:22:47 INFO  Precompiling SPEAK View: ~\sitecore\shell\client\Business Component Library\Layouts\Renderings\Common\TimePickers\TimePicker.cshtml
5872 12:22:49 INFO  Precompiling SPEAK View: ~\sitecore\shell\client\Business Component Library\Layouts\Renderings\Common\Tooltips\ToolTip.cshtml
1428 12:22:50 INFO  Precompiling SPEAK View: ~\sitecore\shell\client\Applications\ContentTesting\Components\DataSource\TestOutcomesDataSource\TestOutcomesDataSource.cshtml
5872 12:22:52 INFO  Precompiling SPEAK View: ~\sitecore\shell\client\Business Component Library\Layouts\Renderings\Configuration\SinglePageAppConfiguration.cshtml
6160 12:22:53 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

2472 12:22:53 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Core.BackgroundService.Run()

3600 12:22:53 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

 424 12:22:53 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

9120 12:22:53 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

4424 12:22:53 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

1428 12:22:53 INFO  Precompiling SPEAK View: ~\sitecore\shell\client\Applications\ContentTesting\Components\DataSource\TestsDataSource\TestsDataSource.cshtml
5296 12:22:53 INFO  [Experience Analytics]: Reduce agent found zero sites to process
ManagedPoolThread #8 12:22:54 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #8 12:22:54 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
5872 12:22:54 INFO  Precompiling SPEAK View: ~\sitecore\shell\client\Business Component Library\Layouts\Renderings\Containers\AdvancedExpanders\AdvancedExpander.cshtml
1428 12:22:56 INFO  Precompiling SPEAK View: ~\sitecore\shell\client\Applications\ContentTesting\Components\DataSource\TestSummary\TestSummary.cshtml
7520 12:22:58 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

5872 12:22:58 INFO  Precompiling SPEAK View: ~\sitecore\shell\client\Business Component Library\Layouts\Renderings\Containers\Borders\Border.cshtml
1428 12:23:00 INFO  Precompiling SPEAK View: ~\sitecore\shell\client\Applications\ContentTesting\Components\DataSource\TestVariablesDataSource\TestVariablesDataSource.cshtml
5872 12:23:01 INFO  Precompiling SPEAK View: ~\sitecore\shell\client\Business Component Library\Layouts\Renderings\Containers\Borders\ProtectedBorder.cshtml
5872 12:23:01 INFO  Precompiling SPEAK View: ~\sitecore\shell\client\Business Component Library\Layouts\Renderings\Containers\ColumnPanels\ColumnPanel.cshtml
1428 12:23:03 INFO  Precompiling SPEAK View: ~\sitecore\shell\client\Applications\ContentTesting\Components\DataSource\TestVariationsDataSource\TestVariationsDataSource.cshtml
5872 12:23:04 INFO  Precompiling SPEAK View: ~\sitecore\shell\client\Business Component Library\Layouts\Renderings\Containers\Expanders\Expander.cshtml
ManagedPoolThread #0 12:23:04 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #0 12:23:04 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
1428 12:23:05 INFO  Precompiling SPEAK View: ~\sitecore\shell\client\Applications\ContentTesting\Components\DataSource\ThumbnailImageDataSource\ThumbnailImageDataSource.cshtml
5872 12:23:07 INFO  Precompiling SPEAK View: ~\sitecore\shell\client\Business Component Library\Layouts\Renderings\Containers\Frames\Frame.cshtml
6160 12:23:08 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

2472 12:23:08 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Core.BackgroundService.Run()

3600 12:23:08 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

 424 12:23:08 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

9120 12:23:08 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

4424 12:23:08 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

1428 12:23:08 INFO  Precompiling SPEAK View: ~\sitecore\shell\client\Applications\ContentTesting\Components\DataSource\TopClicksToPagesDataSource\TopClicksToPagesDataSource.cshtml
5872 12:23:10 INFO  Precompiling SPEAK View: ~\sitecore\shell\client\Business Component Library\Layouts\Renderings\Containers\LoadOnDemandPanel\LoadOnDemandPanel.cshtml
1428 12:23:11 INFO  Precompiling SPEAK View: ~\sitecore\shell\client\Applications\ContentTesting\Components\DataSource\TopGoalsDataSource\TopGoalsDataSource.cshtml
5872 12:23:12 INFO  Precompiling SPEAK View: ~\sitecore\shell\client\Business Component Library\Layouts\Renderings\Containers\Panels\Panel.cshtml
7520 12:23:13 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

1428 12:23:14 INFO  Precompiling SPEAK View: ~\sitecore\shell\client\Applications\ContentTesting\Components\DataSource\VariablesDataSource\VariablesDataSource.cshtml
ManagedPoolThread #8 12:23:14 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #8 12:23:14 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
5872 12:23:15 INFO  Precompiling SPEAK View: ~\sitecore\shell\client\Business Component Library\Layouts\Renderings\Containers\Popovers\Popover.cshtml
1428 12:23:17 INFO  Precompiling SPEAK View: ~\sitecore\shell\client\Applications\ContentTesting\Components\ExperienceIndicator\ExperienceIndicator.cshtml
5872 12:23:18 INFO  Precompiling SPEAK View: ~\sitecore\shell\client\Business Component Library\Layouts\Renderings\Containers\Repeaters\Repeater.cshtml
1428 12:23:20 INFO  Precompiling SPEAK View: ~\sitecore\shell\client\Applications\ContentTesting\Components\FilteredComboBox\FilteredComboBox.cshtml
5872 12:23:21 INFO  Precompiling SPEAK View: ~\sitecore\shell\client\Business Component Library\Layouts\Renderings\Containers\RowPanels\RowPanel.cshtml
1428 12:23:22 INFO  Precompiling SPEAK View: ~\sitecore\shell\client\Applications\ContentTesting\Components\GroupedCheckboxList\GroupedCheckboxList.cshtml
6160 12:23:23 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

2472 12:23:23 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Core.BackgroundService.Run()

3600 12:23:23 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

9120 12:23:23 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

 424 12:23:23 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

4424 12:23:23 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

5296 12:23:23 INFO  [Experience Analytics]: Reduce agent found zero sites to process
5872 12:23:24 INFO  Precompiling SPEAK View: ~\sitecore\shell\client\Business Component Library\Layouts\Renderings\Containers\Sections\Section.cshtml
Heartbeat 12:23:24 INFO  Cache created: '[no name]' (max size: 976KB, running total: 2324MB)
Heartbeat 12:23:24 INFO  Cache created: '[no name]' (max size: 976KB, running total: 2325MB)
Heartbeat 12:23:24 INFO  Cache created: '[no name]' (max size: 976KB, running total: 2326MB)
Heartbeat 12:23:24 INFO  Cache created: '[no name]' (max size: 976KB, running total: 2327MB)
Heartbeat 12:23:24 INFO  Cache created: '[no name]' (max size: 976KB, running total: 2328MB)
Heartbeat 12:23:24 ERROR MongoDbDictionary.Store() has failed.
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Save(Object value)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbDictionary.Store(Object value)

ManagedPoolThread #9 12:23:24 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #9 12:23:24 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
1428 12:23:25 INFO  Precompiling SPEAK View: ~\sitecore\shell\client\Applications\ContentTesting\Components\ImageSrc\ImageSrc.cshtml
5872 12:23:27 INFO  Precompiling SPEAK View: ~\sitecore\shell\client\Business Component Library\Layouts\Renderings\Containers\SmartPanels\SmartPanel.cshtml
7520 12:23:28 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

1428 12:23:28 INFO  Precompiling SPEAK View: ~\sitecore\shell\client\Applications\ContentTesting\Components\OptionsMapper\OptionsMapper.cshtml
5872 12:23:29 INFO  Precompiling SPEAK View: ~\sitecore\shell\client\Business Component Library\Layouts\Renderings\Containers\TabControls\TabControl.cshtml
1428 12:23:31 INFO  Precompiling SPEAK View: ~\sitecore\shell\client\Applications\ContentTesting\Components\PageThumbnail\PageThumbnail.cshtml
5872 12:23:32 INFO  Precompiling SPEAK View: ~\sitecore\shell\client\Business Component Library\Layouts\Renderings\Dialogs\DialogWindow.cshtml
1428 12:23:33 INFO  Precompiling SPEAK View: ~\sitecore\shell\client\Applications\ContentTesting\Components\ProgressBarCustom\ProgressBarCustom.cshtml
ManagedPoolThread #4 12:23:34 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #4 12:23:34 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
5872 12:23:35 INFO  Precompiling SPEAK View: ~\sitecore\shell\client\Business Component Library\Layouts\Renderings\Forms\Uploader\Uploader.cshtml
1428 12:23:36 INFO  Precompiling SPEAK View: ~\sitecore\shell\client\Applications\ContentTesting\Components\QueryStringParameterResolver\QueryStringParameterResolver.cshtml
5872 12:23:38 INFO  Precompiling SPEAK View: ~\sitecore\shell\client\Business Component Library\Layouts\Renderings\Forms\UploaderInfo\UploaderInfo.cshtml
6160 12:23:38 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

2472 12:23:38 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Core.BackgroundService.Run()

3600 12:23:38 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

 424 12:23:38 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

4424 12:23:38 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

9120 12:23:38 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

1428 12:23:39 INFO  Precompiling SPEAK View: ~\sitecore\shell\client\Applications\ContentTesting\Components\ResizableFrameGrip\ResizableFrameGrip.cshtml
5872 12:23:40 INFO  Precompiling SPEAK View: ~\sitecore\shell\client\Business Component Library\Layouts\Renderings\Indicators\ArrowIndicator.cshtml
ManagedPoolThread #13 12:23:42 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
1428 12:23:42 INFO  Precompiling SPEAK View: ~\sitecore\shell\client\Applications\ContentTesting\Components\ScoreGainedSpot\ScoreGainedSpot.cshtml
7520 12:23:43 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #1 12:23:43 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
5872 12:23:43 INFO  Precompiling SPEAK View: ~\sitecore\shell\client\Business Component Library\Layouts\Renderings\Indicators\ValueLabel.cshtml
5872 12:23:43 INFO  Precompiling SPEAK View: ~\sitecore\shell\client\Business Component Library\Layouts\Renderings\ListsAndGrids\Carousels\Carousel.cshtml
ManagedPoolThread #3 12:23:44 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #9 12:23:44 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #9 12:23:44 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
1428 12:23:45 INFO  Precompiling SPEAK View: ~\sitecore\shell\client\Applications\ContentTesting\Components\SliderAdvanced\SliderAdvanced.cshtml
ManagedPoolThread #5 12:23:45 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
5872 12:23:46 INFO  Precompiling SPEAK View: ~\sitecore\shell\client\Business Component Library\Layouts\Renderings\ListsAndGrids\ListControls\DefaultTile.cshtml
ManagedPoolThread #6 12:23:46 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #10 12:23:47 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
1428 12:23:47 INFO  Precompiling SPEAK View: ~\sitecore\shell\client\Applications\ContentTesting\Components\StateListControl\StateListControl.cshtml
ManagedPoolThread #11 12:23:48 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
5872 12:23:49 INFO  Precompiling SPEAK View: ~\sitecore\shell\client\Business Component Library\Layouts\Renderings\ListsAndGrids\ListControls\ListControl.cshtml
5872 12:23:49 INFO  Precompiling SPEAK View: ~\sitecore\shell\client\Business Component Library\Layouts\Renderings\ListsAndGrids\TreeViews\ItemTreeView.cshtml
ManagedPoolThread #12 12:23:49 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
1428 12:23:50 INFO  Precompiling SPEAK View: ~\sitecore\shell\client\Applications\ContentTesting\Components\TestOptions\TestOptions.cshtml
ManagedPoolThread #14 12:23:51 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #15 12:23:52 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
5872 12:23:52 INFO  Precompiling SPEAK View: ~\sitecore\shell\client\Business Component Library\Layouts\Renderings\Navigation\Breadcrumbs\Breadcrumb.cshtml
ManagedPoolThread #16 12:23:53 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
2472 12:23:53 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Core.BackgroundService.Run()

6160 12:23:53 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

3600 12:23:53 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

9120 12:23:53 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

 424 12:23:53 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

4424 12:23:53 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

1428 12:23:53 INFO  Precompiling SPEAK View: ~\sitecore\shell\client\Applications\ContentTesting\Components\TextTemplate\TextTemplate.cshtml
5296 12:23:54 INFO  [Experience Analytics]: Reduce agent found zero sites to process
ManagedPoolThread #17 12:23:54 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #4 12:23:54 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #4 12:23:54 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
5872 12:23:55 INFO  Precompiling SPEAK View: ~\sitecore\shell\client\Business Component Library\Layouts\Renderings\Navigation\HyperlinkButtonsGroups\HyperlinkButtonsGroup.cshtml
ManagedPoolThread #18 12:23:55 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
1428 12:23:56 INFO  Precompiling SPEAK View: ~\sitecore\shell\client\Applications\ContentTesting\Components\UnorderedList\UnorderedList.cshtml
ManagedPoolThread #19 12:23:56 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
5872 12:23:57 INFO  Precompiling SPEAK View: ~\sitecore\shell\client\Business Component Library\Layouts\Renderings\Navigation\Menus\Menu.cshtml
7520 12:23:58 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

1428 12:23:59 INFO  Precompiling SPEAK View: ~\sitecore\shell\client\Applications\ContentTesting\Components\ValueBar\ValueBar.cshtml
5872 12:24:00 INFO  Precompiling SPEAK View: ~\sitecore\shell\client\Business Component Library\Layouts\Renderings\Navigation\NavigationPanelToggleButtons\NavigationPanelToggleButton.cshtml
1428 12:24:04 INFO  Precompiling SPEAK View: ~\sitecore\shell\client\Applications\ContentTesting\Components\WrappingLink\WrappingLink.cshtml
ManagedPoolThread #9 12:24:04 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #9 12:24:04 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
5872 12:24:05 INFO  Precompiling SPEAK View: ~\sitecore\shell\client\Business Component Library\Layouts\Renderings\SearchingAndFiltering\FilterControls\FilterControl.cshtml
ManagedPoolThread #8 12:25:24 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #8 12:25:24 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
5296 12:25:24 INFO  [Experience Analytics]: Reduce agent found zero sites to process
6160 12:25:25 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

3600 12:25:25 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

9120 12:25:25 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

2472 12:25:25 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Core.BackgroundService.Run()

4424 12:25:44 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

 424 12:25:44 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

7520 12:25:44 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
7520 12:25:44 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.HandleDatabaseException(ExceptionBehavior exceptionBehavior, Exception ex)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

Nested Exception

Exception: MongoDB.Driver.MongoConnectionException
Message: Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
Source: MongoDB.Driver
   at MongoDB.Driver.Internal.DirectMongoServerProxy.Connect(TimeSpan timeout, ReadPreference readPreference)
   at MongoDB.Driver.Internal.DirectMongoServerProxy.ChooseServerInstance(ReadPreference readPreference)
   at MongoDB.Driver.MongoServer.AcquireConnection(ReadPreference readPreference)
   at MongoDB.Driver.MongoCollection.RunCommandAs[TCommandResult](IMongoCommand command, ReadPreference readPreference, IBsonSerializer resultSerializer, IBsonSerializationOptions resultSerializationOptions)
   at MongoDB.Driver.MongoCollection.RunCommandAs[TCommandResult](IMongoCommand command, ReadPreference readPreference)
   at MongoDB.Driver.MongoCollection.FindAndModify(FindAndModifyArgs args)
   at MongoDB.Driver.MongoCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.<>c__DisplayClass2c.<FindAndModify>b__2b()
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)

Nested Exception

Exception: System.Net.Sockets.SocketException
Message: No connection could be made because the target machine actively refused it 127.0.0.1:27017
Source: System
   at System.Net.Sockets.Socket.DoConnect(EndPoint endPointSnapshot, SocketAddress socketAddress)
   at System.Net.Sockets.Socket.Connect(EndPoint remoteEP)
   at System.Net.Sockets.TcpClient.Connect(IPEndPoint remoteEP)
   at MongoDB.Driver.Internal.MongoConnection.Open()
   at MongoDB.Driver.Internal.MongoConnection.SendMessage(BsonBuffer buffer, Int32 requestId)
   at MongoDB.Driver.Internal.MongoConnection.SendMessage(MongoRequestMessage message)
   at MongoDB.Driver.Operations.CommandOperation`1.Execute(MongoConnection connection)
   at MongoDB.Driver.MongoServerInstance.Ping(MongoConnection connection)
   at MongoDB.Driver.MongoServerInstance.Connect()
   at MongoDB.Driver.Internal.DirectMongoServerProxy.Connect(TimeSpan timeout, ReadPreference readPreference)



1428 12:25:44 INFO  Precompiling SPEAK View: ~\sitecore\shell\client\Applications\ContentTesting\Components\ZoomFrame\ZoomFrame.cshtml
ManagedPoolThread #0 12:25:44 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #0 12:25:44 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
ManagedPoolThread #2 12:25:45 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
5872 12:25:46 INFO  Precompiling SPEAK View: ~\sitecore\shell\client\Business Component Library\Layouts\Renderings\SearchingAndFiltering\Searches\SearchPanel.cshtml
ManagedPoolThread #5 12:25:46 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
1428 12:25:47 INFO  Precompiling SPEAK View: ~\sitecore\shell\client\Applications\ContentTesting\Components\__OLD\KPISpot\KPISpot.cshtml
ManagedPoolThread #6 12:25:47 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #7 12:25:48 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
5872 12:25:49 INFO  Precompiling SPEAK View: ~\sitecore\shell\client\Business Component Library\Layouts\Renderings\Silverlight\SilverlightFrame\SilverlightFrame.cshtml
ManagedPoolThread #10 12:25:49 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
1428 12:25:50 INFO  Precompiling SPEAK Views: Done - time taking: 264132 milliseconds.
ManagedPoolThread #11 12:25:50 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #13 12:25:51 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
5872 12:25:52 INFO  Precompiling SPEAK View: ~\sitecore\shell\client\Business Component Library\Layouts\Renderings\Structures\Page Structures\Application\Dashboard.cshtml
ManagedPoolThread #14 12:25:52 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
5872 12:25:53 INFO  Precompiling SPEAK View: ~\sitecore\shell\client\Business Component Library\Layouts\Renderings\Structures\Page Structures\Application\List.cshtml
5872 12:25:53 INFO  Precompiling SPEAK View: ~\sitecore\shell\client\Business Component Library\Layouts\Renderings\Structures\Page Structures\Application\Task.cshtml
5872 12:25:53 INFO  Precompiling SPEAK View: ~\sitecore\shell\client\Business Component Library\Layouts\Renderings\Structures\Page Structures\Dialog\Dialog.cshtml
ManagedPoolThread #15 12:25:53 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
5296 12:25:54 INFO  [Experience Analytics]: Reduce agent found zero sites to process
ManagedPoolThread #9 12:25:54 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #9 12:25:54 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
ManagedPoolThread #16 12:25:54 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
5872 12:25:54 INFO  Precompiling SPEAK View: ~\sitecore\shell\client\Business Component Library\Layouts\Renderings\Structures\Page Structures\Framework\SearchResults.cshtml
ManagedPoolThread #17 12:25:55 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
5872 12:25:56 INFO  Precompiling SPEAK View: ~\sitecore\shell\client\Business Component Library\Layouts\Renderings\Structures\Page Structures\Framework\Start.cshtml
5872 12:25:56 INFO  Precompiling SPEAK View: ~\sitecore\shell\client\Business Component Library\Layouts\Renderings\Structures\Substructures\ApplicationContentM.cshtml
ManagedPoolThread #18 12:25:56 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
5872 12:25:57 INFO  Precompiling SPEAK View: ~\sitecore\shell\client\Business Component Library\Layouts\Renderings\Structures\Substructures\ApplicationContentMI.cshtml
5872 12:25:57 INFO  Precompiling SPEAK View: ~\sitecore\shell\client\Business Component Library\Layouts\Renderings\Structures\Substructures\ApplicationContentNM.cshtml
5872 12:25:57 INFO  Precompiling SPEAK View: ~\sitecore\shell\client\Business Component Library\Layouts\Renderings\Structures\Substructures\ApplicationContentNMI.cshtml
5872 12:25:57 INFO  Precompiling SPEAK View: ~\sitecore\shell\client\Business Component Library\Layouts\Renderings\Structures\Substructures\ApplicationHeader.cshtml
5872 12:25:57 INFO  Precompiling SPEAK View: ~\sitecore\shell\client\Business Component Library\Layouts\Renderings\Structures\Substructures\DialogContentM.cshtml
5872 12:25:57 INFO  Precompiling SPEAK View: ~\sitecore\shell\client\Business Component Library\Layouts\Renderings\Structures\Substructures\DialogContentMI.cshtml
5872 12:25:57 INFO  Precompiling SPEAK View: ~\sitecore\shell\client\Business Component Library\Layouts\Renderings\Structures\Substructures\DialogContentNM.cshtml
5872 12:25:57 INFO  Precompiling SPEAK View: ~\sitecore\shell\client\Business Component Library\Layouts\Renderings\Structures\Substructures\DialogFooter.cshtml
5872 12:25:57 INFO  Precompiling SPEAK View: ~\sitecore\shell\client\Business Component Library\Layouts\Renderings\Structures\Substructures\DialogHeader.cshtml
5872 12:25:57 INFO  Precompiling SPEAK View: ~\sitecore\shell\client\Business Component Library\Layouts\Renderings\Structures\Substructures\FrameworkContentM.cshtml
5872 12:25:57 INFO  Precompiling SPEAK View: ~\sitecore\shell\client\Business Component Library\Layouts\Renderings\Structures\Substructures\GlobalFooter.cshtml
5872 12:25:57 INFO  Precompiling SPEAK View: ~\sitecore\shell\client\Business Component Library\Layouts\Renderings\Structures\Substructures\GlobalHeader.cshtml
5872 12:25:57 INFO  Precompiling SPEAK View: ~\sitecore\shell\client\Business Component Library\version 2\Content\Guidance\Common\Layouts\Renderings\AllComponentProperties\AllComponentProperties.cshtml
ManagedPoolThread #19 12:25:57 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
7092 12:25:58 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
5872 12:25:59 INFO  Precompiling SPEAK View: ~\sitecore\shell\client\Business Component Library\version 2\Content\Guidance\Common\Layouts\Renderings\AllComponentsList\AllComponentslist.cshtml
7520 12:25:59 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

4424 12:25:59 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

 424 12:25:59 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

7740 12:25:59 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
5872 12:26:00 INFO  Precompiling SPEAK View: ~\sitecore\shell\client\Business Component Library\version 2\Content\Guidance\Common\Layouts\Renderings\ComponentReferences\ComponentReference.cshtml
ManagedPoolThread #1 12:26:01 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
Heartbeat 12:26:02 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
5872 12:26:02 INFO  Precompiling SPEAK View: ~\sitecore\shell\client\Business Component Library\version 2\Content\Guidance\Common\Layouts\Renderings\DemoComponentPanels\DemoComponentPanel.cshtml
9120 12:26:03 ERROR Exception when executing agent aggregation/automationAggregator
Exception: MongoDB.Driver.MongoConnectionException
Message: Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
Source: MongoDB.Driver
   at MongoDB.Driver.Internal.DirectMongoServerProxy.Connect(TimeSpan timeout, ReadPreference readPreference)
   at MongoDB.Driver.Internal.DirectMongoServerProxy.ChooseServerInstance(ReadPreference readPreference)
   at MongoDB.Driver.MongoServer.AcquireConnection(ReadPreference readPreference)
   at MongoDB.Driver.MongoCursor`1.MongoCursorConnectionProvider.AcquireConnection()
   at MongoDB.Driver.Operations.QueryOperation`1.GetFirstBatch(IConnectionProvider connectionProvider)
   at MongoDB.Driver.Operations.QueryOperation`1.Execute(IConnectionProvider connectionProvider)
   at System.Linq.Buffer`1..ctor(IEnumerable`1 source)
   at System.Linq.Enumerable.ToArray[TSource](IEnumerable`1 source)
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

Nested Exception

Exception: System.Net.Sockets.SocketException
Message: No connection could be made because the target machine actively refused it 127.0.0.1:27017
Source: System
   at System.Net.Sockets.Socket.DoConnect(EndPoint endPointSnapshot, SocketAddress socketAddress)
   at System.Net.Sockets.Socket.Connect(EndPoint remoteEP)
   at System.Net.Sockets.TcpClient.Connect(IPEndPoint remoteEP)
   at MongoDB.Driver.Internal.MongoConnection.Open()
   at MongoDB.Driver.Internal.MongoConnection.SendMessage(BsonBuffer buffer, Int32 requestId)
   at MongoDB.Driver.Internal.MongoConnection.SendMessage(MongoRequestMessage message)
   at MongoDB.Driver.Operations.CommandOperation`1.Execute(MongoConnection connection)
   at MongoDB.Driver.MongoServerInstance.Ping(MongoConnection connection)
   at MongoDB.Driver.MongoServerInstance.Connect()
   at MongoDB.Driver.Internal.DirectMongoServerProxy.Connect(TimeSpan timeout, ReadPreference readPreference)


5872 12:26:03 INFO  Precompiling SPEAK View: ~\sitecore\shell\client\Business Component Library\version 2\Layouts\Layouts\Speak-Extension-Layout.cshtml
2472 12:26:04 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: MongoDB.Driver.MongoConnectionException
Message: Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
Source: MongoDB.Driver
   at MongoDB.Driver.Internal.DirectMongoServerProxy.Connect(TimeSpan timeout, ReadPreference readPreference)
   at MongoDB.Driver.Internal.DirectMongoServerProxy.ChooseServerInstance(ReadPreference readPreference)
   at MongoDB.Driver.MongoServer.AcquireConnection(ReadPreference readPreference)
   at MongoDB.Driver.MongoCursor`1.MongoCursorConnectionProvider.AcquireConnection()
   at MongoDB.Driver.Operations.QueryOperation`1.GetFirstBatch(IConnectionProvider connectionProvider)
   at MongoDB.Driver.Operations.QueryOperation`1.Execute(IConnectionProvider connectionProvider)
   at System.Linq.Enumerable.FirstOrDefault[TSource](IEnumerable`1 source)
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Core.BackgroundService.Run()

Nested Exception

Exception: System.Net.Sockets.SocketException
Message: No connection could be made because the target machine actively refused it 127.0.0.1:27017
Source: System
   at System.Net.Sockets.Socket.DoConnect(EndPoint endPointSnapshot, SocketAddress socketAddress)
   at System.Net.Sockets.Socket.Connect(EndPoint remoteEP)
   at System.Net.Sockets.TcpClient.Connect(IPEndPoint remoteEP)
   at MongoDB.Driver.Internal.MongoConnection.Open()
   at MongoDB.Driver.Internal.MongoConnection.SendMessage(BsonBuffer buffer, Int32 requestId)
   at MongoDB.Driver.Internal.MongoConnection.SendMessage(MongoRequestMessage message)
   at MongoDB.Driver.Operations.CommandOperation`1.Execute(MongoConnection connection)
   at MongoDB.Driver.MongoServerInstance.Ping(MongoConnection connection)
   at MongoDB.Driver.MongoServerInstance.Connect()
   at MongoDB.Driver.Internal.DirectMongoServerProxy.Connect(TimeSpan timeout, ReadPreference readPreference)


ManagedPoolThread #4 12:26:04 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #4 12:26:04 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
6160 12:26:05 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: MongoDB.Driver.MongoConnectionException
Message: Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
Source: MongoDB.Driver
   at MongoDB.Driver.Internal.DirectMongoServerProxy.Connect(TimeSpan timeout, ReadPreference readPreference)
   at MongoDB.Driver.Internal.DirectMongoServerProxy.ChooseServerInstance(ReadPreference readPreference)
   at MongoDB.Driver.MongoServer.AcquireConnection(ReadPreference readPreference)
   at MongoDB.Driver.MongoCursor`1.MongoCursorConnectionProvider.AcquireConnection()
   at MongoDB.Driver.Operations.QueryOperation`1.GetFirstBatch(IConnectionProvider connectionProvider)
   at MongoDB.Driver.Operations.QueryOperation`1.Execute(IConnectionProvider connectionProvider)
   at System.Linq.Enumerable.FirstOrDefault[TSource](IEnumerable`1 source)
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

Nested Exception

Exception: System.Net.Sockets.SocketException
Message: No connection could be made because the target machine actively refused it 127.0.0.1:27017
Source: System
   at System.Net.Sockets.Socket.DoConnect(EndPoint endPointSnapshot, SocketAddress socketAddress)
   at System.Net.Sockets.Socket.Connect(EndPoint remoteEP)
   at System.Net.Sockets.TcpClient.Connect(IPEndPoint remoteEP)
   at MongoDB.Driver.Internal.MongoConnection.Open()
   at MongoDB.Driver.Internal.MongoConnection.SendMessage(BsonBuffer buffer, Int32 requestId)
   at MongoDB.Driver.Internal.MongoConnection.SendMessage(MongoRequestMessage message)
   at MongoDB.Driver.Operations.CommandOperation`1.Execute(MongoConnection connection)
   at MongoDB.Driver.MongoServerInstance.Ping(MongoConnection connection)
   at MongoDB.Driver.MongoServerInstance.Connect()
   at MongoDB.Driver.Internal.DirectMongoServerProxy.Connect(TimeSpan timeout, ReadPreference readPreference)


5872 12:26:05 INFO  Precompiling SPEAK View: ~\sitecore\shell\client\Business Component Library\version 2\Layouts\Layouts\Speak-Test-Layout.cshtml
5872 12:26:05 INFO  Precompiling SPEAK View: ~\sitecore\shell\client\Business Component Library\version 2\Layouts\Renderings\Authentications\AccountInformations\AccountInformation.cshtml
3600 12:26:06 ERROR Exception when executing agent aggregation/automationAggregator
Exception: MongoDB.Driver.MongoConnectionException
Message: Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
Source: MongoDB.Driver
   at MongoDB.Driver.Internal.DirectMongoServerProxy.Connect(TimeSpan timeout, ReadPreference readPreference)
   at MongoDB.Driver.Internal.DirectMongoServerProxy.ChooseServerInstance(ReadPreference readPreference)
   at MongoDB.Driver.MongoServer.AcquireConnection(ReadPreference readPreference)
   at MongoDB.Driver.MongoCursor`1.MongoCursorConnectionProvider.AcquireConnection()
   at MongoDB.Driver.Operations.QueryOperation`1.GetFirstBatch(IConnectionProvider connectionProvider)
   at MongoDB.Driver.Operations.QueryOperation`1.Execute(IConnectionProvider connectionProvider)
   at System.Linq.Buffer`1..ctor(IEnumerable`1 source)
   at System.Linq.Enumerable.ToArray[TSource](IEnumerable`1 source)
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

Nested Exception

Exception: System.Net.Sockets.SocketException
Message: No connection could be made because the target machine actively refused it 127.0.0.1:27017
Source: System
   at System.Net.Sockets.Socket.DoConnect(EndPoint endPointSnapshot, SocketAddress socketAddress)
   at System.Net.Sockets.Socket.Connect(EndPoint remoteEP)
   at System.Net.Sockets.TcpClient.Connect(IPEndPoint remoteEP)
   at MongoDB.Driver.Internal.MongoConnection.Open()
   at MongoDB.Driver.Internal.MongoConnection.SendMessage(BsonBuffer buffer, Int32 requestId)
   at MongoDB.Driver.Internal.MongoConnection.SendMessage(MongoRequestMessage message)
   at MongoDB.Driver.Operations.CommandOperation`1.Execute(MongoConnection connection)
   at MongoDB.Driver.MongoServerInstance.Ping(MongoConnection connection)
   at MongoDB.Driver.MongoServerInstance.Connect()
   at MongoDB.Driver.Internal.DirectMongoServerProxy.Connect(TimeSpan timeout, ReadPreference readPreference)


5872 12:26:06 INFO  Precompiling SPEAK View: ~\sitecore\shell\client\Business Component Library\version 2\Layouts\Renderings\Charts\FusionChartsAreaChart.cshtml
ManagedPoolThread #12 12:26:07 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #3 12:26:08 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
5872 12:26:08 INFO  Precompiling SPEAK View: ~\sitecore\shell\client\Business Component Library\version 2\Layouts\Renderings\Charts\FusionChartsBarChart.cshtml
5872 12:26:08 INFO  Precompiling SPEAK View: ~\sitecore\shell\client\Business Component Library\version 2\Layouts\Renderings\Charts\FusionChartsColumnChart.cshtml
5872 12:26:08 INFO  Precompiling SPEAK View: ~\sitecore\shell\client\Business Component Library\version 2\Layouts\Renderings\Charts\FusionChartsDoughnutChart.cshtml
5872 12:26:08 INFO  Precompiling SPEAK View: ~\sitecore\shell\client\Business Component Library\version 2\Layouts\Renderings\Charts\FusionChartsJourneyChart.cshtml
5872 12:26:08 INFO  Precompiling SPEAK View: ~\sitecore\shell\client\Business Component Library\version 2\Layouts\Renderings\Charts\FusionChartsLineChart.cshtml
5872 12:26:08 INFO  Precompiling SPEAK View: ~\sitecore\shell\client\Business Component Library\version 2\Layouts\Renderings\Charts\FusionChartsPieChart.cshtml
5872 12:26:08 INFO  Precompiling SPEAK View: ~\sitecore\shell\client\Business Component Library\version 2\Layouts\Renderings\Charts\FusionChartsRadarChart.cshtml
5872 12:26:08 INFO  Precompiling SPEAK View: ~\sitecore\shell\client\Business Component Library\version 2\Layouts\Renderings\Common\ActionControls\ActionControl.cshtml
5872 12:26:09 INFO  Precompiling SPEAK View: ~\sitecore\shell\client\Business Component Library\version 2\Layouts\Renderings\Common\Buttons\BackButton.cshtml
5872 12:26:10 INFO  Precompiling SPEAK View: ~\sitecore\shell\client\Business Component Library\version 2\Layouts\Renderings\Common\Buttons\Button.cshtml
5872 12:26:10 INFO  Precompiling SPEAK View: ~\sitecore\shell\client\Business Component Library\version 2\Layouts\Renderings\Common\Buttons\DropDownButton.cshtml
5872 12:26:10 INFO  Precompiling SPEAK View: ~\sitecore\shell\client\Business Component Library\version 2\Layouts\Renderings\Common\Buttons\IconButton.cshtml
5872 12:26:10 INFO  Precompiling SPEAK View: ~\sitecore\shell\client\Business Component Library\version 2\Layouts\Renderings\Common\Buttons\ToggleButton.cshtml
5872 12:26:10 INFO  Precompiling SPEAK View: ~\sitecore\shell\client\Business Component Library\version 2\Layouts\Renderings\Common\CheckBoxes\CheckBox.cshtml
5872 12:26:12 INFO  Precompiling SPEAK View: ~\sitecore\shell\client\Business Component Library\version 2\Layouts\Renderings\Common\ComboBoxes\DropList.cshtml
5872 12:26:13 INFO  Precompiling SPEAK View: ~\sitecore\shell\client\Business Component Library\version 2\Layouts\Renderings\Common\ComboBoxes\SearchableDropList.cshtml
5872 12:26:13 INFO  Precompiling SPEAK View: ~\sitecore\shell\client\Business Component Library\version 2\Layouts\Renderings\Common\ContextSwitchers\ContextSwitcher.cshtml
5872 12:26:14 INFO  Precompiling SPEAK View: ~\sitecore\shell\client\Business Component Library\version 2\Layouts\Renderings\Common\DatePickers\DatePicker.cshtml
7520 12:26:14 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

 424 12:26:14 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

4424 12:26:14 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #8 12:26:14 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #8 12:26:14 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
5872 12:26:16 INFO  Precompiling SPEAK View: ~\sitecore\shell\client\Business Component Library\version 2\Layouts\Renderings\Common\GlobalLogos\GlobalLogo.cshtml
5872 12:26:17 INFO  Precompiling SPEAK View: ~\sitecore\shell\client\Business Component Library\version 2\Layouts\Renderings\Common\HyperlinkButtons\HyperlinkButton.cshtml
9120 12:26:18 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

5872 12:26:18 INFO  Precompiling SPEAK View: ~\sitecore\shell\client\Business Component Library\version 2\Layouts\Renderings\Common\Images\Image.cshtml
2472 12:26:19 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Core.BackgroundService.Run()

6160 12:26:20 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

5872 12:26:20 INFO  Precompiling SPEAK View: ~\sitecore\shell\client\Business Component Library\version 2\Layouts\Renderings\Common\ListBoxes\ListBox.cshtml
3600 12:26:21 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

5872 12:26:21 INFO  Precompiling SPEAK View: ~\sitecore\shell\client\Business Component Library\version 2\Layouts\Renderings\Common\MessageBars\MessageBar.cshtml
5872 12:26:22 INFO  Precompiling SPEAK View: ~\sitecore\shell\client\Business Component Library\version 2\Layouts\Renderings\Common\ProgressBars\ProgressBar.cshtml
5056 12:26:23 INFO  [Path Analyzer](.) Running trail cleanup agent
5056 12:26:23 INFO  [Path Analyzer](.) Running trail cleanup on database
5056 12:26:23 WARN  [Path Analyzer](.) SqlStorage ConnectionString 'reporting.secondary' cannot be found
5872 12:26:24 INFO  Precompiling SPEAK View: ~\sitecore\shell\client\Business Component Library\version 2\Layouts\Renderings\Common\RadioButtons\RadioButton.cshtml
5296 12:26:24 INFO  [Experience Analytics]: Reduce agent found zero sites to process
ManagedPoolThread #4 12:26:24 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #4 12:26:24 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
5872 12:26:25 INFO  Precompiling SPEAK View: ~\sitecore\shell\client\Business Component Library\version 2\Layouts\Renderings\Common\Separators\Separator.cshtml
5872 12:26:26 INFO  Precompiling SPEAK View: ~\sitecore\shell\client\Business Component Library\version 2\Layouts\Renderings\Common\TextAreas\TextArea.cshtml
5872 12:26:28 INFO  Precompiling SPEAK View: ~\sitecore\shell\client\Business Component Library\version 2\Layouts\Renderings\Common\TextBoxes\ButtonTextBox.cshtml
5872 12:26:29 INFO  Precompiling SPEAK View: ~\sitecore\shell\client\Business Component Library\version 2\Layouts\Renderings\Common\TextBoxes\TextBox.cshtml
5872 12:26:29 INFO  Precompiling SPEAK View: ~\sitecore\shell\client\Business Component Library\version 2\Layouts\Renderings\Common\Texts\Text.cshtml
4424 12:26:29 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

7520 12:26:29 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

 424 12:26:29 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

5872 12:26:30 INFO  Precompiling SPEAK View: ~\sitecore\shell\client\Business Component Library\version 2\Layouts\Renderings\Common\Tooltips\Tooltip.cshtml
5872 12:26:31 INFO  Precompiling SPEAK View: ~\sitecore\shell\client\Business Component Library\version 2\Layouts\Renderings\Containers\Borders\Border.cshtml
9120 12:26:33 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

5872 12:26:33 INFO  Precompiling SPEAK View: ~\sitecore\shell\client\Business Component Library\version 2\Layouts\Renderings\Containers\Borders\ScrollablePanel.cshtml
5872 12:26:33 INFO  Precompiling SPEAK View: ~\sitecore\shell\client\Business Component Library\version 2\Layouts\Renderings\Containers\ColumnPanels\ColumnPanel.cshtml
2472 12:26:34 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Core.BackgroundService.Run()

5872 12:26:34 INFO  Precompiling SPEAK View: ~\sitecore\shell\client\Business Component Library\version 2\Layouts\Renderings\Containers\Expanders\Expander.cshtml
ManagedPoolThread #8 12:26:34 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #8 12:26:34 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
6160 12:26:35 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

3600 12:26:36 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

5872 12:26:36 INFO  Precompiling SPEAK View: ~\sitecore\shell\client\Business Component Library\version 2\Layouts\Renderings\Containers\Frames\Frame.cshtml
5872 12:26:37 INFO  Precompiling SPEAK View: ~\sitecore\shell\client\Business Component Library\version 2\Layouts\Renderings\Containers\Popovers\Popover.cshtml
5872 12:26:39 INFO  Precompiling SPEAK View: ~\sitecore\shell\client\Business Component Library\version 2\Layouts\Renderings\Containers\RowPanels\RowPanel.cshtml
5872 12:26:40 INFO  Precompiling SPEAK View: ~\sitecore\shell\client\Business Component Library\version 2\Layouts\Renderings\Containers\Sections\Section.cshtml
5872 12:26:41 INFO  Precompiling SPEAK View: ~\sitecore\shell\client\Business Component Library\version 2\Layouts\Renderings\Containers\SmartPanels\SmartPanel.cshtml
5872 12:26:43 INFO  Precompiling SPEAK View: ~\sitecore\shell\client\Business Component Library\version 2\Layouts\Renderings\Containers\SubAppRenderers\SubAppRenderer.cshtml
5872 12:26:44 INFO  Precompiling SPEAK View: ~\sitecore\shell\client\Business Component Library\version 2\Layouts\Renderings\Containers\TabControl\TabControl.cshtml
7520 12:26:44 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

4424 12:26:44 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

 424 12:26:44 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #9 12:26:45 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #9 12:26:45 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
5872 12:26:45 INFO  Precompiling SPEAK View: ~\sitecore\shell\client\Business Component Library\version 2\Layouts\Renderings\Data\ChartDataSources\ChartDataSource.cshtml
Heartbeat 12:26:46 ERROR MongoDbDictionary.Store() has failed.
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Save(Object value)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbDictionary.Store(Object value)

5872 12:26:47 INFO  Precompiling SPEAK View: ~\sitecore\shell\client\Business Component Library\version 2\Layouts\Renderings\Data\EntityDataSources\EntityDataSource.cshtml
9120 12:26:48 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

5872 12:26:48 INFO  Precompiling SPEAK View: ~\sitecore\shell\client\Business Component Library\version 2\Layouts\Renderings\Data\GenericDataSources\GenericDataSource.cshtml
2472 12:26:49 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Core.BackgroundService.Run()

5872 12:26:49 INFO  Precompiling SPEAK View: ~\sitecore\shell\client\Business Component Library\version 2\Layouts\Renderings\Data\QueryDataSources\QueryDataSource.cshtml
6160 12:26:50 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

5872 12:26:50 INFO  Precompiling SPEAK View: ~\sitecore\shell\client\Business Component Library\version 2\Layouts\Renderings\Data\SearchDataSources\SearchDataSource.cshtml
ManagedPoolThread #10 12:26:50 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
3600 12:26:51 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

5872 12:26:52 INFO  Precompiling SPEAK View: ~\sitecore\shell\client\Business Component Library\version 2\Layouts\Renderings\Dialogs\DialogWindows\ConfirmationDialog.cshtml
5872 12:26:53 INFO  Precompiling SPEAK View: ~\sitecore\shell\client\Business Component Library\version 2\Layouts\Renderings\Dialogs\DialogWindows\DialogWindow.cshtml
5872 12:26:53 INFO  Precompiling SPEAK View: ~\sitecore\shell\client\Business Component Library\version 2\Layouts\Renderings\Forms\FormPanels\Form.cshtml
5296 12:26:54 INFO  [Experience Analytics]: Reduce agent found zero sites to process
5872 12:26:54 INFO  Precompiling SPEAK View: ~\sitecore\shell\client\Business Component Library\version 2\Layouts\Renderings\Forms\Uploader\Uploader.cshtml
ManagedPoolThread #15 12:26:54 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #8 12:26:55 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #8 12:26:55 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
5872 12:26:55 INFO  Precompiling SPEAK View: ~\sitecore\shell\client\Business Component Library\version 2\Layouts\Renderings\Forms\UploaderInfo\UploaderInfo.cshtml
5872 12:26:57 INFO  Precompiling SPEAK View: ~\sitecore\shell\client\Business Component Library\version 2\Layouts\Renderings\Indicators\ArrowIndicators\ArrowIndicator.cshtml
5872 12:26:58 INFO  Precompiling SPEAK View: ~\sitecore\shell\client\Business Component Library\version 2\Layouts\Renderings\Indicators\ValueLabels\ValueLabel.cshtml
4424 12:26:59 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

7520 12:26:59 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

 424 12:26:59 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

5872 12:26:59 INFO  Precompiling SPEAK View: ~\sitecore\shell\client\Business Component Library\version 2\Layouts\Renderings\ListsAndGrids\Grids\Grid.cshtml
5872 12:27:01 INFO  Precompiling SPEAK View: ~\sitecore\shell\client\Business Component Library\version 2\Layouts\Renderings\ListsAndGrids\ItemTreeViews\ItemTreeView.cshtml
5872 12:27:02 INFO  Precompiling SPEAK View: ~\sitecore\shell\client\Business Component Library\version 2\Layouts\Renderings\ListsAndGrids\ListControls\ListControl.cshtml
9120 12:27:03 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

5872 12:27:03 INFO  Precompiling SPEAK View: ~\sitecore\shell\client\Business Component Library\version 2\Layouts\Renderings\Navigation\Breadcrumbs\Breadcrumb.cshtml
2472 12:27:04 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #4 12:27:05 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #4 12:27:05 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
6160 12:27:05 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

5872 12:27:05 INFO  Precompiling SPEAK View: ~\sitecore\shell\client\Business Component Library\version 2\Layouts\Renderings\Navigation\HyperlinkButtonsGroups\HyperlinkButtonsGroup.cshtml
3600 12:27:06 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

5872 12:27:06 INFO  Precompiling SPEAK View: ~\sitecore\shell\client\Business Component Library\version 2\Layouts\Renderings\Navigation\Menus\Menu.cshtml
5872 12:27:07 INFO  Precompiling SPEAK View: ~\sitecore\shell\client\Business Component Library\version 2\Layouts\Renderings\Navigation\NavigationToggles\NavigationToggle.cshtml
ManagedPoolThread #12 12:27:08 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
5872 12:27:09 INFO  Precompiling SPEAK View: ~\sitecore\shell\client\Business Component Library\version 2\Layouts\Renderings\Resources\Pipelines\Pipeline.cshtml
ManagedPoolThread #19 12:27:09 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
5872 12:27:10 INFO  Precompiling SPEAK View: ~\sitecore\shell\client\Business Component Library\version 2\Layouts\Renderings\Resources\Rules\Rule.cshtml
ManagedPoolThread #17 12:27:10 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
5872 12:27:11 INFO  Precompiling SPEAK View: ~\sitecore\shell\client\Business Component Library\version 2\Layouts\Renderings\SearchingandFiltering\FilterControls\FilterControl.cshtml
ManagedPoolThread #16 12:27:11 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #1 12:27:12 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
5872 12:27:12 INFO  Precompiling SPEAK View: ~\sitecore\shell\client\Business Component Library\version 2\Layouts\Renderings\SearchingandFiltering\SearchPanels\SearchPanel.cshtml
ManagedPoolThread #11 12:27:13 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
5872 12:27:14 INFO  Precompiling SPEAK View: ~\sitecore\shell\client\Business Component Library\version 2\Layouts\Renderings\Silverlights\SilverlightFrames\SilverlightFrame.cshtml
ManagedPoolThread #13 12:27:14 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
4424 12:27:14 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

7520 12:27:14 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

 424 12:27:14 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #0 12:27:15 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #0 12:27:15 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
5872 12:27:15 INFO  Precompiling SPEAK View: ~\sitecore\shell\client\Business Component Library\version 2\Layouts\Renderings\Structures\Page Structures\Application\Dashboards\DashboardPageStructure.cshtml
ManagedPoolThread #14 12:27:15 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #3 12:27:16 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
5872 12:27:17 INFO  Precompiling SPEAK View: ~\sitecore\shell\client\Business Component Library\version 2\Layouts\Renderings\Structures\Page Structures\Application\Lists\ListPageStructure.cshtml
ManagedPoolThread #6 12:27:17 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
9120 12:27:18 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

5872 12:27:18 INFO  Precompiling SPEAK View: ~\sitecore\shell\client\Business Component Library\version 2\Layouts\Renderings\Structures\Page Structures\Application\Tasks\TaskPageStructure.cshtml
ManagedPoolThread #5 12:27:18 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
2472 12:27:19 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Core.BackgroundService.Run()

5872 12:27:19 INFO  Precompiling SPEAK View: ~\sitecore\shell\client\Business Component Library\version 2\Layouts\Renderings\Structures\Page Structures\Dialogs\DialogPageStructure.cshtml
6160 12:27:20 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

5872 12:27:21 INFO  Precompiling SPEAK View: ~\sitecore\shell\client\Business Component Library\version 2\Layouts\Renderings\Structures\Page Structures\Framework\SearchResults.cshtml
3600 12:27:21 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

5872 12:27:22 INFO  Precompiling SPEAK View: ~\sitecore\shell\client\Business Component Library\version 2\Layouts\Renderings\Structures\Page Structures\Framework\Start.cshtml
5872 12:27:22 INFO  Precompiling SPEAK View: ~\sitecore\shell\client\Business Component Library\version 2\Layouts\Renderings\Structures\Substructures\ApplicationContentM.cshtml
5872 12:27:23 INFO  Precompiling SPEAK View: ~\sitecore\shell\client\Business Component Library\version 2\Layouts\Renderings\Structures\Substructures\ApplicationContentMI.cshtml
5872 12:27:23 INFO  Precompiling SPEAK View: ~\sitecore\shell\client\Business Component Library\version 2\Layouts\Renderings\Structures\Substructures\ApplicationContentNM.cshtml
5872 12:27:23 INFO  Precompiling SPEAK View: ~\sitecore\shell\client\Business Component Library\version 2\Layouts\Renderings\Structures\Substructures\ApplicationContentNMI.cshtml
5872 12:27:23 INFO  Precompiling SPEAK View: ~\sitecore\shell\client\Business Component Library\version 2\Layouts\Renderings\Structures\Substructures\ApplicationHeader.cshtml
5872 12:27:23 INFO  Precompiling SPEAK View: ~\sitecore\shell\client\Business Component Library\version 2\Layouts\Renderings\Structures\Substructures\DialogFooter.cshtml
5872 12:27:23 INFO  Precompiling SPEAK View: ~\sitecore\shell\client\Business Component Library\version 2\Layouts\Renderings\Structures\Substructures\DialogHeader.cshtml
5872 12:27:23 INFO  Precompiling SPEAK View: ~\sitecore\shell\client\Business Component Library\version 2\Layouts\Renderings\Structures\Substructures\FrameworkContentM.cshtml
5872 12:27:23 INFO  Precompiling SPEAK View: ~\sitecore\shell\client\Business Component Library\version 2\Layouts\Renderings\Structures\Substructures\GlobalFooter.cshtml
5872 12:27:23 INFO  Precompiling SPEAK View: ~\sitecore\shell\client\Business Component Library\version 2\Layouts\Renderings\Structures\Substructures\GlobalHeader.cshtml
5872 12:27:23 INFO  Precompiling SPEAK View: ~\sitecore\shell\client\Business Component Library\version 2\Layouts\Renderings\Structures\Substructures\ApplicationHeaders\ApplicationHeader.cshtml
5296 12:27:24 INFO  [Experience Analytics]: Reduce agent found zero sites to process
5872 12:27:24 INFO  Precompiling SPEAK View: ~\sitecore\shell\client\Business Component Library\version 2\Layouts\Renderings\Structures\Substructures\DialogContentMIs\DialogContentMI.cshtml
ManagedPoolThread #4 12:27:25 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #4 12:27:25 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
5872 12:27:26 INFO  Precompiling SPEAK View: ~\sitecore\shell\client\Business Component Library\version 2\Layouts\Renderings\Structures\Substructures\DialogContentMs\DialogContentM.cshtml
5872 12:27:28 INFO  Precompiling SPEAK View: ~\sitecore\shell\client\Business Component Library\version 2\Layouts\Renderings\Structures\Substructures\DialogContentNMs\DialogContentNM.cshtml
5872 12:27:29 INFO  Precompiling SPEAK View: ~\sitecore\shell\client\Business Component Library\version 2\Layouts\Renderings\Test\PageTestCode.cshtml
7520 12:27:29 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

4424 12:27:29 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

 424 12:27:29 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

5872 12:27:30 INFO  Precompiling SPEAK Views: Done - time taking: 364302 milliseconds.
9120 12:27:33 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

2472 12:27:34 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Core.BackgroundService.Run()

6160 12:27:35 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #0 12:27:35 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #0 12:27:35 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
3600 12:27:36 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

7520 12:27:44 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

 424 12:27:44 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

4424 12:27:44 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #4 12:27:45 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #4 12:27:45 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
9120 12:27:48 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

2472 12:27:49 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Core.BackgroundService.Run()

6160 12:27:50 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

3600 12:27:51 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #10 12:27:51 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
5296 12:27:54 INFO  [Experience Analytics]: Reduce agent found zero sites to process
ManagedPoolThread #0 12:27:55 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #0 12:27:55 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
ManagedPoolThread #15 12:27:55 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
7520 12:27:59 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

4424 12:27:59 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

 424 12:27:59 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

9120 12:28:03 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

2472 12:28:04 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Core.BackgroundService.Run()

6160 12:28:05 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #8 12:28:05 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #8 12:28:05 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
3600 12:28:06 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #12 12:28:09 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
7520 12:28:14 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

4424 12:28:14 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

 424 12:28:14 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #9 12:28:15 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #9 12:28:15 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
9120 12:28:18 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

2472 12:28:20 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: MongoDB.Driver.MongoConnectionException
Message: Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
Source: MongoDB.Driver
   at MongoDB.Driver.Internal.DirectMongoServerProxy.Connect(TimeSpan timeout, ReadPreference readPreference)
   at MongoDB.Driver.Internal.DirectMongoServerProxy.ChooseServerInstance(ReadPreference readPreference)
   at MongoDB.Driver.MongoServer.AcquireConnection(ReadPreference readPreference)
   at MongoDB.Driver.MongoCursor`1.MongoCursorConnectionProvider.AcquireConnection()
   at MongoDB.Driver.Operations.QueryOperation`1.GetFirstBatch(IConnectionProvider connectionProvider)
   at MongoDB.Driver.Operations.QueryOperation`1.Execute(IConnectionProvider connectionProvider)
   at System.Linq.Enumerable.FirstOrDefault[TSource](IEnumerable`1 source)
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Core.BackgroundService.Run()

Nested Exception

Exception: System.Net.Sockets.SocketException
Message: No connection could be made because the target machine actively refused it 127.0.0.1:27017
Source: System
   at System.Net.Sockets.Socket.DoConnect(EndPoint endPointSnapshot, SocketAddress socketAddress)
   at System.Net.Sockets.Socket.Connect(EndPoint remoteEP)
   at System.Net.Sockets.TcpClient.Connect(IPEndPoint remoteEP)
   at MongoDB.Driver.Internal.MongoConnection.Open()
   at MongoDB.Driver.Internal.MongoConnection.SendMessage(BsonBuffer buffer, Int32 requestId)
   at MongoDB.Driver.Internal.MongoConnection.SendMessage(MongoRequestMessage message)
   at MongoDB.Driver.Operations.CommandOperation`1.Execute(MongoConnection connection)
   at MongoDB.Driver.MongoServerInstance.Ping(MongoConnection connection)
   at MongoDB.Driver.MongoServerInstance.Connect()
   at MongoDB.Driver.Internal.DirectMongoServerProxy.Connect(TimeSpan timeout, ReadPreference readPreference)


ManagedPoolThread #1 12:28:21 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #16 12:28:22 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #17 12:28:23 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #11 12:28:24 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
5296 12:28:24 INFO  [Experience Analytics]: Reduce agent found zero sites to process
ManagedPoolThread #5 12:28:25 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #8 12:28:25 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #8 12:28:25 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
ManagedPoolThread #19 12:28:26 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #14 12:28:27 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #6 12:28:28 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #3 12:28:29 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
7520 12:28:29 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

4424 12:28:29 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

 424 12:28:29 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #13 12:28:30 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
6160 12:28:31 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: MongoDB.Driver.MongoConnectionException
Message: Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
Source: MongoDB.Driver
   at MongoDB.Driver.Internal.DirectMongoServerProxy.Connect(TimeSpan timeout, ReadPreference readPreference)
   at MongoDB.Driver.Internal.DirectMongoServerProxy.ChooseServerInstance(ReadPreference readPreference)
   at MongoDB.Driver.MongoServer.AcquireConnection(ReadPreference readPreference)
   at MongoDB.Driver.MongoCursor`1.MongoCursorConnectionProvider.AcquireConnection()
   at MongoDB.Driver.Operations.QueryOperation`1.GetFirstBatch(IConnectionProvider connectionProvider)
   at MongoDB.Driver.Operations.QueryOperation`1.Execute(IConnectionProvider connectionProvider)
   at System.Linq.Enumerable.FirstOrDefault[TSource](IEnumerable`1 source)
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

Nested Exception

Exception: System.Net.Sockets.SocketException
Message: No connection could be made because the target machine actively refused it 127.0.0.1:27017
Source: System
   at System.Net.Sockets.Socket.DoConnect(EndPoint endPointSnapshot, SocketAddress socketAddress)
   at System.Net.Sockets.Socket.Connect(EndPoint remoteEP)
   at System.Net.Sockets.TcpClient.Connect(IPEndPoint remoteEP)
   at MongoDB.Driver.Internal.MongoConnection.Open()
   at MongoDB.Driver.Internal.MongoConnection.SendMessage(BsonBuffer buffer, Int32 requestId)
   at MongoDB.Driver.Internal.MongoConnection.SendMessage(MongoRequestMessage message)
   at MongoDB.Driver.Operations.CommandOperation`1.Execute(MongoConnection connection)
   at MongoDB.Driver.MongoServerInstance.Ping(MongoConnection connection)
   at MongoDB.Driver.MongoServerInstance.Connect()
   at MongoDB.Driver.Internal.DirectMongoServerProxy.Connect(TimeSpan timeout, ReadPreference readPreference)


3600 12:28:32 ERROR Exception when executing agent aggregation/automationAggregator
Exception: MongoDB.Driver.MongoConnectionException
Message: Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
Source: MongoDB.Driver
   at MongoDB.Driver.Internal.DirectMongoServerProxy.Connect(TimeSpan timeout, ReadPreference readPreference)
   at MongoDB.Driver.Internal.DirectMongoServerProxy.ChooseServerInstance(ReadPreference readPreference)
   at MongoDB.Driver.MongoServer.AcquireConnection(ReadPreference readPreference)
   at MongoDB.Driver.MongoCursor`1.MongoCursorConnectionProvider.AcquireConnection()
   at MongoDB.Driver.Operations.QueryOperation`1.GetFirstBatch(IConnectionProvider connectionProvider)
   at MongoDB.Driver.Operations.QueryOperation`1.Execute(IConnectionProvider connectionProvider)
   at System.Linq.Buffer`1..ctor(IEnumerable`1 source)
   at System.Linq.Enumerable.ToArray[TSource](IEnumerable`1 source)
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

Nested Exception

Exception: System.Net.Sockets.SocketException
Message: No connection could be made because the target machine actively refused it 127.0.0.1:27017
Source: System
   at System.Net.Sockets.Socket.DoConnect(EndPoint endPointSnapshot, SocketAddress socketAddress)
   at System.Net.Sockets.Socket.Connect(EndPoint remoteEP)
   at System.Net.Sockets.TcpClient.Connect(IPEndPoint remoteEP)
   at MongoDB.Driver.Internal.MongoConnection.Open()
   at MongoDB.Driver.Internal.MongoConnection.SendMessage(BsonBuffer buffer, Int32 requestId)
   at MongoDB.Driver.Internal.MongoConnection.SendMessage(MongoRequestMessage message)
   at MongoDB.Driver.Operations.CommandOperation`1.Execute(MongoConnection connection)
   at MongoDB.Driver.MongoServerInstance.Ping(MongoConnection connection)
   at MongoDB.Driver.MongoServerInstance.Connect()
   at MongoDB.Driver.Internal.DirectMongoServerProxy.Connect(TimeSpan timeout, ReadPreference readPreference)


9120 12:28:33 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

2472 12:28:35 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #9 12:28:35 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #9 12:28:35 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
4424 12:28:44 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

7520 12:28:44 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

 424 12:28:44 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #8 12:28:45 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #8 12:28:45 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
6160 12:28:46 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

3600 12:28:47 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

Heartbeat 12:28:47 ERROR MongoDbDictionary.Store() has failed.
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Save(Object value)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbDictionary.Store(Object value)

9120 12:28:48 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

2472 12:28:50 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #10 12:28:53 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
5296 12:28:54 INFO  [Experience Analytics]: Reduce agent found zero sites to process
ManagedPoolThread #4 12:28:55 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #4 12:28:55 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
ManagedPoolThread #15 12:28:57 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
7520 12:28:59 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

4424 12:28:59 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

 424 12:28:59 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

6160 12:29:01 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

3600 12:29:02 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

9120 12:29:03 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

2472 12:29:05 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #9 12:29:05 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #9 12:29:05 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
ManagedPoolThread #12 12:29:10 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
7520 12:29:14 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

4424 12:29:14 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

 424 12:29:14 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #8 12:29:15 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #8 12:29:15 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
6160 12:29:16 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

3600 12:29:17 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

9120 12:29:18 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

2472 12:29:20 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Core.BackgroundService.Run()

5296 12:29:24 INFO  [Experience Analytics]: Reduce agent found zero sites to process
ManagedPoolThread #9 12:29:25 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #9 12:29:25 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
7520 12:29:29 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

4424 12:29:29 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

 424 12:29:29 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #13 12:29:31 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
3600 12:29:32 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #5 12:29:32 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
9120 12:29:33 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #3 12:29:33 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #19 12:29:34 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
2472 12:29:35 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #8 12:29:35 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #8 12:29:35 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
ManagedPoolThread #14 12:29:35 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #17 12:29:36 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #6 12:29:37 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #11 12:29:38 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #16 12:29:39 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #1 12:29:40 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
6160 12:29:42 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: MongoDB.Driver.MongoConnectionException
Message: Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
Source: MongoDB.Driver
   at MongoDB.Driver.Internal.DirectMongoServerProxy.Connect(TimeSpan timeout, ReadPreference readPreference)
   at MongoDB.Driver.Internal.DirectMongoServerProxy.ChooseServerInstance(ReadPreference readPreference)
   at MongoDB.Driver.MongoServer.AcquireConnection(ReadPreference readPreference)
   at MongoDB.Driver.MongoCursor`1.MongoCursorConnectionProvider.AcquireConnection()
   at MongoDB.Driver.Operations.QueryOperation`1.GetFirstBatch(IConnectionProvider connectionProvider)
   at MongoDB.Driver.Operations.QueryOperation`1.Execute(IConnectionProvider connectionProvider)
   at System.Linq.Enumerable.FirstOrDefault[TSource](IEnumerable`1 source)
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

Nested Exception

Exception: System.Net.Sockets.SocketException
Message: No connection could be made because the target machine actively refused it 127.0.0.1:27017
Source: System
   at System.Net.Sockets.Socket.DoConnect(EndPoint endPointSnapshot, SocketAddress socketAddress)
   at System.Net.Sockets.Socket.Connect(EndPoint remoteEP)
   at System.Net.Sockets.TcpClient.Connect(IPEndPoint remoteEP)
   at MongoDB.Driver.Internal.MongoConnection.Open()
   at MongoDB.Driver.Internal.MongoConnection.SendMessage(BsonBuffer buffer, Int32 requestId)
   at MongoDB.Driver.Internal.MongoConnection.SendMessage(MongoRequestMessage message)
   at MongoDB.Driver.Operations.CommandOperation`1.Execute(MongoConnection connection)
   at MongoDB.Driver.MongoServerInstance.Ping(MongoConnection connection)
   at MongoDB.Driver.MongoServerInstance.Connect()
   at MongoDB.Driver.Internal.DirectMongoServerProxy.Connect(TimeSpan timeout, ReadPreference readPreference)


7520 12:29:44 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

4424 12:29:44 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

 424 12:29:44 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #9 12:29:45 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #9 12:29:45 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
3600 12:29:47 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

9120 12:29:48 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

2472 12:29:50 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #10 12:29:54 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
5296 12:29:54 INFO  [Experience Analytics]: Reduce agent found zero sites to process
ManagedPoolThread #8 12:29:55 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #8 12:29:55 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
6160 12:29:57 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #15 12:29:58 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
7520 12:30:00 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

 424 12:30:00 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

4424 12:30:00 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

3600 12:30:02 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

9120 12:30:03 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

2472 12:30:05 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #4 12:30:05 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #4 12:30:05 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
ManagedPoolThread #12 12:30:11 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
6160 12:30:12 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

7520 12:30:15 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

 424 12:30:15 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

4424 12:30:15 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #0 12:30:15 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #0 12:30:15 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
3600 12:30:17 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

9120 12:30:18 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

2472 12:30:20 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Core.BackgroundService.Run()

5296 12:30:24 INFO  [Experience Analytics]: Reduce agent found zero sites to process
ManagedPoolThread #4 12:30:25 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #4 12:30:25 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
6160 12:30:27 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

7520 12:30:30 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

 424 12:30:30 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

4424 12:30:30 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

3600 12:30:32 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

9120 12:30:33 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

2472 12:30:35 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #0 12:30:35 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #0 12:30:35 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
ManagedPoolThread #5 12:30:42 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #13 12:30:43 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #19 12:30:44 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
7520 12:30:45 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

4424 12:30:45 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

 424 12:30:45 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #4 12:30:45 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #4 12:30:45 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
ManagedPoolThread #3 12:30:45 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #17 12:30:46 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
3600 12:30:47 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #14 12:30:47 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
Heartbeat 12:30:48 ERROR MongoDbDictionary.Store() has failed.
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Save(Object value)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbDictionary.Store(Object value)

9120 12:30:48 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #11 12:30:48 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #6 12:30:49 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
2472 12:30:50 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #16 12:30:50 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #1 12:30:51 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
6160 12:30:52 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: MongoDB.Driver.MongoConnectionException
Message: Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
Source: MongoDB.Driver
   at MongoDB.Driver.Internal.DirectMongoServerProxy.Connect(TimeSpan timeout, ReadPreference readPreference)
   at MongoDB.Driver.Internal.DirectMongoServerProxy.ChooseServerInstance(ReadPreference readPreference)
   at MongoDB.Driver.MongoServer.AcquireConnection(ReadPreference readPreference)
   at MongoDB.Driver.MongoCursor`1.MongoCursorConnectionProvider.AcquireConnection()
   at MongoDB.Driver.Operations.QueryOperation`1.GetFirstBatch(IConnectionProvider connectionProvider)
   at MongoDB.Driver.Operations.QueryOperation`1.Execute(IConnectionProvider connectionProvider)
   at System.Linq.Enumerable.FirstOrDefault[TSource](IEnumerable`1 source)
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

Nested Exception

Exception: System.Net.Sockets.SocketException
Message: No connection could be made because the target machine actively refused it 127.0.0.1:27017
Source: System
   at System.Net.Sockets.Socket.DoConnect(EndPoint endPointSnapshot, SocketAddress socketAddress)
   at System.Net.Sockets.Socket.Connect(EndPoint remoteEP)
   at System.Net.Sockets.TcpClient.Connect(IPEndPoint remoteEP)
   at MongoDB.Driver.Internal.MongoConnection.Open()
   at MongoDB.Driver.Internal.MongoConnection.SendMessage(BsonBuffer buffer, Int32 requestId)
   at MongoDB.Driver.Internal.MongoConnection.SendMessage(MongoRequestMessage message)
   at MongoDB.Driver.Operations.CommandOperation`1.Execute(MongoConnection connection)
   at MongoDB.Driver.MongoServerInstance.Ping(MongoConnection connection)
   at MongoDB.Driver.MongoServerInstance.Connect()
   at MongoDB.Driver.Internal.DirectMongoServerProxy.Connect(TimeSpan timeout, ReadPreference readPreference)


5296 12:30:54 INFO  [Experience Analytics]: Reduce agent found zero sites to process
ManagedPoolThread #10 12:30:55 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #0 12:30:55 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #0 12:30:55 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
ManagedPoolThread #15 12:30:59 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
7520 12:31:00 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

 424 12:31:00 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

4424 12:31:00 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

3600 12:31:02 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

9120 12:31:03 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

2472 12:31:05 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #8 12:31:05 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #8 12:31:05 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
6160 12:31:07 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #12 12:31:12 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
 424 12:31:15 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

4424 12:31:15 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

7520 12:31:15 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #9 12:31:15 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #9 12:31:15 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
3600 12:31:17 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

9120 12:31:18 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

2472 12:31:20 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Core.BackgroundService.Run()

Heartbeat 12:31:20 INFO  Health.PrivateBytes: 889,212,928
Heartbeat 12:31:20 INFO  Health.CacheInstances: 115
Heartbeat 12:31:20 INFO  Health.CacheTotalCount: 18,057
Heartbeat 12:31:20 INFO  Health.CacheTotalSize: 75,430,198
Heartbeat 12:31:20 WARN  Could not register counter in HealthMonitor. Category: Process, Name: Private Bytes, Instance: , InstanceType: Windows
		Message: Access to the registry key 'Global' is denied.
Heartbeat 12:31:20 WARN  Could not register counter in HealthMonitor. Category: Process, Name: Virtual Bytes, Instance: , InstanceType: Windows
		Message: Access to the registry key 'Global' is denied.
Heartbeat 12:31:20 WARN  Could not register counter in HealthMonitor. Category: Process, Name: Page File Bytes, Instance: , InstanceType: Windows
		Message: Access to the registry key 'Global' is denied.
Heartbeat 12:31:20 WARN  Could not register counter in HealthMonitor. Category: .NET CLR Memory, Name: # Bytes in all Heaps, Instance: , InstanceType: CLR
		Message: Access to the registry key 'Global' is denied.
Heartbeat 12:31:20 WARN  Could not register counter in HealthMonitor. Category: .NET CLR Memory, Name: % Time in GC, Instance: , InstanceType: CLR
		Message: Access to the registry key 'Global' is denied.
Heartbeat 12:31:20 WARN  Could not register counter in HealthMonitor. Category: .NET CLR Memory, Name: Large Object Heap size, Instance: , InstanceType: CLR
		Message: Access to the registry key 'Global' is denied.
Heartbeat 12:31:20 WARN  Could not register counter in HealthMonitor. Category: .NET CLR Loading, Name: Bytes in Loader Heap, Instance: , InstanceType: CLR
		Message: Access to the registry key 'Global' is denied.
Heartbeat 12:31:20 WARN  Could not register counter in HealthMonitor. Category: .NET CLR Loading, Name: Current Assemblies, Instance: , InstanceType: CLR
		Message: Access to the registry key 'Global' is denied.
6160 12:31:22 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

5056 12:31:23 INFO  [Path Analyzer](.) Running trail cleanup agent
5056 12:31:23 INFO  [Path Analyzer](.) Running trail cleanup on database
5296 12:31:24 INFO  [Experience Analytics]: Reduce agent found zero sites to process
ManagedPoolThread #8 12:31:25 INFO  Job started: Sitecore.Tasks.TaskDatabaseAgent
ManagedPoolThread #8 12:31:25 INFO  Processing tasks (count: 0)
ManagedPoolThread #8 12:31:25 INFO  Job ended: Sitecore.Tasks.TaskDatabaseAgent (units processed: )
ManagedPoolThread #8 12:31:25 INFO  Job started: Core_Database_Agent
ManagedPoolThread #8 12:31:25 INFO  Scheduling.DatabaseAgent started. Database: core
ManagedPoolThread #8 12:31:25 INFO  Examining schedules (count: 0)
ManagedPoolThread #8 12:31:25 INFO  Job ended: Core_Database_Agent (units processed: )
ManagedPoolThread #8 12:31:25 INFO  Job started: Master_Database_Agent
ManagedPoolThread #8 12:31:25 INFO  Scheduling.DatabaseAgent started. Database: master
ManagedPoolThread #8 12:31:25 INFO  Examining schedules (count: 5)
ManagedPoolThread #8 12:31:25 INFO  Starting: __Task Schedule
ManagedPoolThread #8 12:31:25 INFO  Ended: __Task Schedule
ManagedPoolThread #8 12:31:25 INFO  Not due: Calculate Statistical Relevancy
ManagedPoolThread #8 12:31:25 INFO  Not due: Rebuild Suggested Tests Index
ManagedPoolThread #8 12:31:25 INFO  Not due: Suspend Corrupted Tests
ManagedPoolThread #8 12:31:25 INFO  Not due: Try Finish Test
ManagedPoolThread #8 12:31:25 INFO  Job ended: Master_Database_Agent (units processed: 5)
ManagedPoolThread #8 12:31:25 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #8 12:31:25 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
 424 12:31:30 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

7520 12:31:30 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

4424 12:31:30 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

3600 12:31:32 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

9120 12:31:33 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

2472 12:31:35 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #0 12:31:35 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #0 12:31:35 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
6160 12:31:37 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

 424 12:31:45 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

4424 12:31:45 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

7520 12:31:45 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #9 12:31:45 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #9 12:31:45 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
3600 12:31:47 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

9120 12:31:48 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

2472 12:31:50 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #19 12:31:53 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #3 12:31:54 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
5296 12:31:54 INFO  [Experience Analytics]: Reduce agent found zero sites to process
ManagedPoolThread #5 12:31:55 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #4 12:31:55 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #4 12:31:55 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
ManagedPoolThread #13 12:31:56 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #6 12:31:57 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #14 12:31:58 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #17 12:31:59 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
 424 12:32:00 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

4424 12:32:00 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #16 12:32:00 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #1 12:32:01 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
3600 12:32:02 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #11 12:32:02 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
9120 12:32:03 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

6160 12:32:03 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: MongoDB.Driver.MongoConnectionException
Message: Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
Source: MongoDB.Driver
   at MongoDB.Driver.Internal.DirectMongoServerProxy.Connect(TimeSpan timeout, ReadPreference readPreference)
   at MongoDB.Driver.Internal.DirectMongoServerProxy.ChooseServerInstance(ReadPreference readPreference)
   at MongoDB.Driver.MongoServer.AcquireConnection(ReadPreference readPreference)
   at MongoDB.Driver.MongoCursor`1.MongoCursorConnectionProvider.AcquireConnection()
   at MongoDB.Driver.Operations.QueryOperation`1.GetFirstBatch(IConnectionProvider connectionProvider)
   at MongoDB.Driver.Operations.QueryOperation`1.Execute(IConnectionProvider connectionProvider)
   at System.Linq.Enumerable.FirstOrDefault[TSource](IEnumerable`1 source)
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

Nested Exception

Exception: System.Net.Sockets.SocketException
Message: No connection could be made because the target machine actively refused it 127.0.0.1:27017
Source: System
   at System.Net.Sockets.Socket.DoConnect(EndPoint endPointSnapshot, SocketAddress socketAddress)
   at System.Net.Sockets.Socket.Connect(EndPoint remoteEP)
   at System.Net.Sockets.TcpClient.Connect(IPEndPoint remoteEP)
   at MongoDB.Driver.Internal.MongoConnection.Open()
   at MongoDB.Driver.Internal.MongoConnection.SendMessage(BsonBuffer buffer, Int32 requestId)
   at MongoDB.Driver.Internal.MongoConnection.SendMessage(MongoRequestMessage message)
   at MongoDB.Driver.Operations.CommandOperation`1.Execute(MongoConnection connection)
   at MongoDB.Driver.MongoServerInstance.Ping(MongoConnection connection)
   at MongoDB.Driver.MongoServerInstance.Connect()
   at MongoDB.Driver.Internal.DirectMongoServerProxy.Connect(TimeSpan timeout, ReadPreference readPreference)


ManagedPoolThread #10 12:32:04 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
2472 12:32:05 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #7 12:32:05 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #0 12:32:05 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #0 12:32:05 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
ManagedPoolThread #15 12:32:06 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
7520 12:32:07 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
7520 12:32:07 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.HandleDatabaseException(ExceptionBehavior exceptionBehavior, Exception ex)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

Nested Exception

Exception: MongoDB.Driver.MongoConnectionException
Message: Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
Source: MongoDB.Driver
   at MongoDB.Driver.Internal.DirectMongoServerProxy.Connect(TimeSpan timeout, ReadPreference readPreference)
   at MongoDB.Driver.Internal.DirectMongoServerProxy.ChooseServerInstance(ReadPreference readPreference)
   at MongoDB.Driver.MongoServer.AcquireConnection(ReadPreference readPreference)
   at MongoDB.Driver.MongoCollection.RunCommandAs[TCommandResult](IMongoCommand command, ReadPreference readPreference, IBsonSerializer resultSerializer, IBsonSerializationOptions resultSerializationOptions)
   at MongoDB.Driver.MongoCollection.RunCommandAs[TCommandResult](IMongoCommand command, ReadPreference readPreference)
   at MongoDB.Driver.MongoCollection.FindAndModify(FindAndModifyArgs args)
   at MongoDB.Driver.MongoCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.<>c__DisplayClass2c.<FindAndModify>b__2b()
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)

Nested Exception

Exception: System.Net.Sockets.SocketException
Message: No connection could be made because the target machine actively refused it 127.0.0.1:27017
Source: System
   at System.Net.Sockets.Socket.DoConnect(EndPoint endPointSnapshot, SocketAddress socketAddress)
   at System.Net.Sockets.Socket.Connect(EndPoint remoteEP)
   at System.Net.Sockets.TcpClient.Connect(IPEndPoint remoteEP)
   at MongoDB.Driver.Internal.MongoConnection.Open()
   at MongoDB.Driver.Internal.MongoConnection.SendMessage(BsonBuffer buffer, Int32 requestId)
   at MongoDB.Driver.Internal.MongoConnection.SendMessage(MongoRequestMessage message)
   at MongoDB.Driver.Operations.CommandOperation`1.Execute(MongoConnection connection)
   at MongoDB.Driver.MongoServerInstance.Ping(MongoConnection connection)
   at MongoDB.Driver.MongoServerInstance.Connect()
   at MongoDB.Driver.Internal.DirectMongoServerProxy.Connect(TimeSpan timeout, ReadPreference readPreference)



ManagedPoolThread #12 12:32:13 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
 424 12:32:15 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

4424 12:32:15 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #9 12:32:15 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #9 12:32:15 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
3600 12:32:17 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

9120 12:32:18 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

6160 12:32:18 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

2472 12:32:20 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Core.BackgroundService.Run()

7520 12:32:22 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

5296 12:32:24 INFO  [Experience Analytics]: Reduce agent found zero sites to process
ManagedPoolThread #0 12:32:25 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #0 12:32:25 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
 424 12:32:30 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

4424 12:32:30 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

3600 12:32:32 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

9120 12:32:33 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

6160 12:32:33 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

2472 12:32:35 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #9 12:32:35 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #9 12:32:35 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
7520 12:32:37 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

 424 12:32:45 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

4424 12:32:45 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #0 12:32:45 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #0 12:32:45 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
3600 12:32:47 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

9120 12:32:48 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

6160 12:32:48 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

Heartbeat 12:32:48 ERROR MongoDbDictionary.Store() has failed.
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Save(Object value)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbDictionary.Store(Object value)

2472 12:32:50 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Core.BackgroundService.Run()

7520 12:32:52 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

5296 12:32:54 INFO  [Experience Analytics]: Reduce agent found zero sites to process
ManagedPoolThread #9 12:32:55 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #9 12:32:55 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
 424 12:33:00 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

4424 12:33:00 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

3600 12:33:02 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #1 12:33:04 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #3 12:33:05 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
2472 12:33:05 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #4 12:33:05 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #4 12:33:05 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
ManagedPoolThread #19 12:33:06 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #5 12:33:07 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #17 12:33:08 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #16 12:33:09 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #6 12:33:10 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #13 12:33:11 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #11 12:33:12 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #14 12:33:13 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
9120 12:33:14 ERROR Exception when executing agent aggregation/automationAggregator
Exception: MongoDB.Driver.MongoConnectionException
Message: Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
Source: MongoDB.Driver
   at MongoDB.Driver.Internal.DirectMongoServerProxy.Connect(TimeSpan timeout, ReadPreference readPreference)
   at MongoDB.Driver.Internal.DirectMongoServerProxy.ChooseServerInstance(ReadPreference readPreference)
   at MongoDB.Driver.MongoServer.AcquireConnection(ReadPreference readPreference)
   at MongoDB.Driver.MongoCursor`1.MongoCursorConnectionProvider.AcquireConnection()
   at MongoDB.Driver.Operations.QueryOperation`1.GetFirstBatch(IConnectionProvider connectionProvider)
   at MongoDB.Driver.Operations.QueryOperation`1.Execute(IConnectionProvider connectionProvider)
   at System.Linq.Buffer`1..ctor(IEnumerable`1 source)
   at System.Linq.Enumerable.ToArray[TSource](IEnumerable`1 source)
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

Nested Exception

Exception: System.Net.Sockets.SocketException
Message: No connection could be made because the target machine actively refused it 127.0.0.1:27017
Source: System
   at System.Net.Sockets.Socket.DoConnect(EndPoint endPointSnapshot, SocketAddress socketAddress)
   at System.Net.Sockets.Socket.Connect(EndPoint remoteEP)
   at System.Net.Sockets.TcpClient.Connect(IPEndPoint remoteEP)
   at MongoDB.Driver.Internal.MongoConnection.Open()
   at MongoDB.Driver.Internal.MongoConnection.SendMessage(BsonBuffer buffer, Int32 requestId)
   at MongoDB.Driver.Internal.MongoConnection.SendMessage(MongoRequestMessage message)
   at MongoDB.Driver.Operations.CommandOperation`1.Execute(MongoConnection connection)
   at MongoDB.Driver.MongoServerInstance.Ping(MongoConnection connection)
   at MongoDB.Driver.MongoServerInstance.Connect()
   at MongoDB.Driver.Internal.DirectMongoServerProxy.Connect(TimeSpan timeout, ReadPreference readPreference)


 424 12:33:15 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

4424 12:33:15 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

6160 12:33:15 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: MongoDB.Driver.MongoConnectionException
Message: Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
Source: MongoDB.Driver
   at MongoDB.Driver.Internal.DirectMongoServerProxy.Connect(TimeSpan timeout, ReadPreference readPreference)
   at MongoDB.Driver.Internal.DirectMongoServerProxy.ChooseServerInstance(ReadPreference readPreference)
   at MongoDB.Driver.MongoServer.AcquireConnection(ReadPreference readPreference)
   at MongoDB.Driver.MongoCursor`1.MongoCursorConnectionProvider.AcquireConnection()
   at MongoDB.Driver.Operations.QueryOperation`1.GetFirstBatch(IConnectionProvider connectionProvider)
   at MongoDB.Driver.Operations.QueryOperation`1.Execute(IConnectionProvider connectionProvider)
   at System.Linq.Enumerable.FirstOrDefault[TSource](IEnumerable`1 source)
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

Nested Exception

Exception: System.Net.Sockets.SocketException
Message: No connection could be made because the target machine actively refused it 127.0.0.1:27017
Source: System
   at System.Net.Sockets.Socket.DoConnect(EndPoint endPointSnapshot, SocketAddress socketAddress)
   at System.Net.Sockets.Socket.Connect(EndPoint remoteEP)
   at System.Net.Sockets.TcpClient.Connect(IPEndPoint remoteEP)
   at MongoDB.Driver.Internal.MongoConnection.Open()
   at MongoDB.Driver.Internal.MongoConnection.SendMessage(BsonBuffer buffer, Int32 requestId)
   at MongoDB.Driver.Internal.MongoConnection.SendMessage(MongoRequestMessage message)
   at MongoDB.Driver.Operations.CommandOperation`1.Execute(MongoConnection connection)
   at MongoDB.Driver.MongoServerInstance.Ping(MongoConnection connection)
   at MongoDB.Driver.MongoServerInstance.Connect()
   at MongoDB.Driver.Internal.DirectMongoServerProxy.Connect(TimeSpan timeout, ReadPreference readPreference)


ManagedPoolThread #8 12:33:15 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #8 12:33:15 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
ManagedPoolThread #15 12:33:16 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
7520 12:33:17 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
7520 12:33:17 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.HandleDatabaseException(ExceptionBehavior exceptionBehavior, Exception ex)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

Nested Exception

Exception: MongoDB.Driver.MongoConnectionException
Message: Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
Source: MongoDB.Driver
   at MongoDB.Driver.Internal.DirectMongoServerProxy.Connect(TimeSpan timeout, ReadPreference readPreference)
   at MongoDB.Driver.Internal.DirectMongoServerProxy.ChooseServerInstance(ReadPreference readPreference)
   at MongoDB.Driver.MongoServer.AcquireConnection(ReadPreference readPreference)
   at MongoDB.Driver.MongoCollection.RunCommandAs[TCommandResult](IMongoCommand command, ReadPreference readPreference, IBsonSerializer resultSerializer, IBsonSerializationOptions resultSerializationOptions)
   at MongoDB.Driver.MongoCollection.RunCommandAs[TCommandResult](IMongoCommand command, ReadPreference readPreference)
   at MongoDB.Driver.MongoCollection.FindAndModify(FindAndModifyArgs args)
   at MongoDB.Driver.MongoCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.<>c__DisplayClass2c.<FindAndModify>b__2b()
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)

Nested Exception

Exception: System.Net.Sockets.SocketException
Message: No connection could be made because the target machine actively refused it 127.0.0.1:27017
Source: System
   at System.Net.Sockets.Socket.DoConnect(EndPoint endPointSnapshot, SocketAddress socketAddress)
   at System.Net.Sockets.Socket.Connect(EndPoint remoteEP)
   at System.Net.Sockets.TcpClient.Connect(IPEndPoint remoteEP)
   at MongoDB.Driver.Internal.MongoConnection.Open()
   at MongoDB.Driver.Internal.MongoConnection.SendMessage(BsonBuffer buffer, Int32 requestId)
   at MongoDB.Driver.Internal.MongoConnection.SendMessage(MongoRequestMessage message)
   at MongoDB.Driver.Operations.CommandOperation`1.Execute(MongoConnection connection)
   at MongoDB.Driver.MongoServerInstance.Ping(MongoConnection connection)
   at MongoDB.Driver.MongoServerInstance.Connect()
   at MongoDB.Driver.Internal.DirectMongoServerProxy.Connect(TimeSpan timeout, ReadPreference readPreference)



3600 12:33:17 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #12 12:33:18 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #10 12:33:19 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #7 12:33:20 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
2472 12:33:20 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #18 12:33:21 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
5296 12:33:24 INFO  [Experience Analytics]: Reduce agent found zero sites to process
ManagedPoolThread #4 12:33:25 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #4 12:33:25 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
9120 12:33:29 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

 424 12:33:30 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

4424 12:33:30 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

6160 12:33:30 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

7520 12:33:32 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

3600 12:33:32 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

2472 12:33:35 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #8 12:33:35 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #8 12:33:35 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
9120 12:33:44 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

 424 12:33:45 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

4424 12:33:45 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

6160 12:33:45 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #4 12:33:45 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #4 12:33:45 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
7520 12:33:47 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

3600 12:33:47 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

2472 12:33:50 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Core.BackgroundService.Run()

5296 12:33:54 INFO  [Experience Analytics]: Reduce agent found zero sites to process
ManagedPoolThread #8 12:33:55 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #8 12:33:55 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
9120 12:33:59 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

 424 12:34:00 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

4424 12:34:00 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

6160 12:34:00 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

7520 12:34:02 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

3600 12:34:02 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

2472 12:34:05 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #9 12:34:05 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #9 12:34:05 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
ManagedPoolThread #11 12:34:14 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
 424 12:34:15 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

4424 12:34:15 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

6160 12:34:15 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #0 12:34:15 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #1 12:34:15 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #0 12:34:15 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
ManagedPoolThread #3 12:34:16 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
7520 12:34:17 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

3600 12:34:17 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #14 12:34:17 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #13 12:34:18 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #16 12:34:20 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
2472 12:34:20 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #6 12:34:21 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #17 12:34:22 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #5 12:34:23 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #19 12:34:24 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
5296 12:34:24 INFO  [Experience Analytics]: Reduce agent found zero sites to process
9120 12:34:25 ERROR Exception when executing agent aggregation/automationAggregator
Exception: MongoDB.Driver.MongoConnectionException
Message: Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
Source: MongoDB.Driver
   at MongoDB.Driver.Internal.DirectMongoServerProxy.Connect(TimeSpan timeout, ReadPreference readPreference)
   at MongoDB.Driver.Internal.DirectMongoServerProxy.ChooseServerInstance(ReadPreference readPreference)
   at MongoDB.Driver.MongoServer.AcquireConnection(ReadPreference readPreference)
   at MongoDB.Driver.MongoCursor`1.MongoCursorConnectionProvider.AcquireConnection()
   at MongoDB.Driver.Operations.QueryOperation`1.GetFirstBatch(IConnectionProvider connectionProvider)
   at MongoDB.Driver.Operations.QueryOperation`1.Execute(IConnectionProvider connectionProvider)
   at System.Linq.Buffer`1..ctor(IEnumerable`1 source)
   at System.Linq.Enumerable.ToArray[TSource](IEnumerable`1 source)
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

Nested Exception

Exception: System.Net.Sockets.SocketException
Message: No connection could be made because the target machine actively refused it 127.0.0.1:27017
Source: System
   at System.Net.Sockets.Socket.DoConnect(EndPoint endPointSnapshot, SocketAddress socketAddress)
   at System.Net.Sockets.Socket.Connect(EndPoint remoteEP)
   at System.Net.Sockets.TcpClient.Connect(IPEndPoint remoteEP)
   at MongoDB.Driver.Internal.MongoConnection.Open()
   at MongoDB.Driver.Internal.MongoConnection.SendMessage(BsonBuffer buffer, Int32 requestId)
   at MongoDB.Driver.Internal.MongoConnection.SendMessage(MongoRequestMessage message)
   at MongoDB.Driver.Operations.CommandOperation`1.Execute(MongoConnection connection)
   at MongoDB.Driver.MongoServerInstance.Ping(MongoConnection connection)
   at MongoDB.Driver.MongoServerInstance.Connect()
   at MongoDB.Driver.Internal.DirectMongoServerProxy.Connect(TimeSpan timeout, ReadPreference readPreference)


ManagedPoolThread #9 12:34:25 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #9 12:34:25 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
7092 12:34:26 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #15 12:34:27 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #7 12:34:28 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #18 12:34:29 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
 424 12:34:30 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

4424 12:34:30 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #12 12:34:30 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
6160 12:34:30 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

7520 12:34:32 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

3600 12:34:32 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

2472 12:34:35 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #0 12:34:36 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #0 12:34:36 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
9120 12:34:40 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

 424 12:34:45 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

4424 12:34:45 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

6160 12:34:45 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #9 12:34:46 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #9 12:34:46 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
7520 12:34:47 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

3600 12:34:47 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

Heartbeat 12:34:49 ERROR MongoDbDictionary.Store() has failed.
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Save(Object value)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbDictionary.Store(Object value)

2472 12:34:50 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Core.BackgroundService.Run()

5296 12:34:54 INFO  [Experience Analytics]: Reduce agent found zero sites to process
9120 12:34:55 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #4 12:34:56 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #4 12:34:56 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
 424 12:35:00 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

4424 12:35:00 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

6160 12:35:00 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

7520 12:35:02 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

3600 12:35:02 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

2472 12:35:05 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #0 12:35:06 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #0 12:35:06 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
9120 12:35:10 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

 424 12:35:15 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

4424 12:35:15 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

6160 12:35:15 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #9 12:35:16 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #9 12:35:16 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
7520 12:35:17 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

3600 12:35:17 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

2472 12:35:20 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Core.BackgroundService.Run()

5296 12:35:24 INFO  [Experience Analytics]: Reduce agent found zero sites to process
9120 12:35:25 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #8 12:35:26 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #8 12:35:26 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
7092 12:35:28 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #2 12:35:29 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #13 12:35:30 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
 424 12:35:30 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

4424 12:35:30 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

6160 12:35:30 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #14 12:35:31 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #3 12:35:32 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
3600 12:35:32 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #1 12:35:33 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #17 12:35:34 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #6 12:35:35 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
2472 12:35:35 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #4 12:35:36 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #4 12:35:36 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
ManagedPoolThread #5 12:35:36 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #11 12:35:37 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #16 12:35:38 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #19 12:35:39 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
9120 12:35:40 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #15 12:35:40 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #7 12:35:41 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #10 12:35:42 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #12 12:35:43 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
7520 12:35:44 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
7520 12:35:44 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.HandleDatabaseException(ExceptionBehavior exceptionBehavior, Exception ex)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

Nested Exception

Exception: MongoDB.Driver.MongoConnectionException
Message: Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
Source: MongoDB.Driver
   at MongoDB.Driver.Internal.DirectMongoServerProxy.Connect(TimeSpan timeout, ReadPreference readPreference)
   at MongoDB.Driver.Internal.DirectMongoServerProxy.ChooseServerInstance(ReadPreference readPreference)
   at MongoDB.Driver.MongoServer.AcquireConnection(ReadPreference readPreference)
   at MongoDB.Driver.MongoCollection.RunCommandAs[TCommandResult](IMongoCommand command, ReadPreference readPreference, IBsonSerializer resultSerializer, IBsonSerializationOptions resultSerializationOptions)
   at MongoDB.Driver.MongoCollection.RunCommandAs[TCommandResult](IMongoCommand command, ReadPreference readPreference)
   at MongoDB.Driver.MongoCollection.FindAndModify(FindAndModifyArgs args)
   at MongoDB.Driver.MongoCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.<>c__DisplayClass2c.<FindAndModify>b__2b()
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)

Nested Exception

Exception: System.Net.Sockets.SocketException
Message: No connection could be made because the target machine actively refused it 127.0.0.1:27017
Source: System
   at System.Net.Sockets.Socket.DoConnect(EndPoint endPointSnapshot, SocketAddress socketAddress)
   at System.Net.Sockets.Socket.Connect(EndPoint remoteEP)
   at System.Net.Sockets.TcpClient.Connect(IPEndPoint remoteEP)
   at MongoDB.Driver.Internal.MongoConnection.Open()
   at MongoDB.Driver.Internal.MongoConnection.SendMessage(BsonBuffer buffer, Int32 requestId)
   at MongoDB.Driver.Internal.MongoConnection.SendMessage(MongoRequestMessage message)
   at MongoDB.Driver.Operations.CommandOperation`1.Execute(MongoConnection connection)
   at MongoDB.Driver.MongoServerInstance.Ping(MongoConnection connection)
   at MongoDB.Driver.MongoServerInstance.Connect()
   at MongoDB.Driver.Internal.DirectMongoServerProxy.Connect(TimeSpan timeout, ReadPreference readPreference)



 424 12:35:45 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

4424 12:35:45 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

6160 12:35:45 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #18 12:35:45 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #8 12:35:46 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #8 12:35:46 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
3600 12:35:47 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

2472 12:35:50 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Core.BackgroundService.Run()

5296 12:35:54 INFO  [Experience Analytics]: Reduce agent found zero sites to process
9120 12:35:55 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #4 12:35:56 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #4 12:35:56 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
7520 12:35:59 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

 424 12:36:00 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

4424 12:36:00 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

6160 12:36:00 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

3600 12:36:02 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

2472 12:36:05 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #8 12:36:06 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #8 12:36:06 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
9120 12:36:10 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

7520 12:36:14 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

 424 12:36:15 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

4424 12:36:15 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

6160 12:36:15 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #9 12:36:16 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #9 12:36:16 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
3600 12:36:17 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

2472 12:36:20 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Core.BackgroundService.Run()

5056 12:36:23 INFO  [Path Analyzer](.) Running trail cleanup agent
5056 12:36:23 INFO  [Path Analyzer](.) Running trail cleanup on database
4088 12:36:23 WARN  [Path Analyzer](.) SmartMergeAgent.Execute() returns. No missing date ranges to merge.
5296 12:36:24 INFO  [Experience Analytics]: Reduce agent found zero sites to process
9120 12:36:25 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #8 12:36:26 INFO  Job started: Sitecore.Tasks.UrlAgent
ManagedPoolThread #8 12:36:26 INFO  Scheduling.UrlAgent started. Url: http://gathercontent.dev/sitecore/service/keepalive.aspx
ManagedPoolThread #8 12:36:26 INFO  Scheduling.UrlAgent done (received: 561 bytes)
ManagedPoolThread #8 12:36:26 INFO  Job ended: Sitecore.Tasks.UrlAgent (units processed: )
ManagedPoolThread #4 12:36:26 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #4 12:36:26 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
7520 12:36:29 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

 424 12:36:30 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

4424 12:36:30 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

6160 12:36:30 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

3600 12:36:32 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

2472 12:36:35 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #8 12:36:36 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #8 12:36:36 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
ManagedPoolThread #19 12:36:40 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #1 12:36:41 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #16 12:36:42 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #17 12:36:43 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #6 12:36:45 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
 424 12:36:45 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

4424 12:36:45 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

6160 12:36:45 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #5 12:36:46 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #9 12:36:46 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #9 12:36:46 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
ManagedPoolThread #11 12:36:47 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
3600 12:36:47 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #3 12:36:48 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #14 12:36:49 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #13 12:36:50 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
2472 12:36:50 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Core.BackgroundService.Run()

Heartbeat 12:36:50 ERROR MongoDbDictionary.Store() has failed.
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Save(Object value)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbDictionary.Store(Object value)

9120 12:36:51 ERROR Exception when executing agent aggregation/automationAggregator
Exception: MongoDB.Driver.MongoConnectionException
Message: Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
Source: MongoDB.Driver
   at MongoDB.Driver.Internal.DirectMongoServerProxy.Connect(TimeSpan timeout, ReadPreference readPreference)
   at MongoDB.Driver.Internal.DirectMongoServerProxy.ChooseServerInstance(ReadPreference readPreference)
   at MongoDB.Driver.MongoServer.AcquireConnection(ReadPreference readPreference)
   at MongoDB.Driver.MongoCursor`1.MongoCursorConnectionProvider.AcquireConnection()
   at MongoDB.Driver.Operations.QueryOperation`1.GetFirstBatch(IConnectionProvider connectionProvider)
   at MongoDB.Driver.Operations.QueryOperation`1.Execute(IConnectionProvider connectionProvider)
   at System.Linq.Buffer`1..ctor(IEnumerable`1 source)
   at System.Linq.Enumerable.ToArray[TSource](IEnumerable`1 source)
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

Nested Exception

Exception: System.Net.Sockets.SocketException
Message: No connection could be made because the target machine actively refused it 127.0.0.1:27017
Source: System
   at System.Net.Sockets.Socket.DoConnect(EndPoint endPointSnapshot, SocketAddress socketAddress)
   at System.Net.Sockets.Socket.Connect(EndPoint remoteEP)
   at System.Net.Sockets.TcpClient.Connect(IPEndPoint remoteEP)
   at MongoDB.Driver.Internal.MongoConnection.Open()
   at MongoDB.Driver.Internal.MongoConnection.SendMessage(BsonBuffer buffer, Int32 requestId)
   at MongoDB.Driver.Internal.MongoConnection.SendMessage(MongoRequestMessage message)
   at MongoDB.Driver.Operations.CommandOperation`1.Execute(MongoConnection connection)
   at MongoDB.Driver.MongoServerInstance.Ping(MongoConnection connection)
   at MongoDB.Driver.MongoServerInstance.Connect()
   at MongoDB.Driver.Internal.DirectMongoServerProxy.Connect(TimeSpan timeout, ReadPreference readPreference)


ManagedPoolThread #15 12:36:52 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
7520 12:36:53 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
7520 12:36:53 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.HandleDatabaseException(ExceptionBehavior exceptionBehavior, Exception ex)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

Nested Exception

Exception: MongoDB.Driver.MongoConnectionException
Message: Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
Source: MongoDB.Driver
   at MongoDB.Driver.Internal.DirectMongoServerProxy.Connect(TimeSpan timeout, ReadPreference readPreference)
   at MongoDB.Driver.Internal.DirectMongoServerProxy.ChooseServerInstance(ReadPreference readPreference)
   at MongoDB.Driver.MongoServer.AcquireConnection(ReadPreference readPreference)
   at MongoDB.Driver.MongoCollection.RunCommandAs[TCommandResult](IMongoCommand command, ReadPreference readPreference, IBsonSerializer resultSerializer, IBsonSerializationOptions resultSerializationOptions)
   at MongoDB.Driver.MongoCollection.RunCommandAs[TCommandResult](IMongoCommand command, ReadPreference readPreference)
   at MongoDB.Driver.MongoCollection.FindAndModify(FindAndModifyArgs args)
   at MongoDB.Driver.MongoCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.<>c__DisplayClass2c.<FindAndModify>b__2b()
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)

Nested Exception

Exception: System.Net.Sockets.SocketException
Message: No connection could be made because the target machine actively refused it 127.0.0.1:27017
Source: System
   at System.Net.Sockets.Socket.DoConnect(EndPoint endPointSnapshot, SocketAddress socketAddress)
   at System.Net.Sockets.Socket.Connect(EndPoint remoteEP)
   at System.Net.Sockets.TcpClient.Connect(IPEndPoint remoteEP)
   at MongoDB.Driver.Internal.MongoConnection.Open()
   at MongoDB.Driver.Internal.MongoConnection.SendMessage(BsonBuffer buffer, Int32 requestId)
   at MongoDB.Driver.Internal.MongoConnection.SendMessage(MongoRequestMessage message)
   at MongoDB.Driver.Operations.CommandOperation`1.Execute(MongoConnection connection)
   at MongoDB.Driver.MongoServerInstance.Ping(MongoConnection connection)
   at MongoDB.Driver.MongoServerInstance.Connect()
   at MongoDB.Driver.Internal.DirectMongoServerProxy.Connect(TimeSpan timeout, ReadPreference readPreference)



ManagedPoolThread #18 12:36:54 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
5296 12:36:54 INFO  [Experience Analytics]: Reduce agent found zero sites to process
ManagedPoolThread #7 12:36:55 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #10 12:36:56 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #8 12:36:56 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #8 12:36:56 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
ManagedPoolThread #12 12:36:57 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
 424 12:37:00 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

4424 12:37:00 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

6160 12:37:00 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

3600 12:37:02 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

2472 12:37:05 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Core.BackgroundService.Run()

9120 12:37:06 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #9 12:37:06 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #9 12:37:06 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
7520 12:37:08 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

 424 12:37:15 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

4424 12:37:15 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

6160 12:37:15 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #4 12:37:16 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #4 12:37:16 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
3600 12:37:17 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

2472 12:37:20 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Core.BackgroundService.Run()

9120 12:37:21 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

7520 12:37:23 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

5296 12:37:24 INFO  [Experience Analytics]: Reduce agent found zero sites to process
ManagedPoolThread #0 12:37:26 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #0 12:37:26 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
 424 12:37:30 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

4424 12:37:30 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

6160 12:37:30 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

3600 12:37:32 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

2472 12:37:35 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Core.BackgroundService.Run()

9120 12:37:36 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #4 12:37:36 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #4 12:37:36 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
7520 12:37:38 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

 424 12:37:45 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

4424 12:37:45 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

6160 12:37:45 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #0 12:37:46 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #0 12:37:46 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
3600 12:37:47 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

2472 12:37:51 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: MongoDB.Driver.MongoConnectionException
Message: Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
Source: MongoDB.Driver
   at MongoDB.Driver.Internal.DirectMongoServerProxy.Connect(TimeSpan timeout, ReadPreference readPreference)
   at MongoDB.Driver.Internal.DirectMongoServerProxy.ChooseServerInstance(ReadPreference readPreference)
   at MongoDB.Driver.MongoServer.AcquireConnection(ReadPreference readPreference)
   at MongoDB.Driver.MongoCursor`1.MongoCursorConnectionProvider.AcquireConnection()
   at MongoDB.Driver.Operations.QueryOperation`1.GetFirstBatch(IConnectionProvider connectionProvider)
   at MongoDB.Driver.Operations.QueryOperation`1.Execute(IConnectionProvider connectionProvider)
   at System.Linq.Enumerable.FirstOrDefault[TSource](IEnumerable`1 source)
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Core.BackgroundService.Run()

Nested Exception

Exception: System.Net.Sockets.SocketException
Message: No connection could be made because the target machine actively refused it 127.0.0.1:27017
Source: System
   at System.Net.Sockets.Socket.DoConnect(EndPoint endPointSnapshot, SocketAddress socketAddress)
   at System.Net.Sockets.Socket.Connect(EndPoint remoteEP)
   at System.Net.Sockets.TcpClient.Connect(IPEndPoint remoteEP)
   at MongoDB.Driver.Internal.MongoConnection.Open()
   at MongoDB.Driver.Internal.MongoConnection.SendMessage(BsonBuffer buffer, Int32 requestId)
   at MongoDB.Driver.Internal.MongoConnection.SendMessage(MongoRequestMessage message)
   at MongoDB.Driver.Operations.CommandOperation`1.Execute(MongoConnection connection)
   at MongoDB.Driver.MongoServerInstance.Ping(MongoConnection connection)
   at MongoDB.Driver.MongoServerInstance.Connect()
   at MongoDB.Driver.Internal.DirectMongoServerProxy.Connect(TimeSpan timeout, ReadPreference readPreference)


ManagedPoolThread #1 12:37:52 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
7520 12:37:53 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #19 12:37:53 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #6 12:37:54 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
5296 12:37:54 INFO  [Experience Analytics]: Reduce agent found zero sites to process
ManagedPoolThread #17 12:37:55 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #9 12:37:56 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #9 12:37:56 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
ManagedPoolThread #16 12:37:56 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #11 12:37:57 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #5 12:37:58 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #3 12:37:59 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
 424 12:38:00 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

4424 12:38:00 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

6160 12:38:00 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #13 12:38:00 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #14 12:38:01 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
3600 12:38:02 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

Heartbeat 12:38:02 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
9120 12:38:03 ERROR Exception when executing agent aggregation/automationAggregator
Exception: MongoDB.Driver.MongoConnectionException
Message: Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
Source: MongoDB.Driver
   at MongoDB.Driver.Internal.DirectMongoServerProxy.Connect(TimeSpan timeout, ReadPreference readPreference)
   at MongoDB.Driver.Internal.DirectMongoServerProxy.ChooseServerInstance(ReadPreference readPreference)
   at MongoDB.Driver.MongoServer.AcquireConnection(ReadPreference readPreference)
   at MongoDB.Driver.MongoCursor`1.MongoCursorConnectionProvider.AcquireConnection()
   at MongoDB.Driver.Operations.QueryOperation`1.GetFirstBatch(IConnectionProvider connectionProvider)
   at MongoDB.Driver.Operations.QueryOperation`1.Execute(IConnectionProvider connectionProvider)
   at System.Linq.Buffer`1..ctor(IEnumerable`1 source)
   at System.Linq.Enumerable.ToArray[TSource](IEnumerable`1 source)
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

Nested Exception

Exception: System.Net.Sockets.SocketException
Message: No connection could be made because the target machine actively refused it 127.0.0.1:27017
Source: System
   at System.Net.Sockets.Socket.DoConnect(EndPoint endPointSnapshot, SocketAddress socketAddress)
   at System.Net.Sockets.Socket.Connect(EndPoint remoteEP)
   at System.Net.Sockets.TcpClient.Connect(IPEndPoint remoteEP)
   at MongoDB.Driver.Internal.MongoConnection.Open()
   at MongoDB.Driver.Internal.MongoConnection.SendMessage(BsonBuffer buffer, Int32 requestId)
   at MongoDB.Driver.Internal.MongoConnection.SendMessage(MongoRequestMessage message)
   at MongoDB.Driver.Operations.CommandOperation`1.Execute(MongoConnection connection)
   at MongoDB.Driver.MongoServerInstance.Ping(MongoConnection connection)
   at MongoDB.Driver.MongoServerInstance.Connect()
   at MongoDB.Driver.Internal.DirectMongoServerProxy.Connect(TimeSpan timeout, ReadPreference readPreference)


ManagedPoolThread #15 12:38:04 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #10 12:38:05 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #8 12:38:06 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #8 12:38:06 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
2472 12:38:06 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #12 12:38:06 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #18 12:38:07 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
7520 12:38:08 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #7 12:38:08 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
 424 12:38:15 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

4424 12:38:15 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

6160 12:38:15 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #0 12:38:16 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #0 12:38:16 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
3600 12:38:17 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

9120 12:38:18 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

2472 12:38:21 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Core.BackgroundService.Run()

7520 12:38:23 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

5296 12:38:24 INFO  [Experience Analytics]: Reduce agent found zero sites to process
ManagedPoolThread #4 12:38:26 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #4 12:38:26 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
 424 12:38:30 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

4424 12:38:30 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

6160 12:38:30 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

3600 12:38:32 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

9120 12:38:33 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

2472 12:38:36 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #0 12:38:36 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #0 12:38:36 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
7520 12:38:38 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

 424 12:38:45 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

4424 12:38:45 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

6160 12:38:45 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #4 12:38:46 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #4 12:38:46 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
3600 12:38:47 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

9120 12:38:48 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

2472 12:38:51 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Core.BackgroundService.Run()

Heartbeat 12:38:52 ERROR MongoDbDictionary.Store() has failed.
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Save(Object value)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbDictionary.Store(Object value)

7520 12:38:53 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

5296 12:38:54 INFO  [Experience Analytics]: Reduce agent found zero sites to process
ManagedPoolThread #0 12:38:56 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #0 12:38:56 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
 424 12:39:00 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

4424 12:39:00 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

6160 12:39:00 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

3600 12:39:02 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #17 12:39:05 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #13 12:39:06 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
2472 12:39:06 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #4 12:39:06 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #4 12:39:06 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
ManagedPoolThread #1 12:39:07 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #5 12:39:08 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
7520 12:39:08 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #6 12:39:09 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #14 12:39:10 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #16 12:39:11 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #3 12:39:12 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #19 12:39:13 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #11 12:39:14 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
9120 12:39:15 ERROR Exception when executing agent aggregation/automationAggregator
Exception: MongoDB.Driver.MongoConnectionException
Message: Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
Source: MongoDB.Driver
   at MongoDB.Driver.Internal.DirectMongoServerProxy.Connect(TimeSpan timeout, ReadPreference readPreference)
   at MongoDB.Driver.Internal.DirectMongoServerProxy.ChooseServerInstance(ReadPreference readPreference)
   at MongoDB.Driver.MongoServer.AcquireConnection(ReadPreference readPreference)
   at MongoDB.Driver.MongoCursor`1.MongoCursorConnectionProvider.AcquireConnection()
   at MongoDB.Driver.Operations.QueryOperation`1.GetFirstBatch(IConnectionProvider connectionProvider)
   at MongoDB.Driver.Operations.QueryOperation`1.Execute(IConnectionProvider connectionProvider)
   at System.Linq.Buffer`1..ctor(IEnumerable`1 source)
   at System.Linq.Enumerable.ToArray[TSource](IEnumerable`1 source)
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

Nested Exception

Exception: System.Net.Sockets.SocketException
Message: No connection could be made because the target machine actively refused it 127.0.0.1:27017
Source: System
   at System.Net.Sockets.Socket.DoConnect(EndPoint endPointSnapshot, SocketAddress socketAddress)
   at System.Net.Sockets.Socket.Connect(EndPoint remoteEP)
   at System.Net.Sockets.TcpClient.Connect(IPEndPoint remoteEP)
   at MongoDB.Driver.Internal.MongoConnection.Open()
   at MongoDB.Driver.Internal.MongoConnection.SendMessage(BsonBuffer buffer, Int32 requestId)
   at MongoDB.Driver.Internal.MongoConnection.SendMessage(MongoRequestMessage message)
   at MongoDB.Driver.Operations.CommandOperation`1.Execute(MongoConnection connection)
   at MongoDB.Driver.MongoServerInstance.Ping(MongoConnection connection)
   at MongoDB.Driver.MongoServerInstance.Connect()
   at MongoDB.Driver.Internal.DirectMongoServerProxy.Connect(TimeSpan timeout, ReadPreference readPreference)


 424 12:39:15 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

4424 12:39:15 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

6160 12:39:15 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #15 12:39:16 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #8 12:39:16 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #8 12:39:16 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
ManagedPoolThread #18 12:39:17 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
3600 12:39:17 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #7 12:39:18 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #10 12:39:19 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #12 12:39:20 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
2472 12:39:21 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Core.BackgroundService.Run()

7520 12:39:23 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

5296 12:39:24 INFO  [Experience Analytics]: Reduce agent found zero sites to process
ManagedPoolThread #9 12:39:26 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #9 12:39:26 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
9120 12:39:30 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

 424 12:39:30 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

4424 12:39:30 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

6160 12:39:30 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

3600 12:39:32 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

2472 12:39:36 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #8 12:39:36 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #8 12:39:36 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
7520 12:39:38 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

9120 12:39:45 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

 424 12:39:45 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

4424 12:39:45 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

6160 12:39:45 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #9 12:39:46 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #9 12:39:46 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
3600 12:39:47 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

2472 12:39:51 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Core.BackgroundService.Run()

7520 12:39:53 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

5296 12:39:54 INFO  [Experience Analytics]: Reduce agent found zero sites to process
ManagedPoolThread #8 12:39:56 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #8 12:39:56 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
9120 12:40:00 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

 424 12:40:00 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

4424 12:40:00 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

6160 12:40:00 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

3600 12:40:02 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

2472 12:40:06 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #9 12:40:06 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #9 12:40:06 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
7520 12:40:08 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #5 12:40:15 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #4 12:40:16 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #4 12:40:16 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
ManagedPoolThread #1 12:40:16 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
3600 12:40:17 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #13 12:40:17 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #17 12:40:18 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #14 12:40:19 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #6 12:40:20 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
2472 12:40:21 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #11 12:40:21 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #19 12:40:22 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #16 12:40:23 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #3 12:40:24 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
5296 12:40:24 INFO  [Experience Analytics]: Reduce agent found zero sites to process
9120 12:40:25 ERROR Exception when executing agent aggregation/automationAggregator
Exception: MongoDB.Driver.MongoConnectionException
Message: Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
Source: MongoDB.Driver
   at MongoDB.Driver.Internal.DirectMongoServerProxy.Connect(TimeSpan timeout, ReadPreference readPreference)
   at MongoDB.Driver.Internal.DirectMongoServerProxy.ChooseServerInstance(ReadPreference readPreference)
   at MongoDB.Driver.MongoServer.AcquireConnection(ReadPreference readPreference)
   at MongoDB.Driver.MongoCursor`1.MongoCursorConnectionProvider.AcquireConnection()
   at MongoDB.Driver.Operations.QueryOperation`1.GetFirstBatch(IConnectionProvider connectionProvider)
   at MongoDB.Driver.Operations.QueryOperation`1.Execute(IConnectionProvider connectionProvider)
   at System.Linq.Buffer`1..ctor(IEnumerable`1 source)
   at System.Linq.Enumerable.ToArray[TSource](IEnumerable`1 source)
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

Nested Exception

Exception: System.Net.Sockets.SocketException
Message: No connection could be made because the target machine actively refused it 127.0.0.1:27017
Source: System
   at System.Net.Sockets.Socket.DoConnect(EndPoint endPointSnapshot, SocketAddress socketAddress)
   at System.Net.Sockets.Socket.Connect(EndPoint remoteEP)
   at System.Net.Sockets.TcpClient.Connect(IPEndPoint remoteEP)
   at MongoDB.Driver.Internal.MongoConnection.Open()
   at MongoDB.Driver.Internal.MongoConnection.SendMessage(BsonBuffer buffer, Int32 requestId)
   at MongoDB.Driver.Internal.MongoConnection.SendMessage(MongoRequestMessage message)
   at MongoDB.Driver.Operations.CommandOperation`1.Execute(MongoConnection connection)
   at MongoDB.Driver.MongoServerInstance.Ping(MongoConnection connection)
   at MongoDB.Driver.MongoServerInstance.Connect()
   at MongoDB.Driver.Internal.DirectMongoServerProxy.Connect(TimeSpan timeout, ReadPreference readPreference)


ManagedPoolThread #0 12:40:26 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #0 12:40:26 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
 424 12:40:26 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: MongoDB.Driver.MongoConnectionException
Message: Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
Source: MongoDB.Driver
   at MongoDB.Driver.Internal.DirectMongoServerProxy.Connect(TimeSpan timeout, ReadPreference readPreference)
   at MongoDB.Driver.Internal.DirectMongoServerProxy.ChooseServerInstance(ReadPreference readPreference)
   at MongoDB.Driver.MongoServer.AcquireConnection(ReadPreference readPreference)
   at MongoDB.Driver.MongoCursor`1.MongoCursorConnectionProvider.AcquireConnection()
   at MongoDB.Driver.Operations.QueryOperation`1.GetFirstBatch(IConnectionProvider connectionProvider)
   at MongoDB.Driver.Operations.QueryOperation`1.Execute(IConnectionProvider connectionProvider)
   at System.Linq.Enumerable.FirstOrDefault[TSource](IEnumerable`1 source)
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

Nested Exception

Exception: System.Net.Sockets.SocketException
Message: No connection could be made because the target machine actively refused it 127.0.0.1:27017
Source: System
   at System.Net.Sockets.Socket.DoConnect(EndPoint endPointSnapshot, SocketAddress socketAddress)
   at System.Net.Sockets.Socket.Connect(EndPoint remoteEP)
   at System.Net.Sockets.TcpClient.Connect(IPEndPoint remoteEP)
   at MongoDB.Driver.Internal.MongoConnection.Open()
   at MongoDB.Driver.Internal.MongoConnection.SendMessage(BsonBuffer buffer, Int32 requestId)
   at MongoDB.Driver.Internal.MongoConnection.SendMessage(MongoRequestMessage message)
   at MongoDB.Driver.Operations.CommandOperation`1.Execute(MongoConnection connection)
   at MongoDB.Driver.MongoServerInstance.Ping(MongoConnection connection)
   at MongoDB.Driver.MongoServerInstance.Connect()
   at MongoDB.Driver.Internal.DirectMongoServerProxy.Connect(TimeSpan timeout, ReadPreference readPreference)


4424 12:40:27 ERROR Exception when executing agent aggregation/automationAggregator
Exception: MongoDB.Driver.MongoConnectionException
Message: Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
Source: MongoDB.Driver
   at MongoDB.Driver.Internal.DirectMongoServerProxy.Connect(TimeSpan timeout, ReadPreference readPreference)
   at MongoDB.Driver.Internal.DirectMongoServerProxy.ChooseServerInstance(ReadPreference readPreference)
   at MongoDB.Driver.MongoServer.AcquireConnection(ReadPreference readPreference)
   at MongoDB.Driver.MongoCursor`1.MongoCursorConnectionProvider.AcquireConnection()
   at MongoDB.Driver.Operations.QueryOperation`1.GetFirstBatch(IConnectionProvider connectionProvider)
   at MongoDB.Driver.Operations.QueryOperation`1.Execute(IConnectionProvider connectionProvider)
   at System.Linq.Buffer`1..ctor(IEnumerable`1 source)
   at System.Linq.Enumerable.ToArray[TSource](IEnumerable`1 source)
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

Nested Exception

Exception: System.Net.Sockets.SocketException
Message: No connection could be made because the target machine actively refused it 127.0.0.1:27017
Source: System
   at System.Net.Sockets.Socket.DoConnect(EndPoint endPointSnapshot, SocketAddress socketAddress)
   at System.Net.Sockets.Socket.Connect(EndPoint remoteEP)
   at System.Net.Sockets.TcpClient.Connect(IPEndPoint remoteEP)
   at MongoDB.Driver.Internal.MongoConnection.Open()
   at MongoDB.Driver.Internal.MongoConnection.SendMessage(BsonBuffer buffer, Int32 requestId)
   at MongoDB.Driver.Internal.MongoConnection.SendMessage(MongoRequestMessage message)
   at MongoDB.Driver.Operations.CommandOperation`1.Execute(MongoConnection connection)
   at MongoDB.Driver.MongoServerInstance.Ping(MongoConnection connection)
   at MongoDB.Driver.MongoServerInstance.Connect()
   at MongoDB.Driver.Internal.DirectMongoServerProxy.Connect(TimeSpan timeout, ReadPreference readPreference)


6160 12:40:28 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: MongoDB.Driver.MongoConnectionException
Message: Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
Source: MongoDB.Driver
   at MongoDB.Driver.Internal.DirectMongoServerProxy.Connect(TimeSpan timeout, ReadPreference readPreference)
   at MongoDB.Driver.Internal.DirectMongoServerProxy.ChooseServerInstance(ReadPreference readPreference)
   at MongoDB.Driver.MongoServer.AcquireConnection(ReadPreference readPreference)
   at MongoDB.Driver.MongoCursor`1.MongoCursorConnectionProvider.AcquireConnection()
   at MongoDB.Driver.Operations.QueryOperation`1.GetFirstBatch(IConnectionProvider connectionProvider)
   at MongoDB.Driver.Operations.QueryOperation`1.Execute(IConnectionProvider connectionProvider)
   at System.Linq.Enumerable.FirstOrDefault[TSource](IEnumerable`1 source)
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

Nested Exception

Exception: System.Net.Sockets.SocketException
Message: No connection could be made because the target machine actively refused it 127.0.0.1:27017
Source: System
   at System.Net.Sockets.Socket.DoConnect(EndPoint endPointSnapshot, SocketAddress socketAddress)
   at System.Net.Sockets.Socket.Connect(EndPoint remoteEP)
   at System.Net.Sockets.TcpClient.Connect(IPEndPoint remoteEP)
   at MongoDB.Driver.Internal.MongoConnection.Open()
   at MongoDB.Driver.Internal.MongoConnection.SendMessage(BsonBuffer buffer, Int32 requestId)
   at MongoDB.Driver.Internal.MongoConnection.SendMessage(MongoRequestMessage message)
   at MongoDB.Driver.Operations.CommandOperation`1.Execute(MongoConnection connection)
   at MongoDB.Driver.MongoServerInstance.Ping(MongoConnection connection)
   at MongoDB.Driver.MongoServerInstance.Connect()
   at MongoDB.Driver.Internal.DirectMongoServerProxy.Connect(TimeSpan timeout, ReadPreference readPreference)


7740 12:40:29 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #15 12:40:30 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #10 12:40:31 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
3600 12:40:32 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #12 12:40:32 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
7520 12:40:33 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
7520 12:40:33 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.HandleDatabaseException(ExceptionBehavior exceptionBehavior, Exception ex)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

Nested Exception

Exception: MongoDB.Driver.MongoConnectionException
Message: Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
Source: MongoDB.Driver
   at MongoDB.Driver.Internal.DirectMongoServerProxy.Connect(TimeSpan timeout, ReadPreference readPreference)
   at MongoDB.Driver.Internal.DirectMongoServerProxy.ChooseServerInstance(ReadPreference readPreference)
   at MongoDB.Driver.MongoServer.AcquireConnection(ReadPreference readPreference)
   at MongoDB.Driver.MongoCollection.RunCommandAs[TCommandResult](IMongoCommand command, ReadPreference readPreference, IBsonSerializer resultSerializer, IBsonSerializationOptions resultSerializationOptions)
   at MongoDB.Driver.MongoCollection.RunCommandAs[TCommandResult](IMongoCommand command, ReadPreference readPreference)
   at MongoDB.Driver.MongoCollection.FindAndModify(FindAndModifyArgs args)
   at MongoDB.Driver.MongoCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.<>c__DisplayClass2c.<FindAndModify>b__2b()
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)

Nested Exception

Exception: System.Net.Sockets.SocketException
Message: No connection could be made because the target machine actively refused it 127.0.0.1:27017
Source: System
   at System.Net.Sockets.Socket.DoConnect(EndPoint endPointSnapshot, SocketAddress socketAddress)
   at System.Net.Sockets.Socket.Connect(EndPoint remoteEP)
   at System.Net.Sockets.TcpClient.Connect(IPEndPoint remoteEP)
   at MongoDB.Driver.Internal.MongoConnection.Open()
   at MongoDB.Driver.Internal.MongoConnection.SendMessage(BsonBuffer buffer, Int32 requestId)
   at MongoDB.Driver.Internal.MongoConnection.SendMessage(MongoRequestMessage message)
   at MongoDB.Driver.Operations.CommandOperation`1.Execute(MongoConnection connection)
   at MongoDB.Driver.MongoServerInstance.Ping(MongoConnection connection)
   at MongoDB.Driver.MongoServerInstance.Connect()
   at MongoDB.Driver.Internal.DirectMongoServerProxy.Connect(TimeSpan timeout, ReadPreference readPreference)



ManagedPoolThread #18 12:40:34 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #7 12:40:35 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
2472 12:40:36 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #4 12:40:36 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #4 12:40:36 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
9120 12:40:40 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

 424 12:40:41 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

4424 12:40:42 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

6160 12:40:43 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #0 12:40:46 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #0 12:40:46 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
3600 12:40:47 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

7520 12:40:48 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

2472 12:40:51 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Core.BackgroundService.Run()

Heartbeat 12:40:53 ERROR MongoDbDictionary.Store() has failed.
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Save(Object value)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbDictionary.Store(Object value)

5296 12:40:54 INFO  [Experience Analytics]: Reduce agent found zero sites to process
9120 12:40:55 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #9 12:40:56 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #9 12:40:56 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
 424 12:40:56 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

4424 12:40:57 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

6160 12:40:58 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

3600 12:41:02 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

7520 12:41:03 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

2472 12:41:06 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #8 12:41:06 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #8 12:41:06 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
9120 12:41:10 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

 424 12:41:11 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

4424 12:41:12 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

6160 12:41:13 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #0 12:41:16 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #0 12:41:16 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
3600 12:41:17 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

7520 12:41:18 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

2472 12:41:21 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Core.BackgroundService.Run()

Heartbeat 12:41:22 INFO  Health.PrivateBytes: 782,258,176
Heartbeat 12:41:22 INFO  Health.CacheInstances: 115
Heartbeat 12:41:22 INFO  Health.CacheTotalCount: 18,100
Heartbeat 12:41:22 INFO  Health.CacheTotalSize: 75,523,756
5056 12:41:23 INFO  [Path Analyzer](.) Running trail cleanup agent
5056 12:41:23 INFO  [Path Analyzer](.) Running trail cleanup on database
5296 12:41:24 INFO  [Experience Analytics]: Reduce agent found zero sites to process
9120 12:41:25 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #4 12:41:26 INFO  Job started: Sitecore.Tasks.TaskDatabaseAgent
ManagedPoolThread #4 12:41:26 INFO  Processing tasks (count: 0)
ManagedPoolThread #4 12:41:26 INFO  Job ended: Sitecore.Tasks.TaskDatabaseAgent (units processed: )
ManagedPoolThread #9 12:41:26 INFO  Job started: Core_Database_Agent
ManagedPoolThread #9 12:41:26 INFO  Scheduling.DatabaseAgent started. Database: core
ManagedPoolThread #9 12:41:26 INFO  Examining schedules (count: 0)
ManagedPoolThread #9 12:41:26 INFO  Job ended: Core_Database_Agent (units processed: )
ManagedPoolThread #0 12:41:26 INFO  Job started: Master_Database_Agent
ManagedPoolThread #0 12:41:26 INFO  Scheduling.DatabaseAgent started. Database: master
ManagedPoolThread #0 12:41:26 INFO  Examining schedules (count: 5)
ManagedPoolThread #0 12:41:26 INFO  Starting: __Task Schedule
ManagedPoolThread #0 12:41:26 INFO  Ended: __Task Schedule
ManagedPoolThread #0 12:41:26 INFO  Not due: Calculate Statistical Relevancy
ManagedPoolThread #0 12:41:26 INFO  Not due: Rebuild Suggested Tests Index
ManagedPoolThread #0 12:41:26 INFO  Not due: Suspend Corrupted Tests
ManagedPoolThread #0 12:41:26 INFO  Not due: Try Finish Test
ManagedPoolThread #0 12:41:26 INFO  Job ended: Master_Database_Agent (units processed: 5)
ManagedPoolThread #8 12:41:26 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #8 12:41:26 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
 424 12:41:26 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

4424 12:41:27 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

6160 12:41:28 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

7740 12:41:30 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #16 12:41:31 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
3600 12:41:32 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #3 12:41:32 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
7520 12:41:33 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #19 12:41:34 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #11 12:41:35 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #6 12:41:36 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
2472 12:41:36 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #9 12:41:36 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #9 12:41:36 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
ManagedPoolThread #14 12:41:37 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #17 12:41:38 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #1 12:41:39 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #5 12:41:40 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
9120 12:41:40 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #13 12:41:41 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
 424 12:41:41 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #15 12:41:42 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
4424 12:41:42 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #18 12:41:43 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
6160 12:41:43 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #7 12:41:44 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #10 12:41:45 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #12 12:41:46 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #0 12:41:46 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #0 12:41:46 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
3600 12:41:47 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

7520 12:41:48 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

2472 12:41:51 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Core.BackgroundService.Run()

5296 12:41:54 INFO  [Experience Analytics]: Reduce agent found zero sites to process
9120 12:41:55 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #9 12:41:56 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #9 12:41:56 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
 424 12:41:56 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

4424 12:41:57 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

6160 12:41:58 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

3600 12:42:02 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

7520 12:42:03 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

2472 12:42:06 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #0 12:42:06 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #0 12:42:06 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
9120 12:42:10 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

 424 12:42:11 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

4424 12:42:12 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

6160 12:42:13 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #4 12:42:16 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #4 12:42:16 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
3600 12:42:17 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

7520 12:42:18 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

2472 12:42:21 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Core.BackgroundService.Run()

5296 12:42:24 INFO  [Experience Analytics]: Reduce agent found zero sites to process
9120 12:42:25 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #8 12:42:26 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #8 12:42:26 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
 424 12:42:26 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

4424 12:42:27 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

6160 12:42:28 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

3600 12:42:32 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

7520 12:42:33 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

2472 12:42:36 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #4 12:42:36 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #4 12:42:36 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
9120 12:42:40 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #3 12:42:42 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
4424 12:42:42 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #19 12:42:43 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
6160 12:42:43 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #16 12:42:44 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #11 12:42:45 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #14 12:42:46 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #8 12:42:46 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #8 12:42:46 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
3600 12:42:47 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #6 12:42:47 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #17 12:42:48 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #1 12:42:49 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #5 12:42:50 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
2472 12:42:51 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #13 12:42:51 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
 424 12:42:52 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: MongoDB.Driver.MongoConnectionException
Message: Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
Source: MongoDB.Driver
   at MongoDB.Driver.Internal.DirectMongoServerProxy.Connect(TimeSpan timeout, ReadPreference readPreference)
   at MongoDB.Driver.Internal.DirectMongoServerProxy.ChooseServerInstance(ReadPreference readPreference)
   at MongoDB.Driver.MongoServer.AcquireConnection(ReadPreference readPreference)
   at MongoDB.Driver.MongoCursor`1.MongoCursorConnectionProvider.AcquireConnection()
   at MongoDB.Driver.Operations.QueryOperation`1.GetFirstBatch(IConnectionProvider connectionProvider)
   at MongoDB.Driver.Operations.QueryOperation`1.Execute(IConnectionProvider connectionProvider)
   at System.Linq.Enumerable.FirstOrDefault[TSource](IEnumerable`1 source)
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

Nested Exception

Exception: System.Net.Sockets.SocketException
Message: No connection could be made because the target machine actively refused it 127.0.0.1:27017
Source: System
   at System.Net.Sockets.Socket.DoConnect(EndPoint endPointSnapshot, SocketAddress socketAddress)
   at System.Net.Sockets.Socket.Connect(EndPoint remoteEP)
   at System.Net.Sockets.TcpClient.Connect(IPEndPoint remoteEP)
   at MongoDB.Driver.Internal.MongoConnection.Open()
   at MongoDB.Driver.Internal.MongoConnection.SendMessage(BsonBuffer buffer, Int32 requestId)
   at MongoDB.Driver.Internal.MongoConnection.SendMessage(MongoRequestMessage message)
   at MongoDB.Driver.Operations.CommandOperation`1.Execute(MongoConnection connection)
   at MongoDB.Driver.MongoServerInstance.Ping(MongoConnection connection)
   at MongoDB.Driver.MongoServerInstance.Connect()
   at MongoDB.Driver.Internal.DirectMongoServerProxy.Connect(TimeSpan timeout, ReadPreference readPreference)


ManagedPoolThread #15 12:42:53 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
Heartbeat 12:42:54 ERROR MongoDbDictionary.Store() has failed.
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Save(Object value)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbDictionary.Store(Object value)

ManagedPoolThread #10 12:42:54 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
5296 12:42:54 INFO  [Experience Analytics]: Reduce agent found zero sites to process
9120 12:42:55 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #12 12:42:55 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #4 12:42:56 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #4 12:42:56 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
7520 12:42:56 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
7520 12:42:56 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.HandleDatabaseException(ExceptionBehavior exceptionBehavior, Exception ex)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

Nested Exception

Exception: MongoDB.Driver.MongoConnectionException
Message: Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
Source: MongoDB.Driver
   at MongoDB.Driver.Internal.DirectMongoServerProxy.Connect(TimeSpan timeout, ReadPreference readPreference)
   at MongoDB.Driver.Internal.DirectMongoServerProxy.ChooseServerInstance(ReadPreference readPreference)
   at MongoDB.Driver.MongoServer.AcquireConnection(ReadPreference readPreference)
   at MongoDB.Driver.MongoCollection.RunCommandAs[TCommandResult](IMongoCommand command, ReadPreference readPreference, IBsonSerializer resultSerializer, IBsonSerializationOptions resultSerializationOptions)
   at MongoDB.Driver.MongoCollection.RunCommandAs[TCommandResult](IMongoCommand command, ReadPreference readPreference)
   at MongoDB.Driver.MongoCollection.FindAndModify(FindAndModifyArgs args)
   at MongoDB.Driver.MongoCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.<>c__DisplayClass2c.<FindAndModify>b__2b()
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)

Nested Exception

Exception: System.Net.Sockets.SocketException
Message: No connection could be made because the target machine actively refused it 127.0.0.1:27017
Source: System
   at System.Net.Sockets.Socket.DoConnect(EndPoint endPointSnapshot, SocketAddress socketAddress)
   at System.Net.Sockets.Socket.Connect(EndPoint remoteEP)
   at System.Net.Sockets.TcpClient.Connect(IPEndPoint remoteEP)
   at MongoDB.Driver.Internal.MongoConnection.Open()
   at MongoDB.Driver.Internal.MongoConnection.SendMessage(BsonBuffer buffer, Int32 requestId)
   at MongoDB.Driver.Internal.MongoConnection.SendMessage(MongoRequestMessage message)
   at MongoDB.Driver.Operations.CommandOperation`1.Execute(MongoConnection connection)
   at MongoDB.Driver.MongoServerInstance.Ping(MongoConnection connection)
   at MongoDB.Driver.MongoServerInstance.Connect()
   at MongoDB.Driver.Internal.DirectMongoServerProxy.Connect(TimeSpan timeout, ReadPreference readPreference)



4424 12:42:57 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #18 12:42:57 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
6160 12:42:58 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #7 12:42:58 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
3600 12:43:02 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

2472 12:43:06 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #8 12:43:06 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #8 12:43:06 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
 424 12:43:07 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

9120 12:43:10 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

7520 12:43:11 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

4424 12:43:12 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

6160 12:43:13 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #0 12:43:16 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #0 12:43:16 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
3600 12:43:17 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

2472 12:43:21 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Core.BackgroundService.Run()

 424 12:43:22 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

5296 12:43:24 INFO  [Experience Analytics]: Reduce agent found zero sites to process
9120 12:43:25 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #9 12:43:26 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #9 12:43:26 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
7520 12:43:26 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

4424 12:43:27 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

6160 12:43:28 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

3600 12:43:32 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

2472 12:43:36 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #0 12:43:36 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #0 12:43:36 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
 424 12:43:37 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

9120 12:43:40 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

7520 12:43:41 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

4424 12:43:42 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

6160 12:43:43 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #9 12:43:46 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #9 12:43:46 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
3600 12:43:47 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

2472 12:43:51 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #3 12:43:53 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #6 12:43:54 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
5296 12:43:54 INFO  [Experience Analytics]: Reduce agent found zero sites to process
ManagedPoolThread #14 12:43:55 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
9120 12:43:55 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #11 12:43:56 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #8 12:43:56 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
7520 12:43:56 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #8 12:43:56 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
ManagedPoolThread #17 12:43:57 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
4424 12:43:57 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #1 12:43:58 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
6160 12:43:58 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #19 12:43:59 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #16 12:44:00 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #5 12:44:01 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #13 12:44:02 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
3600 12:44:02 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

 424 12:44:03 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: MongoDB.Driver.MongoConnectionException
Message: Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
Source: MongoDB.Driver
   at MongoDB.Driver.Internal.DirectMongoServerProxy.Connect(TimeSpan timeout, ReadPreference readPreference)
   at MongoDB.Driver.Internal.DirectMongoServerProxy.ChooseServerInstance(ReadPreference readPreference)
   at MongoDB.Driver.MongoServer.AcquireConnection(ReadPreference readPreference)
   at MongoDB.Driver.MongoCursor`1.MongoCursorConnectionProvider.AcquireConnection()
   at MongoDB.Driver.Operations.QueryOperation`1.GetFirstBatch(IConnectionProvider connectionProvider)
   at MongoDB.Driver.Operations.QueryOperation`1.Execute(IConnectionProvider connectionProvider)
   at System.Linq.Enumerable.FirstOrDefault[TSource](IEnumerable`1 source)
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

Nested Exception

Exception: System.Net.Sockets.SocketException
Message: No connection could be made because the target machine actively refused it 127.0.0.1:27017
Source: System
   at System.Net.Sockets.Socket.DoConnect(EndPoint endPointSnapshot, SocketAddress socketAddress)
   at System.Net.Sockets.Socket.Connect(EndPoint remoteEP)
   at System.Net.Sockets.TcpClient.Connect(IPEndPoint remoteEP)
   at MongoDB.Driver.Internal.MongoConnection.Open()
   at MongoDB.Driver.Internal.MongoConnection.SendMessage(BsonBuffer buffer, Int32 requestId)
   at MongoDB.Driver.Internal.MongoConnection.SendMessage(MongoRequestMessage message)
   at MongoDB.Driver.Operations.CommandOperation`1.Execute(MongoConnection connection)
   at MongoDB.Driver.MongoServerInstance.Ping(MongoConnection connection)
   at MongoDB.Driver.MongoServerInstance.Connect()
   at MongoDB.Driver.Internal.DirectMongoServerProxy.Connect(TimeSpan timeout, ReadPreference readPreference)


ManagedPoolThread #15 12:44:04 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #18 12:44:05 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
2472 12:44:06 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #7 12:44:06 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #4 12:44:06 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #4 12:44:06 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
ManagedPoolThread #10 12:44:07 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
9120 12:44:10 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

7520 12:44:11 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

4424 12:44:12 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

6160 12:44:13 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #9 12:44:16 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #9 12:44:16 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
3600 12:44:17 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

 424 12:44:18 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

2472 12:44:21 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Core.BackgroundService.Run()

5296 12:44:24 INFO  [Experience Analytics]: Reduce agent found zero sites to process
9120 12:44:25 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

7520 12:44:26 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #0 12:44:27 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #0 12:44:27 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
4424 12:44:27 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

6160 12:44:28 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

3600 12:44:32 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

 424 12:44:33 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

2472 12:44:36 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #9 12:44:37 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #9 12:44:37 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
9120 12:44:40 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

7520 12:44:41 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

4424 12:44:42 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

6160 12:44:43 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #0 12:44:47 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #0 12:44:47 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
3600 12:44:47 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

 424 12:44:48 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

2472 12:44:51 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Core.BackgroundService.Run()

5296 12:44:54 INFO  [Experience Analytics]: Reduce agent found zero sites to process
Heartbeat 12:44:55 ERROR MongoDbDictionary.Store() has failed.
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Save(Object value)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbDictionary.Store(Object value)

9120 12:44:55 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

7520 12:44:56 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #9 12:44:57 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #9 12:44:57 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
4424 12:44:57 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

6160 12:44:58 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

3600 12:45:03 ERROR Exception when executing agent aggregation/automationAggregator
Exception: MongoDB.Driver.MongoConnectionException
Message: Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
Source: MongoDB.Driver
   at MongoDB.Driver.Internal.DirectMongoServerProxy.Connect(TimeSpan timeout, ReadPreference readPreference)
   at MongoDB.Driver.Internal.DirectMongoServerProxy.ChooseServerInstance(ReadPreference readPreference)
   at MongoDB.Driver.MongoServer.AcquireConnection(ReadPreference readPreference)
   at MongoDB.Driver.MongoCursor`1.MongoCursorConnectionProvider.AcquireConnection()
   at MongoDB.Driver.Operations.QueryOperation`1.GetFirstBatch(IConnectionProvider connectionProvider)
   at MongoDB.Driver.Operations.QueryOperation`1.Execute(IConnectionProvider connectionProvider)
   at System.Linq.Buffer`1..ctor(IEnumerable`1 source)
   at System.Linq.Enumerable.ToArray[TSource](IEnumerable`1 source)
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

Nested Exception

Exception: System.Net.Sockets.SocketException
Message: No connection could be made because the target machine actively refused it 127.0.0.1:27017
Source: System
   at System.Net.Sockets.Socket.DoConnect(EndPoint endPointSnapshot, SocketAddress socketAddress)
   at System.Net.Sockets.Socket.Connect(EndPoint remoteEP)
   at System.Net.Sockets.TcpClient.Connect(IPEndPoint remoteEP)
   at MongoDB.Driver.Internal.MongoConnection.Open()
   at MongoDB.Driver.Internal.MongoConnection.SendMessage(BsonBuffer buffer, Int32 requestId)
   at MongoDB.Driver.Internal.MongoConnection.SendMessage(MongoRequestMessage message)
   at MongoDB.Driver.Operations.CommandOperation`1.Execute(MongoConnection connection)
   at MongoDB.Driver.MongoServerInstance.Ping(MongoConnection connection)
   at MongoDB.Driver.MongoServerInstance.Connect()
   at MongoDB.Driver.Internal.DirectMongoServerProxy.Connect(TimeSpan timeout, ReadPreference readPreference)


ManagedPoolThread #3 12:45:04 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #6 12:45:05 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
2472 12:45:06 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #14 12:45:06 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #0 12:45:07 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #0 12:45:07 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
ManagedPoolThread #11 12:45:07 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #17 12:45:08 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #16 12:45:09 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #1 12:45:10 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
9120 12:45:10 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #19 12:45:11 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #5 12:45:12 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
4424 12:45:12 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #13 12:45:13 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
6160 12:45:13 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

 424 12:45:14 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: MongoDB.Driver.MongoConnectionException
Message: Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
Source: MongoDB.Driver
   at MongoDB.Driver.Internal.DirectMongoServerProxy.Connect(TimeSpan timeout, ReadPreference readPreference)
   at MongoDB.Driver.Internal.DirectMongoServerProxy.ChooseServerInstance(ReadPreference readPreference)
   at MongoDB.Driver.MongoServer.AcquireConnection(ReadPreference readPreference)
   at MongoDB.Driver.MongoCursor`1.MongoCursorConnectionProvider.AcquireConnection()
   at MongoDB.Driver.Operations.QueryOperation`1.GetFirstBatch(IConnectionProvider connectionProvider)
   at MongoDB.Driver.Operations.QueryOperation`1.Execute(IConnectionProvider connectionProvider)
   at System.Linq.Enumerable.FirstOrDefault[TSource](IEnumerable`1 source)
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

Nested Exception

Exception: System.Net.Sockets.SocketException
Message: No connection could be made because the target machine actively refused it 127.0.0.1:27017
Source: System
   at System.Net.Sockets.Socket.DoConnect(EndPoint endPointSnapshot, SocketAddress socketAddress)
   at System.Net.Sockets.Socket.Connect(EndPoint remoteEP)
   at System.Net.Sockets.TcpClient.Connect(IPEndPoint remoteEP)
   at MongoDB.Driver.Internal.MongoConnection.Open()
   at MongoDB.Driver.Internal.MongoConnection.SendMessage(BsonBuffer buffer, Int32 requestId)
   at MongoDB.Driver.Internal.MongoConnection.SendMessage(MongoRequestMessage message)
   at MongoDB.Driver.Operations.CommandOperation`1.Execute(MongoConnection connection)
   at MongoDB.Driver.MongoServerInstance.Ping(MongoConnection connection)
   at MongoDB.Driver.MongoServerInstance.Connect()
   at MongoDB.Driver.Internal.DirectMongoServerProxy.Connect(TimeSpan timeout, ReadPreference readPreference)


ManagedPoolThread #15 12:45:15 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #18 12:45:16 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #4 12:45:17 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #4 12:45:17 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
ManagedPoolThread #12 12:45:17 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
3600 12:45:18 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #10 12:45:18 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
7520 12:45:19 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
7520 12:45:19 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.HandleDatabaseException(ExceptionBehavior exceptionBehavior, Exception ex)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

Nested Exception

Exception: MongoDB.Driver.MongoConnectionException
Message: Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
Source: MongoDB.Driver
   at MongoDB.Driver.Internal.DirectMongoServerProxy.Connect(TimeSpan timeout, ReadPreference readPreference)
   at MongoDB.Driver.Internal.DirectMongoServerProxy.ChooseServerInstance(ReadPreference readPreference)
   at MongoDB.Driver.MongoServer.AcquireConnection(ReadPreference readPreference)
   at MongoDB.Driver.MongoCollection.RunCommandAs[TCommandResult](IMongoCommand command, ReadPreference readPreference, IBsonSerializer resultSerializer, IBsonSerializationOptions resultSerializationOptions)
   at MongoDB.Driver.MongoCollection.RunCommandAs[TCommandResult](IMongoCommand command, ReadPreference readPreference)
   at MongoDB.Driver.MongoCollection.FindAndModify(FindAndModifyArgs args)
   at MongoDB.Driver.MongoCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.<>c__DisplayClass2c.<FindAndModify>b__2b()
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)

Nested Exception

Exception: System.Net.Sockets.SocketException
Message: No connection could be made because the target machine actively refused it 127.0.0.1:27017
Source: System
   at System.Net.Sockets.Socket.DoConnect(EndPoint endPointSnapshot, SocketAddress socketAddress)
   at System.Net.Sockets.Socket.Connect(EndPoint remoteEP)
   at System.Net.Sockets.TcpClient.Connect(IPEndPoint remoteEP)
   at MongoDB.Driver.Internal.MongoConnection.Open()
   at MongoDB.Driver.Internal.MongoConnection.SendMessage(BsonBuffer buffer, Int32 requestId)
   at MongoDB.Driver.Internal.MongoConnection.SendMessage(MongoRequestMessage message)
   at MongoDB.Driver.Operations.CommandOperation`1.Execute(MongoConnection connection)
   at MongoDB.Driver.MongoServerInstance.Ping(MongoConnection connection)
   at MongoDB.Driver.MongoServerInstance.Connect()
   at MongoDB.Driver.Internal.DirectMongoServerProxy.Connect(TimeSpan timeout, ReadPreference readPreference)



ManagedPoolThread #7 12:45:20 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
2472 12:45:21 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Core.BackgroundService.Run()

5296 12:45:24 INFO  [Experience Analytics]: Reduce agent found zero sites to process
9120 12:45:25 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #8 12:45:27 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #8 12:45:27 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
4424 12:45:27 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

6160 12:45:29 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

 424 12:45:29 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

3600 12:45:33 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

7520 12:45:34 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

2472 12:45:36 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #4 12:45:37 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #4 12:45:37 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
9120 12:45:40 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

4424 12:45:42 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

6160 12:45:44 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

 424 12:45:44 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #8 12:45:47 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #8 12:45:47 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
3600 12:45:48 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

7520 12:45:49 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

2472 12:45:51 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Core.BackgroundService.Run()

5296 12:45:54 INFO  [Experience Analytics]: Reduce agent found zero sites to process
9120 12:45:55 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #4 12:45:57 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #4 12:45:57 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
4424 12:45:57 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

6160 12:45:59 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

 424 12:45:59 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

3600 12:46:03 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

7520 12:46:04 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

2472 12:46:06 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #8 12:46:07 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #8 12:46:07 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
9120 12:46:10 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

4424 12:46:13 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

6160 12:46:15 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: MongoDB.Driver.MongoConnectionException
Message: Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
Source: MongoDB.Driver
   at MongoDB.Driver.Internal.DirectMongoServerProxy.Connect(TimeSpan timeout, ReadPreference readPreference)
   at MongoDB.Driver.Internal.DirectMongoServerProxy.ChooseServerInstance(ReadPreference readPreference)
   at MongoDB.Driver.MongoServer.AcquireConnection(ReadPreference readPreference)
   at MongoDB.Driver.MongoCursor`1.MongoCursorConnectionProvider.AcquireConnection()
   at MongoDB.Driver.Operations.QueryOperation`1.GetFirstBatch(IConnectionProvider connectionProvider)
   at MongoDB.Driver.Operations.QueryOperation`1.Execute(IConnectionProvider connectionProvider)
   at System.Linq.Enumerable.FirstOrDefault[TSource](IEnumerable`1 source)
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

Nested Exception

Exception: System.Net.Sockets.SocketException
Message: No connection could be made because the target machine actively refused it 127.0.0.1:27017
Source: System
   at System.Net.Sockets.Socket.DoConnect(EndPoint endPointSnapshot, SocketAddress socketAddress)
   at System.Net.Sockets.Socket.Connect(EndPoint remoteEP)
   at System.Net.Sockets.TcpClient.Connect(IPEndPoint remoteEP)
   at MongoDB.Driver.Internal.MongoConnection.Open()
   at MongoDB.Driver.Internal.MongoConnection.SendMessage(BsonBuffer buffer, Int32 requestId)
   at MongoDB.Driver.Internal.MongoConnection.SendMessage(MongoRequestMessage message)
   at MongoDB.Driver.Operations.CommandOperation`1.Execute(MongoConnection connection)
   at MongoDB.Driver.MongoServerInstance.Ping(MongoConnection connection)
   at MongoDB.Driver.MongoServerInstance.Connect()
   at MongoDB.Driver.Internal.DirectMongoServerProxy.Connect(TimeSpan timeout, ReadPreference readPreference)


ManagedPoolThread #17 12:46:16 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #11 12:46:17 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #0 12:46:17 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #0 12:46:17 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
ManagedPoolThread #13 12:46:18 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
3600 12:46:18 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #6 12:46:19 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
7520 12:46:19 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #1 12:46:20 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #19 12:46:21 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
2472 12:46:21 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #3 12:46:22 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #14 12:46:23 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
5056 12:46:23 INFO  [Path Analyzer](.) Running trail cleanup agent
5056 12:46:23 INFO  [Path Analyzer](.) Running trail cleanup on database
ManagedPoolThread #5 12:46:24 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
5296 12:46:24 INFO  [Experience Analytics]: Reduce agent found zero sites to process
ManagedPoolThread #16 12:46:25 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
9120 12:46:26 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

 424 12:46:26 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: MongoDB.Driver.MongoConnectionException
Message: Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
Source: MongoDB.Driver
   at MongoDB.Driver.Internal.DirectMongoServerProxy.Connect(TimeSpan timeout, ReadPreference readPreference)
   at MongoDB.Driver.Internal.DirectMongoServerProxy.ChooseServerInstance(ReadPreference readPreference)
   at MongoDB.Driver.MongoServer.AcquireConnection(ReadPreference readPreference)
   at MongoDB.Driver.MongoCursor`1.MongoCursorConnectionProvider.AcquireConnection()
   at MongoDB.Driver.Operations.QueryOperation`1.GetFirstBatch(IConnectionProvider connectionProvider)
   at MongoDB.Driver.Operations.QueryOperation`1.Execute(IConnectionProvider connectionProvider)
   at System.Linq.Enumerable.FirstOrDefault[TSource](IEnumerable`1 source)
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

Nested Exception

Exception: System.Net.Sockets.SocketException
Message: No connection could be made because the target machine actively refused it 127.0.0.1:27017
Source: System
   at System.Net.Sockets.Socket.DoConnect(EndPoint endPointSnapshot, SocketAddress socketAddress)
   at System.Net.Sockets.Socket.Connect(EndPoint remoteEP)
   at System.Net.Sockets.TcpClient.Connect(IPEndPoint remoteEP)
   at MongoDB.Driver.Internal.MongoConnection.Open()
   at MongoDB.Driver.Internal.MongoConnection.SendMessage(BsonBuffer buffer, Int32 requestId)
   at MongoDB.Driver.Internal.MongoConnection.SendMessage(MongoRequestMessage message)
   at MongoDB.Driver.Operations.CommandOperation`1.Execute(MongoConnection connection)
   at MongoDB.Driver.MongoServerInstance.Ping(MongoConnection connection)
   at MongoDB.Driver.MongoServerInstance.Connect()
   at MongoDB.Driver.Internal.DirectMongoServerProxy.Connect(TimeSpan timeout, ReadPreference readPreference)


ManagedPoolThread #15 12:46:27 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #9 12:46:27 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #9 12:46:27 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
4424 12:46:28 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #12 12:46:28 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #7 12:46:29 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
6160 12:46:30 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #18 12:46:30 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #10 12:46:31 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
3600 12:46:33 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

7520 12:46:34 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

2472 12:46:36 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #4 12:46:37 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #4 12:46:37 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
9120 12:46:41 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

 424 12:46:41 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

4424 12:46:43 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

6160 12:46:45 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #8 12:46:47 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #8 12:46:47 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
3600 12:46:48 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

7520 12:46:49 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

2472 12:46:51 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Core.BackgroundService.Run()

5296 12:46:54 INFO  [Experience Analytics]: Reduce agent found zero sites to process
9120 12:46:56 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

 424 12:46:56 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

Heartbeat 12:46:56 ERROR MongoDbDictionary.Store() has failed.
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Save(Object value)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbDictionary.Store(Object value)

ManagedPoolThread #0 12:46:57 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #0 12:46:57 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
4424 12:46:58 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

6160 12:47:00 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

3600 12:47:03 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

7520 12:47:04 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

2472 12:47:06 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #9 12:47:07 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #9 12:47:07 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
9120 12:47:11 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

 424 12:47:11 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

4424 12:47:13 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

6160 12:47:15 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #8 12:47:17 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #8 12:47:17 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
3600 12:47:18 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

7520 12:47:19 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

2472 12:47:21 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Core.BackgroundService.Run()

5296 12:47:25 INFO  [Experience Analytics]: Reduce agent found zero sites to process
ManagedPoolThread #17 12:47:26 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #4 12:47:27 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #4 12:47:27 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
ManagedPoolThread #16 12:47:27 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
4424 12:47:28 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #11 12:47:28 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #13 12:47:29 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
6160 12:47:30 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #5 12:47:30 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #14 12:47:31 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #1 12:47:32 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #3 12:47:33 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
3600 12:47:33 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #6 12:47:34 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #19 12:47:35 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
2472 12:47:36 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Core.BackgroundService.Run()

9120 12:47:36 ERROR Exception when executing agent aggregation/automationAggregator
Exception: MongoDB.Driver.MongoConnectionException
Message: Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
Source: MongoDB.Driver
   at MongoDB.Driver.Internal.DirectMongoServerProxy.Connect(TimeSpan timeout, ReadPreference readPreference)
   at MongoDB.Driver.Internal.DirectMongoServerProxy.ChooseServerInstance(ReadPreference readPreference)
   at MongoDB.Driver.MongoServer.AcquireConnection(ReadPreference readPreference)
   at MongoDB.Driver.MongoCursor`1.MongoCursorConnectionProvider.AcquireConnection()
   at MongoDB.Driver.Operations.QueryOperation`1.GetFirstBatch(IConnectionProvider connectionProvider)
   at MongoDB.Driver.Operations.QueryOperation`1.Execute(IConnectionProvider connectionProvider)
   at System.Linq.Buffer`1..ctor(IEnumerable`1 source)
   at System.Linq.Enumerable.ToArray[TSource](IEnumerable`1 source)
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

Nested Exception

Exception: System.Net.Sockets.SocketException
Message: No connection could be made because the target machine actively refused it 127.0.0.1:27017
Source: System
   at System.Net.Sockets.Socket.DoConnect(EndPoint endPointSnapshot, SocketAddress socketAddress)
   at System.Net.Sockets.Socket.Connect(EndPoint remoteEP)
   at System.Net.Sockets.TcpClient.Connect(IPEndPoint remoteEP)
   at MongoDB.Driver.Internal.MongoConnection.Open()
   at MongoDB.Driver.Internal.MongoConnection.SendMessage(BsonBuffer buffer, Int32 requestId)
   at MongoDB.Driver.Internal.MongoConnection.SendMessage(MongoRequestMessage message)
   at MongoDB.Driver.Operations.CommandOperation`1.Execute(MongoConnection connection)
   at MongoDB.Driver.MongoServerInstance.Ping(MongoConnection connection)
   at MongoDB.Driver.MongoServerInstance.Connect()
   at MongoDB.Driver.Internal.DirectMongoServerProxy.Connect(TimeSpan timeout, ReadPreference readPreference)


ManagedPoolThread #0 12:47:37 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #0 12:47:37 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
 424 12:47:37 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: MongoDB.Driver.MongoConnectionException
Message: Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
Source: MongoDB.Driver
   at MongoDB.Driver.Internal.DirectMongoServerProxy.Connect(TimeSpan timeout, ReadPreference readPreference)
   at MongoDB.Driver.Internal.DirectMongoServerProxy.ChooseServerInstance(ReadPreference readPreference)
   at MongoDB.Driver.MongoServer.AcquireConnection(ReadPreference readPreference)
   at MongoDB.Driver.MongoCursor`1.MongoCursorConnectionProvider.AcquireConnection()
   at MongoDB.Driver.Operations.QueryOperation`1.GetFirstBatch(IConnectionProvider connectionProvider)
   at MongoDB.Driver.Operations.QueryOperation`1.Execute(IConnectionProvider connectionProvider)
   at System.Linq.Enumerable.FirstOrDefault[TSource](IEnumerable`1 source)
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

Nested Exception

Exception: System.Net.Sockets.SocketException
Message: No connection could be made because the target machine actively refused it 127.0.0.1:27017
Source: System
   at System.Net.Sockets.Socket.DoConnect(EndPoint endPointSnapshot, SocketAddress socketAddress)
   at System.Net.Sockets.Socket.Connect(EndPoint remoteEP)
   at System.Net.Sockets.TcpClient.Connect(IPEndPoint remoteEP)
   at MongoDB.Driver.Internal.MongoConnection.Open()
   at MongoDB.Driver.Internal.MongoConnection.SendMessage(BsonBuffer buffer, Int32 requestId)
   at MongoDB.Driver.Internal.MongoConnection.SendMessage(MongoRequestMessage message)
   at MongoDB.Driver.Operations.CommandOperation`1.Execute(MongoConnection connection)
   at MongoDB.Driver.MongoServerInstance.Ping(MongoConnection connection)
   at MongoDB.Driver.MongoServerInstance.Connect()
   at MongoDB.Driver.Internal.DirectMongoServerProxy.Connect(TimeSpan timeout, ReadPreference readPreference)


ManagedPoolThread #15 12:47:39 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #18 12:47:40 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #10 12:47:41 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
7520 12:47:42 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
7520 12:47:42 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.HandleDatabaseException(ExceptionBehavior exceptionBehavior, Exception ex)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

Nested Exception

Exception: MongoDB.Driver.MongoConnectionException
Message: Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
Source: MongoDB.Driver
   at MongoDB.Driver.Internal.DirectMongoServerProxy.Connect(TimeSpan timeout, ReadPreference readPreference)
   at MongoDB.Driver.Internal.DirectMongoServerProxy.ChooseServerInstance(ReadPreference readPreference)
   at MongoDB.Driver.MongoServer.AcquireConnection(ReadPreference readPreference)
   at MongoDB.Driver.MongoCollection.RunCommandAs[TCommandResult](IMongoCommand command, ReadPreference readPreference, IBsonSerializer resultSerializer, IBsonSerializationOptions resultSerializationOptions)
   at MongoDB.Driver.MongoCollection.RunCommandAs[TCommandResult](IMongoCommand command, ReadPreference readPreference)
   at MongoDB.Driver.MongoCollection.FindAndModify(FindAndModifyArgs args)
   at MongoDB.Driver.MongoCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.<>c__DisplayClass2c.<FindAndModify>b__2b()
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)

Nested Exception

Exception: System.Net.Sockets.SocketException
Message: No connection could be made because the target machine actively refused it 127.0.0.1:27017
Source: System
   at System.Net.Sockets.Socket.DoConnect(EndPoint endPointSnapshot, SocketAddress socketAddress)
   at System.Net.Sockets.Socket.Connect(EndPoint remoteEP)
   at System.Net.Sockets.TcpClient.Connect(IPEndPoint remoteEP)
   at MongoDB.Driver.Internal.MongoConnection.Open()
   at MongoDB.Driver.Internal.MongoConnection.SendMessage(BsonBuffer buffer, Int32 requestId)
   at MongoDB.Driver.Internal.MongoConnection.SendMessage(MongoRequestMessage message)
   at MongoDB.Driver.Operations.CommandOperation`1.Execute(MongoConnection connection)
   at MongoDB.Driver.MongoServerInstance.Ping(MongoConnection connection)
   at MongoDB.Driver.MongoServerInstance.Connect()
   at MongoDB.Driver.Internal.DirectMongoServerProxy.Connect(TimeSpan timeout, ReadPreference readPreference)



4424 12:47:43 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #12 12:47:43 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #7 12:47:44 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
6160 12:47:45 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #4 12:47:47 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #4 12:47:47 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
3600 12:47:48 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

2472 12:47:51 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Core.BackgroundService.Run()

9120 12:47:51 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

 424 12:47:52 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

5296 12:47:55 INFO  [Experience Analytics]: Reduce agent found zero sites to process
ManagedPoolThread #9 12:47:57 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #9 12:47:57 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
7520 12:47:57 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

4424 12:47:58 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

6160 12:48:00 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

3600 12:48:03 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

2472 12:48:06 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Core.BackgroundService.Run()

9120 12:48:06 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #4 12:48:07 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #4 12:48:07 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
 424 12:48:07 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

7520 12:48:12 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

4424 12:48:13 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

6160 12:48:15 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #8 12:48:17 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #8 12:48:17 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
3600 12:48:18 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

2472 12:48:21 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Core.BackgroundService.Run()

9120 12:48:21 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

 424 12:48:22 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

5296 12:48:25 INFO  [Experience Analytics]: Reduce agent found zero sites to process
ManagedPoolThread #0 12:48:27 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #0 12:48:27 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
7520 12:48:27 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

4424 12:48:28 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

6160 12:48:30 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

3600 12:48:33 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #13 12:48:37 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #8 12:48:37 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #8 12:48:37 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
 424 12:48:37 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #11 12:48:38 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #16 12:48:39 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #5 12:48:40 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #17 12:48:41 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #14 12:48:42 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
7520 12:48:42 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

4424 12:48:43 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #3 12:48:43 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #19 12:48:44 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
6160 12:48:45 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #6 12:48:45 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #1 12:48:46 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #4 12:48:47 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #4 12:48:47 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
2472 12:48:47 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: MongoDB.Driver.MongoConnectionException
Message: Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
Source: MongoDB.Driver
   at MongoDB.Driver.Internal.DirectMongoServerProxy.Connect(TimeSpan timeout, ReadPreference readPreference)
   at MongoDB.Driver.Internal.DirectMongoServerProxy.ChooseServerInstance(ReadPreference readPreference)
   at MongoDB.Driver.MongoServer.AcquireConnection(ReadPreference readPreference)
   at MongoDB.Driver.MongoCursor`1.MongoCursorConnectionProvider.AcquireConnection()
   at MongoDB.Driver.Operations.QueryOperation`1.GetFirstBatch(IConnectionProvider connectionProvider)
   at MongoDB.Driver.Operations.QueryOperation`1.Execute(IConnectionProvider connectionProvider)
   at System.Linq.Enumerable.FirstOrDefault[TSource](IEnumerable`1 source)
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Core.BackgroundService.Run()

Nested Exception

Exception: System.Net.Sockets.SocketException
Message: No connection could be made because the target machine actively refused it 127.0.0.1:27017
Source: System
   at System.Net.Sockets.Socket.DoConnect(EndPoint endPointSnapshot, SocketAddress socketAddress)
   at System.Net.Sockets.Socket.Connect(EndPoint remoteEP)
   at System.Net.Sockets.TcpClient.Connect(IPEndPoint remoteEP)
   at MongoDB.Driver.Internal.MongoConnection.Open()
   at MongoDB.Driver.Internal.MongoConnection.SendMessage(BsonBuffer buffer, Int32 requestId)
   at MongoDB.Driver.Internal.MongoConnection.SendMessage(MongoRequestMessage message)
   at MongoDB.Driver.Operations.CommandOperation`1.Execute(MongoConnection connection)
   at MongoDB.Driver.MongoServerInstance.Ping(MongoConnection connection)
   at MongoDB.Driver.MongoServerInstance.Connect()
   at MongoDB.Driver.Internal.DirectMongoServerProxy.Connect(TimeSpan timeout, ReadPreference readPreference)


9120 12:48:48 ERROR Exception when executing agent aggregation/automationAggregator
Exception: MongoDB.Driver.MongoConnectionException
Message: Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
Source: MongoDB.Driver
   at MongoDB.Driver.Internal.DirectMongoServerProxy.Connect(TimeSpan timeout, ReadPreference readPreference)
   at MongoDB.Driver.Internal.DirectMongoServerProxy.ChooseServerInstance(ReadPreference readPreference)
   at MongoDB.Driver.MongoServer.AcquireConnection(ReadPreference readPreference)
   at MongoDB.Driver.MongoCursor`1.MongoCursorConnectionProvider.AcquireConnection()
   at MongoDB.Driver.Operations.QueryOperation`1.GetFirstBatch(IConnectionProvider connectionProvider)
   at MongoDB.Driver.Operations.QueryOperation`1.Execute(IConnectionProvider connectionProvider)
   at System.Linq.Buffer`1..ctor(IEnumerable`1 source)
   at System.Linq.Enumerable.ToArray[TSource](IEnumerable`1 source)
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

Nested Exception

Exception: System.Net.Sockets.SocketException
Message: No connection could be made because the target machine actively refused it 127.0.0.1:27017
Source: System
   at System.Net.Sockets.Socket.DoConnect(EndPoint endPointSnapshot, SocketAddress socketAddress)
   at System.Net.Sockets.Socket.Connect(EndPoint remoteEP)
   at System.Net.Sockets.TcpClient.Connect(IPEndPoint remoteEP)
   at MongoDB.Driver.Internal.MongoConnection.Open()
   at MongoDB.Driver.Internal.MongoConnection.SendMessage(BsonBuffer buffer, Int32 requestId)
   at MongoDB.Driver.Internal.MongoConnection.SendMessage(MongoRequestMessage message)
   at MongoDB.Driver.Operations.CommandOperation`1.Execute(MongoConnection connection)
   at MongoDB.Driver.MongoServerInstance.Ping(MongoConnection connection)
   at MongoDB.Driver.MongoServerInstance.Connect()
   at MongoDB.Driver.Internal.DirectMongoServerProxy.Connect(TimeSpan timeout, ReadPreference readPreference)


3600 12:48:48 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #15 12:48:50 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #12 12:48:51 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #7 12:48:52 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
 424 12:48:52 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #18 12:48:53 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #10 12:48:54 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
5296 12:48:55 INFO  [Experience Analytics]: Reduce agent found zero sites to process
Heartbeat 12:48:57 ERROR MongoDbDictionary.Store() has failed.
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Save(Object value)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbDictionary.Store(Object value)

ManagedPoolThread #8 12:48:57 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #8 12:48:57 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
7520 12:48:57 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

4424 12:48:58 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

6160 12:49:00 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

2472 12:49:02 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Core.BackgroundService.Run()

9120 12:49:03 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

3600 12:49:03 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #9 12:49:07 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #9 12:49:07 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
 424 12:49:07 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

7520 12:49:12 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

4424 12:49:13 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

6160 12:49:15 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #8 12:49:17 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #8 12:49:17 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
2472 12:49:17 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Core.BackgroundService.Run()

9120 12:49:18 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

3600 12:49:18 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

 424 12:49:22 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

5296 12:49:25 INFO  [Experience Analytics]: Reduce agent found zero sites to process
ManagedPoolThread #9 12:49:27 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #9 12:49:27 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
7520 12:49:27 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

4424 12:49:28 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

6160 12:49:30 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

2472 12:49:32 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Core.BackgroundService.Run()

9120 12:49:33 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

3600 12:49:33 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #8 12:49:37 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #8 12:49:37 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
 424 12:49:37 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

7520 12:49:42 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

4424 12:49:43 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

6160 12:49:45 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #9 12:49:47 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #9 12:49:47 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
ManagedPoolThread #6 12:49:48 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
9120 12:49:48 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

3600 12:49:48 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #1 12:49:49 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #19 12:49:50 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #17 12:49:51 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #13 12:49:52 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
 424 12:49:52 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #11 12:49:53 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #3 12:49:54 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
5296 12:49:55 INFO  [Experience Analytics]: Reduce agent found zero sites to process
ManagedPoolThread #14 12:49:55 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #5 12:49:56 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #16 12:49:57 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #4 12:49:57 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #4 12:49:57 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
2472 12:49:58 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: MongoDB.Driver.MongoConnectionException
Message: Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
Source: MongoDB.Driver
   at MongoDB.Driver.Internal.DirectMongoServerProxy.Connect(TimeSpan timeout, ReadPreference readPreference)
   at MongoDB.Driver.Internal.DirectMongoServerProxy.ChooseServerInstance(ReadPreference readPreference)
   at MongoDB.Driver.MongoServer.AcquireConnection(ReadPreference readPreference)
   at MongoDB.Driver.MongoCursor`1.MongoCursorConnectionProvider.AcquireConnection()
   at MongoDB.Driver.Operations.QueryOperation`1.GetFirstBatch(IConnectionProvider connectionProvider)
   at MongoDB.Driver.Operations.QueryOperation`1.Execute(IConnectionProvider connectionProvider)
   at System.Linq.Enumerable.FirstOrDefault[TSource](IEnumerable`1 source)
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Core.BackgroundService.Run()

Nested Exception

Exception: System.Net.Sockets.SocketException
Message: No connection could be made because the target machine actively refused it 127.0.0.1:27017
Source: System
   at System.Net.Sockets.Socket.DoConnect(EndPoint endPointSnapshot, SocketAddress socketAddress)
   at System.Net.Sockets.Socket.Connect(EndPoint remoteEP)
   at System.Net.Sockets.TcpClient.Connect(IPEndPoint remoteEP)
   at MongoDB.Driver.Internal.MongoConnection.Open()
   at MongoDB.Driver.Internal.MongoConnection.SendMessage(BsonBuffer buffer, Int32 requestId)
   at MongoDB.Driver.Internal.MongoConnection.SendMessage(MongoRequestMessage message)
   at MongoDB.Driver.Operations.CommandOperation`1.Execute(MongoConnection connection)
   at MongoDB.Driver.MongoServerInstance.Ping(MongoConnection connection)
   at MongoDB.Driver.MongoServerInstance.Connect()
   at MongoDB.Driver.Internal.DirectMongoServerProxy.Connect(TimeSpan timeout, ReadPreference readPreference)


4424 12:49:58 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #15 12:50:00 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
6160 12:50:00 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #18 12:50:01 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #10 12:50:02 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
7520 12:50:03 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
7520 12:50:03 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.HandleDatabaseException(ExceptionBehavior exceptionBehavior, Exception ex)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

Nested Exception

Exception: MongoDB.Driver.MongoConnectionException
Message: Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
Source: MongoDB.Driver
   at MongoDB.Driver.Internal.DirectMongoServerProxy.Connect(TimeSpan timeout, ReadPreference readPreference)
   at MongoDB.Driver.Internal.DirectMongoServerProxy.ChooseServerInstance(ReadPreference readPreference)
   at MongoDB.Driver.MongoServer.AcquireConnection(ReadPreference readPreference)
   at MongoDB.Driver.MongoCollection.RunCommandAs[TCommandResult](IMongoCommand command, ReadPreference readPreference, IBsonSerializer resultSerializer, IBsonSerializationOptions resultSerializationOptions)
   at MongoDB.Driver.MongoCollection.RunCommandAs[TCommandResult](IMongoCommand command, ReadPreference readPreference)
   at MongoDB.Driver.MongoCollection.FindAndModify(FindAndModifyArgs args)
   at MongoDB.Driver.MongoCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.<>c__DisplayClass2c.<FindAndModify>b__2b()
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)

Nested Exception

Exception: System.Net.Sockets.SocketException
Message: No connection could be made because the target machine actively refused it 127.0.0.1:27017
Source: System
   at System.Net.Sockets.Socket.DoConnect(EndPoint endPointSnapshot, SocketAddress socketAddress)
   at System.Net.Sockets.Socket.Connect(EndPoint remoteEP)
   at System.Net.Sockets.TcpClient.Connect(IPEndPoint remoteEP)
   at MongoDB.Driver.Internal.MongoConnection.Open()
   at MongoDB.Driver.Internal.MongoConnection.SendMessage(BsonBuffer buffer, Int32 requestId)
   at MongoDB.Driver.Internal.MongoConnection.SendMessage(MongoRequestMessage message)
   at MongoDB.Driver.Operations.CommandOperation`1.Execute(MongoConnection connection)
   at MongoDB.Driver.MongoServerInstance.Ping(MongoConnection connection)
   at MongoDB.Driver.MongoServerInstance.Connect()
   at MongoDB.Driver.Internal.DirectMongoServerProxy.Connect(TimeSpan timeout, ReadPreference readPreference)



9120 12:50:03 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

3600 12:50:03 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #9 12:50:07 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #9 12:50:07 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
 424 12:50:08 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

2472 12:50:13 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Core.BackgroundService.Run()

4424 12:50:13 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

6160 12:50:15 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #0 12:50:17 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #0 12:50:17 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
7520 12:50:18 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

9120 12:50:18 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

3600 12:50:18 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

 424 12:50:23 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

5296 12:50:25 INFO  [Experience Analytics]: Reduce agent found zero sites to process
ManagedPoolThread #8 12:50:27 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #8 12:50:27 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
2472 12:50:28 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Core.BackgroundService.Run()

4424 12:50:28 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

6160 12:50:30 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

7520 12:50:33 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

9120 12:50:33 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

3600 12:50:33 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #0 12:50:37 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #0 12:50:37 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
 424 12:50:38 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

2472 12:50:43 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Core.BackgroundService.Run()

4424 12:50:43 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

6160 12:50:45 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #8 12:50:47 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #8 12:50:47 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
7520 12:50:48 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

9120 12:50:48 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

3600 12:50:48 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

 424 12:50:53 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

5296 12:50:55 INFO  [Experience Analytics]: Reduce agent found zero sites to process
ManagedPoolThread #0 12:50:57 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #0 12:50:57 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
ManagedPoolThread #11 12:50:58 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #3 12:50:59 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
6160 12:51:00 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #1 12:51:00 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #16 12:51:01 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #13 12:51:02 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
9120 12:51:03 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #17 12:51:03 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
3600 12:51:03 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #19 12:51:04 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #5 12:51:05 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #14 12:51:06 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #9 12:51:07 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #9 12:51:07 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
ManagedPoolThread #6 12:51:07 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
 424 12:51:08 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

2472 12:51:08 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: MongoDB.Driver.MongoConnectionException
Message: Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
Source: MongoDB.Driver
   at MongoDB.Driver.Internal.DirectMongoServerProxy.Connect(TimeSpan timeout, ReadPreference readPreference)
   at MongoDB.Driver.Internal.DirectMongoServerProxy.ChooseServerInstance(ReadPreference readPreference)
   at MongoDB.Driver.MongoServer.AcquireConnection(ReadPreference readPreference)
   at MongoDB.Driver.MongoCursor`1.MongoCursorConnectionProvider.AcquireConnection()
   at MongoDB.Driver.Operations.QueryOperation`1.GetFirstBatch(IConnectionProvider connectionProvider)
   at MongoDB.Driver.Operations.QueryOperation`1.Execute(IConnectionProvider connectionProvider)
   at System.Linq.Enumerable.FirstOrDefault[TSource](IEnumerable`1 source)
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Core.BackgroundService.Run()

Nested Exception

Exception: System.Net.Sockets.SocketException
Message: No connection could be made because the target machine actively refused it 127.0.0.1:27017
Source: System
   at System.Net.Sockets.Socket.DoConnect(EndPoint endPointSnapshot, SocketAddress socketAddress)
   at System.Net.Sockets.Socket.Connect(EndPoint remoteEP)
   at System.Net.Sockets.TcpClient.Connect(IPEndPoint remoteEP)
   at MongoDB.Driver.Internal.MongoConnection.Open()
   at MongoDB.Driver.Internal.MongoConnection.SendMessage(BsonBuffer buffer, Int32 requestId)
   at MongoDB.Driver.Internal.MongoConnection.SendMessage(MongoRequestMessage message)
   at MongoDB.Driver.Operations.CommandOperation`1.Execute(MongoConnection connection)
   at MongoDB.Driver.MongoServerInstance.Ping(MongoConnection connection)
   at MongoDB.Driver.MongoServerInstance.Connect()
   at MongoDB.Driver.Internal.DirectMongoServerProxy.Connect(TimeSpan timeout, ReadPreference readPreference)


4424 12:51:09 ERROR Exception when executing agent aggregation/automationAggregator
Exception: MongoDB.Driver.MongoConnectionException
Message: Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
Source: MongoDB.Driver
   at MongoDB.Driver.Internal.DirectMongoServerProxy.Connect(TimeSpan timeout, ReadPreference readPreference)
   at MongoDB.Driver.Internal.DirectMongoServerProxy.ChooseServerInstance(ReadPreference readPreference)
   at MongoDB.Driver.MongoServer.AcquireConnection(ReadPreference readPreference)
   at MongoDB.Driver.MongoCursor`1.MongoCursorConnectionProvider.AcquireConnection()
   at MongoDB.Driver.Operations.QueryOperation`1.GetFirstBatch(IConnectionProvider connectionProvider)
   at MongoDB.Driver.Operations.QueryOperation`1.Execute(IConnectionProvider connectionProvider)
   at System.Linq.Buffer`1..ctor(IEnumerable`1 source)
   at System.Linq.Enumerable.ToArray[TSource](IEnumerable`1 source)
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

Nested Exception

Exception: System.Net.Sockets.SocketException
Message: No connection could be made because the target machine actively refused it 127.0.0.1:27017
Source: System
   at System.Net.Sockets.Socket.DoConnect(EndPoint endPointSnapshot, SocketAddress socketAddress)
   at System.Net.Sockets.Socket.Connect(EndPoint remoteEP)
   at System.Net.Sockets.TcpClient.Connect(IPEndPoint remoteEP)
   at MongoDB.Driver.Internal.MongoConnection.Open()
   at MongoDB.Driver.Internal.MongoConnection.SendMessage(BsonBuffer buffer, Int32 requestId)
   at MongoDB.Driver.Internal.MongoConnection.SendMessage(MongoRequestMessage message)
   at MongoDB.Driver.Operations.CommandOperation`1.Execute(MongoConnection connection)
   at MongoDB.Driver.MongoServerInstance.Ping(MongoConnection connection)
   at MongoDB.Driver.MongoServerInstance.Connect()
   at MongoDB.Driver.Internal.DirectMongoServerProxy.Connect(TimeSpan timeout, ReadPreference readPreference)


Heartbeat 12:51:10 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
Heartbeat 12:51:10 ERROR MongoDbDictionary.Store() has failed.
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.HandleDatabaseException(ExceptionBehavior exceptionBehavior, Exception ex)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Save(Object value)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbDictionary.Store(Object value)

Nested Exception

Exception: MongoDB.Driver.MongoConnectionException
Message: Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
Source: MongoDB.Driver
   at MongoDB.Driver.Internal.DirectMongoServerProxy.Connect(TimeSpan timeout, ReadPreference readPreference)
   at MongoDB.Driver.Internal.DirectMongoServerProxy.ChooseServerInstance(ReadPreference readPreference)
   at MongoDB.Driver.MongoServer.AcquireConnection(ReadPreference readPreference)
   at MongoDB.Driver.MongoCollection.Update(IMongoQuery query, IMongoUpdate update, MongoUpdateOptions options)
   at MongoDB.Driver.MongoCollection.Save(Type nominalType, Object document, MongoInsertOptions options)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.<>c__DisplayClass3c.<Save>b__3b()
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)

Nested Exception

Exception: System.Net.Sockets.SocketException
Message: No connection could be made because the target machine actively refused it 127.0.0.1:27017
Source: System
   at System.Net.Sockets.Socket.DoConnect(EndPoint endPointSnapshot, SocketAddress socketAddress)
   at System.Net.Sockets.Socket.Connect(EndPoint remoteEP)
   at System.Net.Sockets.TcpClient.Connect(IPEndPoint remoteEP)
   at MongoDB.Driver.Internal.MongoConnection.Open()
   at MongoDB.Driver.Internal.MongoConnection.SendMessage(BsonBuffer buffer, Int32 requestId)
   at MongoDB.Driver.Internal.MongoConnection.SendMessage(MongoRequestMessage message)
   at MongoDB.Driver.Operations.CommandOperation`1.Execute(MongoConnection connection)
   at MongoDB.Driver.MongoServerInstance.Ping(MongoConnection connection)
   at MongoDB.Driver.MongoServerInstance.Connect()
   at MongoDB.Driver.Internal.DirectMongoServerProxy.Connect(TimeSpan timeout, ReadPreference readPreference)



7092 12:51:11 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #15 12:51:12 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #18 12:51:13 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #12 12:51:14 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
6160 12:51:15 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

7520 12:51:15 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
7520 12:51:15 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.HandleDatabaseException(ExceptionBehavior exceptionBehavior, Exception ex)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

Nested Exception

Exception: MongoDB.Driver.MongoConnectionException
Message: Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
Source: MongoDB.Driver
   at MongoDB.Driver.Internal.DirectMongoServerProxy.Connect(TimeSpan timeout, ReadPreference readPreference)
   at MongoDB.Driver.Internal.DirectMongoServerProxy.ChooseServerInstance(ReadPreference readPreference)
   at MongoDB.Driver.MongoServer.AcquireConnection(ReadPreference readPreference)
   at MongoDB.Driver.MongoCollection.RunCommandAs[TCommandResult](IMongoCommand command, ReadPreference readPreference, IBsonSerializer resultSerializer, IBsonSerializationOptions resultSerializationOptions)
   at MongoDB.Driver.MongoCollection.RunCommandAs[TCommandResult](IMongoCommand command, ReadPreference readPreference)
   at MongoDB.Driver.MongoCollection.FindAndModify(FindAndModifyArgs args)
   at MongoDB.Driver.MongoCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.<>c__DisplayClass2c.<FindAndModify>b__2b()
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)

Nested Exception

Exception: System.Net.Sockets.SocketException
Message: No connection could be made because the target machine actively refused it 127.0.0.1:27017
Source: System
   at System.Net.Sockets.Socket.DoConnect(EndPoint endPointSnapshot, SocketAddress socketAddress)
   at System.Net.Sockets.Socket.Connect(EndPoint remoteEP)
   at System.Net.Sockets.TcpClient.Connect(IPEndPoint remoteEP)
   at MongoDB.Driver.Internal.MongoConnection.Open()
   at MongoDB.Driver.Internal.MongoConnection.SendMessage(BsonBuffer buffer, Int32 requestId)
   at MongoDB.Driver.Internal.MongoConnection.SendMessage(MongoRequestMessage message)
   at MongoDB.Driver.Operations.CommandOperation`1.Execute(MongoConnection connection)
   at MongoDB.Driver.MongoServerInstance.Ping(MongoConnection connection)
   at MongoDB.Driver.MongoServerInstance.Connect()
   at MongoDB.Driver.Internal.DirectMongoServerProxy.Connect(TimeSpan timeout, ReadPreference readPreference)



ManagedPoolThread #10 12:51:16 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #0 12:51:17 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #0 12:51:17 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
ManagedPoolThread #7 12:51:18 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
9120 12:51:18 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

3600 12:51:18 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

Heartbeat 12:51:22 INFO  Health.PrivateBytes: 783,675,392
Heartbeat 12:51:22 INFO  Health.CacheInstances: 115
Heartbeat 12:51:22 INFO  Health.CacheTotalCount: 18,100
Heartbeat 12:51:22 INFO  Health.CacheTotalSize: 75,523,756
 424 12:51:23 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

2472 12:51:23 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Core.BackgroundService.Run()

5056 12:51:23 INFO  [Path Analyzer](.) Running trail cleanup agent
5056 12:51:23 INFO  [Path Analyzer](.) Running trail cleanup on database
4088 12:51:23 WARN  [Path Analyzer](.) SmartMergeAgent.Execute() returns. No missing date ranges to merge.
4424 12:51:24 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

5296 12:51:25 INFO  [Experience Analytics]: Reduce agent found zero sites to process
ManagedPoolThread #8 12:51:27 INFO  Job started: Sitecore.Tasks.UrlAgent
ManagedPoolThread #8 12:51:27 INFO  Scheduling.UrlAgent started. Url: http://gathercontent.dev/sitecore/service/keepalive.aspx
ManagedPoolThread #8 12:51:27 INFO  Scheduling.UrlAgent done (received: 561 bytes)
ManagedPoolThread #8 12:51:27 INFO  Job ended: Sitecore.Tasks.UrlAgent (units processed: )
ManagedPoolThread #4 12:51:27 INFO  Job started: Sitecore.Tasks.TaskDatabaseAgent
ManagedPoolThread #4 12:51:27 INFO  Processing tasks (count: 0)
ManagedPoolThread #4 12:51:27 INFO  Job ended: Sitecore.Tasks.TaskDatabaseAgent (units processed: )
ManagedPoolThread #0 12:51:27 INFO  Job started: Core_Database_Agent
ManagedPoolThread #0 12:51:27 INFO  Scheduling.DatabaseAgent started. Database: core
ManagedPoolThread #0 12:51:27 INFO  Examining schedules (count: 0)
ManagedPoolThread #0 12:51:27 INFO  Job ended: Core_Database_Agent (units processed: )
ManagedPoolThread #9 12:51:27 INFO  Job started: Master_Database_Agent
ManagedPoolThread #9 12:51:27 INFO  Scheduling.DatabaseAgent started. Database: master
ManagedPoolThread #9 12:51:27 INFO  Examining schedules (count: 5)
ManagedPoolThread #9 12:51:27 INFO  Starting: __Task Schedule
ManagedPoolThread #9 12:51:27 INFO  Ended: __Task Schedule
ManagedPoolThread #9 12:51:27 INFO  Not due: Calculate Statistical Relevancy
ManagedPoolThread #9 12:51:27 INFO  Not due: Rebuild Suggested Tests Index
ManagedPoolThread #9 12:51:27 INFO  Not due: Suspend Corrupted Tests
ManagedPoolThread #9 12:51:27 INFO  Not due: Try Finish Test
ManagedPoolThread #9 12:51:27 INFO  Job ended: Master_Database_Agent (units processed: 5)
ManagedPoolThread #8 12:51:27 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #8 12:51:27 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
6160 12:51:30 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

7520 12:51:31 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

9120 12:51:33 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

3600 12:51:33 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #0 12:51:37 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #0 12:51:37 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
 424 12:51:38 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

2472 12:51:38 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Core.BackgroundService.Run()

4424 12:51:39 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

6160 12:51:45 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

7520 12:51:46 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #9 12:51:47 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #9 12:51:47 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
9120 12:51:48 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

3600 12:51:48 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

 424 12:51:53 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

2472 12:51:53 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Core.BackgroundService.Run()

4424 12:51:54 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

5296 12:51:55 INFO  [Experience Analytics]: Reduce agent found zero sites to process
ManagedPoolThread #0 12:51:57 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #0 12:51:57 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
6160 12:52:00 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

7520 12:52:01 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

9120 12:52:03 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

3600 12:52:03 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #9 12:52:07 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #9 12:52:07 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
 424 12:52:08 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

2472 12:52:08 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Core.BackgroundService.Run()

4424 12:52:09 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

7092 12:52:12 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #11 12:52:13 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #13 12:52:15 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
6160 12:52:15 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #1 12:52:16 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
7520 12:52:16 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #16 12:52:17 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #4 12:52:17 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #4 12:52:17 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
ManagedPoolThread #3 12:52:18 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
9120 12:52:18 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

3600 12:52:18 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #17 12:52:19 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #14 12:52:20 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #5 12:52:21 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #6 12:52:22 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
 424 12:52:23 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #19 12:52:23 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
2472 12:52:23 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #15 12:52:24 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
4424 12:52:24 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

5296 12:52:25 INFO  [Experience Analytics]: Reduce agent found zero sites to process
ManagedPoolThread #12 12:52:25 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #7 12:52:26 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #18 12:52:27 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #8 12:52:27 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #8 12:52:27 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
6160 12:52:30 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

7520 12:52:31 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

9120 12:52:33 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

3600 12:52:33 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #4 12:52:37 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #4 12:52:37 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
 424 12:52:38 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

2472 12:52:38 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Core.BackgroundService.Run()

4424 12:52:39 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

6160 12:52:45 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

7520 12:52:46 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #8 12:52:47 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #8 12:52:47 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
9120 12:52:48 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

3600 12:52:48 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

 424 12:52:53 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

2472 12:52:53 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Core.BackgroundService.Run()

4424 12:52:54 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

5296 12:52:55 INFO  [Experience Analytics]: Reduce agent found zero sites to process
ManagedPoolThread #9 12:52:57 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #9 12:52:57 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
Heartbeat 12:52:59 ERROR MongoDbDictionary.Store() has failed.
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Save(Object value)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbDictionary.Store(Object value)

6160 12:53:00 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

7520 12:53:01 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

9120 12:53:03 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

3600 12:53:03 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #0 12:53:07 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #0 12:53:07 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
 424 12:53:08 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

2472 12:53:08 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Core.BackgroundService.Run()

4424 12:53:09 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

6160 12:53:15 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

7520 12:53:16 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #8 12:53:17 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #8 12:53:17 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
9120 12:53:18 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

3600 12:53:18 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

 424 12:53:23 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #13 12:53:24 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
4424 12:53:24 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

5296 12:53:25 INFO  [Experience Analytics]: Reduce agent found zero sites to process
ManagedPoolThread #11 12:53:25 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #1 12:53:26 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #4 12:53:27 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #4 12:53:27 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
ManagedPoolThread #19 12:53:27 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #16 12:53:28 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #17 12:53:29 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
6160 12:53:30 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #14 12:53:30 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #3 12:53:31 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #6 12:53:32 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
9120 12:53:33 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #5 12:53:33 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
3600 12:53:33 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

2472 12:53:34 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: MongoDB.Driver.MongoConnectionException
Message: Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
Source: MongoDB.Driver
   at MongoDB.Driver.Internal.DirectMongoServerProxy.Connect(TimeSpan timeout, ReadPreference readPreference)
   at MongoDB.Driver.Internal.DirectMongoServerProxy.ChooseServerInstance(ReadPreference readPreference)
   at MongoDB.Driver.MongoServer.AcquireConnection(ReadPreference readPreference)
   at MongoDB.Driver.MongoCursor`1.MongoCursorConnectionProvider.AcquireConnection()
   at MongoDB.Driver.Operations.QueryOperation`1.GetFirstBatch(IConnectionProvider connectionProvider)
   at MongoDB.Driver.Operations.QueryOperation`1.Execute(IConnectionProvider connectionProvider)
   at System.Linq.Enumerable.FirstOrDefault[TSource](IEnumerable`1 source)
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Core.BackgroundService.Run()

Nested Exception

Exception: System.Net.Sockets.SocketException
Message: No connection could be made because the target machine actively refused it 127.0.0.1:27017
Source: System
   at System.Net.Sockets.Socket.DoConnect(EndPoint endPointSnapshot, SocketAddress socketAddress)
   at System.Net.Sockets.Socket.Connect(EndPoint remoteEP)
   at System.Net.Sockets.TcpClient.Connect(IPEndPoint remoteEP)
   at MongoDB.Driver.Internal.MongoConnection.Open()
   at MongoDB.Driver.Internal.MongoConnection.SendMessage(BsonBuffer buffer, Int32 requestId)
   at MongoDB.Driver.Internal.MongoConnection.SendMessage(MongoRequestMessage message)
   at MongoDB.Driver.Operations.CommandOperation`1.Execute(MongoConnection connection)
   at MongoDB.Driver.MongoServerInstance.Ping(MongoConnection connection)
   at MongoDB.Driver.MongoServerInstance.Connect()
   at MongoDB.Driver.Internal.DirectMongoServerProxy.Connect(TimeSpan timeout, ReadPreference readPreference)


ManagedPoolThread #15 12:53:35 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #7 12:53:36 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #8 12:53:37 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #8 12:53:37 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
ManagedPoolThread #10 12:53:37 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
 424 12:53:38 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #18 12:53:39 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
4424 12:53:39 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

7520 12:53:40 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
7520 12:53:40 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.HandleDatabaseException(ExceptionBehavior exceptionBehavior, Exception ex)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

Nested Exception

Exception: MongoDB.Driver.MongoConnectionException
Message: Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
Source: MongoDB.Driver
   at MongoDB.Driver.Internal.DirectMongoServerProxy.Connect(TimeSpan timeout, ReadPreference readPreference)
   at MongoDB.Driver.Internal.DirectMongoServerProxy.ChooseServerInstance(ReadPreference readPreference)
   at MongoDB.Driver.MongoServer.AcquireConnection(ReadPreference readPreference)
   at MongoDB.Driver.MongoCollection.RunCommandAs[TCommandResult](IMongoCommand command, ReadPreference readPreference, IBsonSerializer resultSerializer, IBsonSerializationOptions resultSerializationOptions)
   at MongoDB.Driver.MongoCollection.RunCommandAs[TCommandResult](IMongoCommand command, ReadPreference readPreference)
   at MongoDB.Driver.MongoCollection.FindAndModify(FindAndModifyArgs args)
   at MongoDB.Driver.MongoCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.<>c__DisplayClass2c.<FindAndModify>b__2b()
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)

Nested Exception

Exception: System.Net.Sockets.SocketException
Message: No connection could be made because the target machine actively refused it 127.0.0.1:27017
Source: System
   at System.Net.Sockets.Socket.DoConnect(EndPoint endPointSnapshot, SocketAddress socketAddress)
   at System.Net.Sockets.Socket.Connect(EndPoint remoteEP)
   at System.Net.Sockets.TcpClient.Connect(IPEndPoint remoteEP)
   at MongoDB.Driver.Internal.MongoConnection.Open()
   at MongoDB.Driver.Internal.MongoConnection.SendMessage(BsonBuffer buffer, Int32 requestId)
   at MongoDB.Driver.Internal.MongoConnection.SendMessage(MongoRequestMessage message)
   at MongoDB.Driver.Operations.CommandOperation`1.Execute(MongoConnection connection)
   at MongoDB.Driver.MongoServerInstance.Ping(MongoConnection connection)
   at MongoDB.Driver.MongoServerInstance.Connect()
   at MongoDB.Driver.Internal.DirectMongoServerProxy.Connect(TimeSpan timeout, ReadPreference readPreference)



ManagedPoolThread #12 12:53:41 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
6160 12:53:45 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #4 12:53:47 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #4 12:53:47 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
9120 12:53:48 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

3600 12:53:48 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

2472 12:53:49 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Core.BackgroundService.Run()

 424 12:53:53 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

4424 12:53:54 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

7520 12:53:55 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

5296 12:53:55 INFO  [Experience Analytics]: Reduce agent found zero sites to process
ManagedPoolThread #8 12:53:57 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #8 12:53:57 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
6160 12:54:00 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

9120 12:54:03 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

3600 12:54:03 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

2472 12:54:04 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #4 12:54:07 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #4 12:54:07 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
 424 12:54:08 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

4424 12:54:09 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

7520 12:54:10 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

6160 12:54:15 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #0 12:54:17 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #0 12:54:17 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
9120 12:54:18 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

3600 12:54:19 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

2472 12:54:19 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Core.BackgroundService.Run()

 424 12:54:23 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

4424 12:54:24 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

7520 12:54:25 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

5296 12:54:25 INFO  [Experience Analytics]: Reduce agent found zero sites to process
ManagedPoolThread #9 12:54:28 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #9 12:54:28 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
6160 12:54:30 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

9120 12:54:33 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

3600 12:54:35 ERROR Exception when executing agent aggregation/automationAggregator
Exception: MongoDB.Driver.MongoConnectionException
Message: Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
Source: MongoDB.Driver
   at MongoDB.Driver.Internal.DirectMongoServerProxy.Connect(TimeSpan timeout, ReadPreference readPreference)
   at MongoDB.Driver.Internal.DirectMongoServerProxy.ChooseServerInstance(ReadPreference readPreference)
   at MongoDB.Driver.MongoServer.AcquireConnection(ReadPreference readPreference)
   at MongoDB.Driver.MongoCursor`1.MongoCursorConnectionProvider.AcquireConnection()
   at MongoDB.Driver.Operations.QueryOperation`1.GetFirstBatch(IConnectionProvider connectionProvider)
   at MongoDB.Driver.Operations.QueryOperation`1.Execute(IConnectionProvider connectionProvider)
   at System.Linq.Buffer`1..ctor(IEnumerable`1 source)
   at System.Linq.Enumerable.ToArray[TSource](IEnumerable`1 source)
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

Nested Exception

Exception: System.Net.Sockets.SocketException
Message: No connection could be made because the target machine actively refused it 127.0.0.1:27017
Source: System
   at System.Net.Sockets.Socket.DoConnect(EndPoint endPointSnapshot, SocketAddress socketAddress)
   at System.Net.Sockets.Socket.Connect(EndPoint remoteEP)
   at System.Net.Sockets.TcpClient.Connect(IPEndPoint remoteEP)
   at MongoDB.Driver.Internal.MongoConnection.Open()
   at MongoDB.Driver.Internal.MongoConnection.SendMessage(BsonBuffer buffer, Int32 requestId)
   at MongoDB.Driver.Internal.MongoConnection.SendMessage(MongoRequestMessage message)
   at MongoDB.Driver.Operations.CommandOperation`1.Execute(MongoConnection connection)
   at MongoDB.Driver.MongoServerInstance.Ping(MongoConnection connection)
   at MongoDB.Driver.MongoServerInstance.Connect()
   at MongoDB.Driver.Internal.DirectMongoServerProxy.Connect(TimeSpan timeout, ReadPreference readPreference)


ManagedPoolThread #6 12:54:36 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #5 12:54:37 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #0 12:54:38 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #0 12:54:38 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
ManagedPoolThread #3 12:54:38 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
 424 12:54:38 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #14 12:54:39 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
4424 12:54:39 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #13 12:54:40 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #17 12:54:41 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #11 12:54:42 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #16 12:54:43 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #1 12:54:44 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #19 12:54:45 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
6160 12:54:45 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

2472 12:54:46 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: MongoDB.Driver.MongoConnectionException
Message: Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
Source: MongoDB.Driver
   at MongoDB.Driver.Internal.DirectMongoServerProxy.Connect(TimeSpan timeout, ReadPreference readPreference)
   at MongoDB.Driver.Internal.DirectMongoServerProxy.ChooseServerInstance(ReadPreference readPreference)
   at MongoDB.Driver.MongoServer.AcquireConnection(ReadPreference readPreference)
   at MongoDB.Driver.MongoCursor`1.MongoCursorConnectionProvider.AcquireConnection()
   at MongoDB.Driver.Operations.QueryOperation`1.GetFirstBatch(IConnectionProvider connectionProvider)
   at MongoDB.Driver.Operations.QueryOperation`1.Execute(IConnectionProvider connectionProvider)
   at System.Linq.Enumerable.FirstOrDefault[TSource](IEnumerable`1 source)
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Core.BackgroundService.Run()

Nested Exception

Exception: System.Net.Sockets.SocketException
Message: No connection could be made because the target machine actively refused it 127.0.0.1:27017
Source: System
   at System.Net.Sockets.Socket.DoConnect(EndPoint endPointSnapshot, SocketAddress socketAddress)
   at System.Net.Sockets.Socket.Connect(EndPoint remoteEP)
   at System.Net.Sockets.TcpClient.Connect(IPEndPoint remoteEP)
   at MongoDB.Driver.Internal.MongoConnection.Open()
   at MongoDB.Driver.Internal.MongoConnection.SendMessage(BsonBuffer buffer, Int32 requestId)
   at MongoDB.Driver.Internal.MongoConnection.SendMessage(MongoRequestMessage message)
   at MongoDB.Driver.Operations.CommandOperation`1.Execute(MongoConnection connection)
   at MongoDB.Driver.MongoServerInstance.Ping(MongoConnection connection)
   at MongoDB.Driver.MongoServerInstance.Connect()
   at MongoDB.Driver.Internal.DirectMongoServerProxy.Connect(TimeSpan timeout, ReadPreference readPreference)


ManagedPoolThread #15 12:54:47 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #9 12:54:48 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #9 12:54:48 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
7520 12:54:48 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
7520 12:54:48 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.HandleDatabaseException(ExceptionBehavior exceptionBehavior, Exception ex)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

Nested Exception

Exception: MongoDB.Driver.MongoConnectionException
Message: Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
Source: MongoDB.Driver
   at MongoDB.Driver.Internal.DirectMongoServerProxy.Connect(TimeSpan timeout, ReadPreference readPreference)
   at MongoDB.Driver.Internal.DirectMongoServerProxy.ChooseServerInstance(ReadPreference readPreference)
   at MongoDB.Driver.MongoServer.AcquireConnection(ReadPreference readPreference)
   at MongoDB.Driver.MongoCollection.RunCommandAs[TCommandResult](IMongoCommand command, ReadPreference readPreference, IBsonSerializer resultSerializer, IBsonSerializationOptions resultSerializationOptions)
   at MongoDB.Driver.MongoCollection.RunCommandAs[TCommandResult](IMongoCommand command, ReadPreference readPreference)
   at MongoDB.Driver.MongoCollection.FindAndModify(FindAndModifyArgs args)
   at MongoDB.Driver.MongoCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.<>c__DisplayClass2c.<FindAndModify>b__2b()
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)

Nested Exception

Exception: System.Net.Sockets.SocketException
Message: No connection could be made because the target machine actively refused it 127.0.0.1:27017
Source: System
   at System.Net.Sockets.Socket.DoConnect(EndPoint endPointSnapshot, SocketAddress socketAddress)
   at System.Net.Sockets.Socket.Connect(EndPoint remoteEP)
   at System.Net.Sockets.TcpClient.Connect(IPEndPoint remoteEP)
   at MongoDB.Driver.Internal.MongoConnection.Open()
   at MongoDB.Driver.Internal.MongoConnection.SendMessage(BsonBuffer buffer, Int32 requestId)
   at MongoDB.Driver.Internal.MongoConnection.SendMessage(MongoRequestMessage message)
   at MongoDB.Driver.Operations.CommandOperation`1.Execute(MongoConnection connection)
   at MongoDB.Driver.MongoServerInstance.Ping(MongoConnection connection)
   at MongoDB.Driver.MongoServerInstance.Connect()
   at MongoDB.Driver.Internal.DirectMongoServerProxy.Connect(TimeSpan timeout, ReadPreference readPreference)



9120 12:54:48 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #12 12:54:49 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
3600 12:54:50 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #7 12:54:50 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #10 12:54:51 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #18 12:54:52 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
 424 12:54:53 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

4424 12:54:54 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

5296 12:54:55 INFO  [Experience Analytics]: Reduce agent found zero sites to process
ManagedPoolThread #0 12:54:58 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #0 12:54:58 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
6160 12:55:00 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

Heartbeat 12:55:00 ERROR MongoDbDictionary.Store() has failed.
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Save(Object value)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbDictionary.Store(Object value)

2472 12:55:01 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Core.BackgroundService.Run()

7520 12:55:03 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

9120 12:55:03 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

3600 12:55:05 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #9 12:55:08 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #9 12:55:08 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
 424 12:55:08 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

4424 12:55:09 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

6160 12:55:15 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

2472 12:55:16 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #4 12:55:18 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #4 12:55:18 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
7520 12:55:18 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

9120 12:55:18 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

3600 12:55:20 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

 424 12:55:23 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

4424 12:55:25 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

5296 12:55:25 INFO  [Experience Analytics]: Reduce agent found zero sites to process
ManagedPoolThread #8 12:55:28 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #8 12:55:28 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
6160 12:55:30 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

2472 12:55:31 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Core.BackgroundService.Run()

7520 12:55:33 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

9120 12:55:33 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

3600 12:55:35 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #4 12:55:38 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #4 12:55:38 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
 424 12:55:38 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

4424 12:55:40 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

6160 12:55:46 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: MongoDB.Driver.MongoConnectionException
Message: Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
Source: MongoDB.Driver
   at MongoDB.Driver.Internal.DirectMongoServerProxy.Connect(TimeSpan timeout, ReadPreference readPreference)
   at MongoDB.Driver.Internal.DirectMongoServerProxy.ChooseServerInstance(ReadPreference readPreference)
   at MongoDB.Driver.MongoServer.AcquireConnection(ReadPreference readPreference)
   at MongoDB.Driver.MongoCursor`1.MongoCursorConnectionProvider.AcquireConnection()
   at MongoDB.Driver.Operations.QueryOperation`1.GetFirstBatch(IConnectionProvider connectionProvider)
   at MongoDB.Driver.Operations.QueryOperation`1.Execute(IConnectionProvider connectionProvider)
   at System.Linq.Enumerable.FirstOrDefault[TSource](IEnumerable`1 source)
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

Nested Exception

Exception: System.Net.Sockets.SocketException
Message: No connection could be made because the target machine actively refused it 127.0.0.1:27017
Source: System
   at System.Net.Sockets.Socket.DoConnect(EndPoint endPointSnapshot, SocketAddress socketAddress)
   at System.Net.Sockets.Socket.Connect(EndPoint remoteEP)
   at System.Net.Sockets.TcpClient.Connect(IPEndPoint remoteEP)
   at MongoDB.Driver.Internal.MongoConnection.Open()
   at MongoDB.Driver.Internal.MongoConnection.SendMessage(BsonBuffer buffer, Int32 requestId)
   at MongoDB.Driver.Internal.MongoConnection.SendMessage(MongoRequestMessage message)
   at MongoDB.Driver.Operations.CommandOperation`1.Execute(MongoConnection connection)
   at MongoDB.Driver.MongoServerInstance.Ping(MongoConnection connection)
   at MongoDB.Driver.MongoServerInstance.Connect()
   at MongoDB.Driver.Internal.DirectMongoServerProxy.Connect(TimeSpan timeout, ReadPreference readPreference)


ManagedPoolThread #6 12:55:47 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #8 12:55:48 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #8 12:55:48 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
7520 12:55:48 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #5 12:55:48 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
9120 12:55:48 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #14 12:55:49 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
3600 12:55:50 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #11 12:55:50 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #16 12:55:51 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #19 12:55:52 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
 424 12:55:53 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #17 12:55:53 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #1 12:55:54 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
4424 12:55:55 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

5296 12:55:55 INFO  [Experience Analytics]: Reduce agent found zero sites to process
ManagedPoolThread #3 12:55:55 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #13 12:55:56 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
2472 12:55:57 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: MongoDB.Driver.MongoConnectionException
Message: Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
Source: MongoDB.Driver
   at MongoDB.Driver.Internal.DirectMongoServerProxy.Connect(TimeSpan timeout, ReadPreference readPreference)
   at MongoDB.Driver.Internal.DirectMongoServerProxy.ChooseServerInstance(ReadPreference readPreference)
   at MongoDB.Driver.MongoServer.AcquireConnection(ReadPreference readPreference)
   at MongoDB.Driver.MongoCursor`1.MongoCursorConnectionProvider.AcquireConnection()
   at MongoDB.Driver.Operations.QueryOperation`1.GetFirstBatch(IConnectionProvider connectionProvider)
   at MongoDB.Driver.Operations.QueryOperation`1.Execute(IConnectionProvider connectionProvider)
   at System.Linq.Enumerable.FirstOrDefault[TSource](IEnumerable`1 source)
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Core.BackgroundService.Run()

Nested Exception

Exception: System.Net.Sockets.SocketException
Message: No connection could be made because the target machine actively refused it 127.0.0.1:27017
Source: System
   at System.Net.Sockets.Socket.DoConnect(EndPoint endPointSnapshot, SocketAddress socketAddress)
   at System.Net.Sockets.Socket.Connect(EndPoint remoteEP)
   at System.Net.Sockets.TcpClient.Connect(IPEndPoint remoteEP)
   at MongoDB.Driver.Internal.MongoConnection.Open()
   at MongoDB.Driver.Internal.MongoConnection.SendMessage(BsonBuffer buffer, Int32 requestId)
   at MongoDB.Driver.Internal.MongoConnection.SendMessage(MongoRequestMessage message)
   at MongoDB.Driver.Operations.CommandOperation`1.Execute(MongoConnection connection)
   at MongoDB.Driver.MongoServerInstance.Ping(MongoConnection connection)
   at MongoDB.Driver.MongoServerInstance.Connect()
   at MongoDB.Driver.Internal.DirectMongoServerProxy.Connect(TimeSpan timeout, ReadPreference readPreference)


ManagedPoolThread #9 12:55:58 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #9 12:55:58 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
7740 12:55:58 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #15 12:55:59 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #10 12:56:00 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
6160 12:56:01 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #18 12:56:01 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #12 12:56:02 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
7520 12:56:03 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

9120 12:56:03 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #7 12:56:03 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
3600 12:56:05 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

 424 12:56:08 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #0 12:56:08 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #0 12:56:08 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
4424 12:56:10 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

2472 12:56:12 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Core.BackgroundService.Run()

6160 12:56:16 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #8 12:56:18 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #8 12:56:18 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
7520 12:56:18 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

9120 12:56:18 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

3600 12:56:20 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

 424 12:56:23 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

5056 12:56:23 INFO  [Path Analyzer](.) Running trail cleanup agent
5056 12:56:23 INFO  [Path Analyzer](.) Running trail cleanup on database
4424 12:56:25 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

5296 12:56:25 INFO  [Experience Analytics]: Reduce agent found zero sites to process
2472 12:56:27 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #4 12:56:28 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #4 12:56:28 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
6160 12:56:31 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

7520 12:56:33 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

9120 12:56:33 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

3600 12:56:35 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

 424 12:56:38 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #8 12:56:38 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #8 12:56:38 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
4424 12:56:40 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

2472 12:56:42 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Core.BackgroundService.Run()

6160 12:56:46 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #0 12:56:48 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #0 12:56:48 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
7520 12:56:48 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

9120 12:56:48 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

3600 12:56:50 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

 424 12:56:53 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

4424 12:56:55 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

5296 12:56:55 INFO  [Experience Analytics]: Reduce agent found zero sites to process
2472 12:56:57 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #8 12:56:58 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #8 12:56:58 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
7740 12:56:59 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #6 12:57:00 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
6160 12:57:01 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

Heartbeat 12:57:01 ERROR MongoDbDictionary.Store() has failed.
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Save(Object value)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbDictionary.Store(Object value)

ManagedPoolThread #5 12:57:01 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #14 12:57:02 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
7520 12:57:03 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #11 12:57:03 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
9120 12:57:03 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #1 12:57:04 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
3600 12:57:05 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #13 12:57:05 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #3 12:57:06 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #17 12:57:07 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
 424 12:57:08 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #0 12:57:08 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #0 12:57:08 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
ManagedPoolThread #19 12:57:08 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #16 12:57:09 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
4424 12:57:10 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #15 12:57:10 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #12 12:57:11 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
2472 12:57:12 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #7 12:57:12 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #10 12:57:13 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #18 12:57:14 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
6160 12:57:16 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

7520 12:57:18 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #9 12:57:18 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #9 12:57:18 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
9120 12:57:18 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

3600 12:57:20 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

 424 12:57:23 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

4424 12:57:25 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

5296 12:57:25 INFO  [Experience Analytics]: Reduce agent found zero sites to process
2472 12:57:27 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #4 12:57:28 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #4 12:57:28 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
6160 12:57:31 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

7520 12:57:33 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

9120 12:57:33 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

3600 12:57:35 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

 424 12:57:38 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #9 12:57:38 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #9 12:57:38 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
4424 12:57:40 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

2472 12:57:42 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Core.BackgroundService.Run()

6160 12:57:46 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

7520 12:57:48 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #4 12:57:48 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #4 12:57:48 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
9120 12:57:48 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

3600 12:57:50 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

 424 12:57:53 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

4424 12:57:55 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

5296 12:57:55 INFO  [Experience Analytics]: Reduce agent found zero sites to process
2472 12:57:57 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #9 12:57:58 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #9 12:57:58 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
6160 12:58:01 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

7520 12:58:03 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

9120 12:58:03 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

3600 12:58:05 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

 424 12:58:08 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #4 12:58:08 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #4 12:58:08 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
4424 12:58:11 ERROR Exception when executing agent aggregation/automationAggregator
Exception: MongoDB.Driver.MongoConnectionException
Message: Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
Source: MongoDB.Driver
   at MongoDB.Driver.Internal.DirectMongoServerProxy.Connect(TimeSpan timeout, ReadPreference readPreference)
   at MongoDB.Driver.Internal.DirectMongoServerProxy.ChooseServerInstance(ReadPreference readPreference)
   at MongoDB.Driver.MongoServer.AcquireConnection(ReadPreference readPreference)
   at MongoDB.Driver.MongoCursor`1.MongoCursorConnectionProvider.AcquireConnection()
   at MongoDB.Driver.Operations.QueryOperation`1.GetFirstBatch(IConnectionProvider connectionProvider)
   at MongoDB.Driver.Operations.QueryOperation`1.Execute(IConnectionProvider connectionProvider)
   at System.Linq.Buffer`1..ctor(IEnumerable`1 source)
   at System.Linq.Enumerable.ToArray[TSource](IEnumerable`1 source)
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

Nested Exception

Exception: System.Net.Sockets.SocketException
Message: No connection could be made because the target machine actively refused it 127.0.0.1:27017
Source: System
   at System.Net.Sockets.Socket.DoConnect(EndPoint endPointSnapshot, SocketAddress socketAddress)
   at System.Net.Sockets.Socket.Connect(EndPoint remoteEP)
   at System.Net.Sockets.TcpClient.Connect(IPEndPoint remoteEP)
   at MongoDB.Driver.Internal.MongoConnection.Open()
   at MongoDB.Driver.Internal.MongoConnection.SendMessage(BsonBuffer buffer, Int32 requestId)
   at MongoDB.Driver.Internal.MongoConnection.SendMessage(MongoRequestMessage message)
   at MongoDB.Driver.Operations.CommandOperation`1.Execute(MongoConnection connection)
   at MongoDB.Driver.MongoServerInstance.Ping(MongoConnection connection)
   at MongoDB.Driver.MongoServerInstance.Connect()
   at MongoDB.Driver.Internal.DirectMongoServerProxy.Connect(TimeSpan timeout, ReadPreference readPreference)


ManagedPoolThread #2 12:58:12 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
2472 12:58:12 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #3 12:58:13 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #11 12:58:14 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #1 12:58:15 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #6 12:58:16 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
6160 12:58:16 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #17 12:58:17 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #19 12:58:18 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #0 12:58:18 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #0 12:58:18 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
9120 12:58:18 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #13 12:58:19 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
3600 12:58:20 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #16 12:58:20 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #5 12:58:21 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #14 12:58:22 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
 424 12:58:23 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #15 12:58:23 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #10 12:58:24 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
5296 12:58:25 INFO  [Experience Analytics]: Reduce agent found zero sites to process
ManagedPoolThread #18 12:58:25 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
4424 12:58:26 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

7520 12:58:26 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
7520 12:58:26 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.HandleDatabaseException(ExceptionBehavior exceptionBehavior, Exception ex)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

Nested Exception

Exception: MongoDB.Driver.MongoConnectionException
Message: Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
Source: MongoDB.Driver
   at MongoDB.Driver.Internal.DirectMongoServerProxy.Connect(TimeSpan timeout, ReadPreference readPreference)
   at MongoDB.Driver.Internal.DirectMongoServerProxy.ChooseServerInstance(ReadPreference readPreference)
   at MongoDB.Driver.MongoServer.AcquireConnection(ReadPreference readPreference)
   at MongoDB.Driver.MongoCollection.RunCommandAs[TCommandResult](IMongoCommand command, ReadPreference readPreference, IBsonSerializer resultSerializer, IBsonSerializationOptions resultSerializationOptions)
   at MongoDB.Driver.MongoCollection.RunCommandAs[TCommandResult](IMongoCommand command, ReadPreference readPreference)
   at MongoDB.Driver.MongoCollection.FindAndModify(FindAndModifyArgs args)
   at MongoDB.Driver.MongoCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.<>c__DisplayClass2c.<FindAndModify>b__2b()
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)

Nested Exception

Exception: System.Net.Sockets.SocketException
Message: No connection could be made because the target machine actively refused it 127.0.0.1:27017
Source: System
   at System.Net.Sockets.Socket.DoConnect(EndPoint endPointSnapshot, SocketAddress socketAddress)
   at System.Net.Sockets.Socket.Connect(EndPoint remoteEP)
   at System.Net.Sockets.TcpClient.Connect(IPEndPoint remoteEP)
   at MongoDB.Driver.Internal.MongoConnection.Open()
   at MongoDB.Driver.Internal.MongoConnection.SendMessage(BsonBuffer buffer, Int32 requestId)
   at MongoDB.Driver.Internal.MongoConnection.SendMessage(MongoRequestMessage message)
   at MongoDB.Driver.Operations.CommandOperation`1.Execute(MongoConnection connection)
   at MongoDB.Driver.MongoServerInstance.Ping(MongoConnection connection)
   at MongoDB.Driver.MongoServerInstance.Connect()
   at MongoDB.Driver.Internal.DirectMongoServerProxy.Connect(TimeSpan timeout, ReadPreference readPreference)



ManagedPoolThread #12 12:58:27 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
2472 12:58:27 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #7 12:58:28 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #8 12:58:28 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #8 12:58:28 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
6160 12:58:31 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

9120 12:58:33 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

3600 12:58:35 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

 424 12:58:38 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #0 12:58:38 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #0 12:58:38 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
4424 12:58:41 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

7520 12:58:41 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

2472 12:58:42 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Core.BackgroundService.Run()

6160 12:58:46 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #8 12:58:48 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #8 12:58:48 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
9120 12:58:48 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

3600 12:58:50 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

 424 12:58:53 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

5296 12:58:55 INFO  [Experience Analytics]: Reduce agent found zero sites to process
4424 12:58:56 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

7520 12:58:56 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

2472 12:58:57 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #4 12:58:58 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #4 12:58:58 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
6160 12:59:01 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

Heartbeat 12:59:02 ERROR MongoDbDictionary.Store() has failed.
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Save(Object value)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbDictionary.Store(Object value)

9120 12:59:03 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

3600 12:59:05 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

 424 12:59:08 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #9 12:59:08 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #9 12:59:08 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
4424 12:59:11 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

7520 12:59:11 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

2472 12:59:12 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Core.BackgroundService.Run()

6160 12:59:16 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #4 12:59:18 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #4 12:59:18 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
9120 12:59:18 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

3600 12:59:20 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #13 12:59:23 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #17 12:59:24 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
5296 12:59:25 INFO  [Experience Analytics]: Reduce agent found zero sites to process
ManagedPoolThread #16 12:59:25 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
4424 12:59:26 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

7520 12:59:26 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #14 12:59:26 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
2472 12:59:27 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #19 12:59:27 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #0 12:59:28 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #0 12:59:28 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
ManagedPoolThread #6 12:59:28 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #5 12:59:29 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #3 12:59:30 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
6160 12:59:31 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #1 12:59:31 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #11 12:59:32 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
9120 12:59:33 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

 424 12:59:33 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: MongoDB.Driver.MongoConnectionException
Message: Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
Source: MongoDB.Driver
   at MongoDB.Driver.Internal.DirectMongoServerProxy.Connect(TimeSpan timeout, ReadPreference readPreference)
   at MongoDB.Driver.Internal.DirectMongoServerProxy.ChooseServerInstance(ReadPreference readPreference)
   at MongoDB.Driver.MongoServer.AcquireConnection(ReadPreference readPreference)
   at MongoDB.Driver.MongoCursor`1.MongoCursorConnectionProvider.AcquireConnection()
   at MongoDB.Driver.Operations.QueryOperation`1.GetFirstBatch(IConnectionProvider connectionProvider)
   at MongoDB.Driver.Operations.QueryOperation`1.Execute(IConnectionProvider connectionProvider)
   at System.Linq.Enumerable.FirstOrDefault[TSource](IEnumerable`1 source)
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

Nested Exception

Exception: System.Net.Sockets.SocketException
Message: No connection could be made because the target machine actively refused it 127.0.0.1:27017
Source: System
   at System.Net.Sockets.Socket.DoConnect(EndPoint endPointSnapshot, SocketAddress socketAddress)
   at System.Net.Sockets.Socket.Connect(EndPoint remoteEP)
   at System.Net.Sockets.TcpClient.Connect(IPEndPoint remoteEP)
   at MongoDB.Driver.Internal.MongoConnection.Open()
   at MongoDB.Driver.Internal.MongoConnection.SendMessage(BsonBuffer buffer, Int32 requestId)
   at MongoDB.Driver.Internal.MongoConnection.SendMessage(MongoRequestMessage message)
   at MongoDB.Driver.Operations.CommandOperation`1.Execute(MongoConnection connection)
   at MongoDB.Driver.MongoServerInstance.Ping(MongoConnection connection)
   at MongoDB.Driver.MongoServerInstance.Connect()
   at MongoDB.Driver.Internal.DirectMongoServerProxy.Connect(TimeSpan timeout, ReadPreference readPreference)


ManagedPoolThread #15 12:59:34 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
3600 12:59:35 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #12 12:59:36 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #7 12:59:37 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #10 12:59:38 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #8 12:59:38 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #8 12:59:38 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
ManagedPoolThread #18 12:59:39 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
4424 12:59:41 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

7520 12:59:41 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

2472 12:59:42 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Core.BackgroundService.Run()

6160 12:59:46 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #0 12:59:48 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #0 12:59:48 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
9120 12:59:48 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

 424 12:59:48 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

3600 12:59:50 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

5296 12:59:55 INFO  [Experience Analytics]: Reduce agent found zero sites to process
4424 12:59:56 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

7520 12:59:56 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

2472 12:59:57 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #8 12:59:58 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #8 12:59:58 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
6160 13:00:01 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

9120 13:00:03 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

 424 13:00:03 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

3600 13:00:05 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #0 13:00:08 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #0 13:00:08 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
4424 13:00:11 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

7520 13:00:11 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

2472 13:00:12 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Core.BackgroundService.Run()

6160 13:00:16 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #8 13:00:18 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #8 13:00:18 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
9120 13:00:18 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

 424 13:00:19 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

3600 13:00:20 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

5296 13:00:25 INFO  [Experience Analytics]: Reduce agent found zero sites to process
4424 13:00:26 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

7520 13:00:26 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

2472 13:00:27 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #4 13:00:28 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #4 13:00:28 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
6160 13:00:31 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #13 13:00:34 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
3600 13:00:35 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #17 13:00:35 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #1 13:00:36 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #19 13:00:37 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #3 13:00:38 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #9 13:00:38 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #9 13:00:38 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
ManagedPoolThread #14 13:00:39 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #16 13:00:40 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
4424 13:00:41 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #11 13:00:41 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #5 13:00:42 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
2472 13:00:42 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #6 13:00:43 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
9120 13:00:44 ERROR Exception when executing agent aggregation/automationAggregator
Exception: MongoDB.Driver.MongoConnectionException
Message: Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
Source: MongoDB.Driver
   at MongoDB.Driver.Internal.DirectMongoServerProxy.Connect(TimeSpan timeout, ReadPreference readPreference)
   at MongoDB.Driver.Internal.DirectMongoServerProxy.ChooseServerInstance(ReadPreference readPreference)
   at MongoDB.Driver.MongoServer.AcquireConnection(ReadPreference readPreference)
   at MongoDB.Driver.MongoCursor`1.MongoCursorConnectionProvider.AcquireConnection()
   at MongoDB.Driver.Operations.QueryOperation`1.GetFirstBatch(IConnectionProvider connectionProvider)
   at MongoDB.Driver.Operations.QueryOperation`1.Execute(IConnectionProvider connectionProvider)
   at System.Linq.Buffer`1..ctor(IEnumerable`1 source)
   at System.Linq.Enumerable.ToArray[TSource](IEnumerable`1 source)
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

Nested Exception

Exception: System.Net.Sockets.SocketException
Message: No connection could be made because the target machine actively refused it 127.0.0.1:27017
Source: System
   at System.Net.Sockets.Socket.DoConnect(EndPoint endPointSnapshot, SocketAddress socketAddress)
   at System.Net.Sockets.Socket.Connect(EndPoint remoteEP)
   at System.Net.Sockets.TcpClient.Connect(IPEndPoint remoteEP)
   at MongoDB.Driver.Internal.MongoConnection.Open()
   at MongoDB.Driver.Internal.MongoConnection.SendMessage(BsonBuffer buffer, Int32 requestId)
   at MongoDB.Driver.Internal.MongoConnection.SendMessage(MongoRequestMessage message)
   at MongoDB.Driver.Operations.CommandOperation`1.Execute(MongoConnection connection)
   at MongoDB.Driver.MongoServerInstance.Ping(MongoConnection connection)
   at MongoDB.Driver.MongoServerInstance.Connect()
   at MongoDB.Driver.Internal.DirectMongoServerProxy.Connect(TimeSpan timeout, ReadPreference readPreference)


 424 13:00:45 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: MongoDB.Driver.MongoConnectionException
Message: Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
Source: MongoDB.Driver
   at MongoDB.Driver.Internal.DirectMongoServerProxy.Connect(TimeSpan timeout, ReadPreference readPreference)
   at MongoDB.Driver.Internal.DirectMongoServerProxy.ChooseServerInstance(ReadPreference readPreference)
   at MongoDB.Driver.MongoServer.AcquireConnection(ReadPreference readPreference)
   at MongoDB.Driver.MongoCursor`1.MongoCursorConnectionProvider.AcquireConnection()
   at MongoDB.Driver.Operations.QueryOperation`1.GetFirstBatch(IConnectionProvider connectionProvider)
   at MongoDB.Driver.Operations.QueryOperation`1.Execute(IConnectionProvider connectionProvider)
   at System.Linq.Enumerable.FirstOrDefault[TSource](IEnumerable`1 source)
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

Nested Exception

Exception: System.Net.Sockets.SocketException
Message: No connection could be made because the target machine actively refused it 127.0.0.1:27017
Source: System
   at System.Net.Sockets.Socket.DoConnect(EndPoint endPointSnapshot, SocketAddress socketAddress)
   at System.Net.Sockets.Socket.Connect(EndPoint remoteEP)
   at System.Net.Sockets.TcpClient.Connect(IPEndPoint remoteEP)
   at MongoDB.Driver.Internal.MongoConnection.Open()
   at MongoDB.Driver.Internal.MongoConnection.SendMessage(BsonBuffer buffer, Int32 requestId)
   at MongoDB.Driver.Internal.MongoConnection.SendMessage(MongoRequestMessage message)
   at MongoDB.Driver.Operations.CommandOperation`1.Execute(MongoConnection connection)
   at MongoDB.Driver.MongoServerInstance.Ping(MongoConnection connection)
   at MongoDB.Driver.MongoServerInstance.Connect()
   at MongoDB.Driver.Internal.DirectMongoServerProxy.Connect(TimeSpan timeout, ReadPreference readPreference)


6160 13:00:46 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #15 13:00:46 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #10 13:00:47 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #4 13:00:48 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #4 13:00:48 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
ManagedPoolThread #18 13:00:48 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
7520 13:00:49 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
7520 13:00:49 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.HandleDatabaseException(ExceptionBehavior exceptionBehavior, Exception ex)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

Nested Exception

Exception: MongoDB.Driver.MongoConnectionException
Message: Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
Source: MongoDB.Driver
   at MongoDB.Driver.Internal.DirectMongoServerProxy.Connect(TimeSpan timeout, ReadPreference readPreference)
   at MongoDB.Driver.Internal.DirectMongoServerProxy.ChooseServerInstance(ReadPreference readPreference)
   at MongoDB.Driver.MongoServer.AcquireConnection(ReadPreference readPreference)
   at MongoDB.Driver.MongoCollection.RunCommandAs[TCommandResult](IMongoCommand command, ReadPreference readPreference, IBsonSerializer resultSerializer, IBsonSerializationOptions resultSerializationOptions)
   at MongoDB.Driver.MongoCollection.RunCommandAs[TCommandResult](IMongoCommand command, ReadPreference readPreference)
   at MongoDB.Driver.MongoCollection.FindAndModify(FindAndModifyArgs args)
   at MongoDB.Driver.MongoCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.<>c__DisplayClass2c.<FindAndModify>b__2b()
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)

Nested Exception

Exception: System.Net.Sockets.SocketException
Message: No connection could be made because the target machine actively refused it 127.0.0.1:27017
Source: System
   at System.Net.Sockets.Socket.DoConnect(EndPoint endPointSnapshot, SocketAddress socketAddress)
   at System.Net.Sockets.Socket.Connect(EndPoint remoteEP)
   at System.Net.Sockets.TcpClient.Connect(IPEndPoint remoteEP)
   at MongoDB.Driver.Internal.MongoConnection.Open()
   at MongoDB.Driver.Internal.MongoConnection.SendMessage(BsonBuffer buffer, Int32 requestId)
   at MongoDB.Driver.Internal.MongoConnection.SendMessage(MongoRequestMessage message)
   at MongoDB.Driver.Operations.CommandOperation`1.Execute(MongoConnection connection)
   at MongoDB.Driver.MongoServerInstance.Ping(MongoConnection connection)
   at MongoDB.Driver.MongoServerInstance.Connect()
   at MongoDB.Driver.Internal.DirectMongoServerProxy.Connect(TimeSpan timeout, ReadPreference readPreference)



3600 13:00:50 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #12 13:00:50 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #7 13:00:51 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
5296 13:00:55 INFO  [Experience Analytics]: Reduce agent found zero sites to process
4424 13:00:56 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

2472 13:00:57 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #9 13:00:58 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #9 13:00:58 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
9120 13:00:59 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

 424 13:01:00 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

6160 13:01:01 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

Heartbeat 13:01:03 ERROR MongoDbDictionary.Store() has failed.
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Save(Object value)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbDictionary.Store(Object value)

7520 13:01:04 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

3600 13:01:05 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #4 13:01:08 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #4 13:01:08 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
4424 13:01:11 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

2472 13:01:12 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Core.BackgroundService.Run()

9120 13:01:14 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

 424 13:01:15 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

6160 13:01:16 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #9 13:01:18 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #9 13:01:18 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
7520 13:01:19 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

3600 13:01:20 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

Heartbeat 13:01:23 INFO  Health.PrivateBytes: 714,330,112
Heartbeat 13:01:23 INFO  Health.CacheInstances: 115
Heartbeat 13:01:23 INFO  Health.CacheTotalCount: 18,100
Heartbeat 13:01:23 INFO  Health.CacheTotalSize: 75,523,756
5056 13:01:23 INFO  [Path Analyzer](.) Running trail cleanup agent
5056 13:01:23 INFO  [Path Analyzer](.) Running trail cleanup on database
5296 13:01:25 INFO  [Experience Analytics]: Reduce agent found zero sites to process
4424 13:01:26 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

2472 13:01:27 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #4 13:01:28 INFO  Job started: Sitecore.Tasks.TaskDatabaseAgent
ManagedPoolThread #4 13:01:28 INFO  Processing tasks (count: 0)
ManagedPoolThread #4 13:01:28 INFO  Job ended: Sitecore.Tasks.TaskDatabaseAgent (units processed: )
ManagedPoolThread #8 13:01:28 INFO  Job started: Core_Database_Agent
ManagedPoolThread #8 13:01:28 INFO  Scheduling.DatabaseAgent started. Database: core
ManagedPoolThread #8 13:01:28 INFO  Examining schedules (count: 0)
ManagedPoolThread #8 13:01:28 INFO  Job ended: Core_Database_Agent (units processed: )
ManagedPoolThread #4 13:01:28 INFO  Job started: Master_Database_Agent
ManagedPoolThread #4 13:01:28 INFO  Scheduling.DatabaseAgent started. Database: master
ManagedPoolThread #4 13:01:28 INFO  Examining schedules (count: 5)
ManagedPoolThread #4 13:01:28 INFO  Starting: __Task Schedule
ManagedPoolThread #4 13:01:28 INFO  Ended: __Task Schedule
ManagedPoolThread #4 13:01:28 INFO  Not due: Calculate Statistical Relevancy
ManagedPoolThread #4 13:01:28 INFO  Not due: Rebuild Suggested Tests Index
ManagedPoolThread #4 13:01:28 INFO  Not due: Suspend Corrupted Tests
ManagedPoolThread #4 13:01:28 INFO  Not due: Try Finish Test
ManagedPoolThread #4 13:01:28 INFO  Job ended: Master_Database_Agent (units processed: 5)
ManagedPoolThread #8 13:01:28 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #8 13:01:28 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
9120 13:01:29 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

 424 13:01:30 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

6160 13:01:31 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

7520 13:01:34 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

3600 13:01:35 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #4 13:01:38 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #4 13:01:38 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
4424 13:01:41 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

2472 13:01:42 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #13 13:01:45 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
 424 13:01:45 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #17 13:01:46 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
6160 13:01:46 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #1 13:01:47 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #19 13:01:48 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #8 13:01:48 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #8 13:01:48 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
ManagedPoolThread #14 13:01:49 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
7520 13:01:49 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

3600 13:01:50 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #6 13:01:50 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #5 13:01:51 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #16 13:01:52 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #11 13:01:53 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #3 13:01:54 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
5296 13:01:55 INFO  [Experience Analytics]: Reduce agent found zero sites to process
9120 13:01:55 ERROR Exception when executing agent aggregation/automationAggregator
Exception: MongoDB.Driver.MongoConnectionException
Message: Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
Source: MongoDB.Driver
   at MongoDB.Driver.Internal.DirectMongoServerProxy.Connect(TimeSpan timeout, ReadPreference readPreference)
   at MongoDB.Driver.Internal.DirectMongoServerProxy.ChooseServerInstance(ReadPreference readPreference)
   at MongoDB.Driver.MongoServer.AcquireConnection(ReadPreference readPreference)
   at MongoDB.Driver.MongoCursor`1.MongoCursorConnectionProvider.AcquireConnection()
   at MongoDB.Driver.Operations.QueryOperation`1.GetFirstBatch(IConnectionProvider connectionProvider)
   at MongoDB.Driver.Operations.QueryOperation`1.Execute(IConnectionProvider connectionProvider)
   at System.Linq.Buffer`1..ctor(IEnumerable`1 source)
   at System.Linq.Enumerable.ToArray[TSource](IEnumerable`1 source)
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

Nested Exception

Exception: System.Net.Sockets.SocketException
Message: No connection could be made because the target machine actively refused it 127.0.0.1:27017
Source: System
   at System.Net.Sockets.Socket.DoConnect(EndPoint endPointSnapshot, SocketAddress socketAddress)
   at System.Net.Sockets.Socket.Connect(EndPoint remoteEP)
   at System.Net.Sockets.TcpClient.Connect(IPEndPoint remoteEP)
   at MongoDB.Driver.Internal.MongoConnection.Open()
   at MongoDB.Driver.Internal.MongoConnection.SendMessage(BsonBuffer buffer, Int32 requestId)
   at MongoDB.Driver.Internal.MongoConnection.SendMessage(MongoRequestMessage message)
   at MongoDB.Driver.Operations.CommandOperation`1.Execute(MongoConnection connection)
   at MongoDB.Driver.MongoServerInstance.Ping(MongoConnection connection)
   at MongoDB.Driver.MongoServerInstance.Connect()
   at MongoDB.Driver.Internal.DirectMongoServerProxy.Connect(TimeSpan timeout, ReadPreference readPreference)


4424 13:01:56 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

7740 13:01:56 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #15 13:01:57 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
2472 13:01:57 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #12 13:01:58 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #4 13:01:58 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #4 13:01:58 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
ManagedPoolThread #7 13:01:59 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #10 13:02:00 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
 424 13:02:00 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

6160 13:02:01 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

7520 13:02:04 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

3600 13:02:05 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #9 13:02:08 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #9 13:02:08 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
9120 13:02:10 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

4424 13:02:11 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

2472 13:02:12 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Core.BackgroundService.Run()

 424 13:02:15 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

6160 13:02:16 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #0 13:02:18 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #0 13:02:18 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
7520 13:02:19 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

3600 13:02:20 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

5296 13:02:25 INFO  [Experience Analytics]: Reduce agent found zero sites to process
9120 13:02:25 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

4424 13:02:26 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

2472 13:02:27 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #4 13:02:28 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #4 13:02:28 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
 424 13:02:30 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

6160 13:02:31 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

7520 13:02:34 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

3600 13:02:35 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #8 13:02:38 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #8 13:02:38 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
9120 13:02:40 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

4424 13:02:41 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

2472 13:02:42 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Core.BackgroundService.Run()

 424 13:02:45 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

6160 13:02:46 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #4 13:02:48 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #4 13:02:48 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
7520 13:02:49 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

3600 13:02:50 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

5296 13:02:55 INFO  [Experience Analytics]: Reduce agent found zero sites to process
9120 13:02:55 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

4424 13:02:56 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

7740 13:02:57 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
2472 13:02:57 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #1 13:02:58 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #8 13:02:58 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #8 13:02:58 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
ManagedPoolThread #13 13:02:59 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #19 13:03:00 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
 424 13:03:00 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #17 13:03:01 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
6160 13:03:01 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #14 13:03:02 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #6 13:03:03 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
Heartbeat 13:03:04 ERROR MongoDbDictionary.Store() has failed.
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Save(Object value)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbDictionary.Store(Object value)

ManagedPoolThread #5 13:03:04 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
3600 13:03:05 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #11 13:03:05 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #16 13:03:06 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #3 13:03:07 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #15 13:03:08 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #4 13:03:08 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #4 13:03:08 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
ManagedPoolThread #12 13:03:09 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
9120 13:03:10 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #18 13:03:10 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
4424 13:03:11 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #10 13:03:11 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
7520 13:03:12 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
7520 13:03:12 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.HandleDatabaseException(ExceptionBehavior exceptionBehavior, Exception ex)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

Nested Exception

Exception: MongoDB.Driver.MongoConnectionException
Message: Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
Source: MongoDB.Driver
   at MongoDB.Driver.Internal.DirectMongoServerProxy.Connect(TimeSpan timeout, ReadPreference readPreference)
   at MongoDB.Driver.Internal.DirectMongoServerProxy.ChooseServerInstance(ReadPreference readPreference)
   at MongoDB.Driver.MongoServer.AcquireConnection(ReadPreference readPreference)
   at MongoDB.Driver.MongoCollection.RunCommandAs[TCommandResult](IMongoCommand command, ReadPreference readPreference, IBsonSerializer resultSerializer, IBsonSerializationOptions resultSerializationOptions)
   at MongoDB.Driver.MongoCollection.RunCommandAs[TCommandResult](IMongoCommand command, ReadPreference readPreference)
   at MongoDB.Driver.MongoCollection.FindAndModify(FindAndModifyArgs args)
   at MongoDB.Driver.MongoCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.<>c__DisplayClass2c.<FindAndModify>b__2b()
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)

Nested Exception

Exception: System.Net.Sockets.SocketException
Message: No connection could be made because the target machine actively refused it 127.0.0.1:27017
Source: System
   at System.Net.Sockets.Socket.DoConnect(EndPoint endPointSnapshot, SocketAddress socketAddress)
   at System.Net.Sockets.Socket.Connect(EndPoint remoteEP)
   at System.Net.Sockets.TcpClient.Connect(IPEndPoint remoteEP)
   at MongoDB.Driver.Internal.MongoConnection.Open()
   at MongoDB.Driver.Internal.MongoConnection.SendMessage(BsonBuffer buffer, Int32 requestId)
   at MongoDB.Driver.Internal.MongoConnection.SendMessage(MongoRequestMessage message)
   at MongoDB.Driver.Operations.CommandOperation`1.Execute(MongoConnection connection)
   at MongoDB.Driver.MongoServerInstance.Ping(MongoConnection connection)
   at MongoDB.Driver.MongoServerInstance.Connect()
   at MongoDB.Driver.Internal.DirectMongoServerProxy.Connect(TimeSpan timeout, ReadPreference readPreference)



2472 13:03:12 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #7 13:03:13 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
 424 13:03:15 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

6160 13:03:16 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #8 13:03:19 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #8 13:03:19 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
3600 13:03:20 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

5296 13:03:25 INFO  [Experience Analytics]: Reduce agent found zero sites to process
9120 13:03:25 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

4424 13:03:26 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

7520 13:03:27 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

2472 13:03:27 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #0 13:03:29 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #0 13:03:29 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
 424 13:03:30 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

6160 13:03:31 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

3600 13:03:35 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #9 13:03:39 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #9 13:03:39 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
9120 13:03:40 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

4424 13:03:41 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

7520 13:03:42 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

2472 13:03:42 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Core.BackgroundService.Run()

 424 13:03:45 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

6160 13:03:46 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #0 13:03:49 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #0 13:03:49 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
3600 13:03:50 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

5296 13:03:55 INFO  [Experience Analytics]: Reduce agent found zero sites to process
9120 13:03:55 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

4424 13:03:56 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

7520 13:03:57 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

2472 13:03:57 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #9 13:03:59 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #9 13:03:59 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
 424 13:04:00 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

6160 13:04:01 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

3600 13:04:05 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #0 13:04:09 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #0 13:04:09 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
ManagedPoolThread #3 13:04:09 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #19 13:04:10 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
9120 13:04:10 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #16 13:04:11 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
4424 13:04:11 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #11 13:04:12 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
7520 13:04:12 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

2472 13:04:12 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #1 13:04:13 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #13 13:04:14 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #17 13:04:15 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
 424 13:04:15 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #5 13:04:16 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
6160 13:04:16 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #6 13:04:17 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #14 13:04:18 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #9 13:04:19 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #9 13:04:19 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
ManagedPoolThread #15 13:04:19 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
3600 13:04:20 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #18 13:04:20 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #7 13:04:21 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #12 13:04:22 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
5296 13:04:25 INFO  [Experience Analytics]: Reduce agent found zero sites to process
9120 13:04:25 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

4424 13:04:26 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

7520 13:04:27 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

2472 13:04:27 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #8 13:04:29 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #8 13:04:29 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
 424 13:04:30 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

6160 13:04:31 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

3600 13:04:35 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #4 13:04:39 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #4 13:04:39 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
9120 13:04:40 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

4424 13:04:41 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

7520 13:04:42 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

2472 13:04:42 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Core.BackgroundService.Run()

 424 13:04:45 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

6160 13:04:46 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #8 13:04:49 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #8 13:04:49 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
3600 13:04:50 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

5296 13:04:55 INFO  [Experience Analytics]: Reduce agent found zero sites to process
9120 13:04:55 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

4424 13:04:56 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

7520 13:04:57 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

2472 13:04:57 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #4 13:04:59 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #4 13:04:59 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
 424 13:05:00 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

6160 13:05:01 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

Heartbeat 13:05:05 ERROR MongoDbDictionary.Store() has failed.
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Save(Object value)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbDictionary.Store(Object value)

3600 13:05:05 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #9 13:05:09 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #9 13:05:09 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
9120 13:05:10 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

4424 13:05:11 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

7520 13:05:12 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

2472 13:05:12 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Core.BackgroundService.Run()

 424 13:05:15 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

6160 13:05:16 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #0 13:05:19 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #0 13:05:19 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
ManagedPoolThread #17 13:05:19 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
3600 13:05:20 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #14 13:05:20 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #13 13:05:22 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #3 13:05:23 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #1 13:05:24 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #19 13:05:25 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
5296 13:05:25 INFO  [Experience Analytics]: Reduce agent found zero sites to process
9120 13:05:25 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #16 13:05:26 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
4424 13:05:26 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #6 13:05:27 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
2472 13:05:27 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #11 13:05:28 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #5 13:05:29 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #4 13:05:29 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #4 13:05:29 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
ManagedPoolThread #15 13:05:30 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
 424 13:05:30 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #7 13:05:31 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
6160 13:05:31 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #10 13:05:32 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #12 13:05:33 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
7520 13:05:34 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
7520 13:05:34 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.HandleDatabaseException(ExceptionBehavior exceptionBehavior, Exception ex)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

Nested Exception

Exception: MongoDB.Driver.MongoConnectionException
Message: Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
Source: MongoDB.Driver
   at MongoDB.Driver.Internal.DirectMongoServerProxy.Connect(TimeSpan timeout, ReadPreference readPreference)
   at MongoDB.Driver.Internal.DirectMongoServerProxy.ChooseServerInstance(ReadPreference readPreference)
   at MongoDB.Driver.MongoServer.AcquireConnection(ReadPreference readPreference)
   at MongoDB.Driver.MongoCollection.RunCommandAs[TCommandResult](IMongoCommand command, ReadPreference readPreference, IBsonSerializer resultSerializer, IBsonSerializationOptions resultSerializationOptions)
   at MongoDB.Driver.MongoCollection.RunCommandAs[TCommandResult](IMongoCommand command, ReadPreference readPreference)
   at MongoDB.Driver.MongoCollection.FindAndModify(FindAndModifyArgs args)
   at MongoDB.Driver.MongoCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.<>c__DisplayClass2c.<FindAndModify>b__2b()
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)

Nested Exception

Exception: System.Net.Sockets.SocketException
Message: No connection could be made because the target machine actively refused it 127.0.0.1:27017
Source: System
   at System.Net.Sockets.Socket.DoConnect(EndPoint endPointSnapshot, SocketAddress socketAddress)
   at System.Net.Sockets.Socket.Connect(EndPoint remoteEP)
   at System.Net.Sockets.TcpClient.Connect(IPEndPoint remoteEP)
   at MongoDB.Driver.Internal.MongoConnection.Open()
   at MongoDB.Driver.Internal.MongoConnection.SendMessage(BsonBuffer buffer, Int32 requestId)
   at MongoDB.Driver.Internal.MongoConnection.SendMessage(MongoRequestMessage message)
   at MongoDB.Driver.Operations.CommandOperation`1.Execute(MongoConnection connection)
   at MongoDB.Driver.MongoServerInstance.Ping(MongoConnection connection)
   at MongoDB.Driver.MongoServerInstance.Connect()
   at MongoDB.Driver.Internal.DirectMongoServerProxy.Connect(TimeSpan timeout, ReadPreference readPreference)



ManagedPoolThread #18 13:05:35 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
3600 13:05:35 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #8 13:05:39 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #8 13:05:39 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
9120 13:05:40 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

4424 13:05:41 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

2472 13:05:42 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Core.BackgroundService.Run()

 424 13:05:45 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

6160 13:05:46 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

7520 13:05:49 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #4 13:05:49 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #4 13:05:49 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
3600 13:05:50 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

5296 13:05:55 INFO  [Experience Analytics]: Reduce agent found zero sites to process
9120 13:05:55 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

4424 13:05:56 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

2472 13:05:57 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #8 13:05:59 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #8 13:05:59 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
 424 13:06:00 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

6160 13:06:01 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

7520 13:06:04 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

3600 13:06:05 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #4 13:06:09 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #4 13:06:09 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
9120 13:06:10 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

4424 13:06:11 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

2472 13:06:12 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Core.BackgroundService.Run()

 424 13:06:15 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

6160 13:06:16 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

7520 13:06:19 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #8 13:06:19 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #8 13:06:19 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
3600 13:06:20 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

5056 13:06:23 INFO  [Path Analyzer](.) Running trail cleanup agent
5056 13:06:23 INFO  [Path Analyzer](.) Running trail cleanup on database
4088 13:06:24 WARN  [Path Analyzer](.) SmartMergeAgent.Execute() returns. No missing date ranges to merge.
5296 13:06:25 INFO  [Experience Analytics]: Reduce agent found zero sites to process
9120 13:06:25 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

4424 13:06:26 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

2472 13:06:27 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #0 13:06:29 INFO  Job started: Sitecore.Tasks.UrlAgent
ManagedPoolThread #0 13:06:29 INFO  Scheduling.UrlAgent started. Url: http://gathercontent.dev/sitecore/service/keepalive.aspx
ManagedPoolThread #0 13:06:29 INFO  Scheduling.UrlAgent done (received: 561 bytes)
ManagedPoolThread #0 13:06:29 INFO  Job ended: Sitecore.Tasks.UrlAgent (units processed: )
ManagedPoolThread #9 13:06:29 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #9 13:06:29 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
ManagedPoolThread #13 13:06:30 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
 424 13:06:30 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

6160 13:06:31 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #14 13:06:31 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #17 13:06:32 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #16 13:06:33 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #3 13:06:34 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
3600 13:06:35 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #11 13:06:35 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #5 13:06:36 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #19 13:06:37 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #1 13:06:38 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #0 13:06:39 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #0 13:06:39 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
ManagedPoolThread #6 13:06:39 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
9120 13:06:40 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #15 13:06:40 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
4424 13:06:41 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

7520 13:06:41 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
7520 13:06:41 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.HandleDatabaseException(ExceptionBehavior exceptionBehavior, Exception ex)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

Nested Exception

Exception: MongoDB.Driver.MongoConnectionException
Message: Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
Source: MongoDB.Driver
   at MongoDB.Driver.Internal.DirectMongoServerProxy.Connect(TimeSpan timeout, ReadPreference readPreference)
   at MongoDB.Driver.Internal.DirectMongoServerProxy.ChooseServerInstance(ReadPreference readPreference)
   at MongoDB.Driver.MongoServer.AcquireConnection(ReadPreference readPreference)
   at MongoDB.Driver.MongoCollection.RunCommandAs[TCommandResult](IMongoCommand command, ReadPreference readPreference, IBsonSerializer resultSerializer, IBsonSerializationOptions resultSerializationOptions)
   at MongoDB.Driver.MongoCollection.RunCommandAs[TCommandResult](IMongoCommand command, ReadPreference readPreference)
   at MongoDB.Driver.MongoCollection.FindAndModify(FindAndModifyArgs args)
   at MongoDB.Driver.MongoCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.<>c__DisplayClass2c.<FindAndModify>b__2b()
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)

Nested Exception

Exception: System.Net.Sockets.SocketException
Message: No connection could be made because the target machine actively refused it 127.0.0.1:27017
Source: System
   at System.Net.Sockets.Socket.DoConnect(EndPoint endPointSnapshot, SocketAddress socketAddress)
   at System.Net.Sockets.Socket.Connect(EndPoint remoteEP)
   at System.Net.Sockets.TcpClient.Connect(IPEndPoint remoteEP)
   at MongoDB.Driver.Internal.MongoConnection.Open()
   at MongoDB.Driver.Internal.MongoConnection.SendMessage(BsonBuffer buffer, Int32 requestId)
   at MongoDB.Driver.Internal.MongoConnection.SendMessage(MongoRequestMessage message)
   at MongoDB.Driver.Operations.CommandOperation`1.Execute(MongoConnection connection)
   at MongoDB.Driver.MongoServerInstance.Ping(MongoConnection connection)
   at MongoDB.Driver.MongoServerInstance.Connect()
   at MongoDB.Driver.Internal.DirectMongoServerProxy.Connect(TimeSpan timeout, ReadPreference readPreference)



2472 13:06:42 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #18 13:06:42 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #7 13:06:43 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
 424 13:06:45 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

6160 13:06:46 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #9 13:06:49 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #9 13:06:49 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
3600 13:06:50 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

5296 13:06:55 INFO  [Experience Analytics]: Reduce agent found zero sites to process
9120 13:06:55 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

4424 13:06:56 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

7520 13:06:56 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

2472 13:06:57 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #0 13:06:59 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #0 13:06:59 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
 424 13:07:00 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

6160 13:07:01 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

3600 13:07:05 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

Heartbeat 13:07:05 ERROR MongoDbDictionary.Store() has failed.
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Save(Object value)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbDictionary.Store(Object value)

ManagedPoolThread #9 13:07:09 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #9 13:07:09 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
9120 13:07:10 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

4424 13:07:11 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

7520 13:07:11 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

2472 13:07:12 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Core.BackgroundService.Run()

 424 13:07:15 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

6160 13:07:16 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #0 13:07:19 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #0 13:07:19 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
3600 13:07:20 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

5296 13:07:25 INFO  [Experience Analytics]: Reduce agent found zero sites to process
9120 13:07:25 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

4424 13:07:26 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

7520 13:07:26 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

2472 13:07:27 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #4 13:07:29 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #4 13:07:29 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
 424 13:07:31 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

6160 13:07:31 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

3600 13:07:35 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #8 13:07:39 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #8 13:07:39 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
ManagedPoolThread #5 13:07:41 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
4424 13:07:41 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

7520 13:07:41 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #11 13:07:42 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
2472 13:07:42 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #16 13:07:43 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #19 13:07:44 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #17 13:07:45 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
 424 13:07:46 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #3 13:07:46 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
6160 13:07:46 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #14 13:07:47 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #1 13:07:48 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #13 13:07:49 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #4 13:07:49 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #4 13:07:49 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
ManagedPoolThread #6 13:07:50 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
3600 13:07:50 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

9120 13:07:51 ERROR Exception when executing agent aggregation/automationAggregator
Exception: MongoDB.Driver.MongoConnectionException
Message: Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
Source: MongoDB.Driver
   at MongoDB.Driver.Internal.DirectMongoServerProxy.Connect(TimeSpan timeout, ReadPreference readPreference)
   at MongoDB.Driver.Internal.DirectMongoServerProxy.ChooseServerInstance(ReadPreference readPreference)
   at MongoDB.Driver.MongoServer.AcquireConnection(ReadPreference readPreference)
   at MongoDB.Driver.MongoCursor`1.MongoCursorConnectionProvider.AcquireConnection()
   at MongoDB.Driver.Operations.QueryOperation`1.GetFirstBatch(IConnectionProvider connectionProvider)
   at MongoDB.Driver.Operations.QueryOperation`1.Execute(IConnectionProvider connectionProvider)
   at System.Linq.Buffer`1..ctor(IEnumerable`1 source)
   at System.Linq.Enumerable.ToArray[TSource](IEnumerable`1 source)
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

Nested Exception

Exception: System.Net.Sockets.SocketException
Message: No connection could be made because the target machine actively refused it 127.0.0.1:27017
Source: System
   at System.Net.Sockets.Socket.DoConnect(EndPoint endPointSnapshot, SocketAddress socketAddress)
   at System.Net.Sockets.Socket.Connect(EndPoint remoteEP)
   at System.Net.Sockets.TcpClient.Connect(IPEndPoint remoteEP)
   at MongoDB.Driver.Internal.MongoConnection.Open()
   at MongoDB.Driver.Internal.MongoConnection.SendMessage(BsonBuffer buffer, Int32 requestId)
   at MongoDB.Driver.Internal.MongoConnection.SendMessage(MongoRequestMessage message)
   at MongoDB.Driver.Operations.CommandOperation`1.Execute(MongoConnection connection)
   at MongoDB.Driver.MongoServerInstance.Ping(MongoConnection connection)
   at MongoDB.Driver.MongoServerInstance.Connect()
   at MongoDB.Driver.Internal.DirectMongoServerProxy.Connect(TimeSpan timeout, ReadPreference readPreference)


ManagedPoolThread #15 13:07:52 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #18 13:07:53 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #12 13:07:54 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
5296 13:07:55 INFO  [Experience Analytics]: Reduce agent found zero sites to process
ManagedPoolThread #7 13:07:55 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #10 13:07:56 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
4424 13:07:56 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

7520 13:07:57 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

2472 13:07:57 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #8 13:07:59 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #8 13:07:59 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
 424 13:08:01 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

6160 13:08:01 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

3600 13:08:05 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

9120 13:08:06 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #0 13:08:09 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #0 13:08:09 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
4424 13:08:11 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

7520 13:08:12 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

2472 13:08:12 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Core.BackgroundService.Run()

 424 13:08:16 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

6160 13:08:16 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #9 13:08:19 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #9 13:08:19 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
3600 13:08:20 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

9120 13:08:21 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

5296 13:08:25 INFO  [Experience Analytics]: Reduce agent found zero sites to process
4424 13:08:26 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

7520 13:08:27 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

2472 13:08:27 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #8 13:08:29 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #8 13:08:29 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
 424 13:08:31 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

6160 13:08:31 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

3600 13:08:35 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

9120 13:08:36 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #4 13:08:39 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #4 13:08:39 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
4424 13:08:41 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

7520 13:08:42 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

2472 13:08:42 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Core.BackgroundService.Run()

 424 13:08:46 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

6160 13:08:46 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #8 13:08:49 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #8 13:08:49 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
3600 13:08:51 ERROR Exception when executing agent aggregation/automationAggregator
Exception: MongoDB.Driver.MongoConnectionException
Message: Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
Source: MongoDB.Driver
   at MongoDB.Driver.Internal.DirectMongoServerProxy.Connect(TimeSpan timeout, ReadPreference readPreference)
   at MongoDB.Driver.Internal.DirectMongoServerProxy.ChooseServerInstance(ReadPreference readPreference)
   at MongoDB.Driver.MongoServer.AcquireConnection(ReadPreference readPreference)
   at MongoDB.Driver.MongoCursor`1.MongoCursorConnectionProvider.AcquireConnection()
   at MongoDB.Driver.Operations.QueryOperation`1.GetFirstBatch(IConnectionProvider connectionProvider)
   at MongoDB.Driver.Operations.QueryOperation`1.Execute(IConnectionProvider connectionProvider)
   at System.Linq.Buffer`1..ctor(IEnumerable`1 source)
   at System.Linq.Enumerable.ToArray[TSource](IEnumerable`1 source)
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

Nested Exception

Exception: System.Net.Sockets.SocketException
Message: No connection could be made because the target machine actively refused it 127.0.0.1:27017
Source: System
   at System.Net.Sockets.Socket.DoConnect(EndPoint endPointSnapshot, SocketAddress socketAddress)
   at System.Net.Sockets.Socket.Connect(EndPoint remoteEP)
   at System.Net.Sockets.TcpClient.Connect(IPEndPoint remoteEP)
   at MongoDB.Driver.Internal.MongoConnection.Open()
   at MongoDB.Driver.Internal.MongoConnection.SendMessage(BsonBuffer buffer, Int32 requestId)
   at MongoDB.Driver.Internal.MongoConnection.SendMessage(MongoRequestMessage message)
   at MongoDB.Driver.Operations.CommandOperation`1.Execute(MongoConnection connection)
   at MongoDB.Driver.MongoServerInstance.Ping(MongoConnection connection)
   at MongoDB.Driver.MongoServerInstance.Connect()
   at MongoDB.Driver.Internal.DirectMongoServerProxy.Connect(TimeSpan timeout, ReadPreference readPreference)


ManagedPoolThread #16 13:08:52 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #5 13:08:53 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #11 13:08:54 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
5296 13:08:55 INFO  [Experience Analytics]: Reduce agent found zero sites to process
ManagedPoolThread #17 13:08:55 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
4424 13:08:56 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #1 13:08:56 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #13 13:08:57 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
2472 13:08:57 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #3 13:08:58 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #14 13:08:59 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #4 13:08:59 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #4 13:08:59 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
ManagedPoolThread #6 13:09:00 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
 424 13:09:01 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #19 13:09:01 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
6160 13:09:01 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

9120 13:09:02 ERROR Exception when executing agent aggregation/automationAggregator
Exception: MongoDB.Driver.MongoConnectionException
Message: Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
Source: MongoDB.Driver
   at MongoDB.Driver.Internal.DirectMongoServerProxy.Connect(TimeSpan timeout, ReadPreference readPreference)
   at MongoDB.Driver.Internal.DirectMongoServerProxy.ChooseServerInstance(ReadPreference readPreference)
   at MongoDB.Driver.MongoServer.AcquireConnection(ReadPreference readPreference)
   at MongoDB.Driver.MongoCursor`1.MongoCursorConnectionProvider.AcquireConnection()
   at MongoDB.Driver.Operations.QueryOperation`1.GetFirstBatch(IConnectionProvider connectionProvider)
   at MongoDB.Driver.Operations.QueryOperation`1.Execute(IConnectionProvider connectionProvider)
   at System.Linq.Buffer`1..ctor(IEnumerable`1 source)
   at System.Linq.Enumerable.ToArray[TSource](IEnumerable`1 source)
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

Nested Exception

Exception: System.Net.Sockets.SocketException
Message: No connection could be made because the target machine actively refused it 127.0.0.1:27017
Source: System
   at System.Net.Sockets.Socket.DoConnect(EndPoint endPointSnapshot, SocketAddress socketAddress)
   at System.Net.Sockets.Socket.Connect(EndPoint remoteEP)
   at System.Net.Sockets.TcpClient.Connect(IPEndPoint remoteEP)
   at MongoDB.Driver.Internal.MongoConnection.Open()
   at MongoDB.Driver.Internal.MongoConnection.SendMessage(BsonBuffer buffer, Int32 requestId)
   at MongoDB.Driver.Internal.MongoConnection.SendMessage(MongoRequestMessage message)
   at MongoDB.Driver.Operations.CommandOperation`1.Execute(MongoConnection connection)
   at MongoDB.Driver.MongoServerInstance.Ping(MongoConnection connection)
   at MongoDB.Driver.MongoServerInstance.Connect()
   at MongoDB.Driver.Internal.DirectMongoServerProxy.Connect(TimeSpan timeout, ReadPreference readPreference)


ManagedPoolThread #15 13:09:03 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #12 13:09:04 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #10 13:09:05 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
3600 13:09:06 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

Heartbeat 13:09:06 ERROR MongoDbDictionary.Store() has failed.
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Save(Object value)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbDictionary.Store(Object value)

7520 13:09:06 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
7520 13:09:06 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.HandleDatabaseException(ExceptionBehavior exceptionBehavior, Exception ex)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

Nested Exception

Exception: MongoDB.Driver.MongoConnectionException
Message: Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
Source: MongoDB.Driver
   at MongoDB.Driver.Internal.DirectMongoServerProxy.Connect(TimeSpan timeout, ReadPreference readPreference)
   at MongoDB.Driver.Internal.DirectMongoServerProxy.ChooseServerInstance(ReadPreference readPreference)
   at MongoDB.Driver.MongoServer.AcquireConnection(ReadPreference readPreference)
   at MongoDB.Driver.MongoCollection.RunCommandAs[TCommandResult](IMongoCommand command, ReadPreference readPreference, IBsonSerializer resultSerializer, IBsonSerializationOptions resultSerializationOptions)
   at MongoDB.Driver.MongoCollection.RunCommandAs[TCommandResult](IMongoCommand command, ReadPreference readPreference)
   at MongoDB.Driver.MongoCollection.FindAndModify(FindAndModifyArgs args)
   at MongoDB.Driver.MongoCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.<>c__DisplayClass2c.<FindAndModify>b__2b()
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)

Nested Exception

Exception: System.Net.Sockets.SocketException
Message: No connection could be made because the target machine actively refused it 127.0.0.1:27017
Source: System
   at System.Net.Sockets.Socket.DoConnect(EndPoint endPointSnapshot, SocketAddress socketAddress)
   at System.Net.Sockets.Socket.Connect(EndPoint remoteEP)
   at System.Net.Sockets.TcpClient.Connect(IPEndPoint remoteEP)
   at MongoDB.Driver.Internal.MongoConnection.Open()
   at MongoDB.Driver.Internal.MongoConnection.SendMessage(BsonBuffer buffer, Int32 requestId)
   at MongoDB.Driver.Internal.MongoConnection.SendMessage(MongoRequestMessage message)
   at MongoDB.Driver.Operations.CommandOperation`1.Execute(MongoConnection connection)
   at MongoDB.Driver.MongoServerInstance.Ping(MongoConnection connection)
   at MongoDB.Driver.MongoServerInstance.Connect()
   at MongoDB.Driver.Internal.DirectMongoServerProxy.Connect(TimeSpan timeout, ReadPreference readPreference)



ManagedPoolThread #18 13:09:07 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #7 13:09:08 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #8 13:09:09 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #8 13:09:09 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
4424 13:09:11 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

2472 13:09:12 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Core.BackgroundService.Run()

 424 13:09:16 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

6160 13:09:16 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

9120 13:09:17 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #4 13:09:19 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #4 13:09:19 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
3600 13:09:21 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

7520 13:09:21 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

5296 13:09:25 INFO  [Experience Analytics]: Reduce agent found zero sites to process
4424 13:09:26 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

2472 13:09:27 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #9 13:09:29 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #9 13:09:29 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
 424 13:09:31 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

6160 13:09:31 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

9120 13:09:32 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

3600 13:09:36 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

7520 13:09:36 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #0 13:09:39 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #0 13:09:39 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
4424 13:09:41 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

2472 13:09:42 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Core.BackgroundService.Run()

 424 13:09:46 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

6160 13:09:46 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

9120 13:09:47 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #9 13:09:49 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #9 13:09:49 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
3600 13:09:51 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

7520 13:09:51 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

5296 13:09:55 INFO  [Experience Analytics]: Reduce agent found zero sites to process
4424 13:09:56 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

2472 13:09:57 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #0 13:09:59 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #0 13:09:59 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
 424 13:10:01 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

6160 13:10:02 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: MongoDB.Driver.MongoConnectionException
Message: Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
Source: MongoDB.Driver
   at MongoDB.Driver.Internal.DirectMongoServerProxy.Connect(TimeSpan timeout, ReadPreference readPreference)
   at MongoDB.Driver.Internal.DirectMongoServerProxy.ChooseServerInstance(ReadPreference readPreference)
   at MongoDB.Driver.MongoServer.AcquireConnection(ReadPreference readPreference)
   at MongoDB.Driver.MongoCursor`1.MongoCursorConnectionProvider.AcquireConnection()
   at MongoDB.Driver.Operations.QueryOperation`1.GetFirstBatch(IConnectionProvider connectionProvider)
   at MongoDB.Driver.Operations.QueryOperation`1.Execute(IConnectionProvider connectionProvider)
   at System.Linq.Enumerable.FirstOrDefault[TSource](IEnumerable`1 source)
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

Nested Exception

Exception: System.Net.Sockets.SocketException
Message: No connection could be made because the target machine actively refused it 127.0.0.1:27017
Source: System
   at System.Net.Sockets.Socket.DoConnect(EndPoint endPointSnapshot, SocketAddress socketAddress)
   at System.Net.Sockets.Socket.Connect(EndPoint remoteEP)
   at System.Net.Sockets.TcpClient.Connect(IPEndPoint remoteEP)
   at MongoDB.Driver.Internal.MongoConnection.Open()
   at MongoDB.Driver.Internal.MongoConnection.SendMessage(BsonBuffer buffer, Int32 requestId)
   at MongoDB.Driver.Internal.MongoConnection.SendMessage(MongoRequestMessage message)
   at MongoDB.Driver.Operations.CommandOperation`1.Execute(MongoConnection connection)
   at MongoDB.Driver.MongoServerInstance.Ping(MongoConnection connection)
   at MongoDB.Driver.MongoServerInstance.Connect()
   at MongoDB.Driver.Internal.DirectMongoServerProxy.Connect(TimeSpan timeout, ReadPreference readPreference)


ManagedPoolThread #16 13:10:03 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #5 13:10:04 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #6 13:10:05 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
3600 13:10:06 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

7520 13:10:06 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #11 13:10:06 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #19 13:10:07 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #1 13:10:08 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #9 13:10:09 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #9 13:10:09 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
ManagedPoolThread #13 13:10:09 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #14 13:10:10 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
4424 13:10:11 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #17 13:10:12 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
2472 13:10:12 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #3 13:10:13 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
9120 13:10:14 ERROR Exception when executing agent aggregation/automationAggregator
Exception: MongoDB.Driver.MongoConnectionException
Message: Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
Source: MongoDB.Driver
   at MongoDB.Driver.Internal.DirectMongoServerProxy.Connect(TimeSpan timeout, ReadPreference readPreference)
   at MongoDB.Driver.Internal.DirectMongoServerProxy.ChooseServerInstance(ReadPreference readPreference)
   at MongoDB.Driver.MongoServer.AcquireConnection(ReadPreference readPreference)
   at MongoDB.Driver.MongoCursor`1.MongoCursorConnectionProvider.AcquireConnection()
   at MongoDB.Driver.Operations.QueryOperation`1.GetFirstBatch(IConnectionProvider connectionProvider)
   at MongoDB.Driver.Operations.QueryOperation`1.Execute(IConnectionProvider connectionProvider)
   at System.Linq.Buffer`1..ctor(IEnumerable`1 source)
   at System.Linq.Enumerable.ToArray[TSource](IEnumerable`1 source)
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

Nested Exception

Exception: System.Net.Sockets.SocketException
Message: No connection could be made because the target machine actively refused it 127.0.0.1:27017
Source: System
   at System.Net.Sockets.Socket.DoConnect(EndPoint endPointSnapshot, SocketAddress socketAddress)
   at System.Net.Sockets.Socket.Connect(EndPoint remoteEP)
   at System.Net.Sockets.TcpClient.Connect(IPEndPoint remoteEP)
   at MongoDB.Driver.Internal.MongoConnection.Open()
   at MongoDB.Driver.Internal.MongoConnection.SendMessage(BsonBuffer buffer, Int32 requestId)
   at MongoDB.Driver.Internal.MongoConnection.SendMessage(MongoRequestMessage message)
   at MongoDB.Driver.Operations.CommandOperation`1.Execute(MongoConnection connection)
   at MongoDB.Driver.MongoServerInstance.Ping(MongoConnection connection)
   at MongoDB.Driver.MongoServerInstance.Connect()
   at MongoDB.Driver.Internal.DirectMongoServerProxy.Connect(TimeSpan timeout, ReadPreference readPreference)


ManagedPoolThread #2 13:10:15 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #15 13:10:16 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
 424 13:10:16 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #18 13:10:17 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
6160 13:10:17 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #7 13:10:18 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #12 13:10:19 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #0 13:10:19 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #0 13:10:19 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
ManagedPoolThread #10 13:10:20 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
3600 13:10:21 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

7520 13:10:21 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

5296 13:10:25 INFO  [Experience Analytics]: Reduce agent found zero sites to process
4424 13:10:26 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

2472 13:10:27 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Core.BackgroundService.Run()

9120 13:10:29 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #4 13:10:29 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #4 13:10:29 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
 424 13:10:31 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

6160 13:10:32 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

3600 13:10:36 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

7520 13:10:36 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #8 13:10:39 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #8 13:10:39 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
4424 13:10:41 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

2472 13:10:42 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Core.BackgroundService.Run()

9120 13:10:44 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

 424 13:10:46 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

6160 13:10:47 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #4 13:10:49 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #4 13:10:49 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
3600 13:10:51 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

7520 13:10:51 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

5296 13:10:55 INFO  [Experience Analytics]: Reduce agent found zero sites to process
4424 13:10:56 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

2472 13:10:57 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Core.BackgroundService.Run()

9120 13:10:59 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #8 13:10:59 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #8 13:10:59 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
 424 13:11:01 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

6160 13:11:02 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

3600 13:11:06 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

7520 13:11:06 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

Heartbeat 13:11:07 ERROR MongoDbDictionary.Store() has failed.
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Save(Object value)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbDictionary.Store(Object value)

ManagedPoolThread #0 13:11:09 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #0 13:11:09 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
4424 13:11:11 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

2472 13:11:12 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Core.BackgroundService.Run()

9120 13:11:14 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #2 13:11:16 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
 424 13:11:16 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #11 13:11:17 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
6160 13:11:17 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #13 13:11:18 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #5 13:11:19 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #9 13:11:19 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #9 13:11:19 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
ManagedPoolThread #1 13:11:20 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #3 13:11:21 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
3600 13:11:21 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #14 13:11:22 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #6 13:11:23 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
5056 13:11:23 INFO  [Path Analyzer](.) Running trail cleanup agent
5056 13:11:23 INFO  [Path Analyzer](.) Running trail cleanup on database
ManagedPoolThread #16 13:11:24 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #17 13:11:25 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
Heartbeat 13:11:25 INFO  Health.PrivateBytes: 694,394,880
Heartbeat 13:11:25 INFO  Health.CacheInstances: 115
Heartbeat 13:11:25 INFO  Health.CacheTotalCount: 18,100
Heartbeat 13:11:25 INFO  Health.CacheTotalSize: 75,523,756
5296 13:11:25 INFO  [Experience Analytics]: Reduce agent found zero sites to process
ManagedPoolThread #19 13:11:26 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
4424 13:11:26 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #15 13:11:27 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
2472 13:11:28 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #12 13:11:28 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
9120 13:11:29 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #10 13:11:29 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #8 13:11:29 INFO  Job started: Sitecore.Tasks.TaskDatabaseAgent
ManagedPoolThread #8 13:11:29 INFO  Processing tasks (count: 0)
ManagedPoolThread #8 13:11:29 INFO  Job ended: Sitecore.Tasks.TaskDatabaseAgent (units processed: )
ManagedPoolThread #9 13:11:29 INFO  Job started: Core_Database_Agent
ManagedPoolThread #9 13:11:29 INFO  Scheduling.DatabaseAgent started. Database: core
ManagedPoolThread #9 13:11:29 INFO  Examining schedules (count: 0)
ManagedPoolThread #9 13:11:29 INFO  Job ended: Core_Database_Agent (units processed: )
ManagedPoolThread #4 13:11:29 INFO  Job started: Master_Database_Agent
ManagedPoolThread #4 13:11:29 INFO  Scheduling.DatabaseAgent started. Database: master
ManagedPoolThread #4 13:11:29 INFO  Examining schedules (count: 5)
ManagedPoolThread #4 13:11:29 INFO  Starting: __Task Schedule
ManagedPoolThread #4 13:11:29 INFO  Ended: __Task Schedule
ManagedPoolThread #4 13:11:29 INFO  Not due: Calculate Statistical Relevancy
ManagedPoolThread #4 13:11:29 INFO  Not due: Rebuild Suggested Tests Index
ManagedPoolThread #4 13:11:29 INFO  Not due: Suspend Corrupted Tests
ManagedPoolThread #4 13:11:29 INFO  Not due: Try Finish Test
ManagedPoolThread #4 13:11:29 INFO  Job ended: Master_Database_Agent (units processed: 5)
ManagedPoolThread #0 13:11:29 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #0 13:11:29 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
7520 13:11:30 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
7520 13:11:30 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.HandleDatabaseException(ExceptionBehavior exceptionBehavior, Exception ex)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

Nested Exception

Exception: MongoDB.Driver.MongoConnectionException
Message: Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
Source: MongoDB.Driver
   at MongoDB.Driver.Internal.DirectMongoServerProxy.Connect(TimeSpan timeout, ReadPreference readPreference)
   at MongoDB.Driver.Internal.DirectMongoServerProxy.ChooseServerInstance(ReadPreference readPreference)
   at MongoDB.Driver.MongoServer.AcquireConnection(ReadPreference readPreference)
   at MongoDB.Driver.MongoCollection.RunCommandAs[TCommandResult](IMongoCommand command, ReadPreference readPreference, IBsonSerializer resultSerializer, IBsonSerializationOptions resultSerializationOptions)
   at MongoDB.Driver.MongoCollection.RunCommandAs[TCommandResult](IMongoCommand command, ReadPreference readPreference)
   at MongoDB.Driver.MongoCollection.FindAndModify(FindAndModifyArgs args)
   at MongoDB.Driver.MongoCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.<>c__DisplayClass2c.<FindAndModify>b__2b()
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)

Nested Exception

Exception: System.Net.Sockets.SocketException
Message: No connection could be made because the target machine actively refused it 127.0.0.1:27017
Source: System
   at System.Net.Sockets.Socket.DoConnect(EndPoint endPointSnapshot, SocketAddress socketAddress)
   at System.Net.Sockets.Socket.Connect(EndPoint remoteEP)
   at System.Net.Sockets.TcpClient.Connect(IPEndPoint remoteEP)
   at MongoDB.Driver.Internal.MongoConnection.Open()
   at MongoDB.Driver.Internal.MongoConnection.SendMessage(BsonBuffer buffer, Int32 requestId)
   at MongoDB.Driver.Internal.MongoConnection.SendMessage(MongoRequestMessage message)
   at MongoDB.Driver.Operations.CommandOperation`1.Execute(MongoConnection connection)
   at MongoDB.Driver.MongoServerInstance.Ping(MongoConnection connection)
   at MongoDB.Driver.MongoServerInstance.Connect()
   at MongoDB.Driver.Internal.DirectMongoServerProxy.Connect(TimeSpan timeout, ReadPreference readPreference)



 424 13:11:31 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #18 13:11:31 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #7 13:11:32 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
6160 13:11:32 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

3600 13:11:36 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #9 13:11:39 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #9 13:11:39 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
4424 13:11:41 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

2472 13:11:43 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Core.BackgroundService.Run()

9120 13:11:44 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

7520 13:11:45 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

 424 13:11:46 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

6160 13:11:47 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #4 13:11:49 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #4 13:11:49 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
3600 13:11:51 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

5296 13:11:55 INFO  [Experience Analytics]: Reduce agent found zero sites to process
4424 13:11:56 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

2472 13:11:58 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Core.BackgroundService.Run()

9120 13:11:59 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #9 13:11:59 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #9 13:11:59 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
7520 13:12:00 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

 424 13:12:01 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

6160 13:12:02 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

3600 13:12:06 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #4 13:12:09 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #4 13:12:09 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
4424 13:12:11 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

2472 13:12:13 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Core.BackgroundService.Run()

9120 13:12:14 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

7520 13:12:15 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

 424 13:12:16 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

6160 13:12:17 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #9 13:12:19 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #9 13:12:19 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
3600 13:12:21 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

5296 13:12:25 INFO  [Experience Analytics]: Reduce agent found zero sites to process
4424 13:12:27 ERROR Exception when executing agent aggregation/automationAggregator
Exception: MongoDB.Driver.MongoConnectionException
Message: Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
Source: MongoDB.Driver
   at MongoDB.Driver.Internal.DirectMongoServerProxy.Connect(TimeSpan timeout, ReadPreference readPreference)
   at MongoDB.Driver.Internal.DirectMongoServerProxy.ChooseServerInstance(ReadPreference readPreference)
   at MongoDB.Driver.MongoServer.AcquireConnection(ReadPreference readPreference)
   at MongoDB.Driver.MongoCursor`1.MongoCursorConnectionProvider.AcquireConnection()
   at MongoDB.Driver.Operations.QueryOperation`1.GetFirstBatch(IConnectionProvider connectionProvider)
   at MongoDB.Driver.Operations.QueryOperation`1.Execute(IConnectionProvider connectionProvider)
   at System.Linq.Buffer`1..ctor(IEnumerable`1 source)
   at System.Linq.Enumerable.ToArray[TSource](IEnumerable`1 source)
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

Nested Exception

Exception: System.Net.Sockets.SocketException
Message: No connection could be made because the target machine actively refused it 127.0.0.1:27017
Source: System
   at System.Net.Sockets.Socket.DoConnect(EndPoint endPointSnapshot, SocketAddress socketAddress)
   at System.Net.Sockets.Socket.Connect(EndPoint remoteEP)
   at System.Net.Sockets.TcpClient.Connect(IPEndPoint remoteEP)
   at MongoDB.Driver.Internal.MongoConnection.Open()
   at MongoDB.Driver.Internal.MongoConnection.SendMessage(BsonBuffer buffer, Int32 requestId)
   at MongoDB.Driver.Internal.MongoConnection.SendMessage(MongoRequestMessage message)
   at MongoDB.Driver.Operations.CommandOperation`1.Execute(MongoConnection connection)
   at MongoDB.Driver.MongoServerInstance.Ping(MongoConnection connection)
   at MongoDB.Driver.MongoServerInstance.Connect()
   at MongoDB.Driver.Internal.DirectMongoServerProxy.Connect(TimeSpan timeout, ReadPreference readPreference)


ManagedPoolThread #1 13:12:28 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
9120 13:12:29 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #13 13:12:29 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #8 13:12:29 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #8 13:12:29 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
7520 13:12:30 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #3 13:12:30 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
 424 13:12:31 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #11 13:12:31 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #5 13:12:32 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
6160 13:12:32 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #14 13:12:33 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #16 13:12:34 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #6 13:12:35 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
3600 13:12:36 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #19 13:12:36 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #17 13:12:37 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #15 13:12:38 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
7740 13:12:39 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #0 13:12:39 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #0 13:12:39 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
2472 13:12:40 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: MongoDB.Driver.MongoConnectionException
Message: Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
Source: MongoDB.Driver
   at MongoDB.Driver.Internal.DirectMongoServerProxy.Connect(TimeSpan timeout, ReadPreference readPreference)
   at MongoDB.Driver.Internal.DirectMongoServerProxy.ChooseServerInstance(ReadPreference readPreference)
   at MongoDB.Driver.MongoServer.AcquireConnection(ReadPreference readPreference)
   at MongoDB.Driver.MongoCursor`1.MongoCursorConnectionProvider.AcquireConnection()
   at MongoDB.Driver.Operations.QueryOperation`1.GetFirstBatch(IConnectionProvider connectionProvider)
   at MongoDB.Driver.Operations.QueryOperation`1.Execute(IConnectionProvider connectionProvider)
   at System.Linq.Enumerable.FirstOrDefault[TSource](IEnumerable`1 source)
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Core.BackgroundService.Run()

Nested Exception

Exception: System.Net.Sockets.SocketException
Message: No connection could be made because the target machine actively refused it 127.0.0.1:27017
Source: System
   at System.Net.Sockets.Socket.DoConnect(EndPoint endPointSnapshot, SocketAddress socketAddress)
   at System.Net.Sockets.Socket.Connect(EndPoint remoteEP)
   at System.Net.Sockets.TcpClient.Connect(IPEndPoint remoteEP)
   at MongoDB.Driver.Internal.MongoConnection.Open()
   at MongoDB.Driver.Internal.MongoConnection.SendMessage(BsonBuffer buffer, Int32 requestId)
   at MongoDB.Driver.Internal.MongoConnection.SendMessage(MongoRequestMessage message)
   at MongoDB.Driver.Operations.CommandOperation`1.Execute(MongoConnection connection)
   at MongoDB.Driver.MongoServerInstance.Ping(MongoConnection connection)
   at MongoDB.Driver.MongoServerInstance.Connect()
   at MongoDB.Driver.Internal.DirectMongoServerProxy.Connect(TimeSpan timeout, ReadPreference readPreference)


7092 13:12:41 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
4424 13:12:42 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #18 13:12:42 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #7 13:12:43 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
9120 13:12:44 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #12 13:12:44 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
7520 13:12:45 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #10 13:12:45 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
 424 13:12:46 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

6160 13:12:47 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #8 13:12:50 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #8 13:12:50 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
3600 13:12:51 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

5296 13:12:55 INFO  [Experience Analytics]: Reduce agent found zero sites to process
2472 13:12:55 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Core.BackgroundService.Run()

4424 13:12:57 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

9120 13:12:59 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #0 13:13:00 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #0 13:13:00 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
7520 13:13:00 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

 424 13:13:01 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

6160 13:13:02 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

3600 13:13:06 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

Heartbeat 13:13:08 ERROR MongoDbDictionary.Store() has failed.
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Save(Object value)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbDictionary.Store(Object value)

ManagedPoolThread #4 13:13:10 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #4 13:13:10 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
2472 13:13:10 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Core.BackgroundService.Run()

4424 13:13:12 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

9120 13:13:14 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

7520 13:13:15 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

 424 13:13:16 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

6160 13:13:17 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #9 13:13:20 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #9 13:13:20 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
3600 13:13:21 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

5296 13:13:25 INFO  [Experience Analytics]: Reduce agent found zero sites to process
2472 13:13:25 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Core.BackgroundService.Run()

4424 13:13:27 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

9120 13:13:29 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #8 13:13:30 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #8 13:13:30 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
7520 13:13:30 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

 424 13:13:31 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

6160 13:13:32 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

3600 13:13:36 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #15 13:13:39 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #0 13:13:40 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #0 13:13:40 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
2472 13:13:40 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Core.BackgroundService.Run()

7092 13:13:42 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #1 13:13:43 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
9120 13:13:44 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #14 13:13:44 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
7520 13:13:45 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #5 13:13:45 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
 424 13:13:46 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #3 13:13:46 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #11 13:13:47 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
6160 13:13:47 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #13 13:13:48 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #16 13:13:50 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #8 13:13:50 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #8 13:13:50 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
ManagedPoolThread #17 13:13:51 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
3600 13:13:51 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #6 13:13:52 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #19 13:13:53 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
4424 13:13:54 ERROR Exception when executing agent aggregation/automationAggregator
Exception: MongoDB.Driver.MongoConnectionException
Message: Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
Source: MongoDB.Driver
   at MongoDB.Driver.Internal.DirectMongoServerProxy.Connect(TimeSpan timeout, ReadPreference readPreference)
   at MongoDB.Driver.Internal.DirectMongoServerProxy.ChooseServerInstance(ReadPreference readPreference)
   at MongoDB.Driver.MongoServer.AcquireConnection(ReadPreference readPreference)
   at MongoDB.Driver.MongoCursor`1.MongoCursorConnectionProvider.AcquireConnection()
   at MongoDB.Driver.Operations.QueryOperation`1.GetFirstBatch(IConnectionProvider connectionProvider)
   at MongoDB.Driver.Operations.QueryOperation`1.Execute(IConnectionProvider connectionProvider)
   at System.Linq.Buffer`1..ctor(IEnumerable`1 source)
   at System.Linq.Enumerable.ToArray[TSource](IEnumerable`1 source)
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

Nested Exception

Exception: System.Net.Sockets.SocketException
Message: No connection could be made because the target machine actively refused it 127.0.0.1:27017
Source: System
   at System.Net.Sockets.Socket.DoConnect(EndPoint endPointSnapshot, SocketAddress socketAddress)
   at System.Net.Sockets.Socket.Connect(EndPoint remoteEP)
   at System.Net.Sockets.TcpClient.Connect(IPEndPoint remoteEP)
   at MongoDB.Driver.Internal.MongoConnection.Open()
   at MongoDB.Driver.Internal.MongoConnection.SendMessage(BsonBuffer buffer, Int32 requestId)
   at MongoDB.Driver.Internal.MongoConnection.SendMessage(MongoRequestMessage message)
   at MongoDB.Driver.Operations.CommandOperation`1.Execute(MongoConnection connection)
   at MongoDB.Driver.MongoServerInstance.Ping(MongoConnection connection)
   at MongoDB.Driver.MongoServerInstance.Connect()
   at MongoDB.Driver.Internal.DirectMongoServerProxy.Connect(TimeSpan timeout, ReadPreference readPreference)


ManagedPoolThread #12 13:13:55 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
5296 13:13:55 INFO  [Experience Analytics]: Reduce agent found zero sites to process
2472 13:13:55 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #10 13:13:56 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #18 13:13:57 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #7 13:13:58 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
9120 13:13:59 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #0 13:14:00 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #0 13:14:00 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
7520 13:14:00 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

 424 13:14:01 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

6160 13:14:02 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

3600 13:14:06 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

4424 13:14:09 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #9 13:14:10 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #9 13:14:10 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
2472 13:14:10 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Core.BackgroundService.Run()

9120 13:14:14 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

7520 13:14:15 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

 424 13:14:16 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

6160 13:14:17 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #4 13:14:20 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #4 13:14:20 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
3600 13:14:21 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

4424 13:14:24 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

5296 13:14:25 INFO  [Experience Analytics]: Reduce agent found zero sites to process
2472 13:14:25 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Core.BackgroundService.Run()

9120 13:14:29 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #0 13:14:30 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #0 13:14:30 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
7520 13:14:30 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

 424 13:14:31 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

6160 13:14:32 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

3600 13:14:36 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

4424 13:14:39 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #8 13:14:40 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #8 13:14:40 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
2472 13:14:40 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #15 13:14:40 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
9120 13:14:44 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

7520 13:14:45 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

 424 13:14:46 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

6160 13:14:47 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #0 13:14:50 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #0 13:14:50 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
3600 13:14:51 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #1 13:14:54 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #5 13:14:55 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
5296 13:14:55 INFO  [Experience Analytics]: Reduce agent found zero sites to process
2472 13:14:55 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #3 13:14:56 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #14 13:14:57 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #19 13:14:58 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
9120 13:14:59 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #6 13:14:59 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #8 13:15:00 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #8 13:15:00 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
ManagedPoolThread #11 13:15:00 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
 424 13:15:01 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #13 13:15:01 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #16 13:15:02 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
6160 13:15:03 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #17 13:15:03 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
4424 13:15:04 ERROR Exception when executing agent aggregation/automationAggregator
Exception: MongoDB.Driver.MongoConnectionException
Message: Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
Source: MongoDB.Driver
   at MongoDB.Driver.Internal.DirectMongoServerProxy.Connect(TimeSpan timeout, ReadPreference readPreference)
   at MongoDB.Driver.Internal.DirectMongoServerProxy.ChooseServerInstance(ReadPreference readPreference)
   at MongoDB.Driver.MongoServer.AcquireConnection(ReadPreference readPreference)
   at MongoDB.Driver.MongoCursor`1.MongoCursorConnectionProvider.AcquireConnection()
   at MongoDB.Driver.Operations.QueryOperation`1.GetFirstBatch(IConnectionProvider connectionProvider)
   at MongoDB.Driver.Operations.QueryOperation`1.Execute(IConnectionProvider connectionProvider)
   at System.Linq.Buffer`1..ctor(IEnumerable`1 source)
   at System.Linq.Enumerable.ToArray[TSource](IEnumerable`1 source)
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

Nested Exception

Exception: System.Net.Sockets.SocketException
Message: No connection could be made because the target machine actively refused it 127.0.0.1:27017
Source: System
   at System.Net.Sockets.Socket.DoConnect(EndPoint endPointSnapshot, SocketAddress socketAddress)
   at System.Net.Sockets.Socket.Connect(EndPoint remoteEP)
   at System.Net.Sockets.TcpClient.Connect(IPEndPoint remoteEP)
   at MongoDB.Driver.Internal.MongoConnection.Open()
   at MongoDB.Driver.Internal.MongoConnection.SendMessage(BsonBuffer buffer, Int32 requestId)
   at MongoDB.Driver.Internal.MongoConnection.SendMessage(MongoRequestMessage message)
   at MongoDB.Driver.Operations.CommandOperation`1.Execute(MongoConnection connection)
   at MongoDB.Driver.MongoServerInstance.Ping(MongoConnection connection)
   at MongoDB.Driver.MongoServerInstance.Connect()
   at MongoDB.Driver.Internal.DirectMongoServerProxy.Connect(TimeSpan timeout, ReadPreference readPreference)


ManagedPoolThread #18 13:15:05 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #7 13:15:06 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
3600 13:15:06 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

7520 13:15:07 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
7520 13:15:07 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.HandleDatabaseException(ExceptionBehavior exceptionBehavior, Exception ex)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

Nested Exception

Exception: MongoDB.Driver.MongoConnectionException
Message: Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
Source: MongoDB.Driver
   at MongoDB.Driver.Internal.DirectMongoServerProxy.Connect(TimeSpan timeout, ReadPreference readPreference)
   at MongoDB.Driver.Internal.DirectMongoServerProxy.ChooseServerInstance(ReadPreference readPreference)
   at MongoDB.Driver.MongoServer.AcquireConnection(ReadPreference readPreference)
   at MongoDB.Driver.MongoCollection.RunCommandAs[TCommandResult](IMongoCommand command, ReadPreference readPreference, IBsonSerializer resultSerializer, IBsonSerializationOptions resultSerializationOptions)
   at MongoDB.Driver.MongoCollection.RunCommandAs[TCommandResult](IMongoCommand command, ReadPreference readPreference)
   at MongoDB.Driver.MongoCollection.FindAndModify(FindAndModifyArgs args)
   at MongoDB.Driver.MongoCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.<>c__DisplayClass2c.<FindAndModify>b__2b()
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)

Nested Exception

Exception: System.Net.Sockets.SocketException
Message: No connection could be made because the target machine actively refused it 127.0.0.1:27017
Source: System
   at System.Net.Sockets.Socket.DoConnect(EndPoint endPointSnapshot, SocketAddress socketAddress)
   at System.Net.Sockets.Socket.Connect(EndPoint remoteEP)
   at System.Net.Sockets.TcpClient.Connect(IPEndPoint remoteEP)
   at MongoDB.Driver.Internal.MongoConnection.Open()
   at MongoDB.Driver.Internal.MongoConnection.SendMessage(BsonBuffer buffer, Int32 requestId)
   at MongoDB.Driver.Internal.MongoConnection.SendMessage(MongoRequestMessage message)
   at MongoDB.Driver.Operations.CommandOperation`1.Execute(MongoConnection connection)
   at MongoDB.Driver.MongoServerInstance.Ping(MongoConnection connection)
   at MongoDB.Driver.MongoServerInstance.Connect()
   at MongoDB.Driver.Internal.DirectMongoServerProxy.Connect(TimeSpan timeout, ReadPreference readPreference)



ManagedPoolThread #12 13:15:08 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
Heartbeat 13:15:09 ERROR MongoDbDictionary.Store() has failed.
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Save(Object value)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbDictionary.Store(Object value)

ManagedPoolThread #10 13:15:09 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #0 13:15:10 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #0 13:15:10 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
2472 13:15:10 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Core.BackgroundService.Run()

9120 13:15:14 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

 424 13:15:16 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

6160 13:15:18 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

4424 13:15:19 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #8 13:15:20 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #8 13:15:20 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
3600 13:15:21 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

7520 13:15:22 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

5296 13:15:25 INFO  [Experience Analytics]: Reduce agent found zero sites to process
2472 13:15:25 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Core.BackgroundService.Run()

9120 13:15:29 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #4 13:15:30 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #4 13:15:30 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
 424 13:15:31 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

6160 13:15:33 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

4424 13:15:34 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

3600 13:15:36 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

7520 13:15:37 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #9 13:15:40 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #9 13:15:40 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
2472 13:15:40 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #15 13:15:41 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
9120 13:15:44 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

 424 13:15:46 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

6160 13:15:48 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

4424 13:15:49 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #4 13:15:50 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #4 13:15:50 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
3600 13:15:51 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

7520 13:15:52 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

5296 13:15:55 INFO  [Experience Analytics]: Reduce agent found zero sites to process
2472 13:15:55 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Core.BackgroundService.Run()

9120 13:15:59 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #9 13:16:00 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #9 13:16:00 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
 424 13:16:01 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

6160 13:16:03 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #1 13:16:04 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #5 13:16:05 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
3600 13:16:06 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #14 13:16:06 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
7520 13:16:07 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #3 13:16:07 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #16 13:16:08 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #13 13:16:09 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #4 13:16:10 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #4 13:16:10 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
ManagedPoolThread #6 13:16:10 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
2472 13:16:10 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #19 13:16:11 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #11 13:16:12 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #17 13:16:13 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
9120 13:16:14 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

4424 13:16:15 ERROR Exception when executing agent aggregation/automationAggregator
Exception: MongoDB.Driver.MongoConnectionException
Message: Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
Source: MongoDB.Driver
   at MongoDB.Driver.Internal.DirectMongoServerProxy.Connect(TimeSpan timeout, ReadPreference readPreference)
   at MongoDB.Driver.Internal.DirectMongoServerProxy.ChooseServerInstance(ReadPreference readPreference)
   at MongoDB.Driver.MongoServer.AcquireConnection(ReadPreference readPreference)
   at MongoDB.Driver.MongoCursor`1.MongoCursorConnectionProvider.AcquireConnection()
   at MongoDB.Driver.Operations.QueryOperation`1.GetFirstBatch(IConnectionProvider connectionProvider)
   at MongoDB.Driver.Operations.QueryOperation`1.Execute(IConnectionProvider connectionProvider)
   at System.Linq.Buffer`1..ctor(IEnumerable`1 source)
   at System.Linq.Enumerable.ToArray[TSource](IEnumerable`1 source)
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

Nested Exception

Exception: System.Net.Sockets.SocketException
Message: No connection could be made because the target machine actively refused it 127.0.0.1:27017
Source: System
   at System.Net.Sockets.Socket.DoConnect(EndPoint endPointSnapshot, SocketAddress socketAddress)
   at System.Net.Sockets.Socket.Connect(EndPoint remoteEP)
   at System.Net.Sockets.TcpClient.Connect(IPEndPoint remoteEP)
   at MongoDB.Driver.Internal.MongoConnection.Open()
   at MongoDB.Driver.Internal.MongoConnection.SendMessage(BsonBuffer buffer, Int32 requestId)
   at MongoDB.Driver.Internal.MongoConnection.SendMessage(MongoRequestMessage message)
   at MongoDB.Driver.Operations.CommandOperation`1.Execute(MongoConnection connection)
   at MongoDB.Driver.MongoServerInstance.Ping(MongoConnection connection)
   at MongoDB.Driver.MongoServerInstance.Connect()
   at MongoDB.Driver.Internal.DirectMongoServerProxy.Connect(TimeSpan timeout, ReadPreference readPreference)


ManagedPoolThread #12 13:16:16 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
 424 13:16:16 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #10 13:16:17 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
6160 13:16:18 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #18 13:16:18 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #7 13:16:19 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #9 13:16:20 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #9 13:16:20 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
3600 13:16:21 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

7520 13:16:22 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

5056 13:16:23 INFO  [Path Analyzer](.) Running trail cleanup agent
5056 13:16:23 INFO  [Path Analyzer](.) Running trail cleanup on database
5296 13:16:25 INFO  [Experience Analytics]: Reduce agent found zero sites to process
2472 13:16:25 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Core.BackgroundService.Run()

9120 13:16:29 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

4424 13:16:30 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #8 13:16:30 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #8 13:16:30 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
 424 13:16:31 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

6160 13:16:33 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

3600 13:16:36 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

7520 13:16:37 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #4 13:16:40 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #4 13:16:40 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
2472 13:16:40 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #15 13:16:43 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
9120 13:16:44 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

4424 13:16:45 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

 424 13:16:46 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

6160 13:16:48 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #0 13:16:50 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #0 13:16:50 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
3600 13:16:51 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

7520 13:16:52 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

5296 13:16:55 INFO  [Experience Analytics]: Reduce agent found zero sites to process
2472 13:16:55 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Core.BackgroundService.Run()

9120 13:16:59 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

4424 13:17:00 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #4 13:17:00 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #4 13:17:00 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
 424 13:17:01 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

6160 13:17:03 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

3600 13:17:06 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

7520 13:17:07 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

Heartbeat 13:17:09 ERROR MongoDbDictionary.Store() has failed.
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Save(Object value)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbDictionary.Store(Object value)

ManagedPoolThread #8 13:17:10 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #8 13:17:10 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
2472 13:17:10 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Core.BackgroundService.Run()

9120 13:17:15 ERROR Exception when executing agent aggregation/automationAggregator
Exception: MongoDB.Driver.MongoConnectionException
Message: Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
Source: MongoDB.Driver
   at MongoDB.Driver.Internal.DirectMongoServerProxy.Connect(TimeSpan timeout, ReadPreference readPreference)
   at MongoDB.Driver.Internal.DirectMongoServerProxy.ChooseServerInstance(ReadPreference readPreference)
   at MongoDB.Driver.MongoServer.AcquireConnection(ReadPreference readPreference)
   at MongoDB.Driver.MongoCursor`1.MongoCursorConnectionProvider.AcquireConnection()
   at MongoDB.Driver.Operations.QueryOperation`1.GetFirstBatch(IConnectionProvider connectionProvider)
   at MongoDB.Driver.Operations.QueryOperation`1.Execute(IConnectionProvider connectionProvider)
   at System.Linq.Buffer`1..ctor(IEnumerable`1 source)
   at System.Linq.Enumerable.ToArray[TSource](IEnumerable`1 source)
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

Nested Exception

Exception: System.Net.Sockets.SocketException
Message: No connection could be made because the target machine actively refused it 127.0.0.1:27017
Source: System
   at System.Net.Sockets.Socket.DoConnect(EndPoint endPointSnapshot, SocketAddress socketAddress)
   at System.Net.Sockets.Socket.Connect(EndPoint remoteEP)
   at System.Net.Sockets.TcpClient.Connect(IPEndPoint remoteEP)
   at MongoDB.Driver.Internal.MongoConnection.Open()
   at MongoDB.Driver.Internal.MongoConnection.SendMessage(BsonBuffer buffer, Int32 requestId)
   at MongoDB.Driver.Internal.MongoConnection.SendMessage(MongoRequestMessage message)
   at MongoDB.Driver.Operations.CommandOperation`1.Execute(MongoConnection connection)
   at MongoDB.Driver.MongoServerInstance.Ping(MongoConnection connection)
   at MongoDB.Driver.MongoServerInstance.Connect()
   at MongoDB.Driver.Internal.DirectMongoServerProxy.Connect(TimeSpan timeout, ReadPreference readPreference)


ManagedPoolThread #5 13:17:16 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
 424 13:17:16 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #3 13:17:17 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
6160 13:17:18 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #14 13:17:18 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #1 13:17:19 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #16 13:17:20 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #9 13:17:20 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #9 13:17:20 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
ManagedPoolThread #6 13:17:21 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
3600 13:17:21 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #11 13:17:22 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #19 13:17:23 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #13 13:17:24 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #17 13:17:25 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
5296 13:17:25 INFO  [Experience Analytics]: Reduce agent found zero sites to process
2472 13:17:25 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Core.BackgroundService.Run()

4424 13:17:26 ERROR Exception when executing agent aggregation/automationAggregator
Exception: MongoDB.Driver.MongoConnectionException
Message: Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
Source: MongoDB.Driver
   at MongoDB.Driver.Internal.DirectMongoServerProxy.Connect(TimeSpan timeout, ReadPreference readPreference)
   at MongoDB.Driver.Internal.DirectMongoServerProxy.ChooseServerInstance(ReadPreference readPreference)
   at MongoDB.Driver.MongoServer.AcquireConnection(ReadPreference readPreference)
   at MongoDB.Driver.MongoCursor`1.MongoCursorConnectionProvider.AcquireConnection()
   at MongoDB.Driver.Operations.QueryOperation`1.GetFirstBatch(IConnectionProvider connectionProvider)
   at MongoDB.Driver.Operations.QueryOperation`1.Execute(IConnectionProvider connectionProvider)
   at System.Linq.Buffer`1..ctor(IEnumerable`1 source)
   at System.Linq.Enumerable.ToArray[TSource](IEnumerable`1 source)
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

Nested Exception

Exception: System.Net.Sockets.SocketException
Message: No connection could be made because the target machine actively refused it 127.0.0.1:27017
Source: System
   at System.Net.Sockets.Socket.DoConnect(EndPoint endPointSnapshot, SocketAddress socketAddress)
   at System.Net.Sockets.Socket.Connect(EndPoint remoteEP)
   at System.Net.Sockets.TcpClient.Connect(IPEndPoint remoteEP)
   at MongoDB.Driver.Internal.MongoConnection.Open()
   at MongoDB.Driver.Internal.MongoConnection.SendMessage(BsonBuffer buffer, Int32 requestId)
   at MongoDB.Driver.Internal.MongoConnection.SendMessage(MongoRequestMessage message)
   at MongoDB.Driver.Operations.CommandOperation`1.Execute(MongoConnection connection)
   at MongoDB.Driver.MongoServerInstance.Ping(MongoConnection connection)
   at MongoDB.Driver.MongoServerInstance.Connect()
   at MongoDB.Driver.Internal.DirectMongoServerProxy.Connect(TimeSpan timeout, ReadPreference readPreference)


ManagedPoolThread #18 13:17:27 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #7 13:17:28 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
7520 13:17:29 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
7520 13:17:29 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.HandleDatabaseException(ExceptionBehavior exceptionBehavior, Exception ex)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

Nested Exception

Exception: MongoDB.Driver.MongoConnectionException
Message: Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
Source: MongoDB.Driver
   at MongoDB.Driver.Internal.DirectMongoServerProxy.Connect(TimeSpan timeout, ReadPreference readPreference)
   at MongoDB.Driver.Internal.DirectMongoServerProxy.ChooseServerInstance(ReadPreference readPreference)
   at MongoDB.Driver.MongoServer.AcquireConnection(ReadPreference readPreference)
   at MongoDB.Driver.MongoCollection.RunCommandAs[TCommandResult](IMongoCommand command, ReadPreference readPreference, IBsonSerializer resultSerializer, IBsonSerializationOptions resultSerializationOptions)
   at MongoDB.Driver.MongoCollection.RunCommandAs[TCommandResult](IMongoCommand command, ReadPreference readPreference)
   at MongoDB.Driver.MongoCollection.FindAndModify(FindAndModifyArgs args)
   at MongoDB.Driver.MongoCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.<>c__DisplayClass2c.<FindAndModify>b__2b()
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)

Nested Exception

Exception: System.Net.Sockets.SocketException
Message: No connection could be made because the target machine actively refused it 127.0.0.1:27017
Source: System
   at System.Net.Sockets.Socket.DoConnect(EndPoint endPointSnapshot, SocketAddress socketAddress)
   at System.Net.Sockets.Socket.Connect(EndPoint remoteEP)
   at System.Net.Sockets.TcpClient.Connect(IPEndPoint remoteEP)
   at MongoDB.Driver.Internal.MongoConnection.Open()
   at MongoDB.Driver.Internal.MongoConnection.SendMessage(BsonBuffer buffer, Int32 requestId)
   at MongoDB.Driver.Internal.MongoConnection.SendMessage(MongoRequestMessage message)
   at MongoDB.Driver.Operations.CommandOperation`1.Execute(MongoConnection connection)
   at MongoDB.Driver.MongoServerInstance.Ping(MongoConnection connection)
   at MongoDB.Driver.MongoServerInstance.Connect()
   at MongoDB.Driver.Internal.DirectMongoServerProxy.Connect(TimeSpan timeout, ReadPreference readPreference)



9120 13:17:30 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #12 13:17:30 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #4 13:17:30 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #4 13:17:30 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
 424 13:17:31 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #10 13:17:31 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
6160 13:17:33 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

3600 13:17:36 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #0 13:17:40 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #0 13:17:40 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
2472 13:17:40 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Core.BackgroundService.Run()

4424 13:17:41 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #15 13:17:44 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
7520 13:17:44 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

9120 13:17:45 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

 424 13:17:46 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

6160 13:17:48 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #4 13:17:50 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #4 13:17:50 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
3600 13:17:51 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

5296 13:17:55 INFO  [Experience Analytics]: Reduce agent found zero sites to process
2472 13:17:55 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Core.BackgroundService.Run()

4424 13:17:56 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

7520 13:17:59 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

9120 13:18:00 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #0 13:18:00 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #0 13:18:00 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
 424 13:18:01 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

6160 13:18:03 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

3600 13:18:06 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #4 13:18:10 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #4 13:18:10 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
2472 13:18:11 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Core.BackgroundService.Run()

4424 13:18:11 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

7520 13:18:14 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

9120 13:18:15 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

 424 13:18:16 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

6160 13:18:18 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #0 13:18:20 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #0 13:18:20 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
3600 13:18:21 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

5296 13:18:25 INFO  [Experience Analytics]: Reduce agent found zero sites to process
ManagedPoolThread #5 13:18:26 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #1 13:18:28 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #6 13:18:29 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
7520 13:18:29 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #3 13:18:30 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
9120 13:18:30 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #9 13:18:30 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #9 13:18:30 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
ManagedPoolThread #16 13:18:31 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
 424 13:18:31 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

2472 13:18:32 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: MongoDB.Driver.MongoConnectionException
Message: Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
Source: MongoDB.Driver
   at MongoDB.Driver.Internal.DirectMongoServerProxy.Connect(TimeSpan timeout, ReadPreference readPreference)
   at MongoDB.Driver.Internal.DirectMongoServerProxy.ChooseServerInstance(ReadPreference readPreference)
   at MongoDB.Driver.MongoServer.AcquireConnection(ReadPreference readPreference)
   at MongoDB.Driver.MongoCursor`1.MongoCursorConnectionProvider.AcquireConnection()
   at MongoDB.Driver.Operations.QueryOperation`1.GetFirstBatch(IConnectionProvider connectionProvider)
   at MongoDB.Driver.Operations.QueryOperation`1.Execute(IConnectionProvider connectionProvider)
   at System.Linq.Enumerable.FirstOrDefault[TSource](IEnumerable`1 source)
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Core.BackgroundService.Run()

Nested Exception

Exception: System.Net.Sockets.SocketException
Message: No connection could be made because the target machine actively refused it 127.0.0.1:27017
Source: System
   at System.Net.Sockets.Socket.DoConnect(EndPoint endPointSnapshot, SocketAddress socketAddress)
   at System.Net.Sockets.Socket.Connect(EndPoint remoteEP)
   at System.Net.Sockets.TcpClient.Connect(IPEndPoint remoteEP)
   at MongoDB.Driver.Internal.MongoConnection.Open()
   at MongoDB.Driver.Internal.MongoConnection.SendMessage(BsonBuffer buffer, Int32 requestId)
   at MongoDB.Driver.Internal.MongoConnection.SendMessage(MongoRequestMessage message)
   at MongoDB.Driver.Operations.CommandOperation`1.Execute(MongoConnection connection)
   at MongoDB.Driver.MongoServerInstance.Ping(MongoConnection connection)
   at MongoDB.Driver.MongoServerInstance.Connect()
   at MongoDB.Driver.Internal.DirectMongoServerProxy.Connect(TimeSpan timeout, ReadPreference readPreference)


ManagedPoolThread #13 13:18:33 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
6160 13:18:33 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #14 13:18:34 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #11 13:18:35 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #19 13:18:36 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
3600 13:18:36 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #17 13:18:37 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #2 13:18:38 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
4424 13:18:39 ERROR Exception when executing agent aggregation/automationAggregator
Exception: MongoDB.Driver.MongoConnectionException
Message: Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
Source: MongoDB.Driver
   at MongoDB.Driver.Internal.DirectMongoServerProxy.Connect(TimeSpan timeout, ReadPreference readPreference)
   at MongoDB.Driver.Internal.DirectMongoServerProxy.ChooseServerInstance(ReadPreference readPreference)
   at MongoDB.Driver.MongoServer.AcquireConnection(ReadPreference readPreference)
   at MongoDB.Driver.MongoCursor`1.MongoCursorConnectionProvider.AcquireConnection()
   at MongoDB.Driver.Operations.QueryOperation`1.GetFirstBatch(IConnectionProvider connectionProvider)
   at MongoDB.Driver.Operations.QueryOperation`1.Execute(IConnectionProvider connectionProvider)
   at System.Linq.Buffer`1..ctor(IEnumerable`1 source)
   at System.Linq.Enumerable.ToArray[TSource](IEnumerable`1 source)
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

Nested Exception

Exception: System.Net.Sockets.SocketException
Message: No connection could be made because the target machine actively refused it 127.0.0.1:27017
Source: System
   at System.Net.Sockets.Socket.DoConnect(EndPoint endPointSnapshot, SocketAddress socketAddress)
   at System.Net.Sockets.Socket.Connect(EndPoint remoteEP)
   at System.Net.Sockets.TcpClient.Connect(IPEndPoint remoteEP)
   at MongoDB.Driver.Internal.MongoConnection.Open()
   at MongoDB.Driver.Internal.MongoConnection.SendMessage(BsonBuffer buffer, Int32 requestId)
   at MongoDB.Driver.Internal.MongoConnection.SendMessage(MongoRequestMessage message)
   at MongoDB.Driver.Operations.CommandOperation`1.Execute(MongoConnection connection)
   at MongoDB.Driver.MongoServerInstance.Ping(MongoConnection connection)
   at MongoDB.Driver.MongoServerInstance.Connect()
   at MongoDB.Driver.Internal.DirectMongoServerProxy.Connect(TimeSpan timeout, ReadPreference readPreference)


ManagedPoolThread #12 13:18:40 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #8 13:18:40 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #8 13:18:40 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
ManagedPoolThread #10 13:18:41 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #18 13:18:42 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #7 13:18:43 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
7520 13:18:44 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #15 13:18:45 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
9120 13:18:45 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

 424 13:18:46 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

2472 13:18:47 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Core.BackgroundService.Run()

6160 13:18:48 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #9 13:18:50 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #9 13:18:50 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
3600 13:18:51 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

4424 13:18:54 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

5296 13:18:55 INFO  [Experience Analytics]: Reduce agent found zero sites to process
7520 13:18:59 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

9120 13:19:00 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #8 13:19:00 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #8 13:19:00 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
 424 13:19:01 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

2472 13:19:02 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Core.BackgroundService.Run()

6160 13:19:03 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

3600 13:19:06 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

4424 13:19:09 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #9 13:19:10 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #9 13:19:10 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
Heartbeat 13:19:10 ERROR MongoDbDictionary.Store() has failed.
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Save(Object value)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbDictionary.Store(Object value)

7520 13:19:14 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

9120 13:19:15 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

 424 13:19:16 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

2472 13:19:17 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Core.BackgroundService.Run()

6160 13:19:18 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #8 13:19:20 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #8 13:19:20 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
3600 13:19:21 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

4424 13:19:24 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

5296 13:19:25 INFO  [Experience Analytics]: Reduce agent found zero sites to process
7520 13:19:29 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

9120 13:19:30 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #0 13:19:30 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #0 13:19:30 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
 424 13:19:31 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

2472 13:19:32 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Core.BackgroundService.Run()

6160 13:19:33 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

3600 13:19:36 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #2 13:19:39 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
4424 13:19:39 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #5 13:19:40 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #4 13:19:40 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #4 13:19:40 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
ManagedPoolThread #3 13:19:41 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #6 13:19:42 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #16 13:19:43 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #1 13:19:44 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #13 13:19:45 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
9120 13:19:45 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #14 13:19:46 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
 424 13:19:46 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

2472 13:19:47 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #11 13:19:47 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
6160 13:19:48 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #17 13:19:48 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #19 13:19:49 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #18 13:19:50 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #0 13:19:50 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #0 13:19:50 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
ManagedPoolThread #7 13:19:51 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
3600 13:19:51 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

7520 13:19:52 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
7520 13:19:52 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.HandleDatabaseException(ExceptionBehavior exceptionBehavior, Exception ex)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

Nested Exception

Exception: MongoDB.Driver.MongoConnectionException
Message: Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
Source: MongoDB.Driver
   at MongoDB.Driver.Internal.DirectMongoServerProxy.Connect(TimeSpan timeout, ReadPreference readPreference)
   at MongoDB.Driver.Internal.DirectMongoServerProxy.ChooseServerInstance(ReadPreference readPreference)
   at MongoDB.Driver.MongoServer.AcquireConnection(ReadPreference readPreference)
   at MongoDB.Driver.MongoCollection.RunCommandAs[TCommandResult](IMongoCommand command, ReadPreference readPreference, IBsonSerializer resultSerializer, IBsonSerializationOptions resultSerializationOptions)
   at MongoDB.Driver.MongoCollection.RunCommandAs[TCommandResult](IMongoCommand command, ReadPreference readPreference)
   at MongoDB.Driver.MongoCollection.FindAndModify(FindAndModifyArgs args)
   at MongoDB.Driver.MongoCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.<>c__DisplayClass2c.<FindAndModify>b__2b()
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)

Nested Exception

Exception: System.Net.Sockets.SocketException
Message: No connection could be made because the target machine actively refused it 127.0.0.1:27017
Source: System
   at System.Net.Sockets.Socket.DoConnect(EndPoint endPointSnapshot, SocketAddress socketAddress)
   at System.Net.Sockets.Socket.Connect(EndPoint remoteEP)
   at System.Net.Sockets.TcpClient.Connect(IPEndPoint remoteEP)
   at MongoDB.Driver.Internal.MongoConnection.Open()
   at MongoDB.Driver.Internal.MongoConnection.SendMessage(BsonBuffer buffer, Int32 requestId)
   at MongoDB.Driver.Internal.MongoConnection.SendMessage(MongoRequestMessage message)
   at MongoDB.Driver.Operations.CommandOperation`1.Execute(MongoConnection connection)
   at MongoDB.Driver.MongoServerInstance.Ping(MongoConnection connection)
   at MongoDB.Driver.MongoServerInstance.Connect()
   at MongoDB.Driver.Internal.DirectMongoServerProxy.Connect(TimeSpan timeout, ReadPreference readPreference)



ManagedPoolThread #15 13:19:53 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
4424 13:19:54 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #12 13:19:54 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #10 13:19:55 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
5296 13:19:55 INFO  [Experience Analytics]: Reduce agent found zero sites to process
9120 13:20:00 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #4 13:20:00 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #4 13:20:00 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
 424 13:20:01 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

2472 13:20:02 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Core.BackgroundService.Run()

6160 13:20:03 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

3600 13:20:06 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

7520 13:20:07 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

4424 13:20:09 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #8 13:20:10 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #8 13:20:10 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
9120 13:20:15 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

 424 13:20:16 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

2472 13:20:17 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Core.BackgroundService.Run()

6160 13:20:18 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #9 13:20:20 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #9 13:20:20 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
3600 13:20:21 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

7520 13:20:22 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

4424 13:20:24 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

5296 13:20:25 INFO  [Experience Analytics]: Reduce agent found zero sites to process
9120 13:20:30 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #4 13:20:30 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #4 13:20:30 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
 424 13:20:31 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

2472 13:20:32 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Core.BackgroundService.Run()

6160 13:20:33 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

3600 13:20:36 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

7520 13:20:37 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

4424 13:20:39 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #0 13:20:40 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #0 13:20:40 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
9120 13:20:45 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

 424 13:20:46 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

2472 13:20:47 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Core.BackgroundService.Run()

6160 13:20:48 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #4 13:20:50 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #4 13:20:50 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
ManagedPoolThread #14 13:20:50 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
3600 13:20:51 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #6 13:20:51 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
7520 13:20:52 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #11 13:20:53 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #1 13:20:54 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
4424 13:20:54 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #5 13:20:55 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
5296 13:20:55 INFO  [Experience Analytics]: Reduce agent found zero sites to process
ManagedPoolThread #3 13:20:56 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #19 13:20:56 ERROR Unable to connect to server localhost:27017: Message header opcode is not the expected one..
ManagedPoolThread #17 13:20:57 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #13 13:20:58 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #16 13:20:59 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #15 13:21:00 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
9120 13:21:00 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #0 13:21:00 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #0 13:21:00 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
ManagedPoolThread #12 13:21:01 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
 424 13:21:01 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

2472 13:21:02 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #10 13:21:02 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #18 13:21:03 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
6160 13:21:03 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #7 13:21:04 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
3600 13:21:06 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

7520 13:21:07 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

4424 13:21:09 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #4 13:21:10 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #4 13:21:10 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
Heartbeat 13:21:11 ERROR MongoDbDictionary.Store() has failed.
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Save(Object value)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbDictionary.Store(Object value)

9120 13:21:15 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

 424 13:21:16 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

2472 13:21:17 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Core.BackgroundService.Run()

6160 13:21:18 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #0 13:21:20 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #0 13:21:20 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
3600 13:21:21 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

7520 13:21:22 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

5056 13:21:23 INFO  [Path Analyzer](.) Running trail cleanup agent
5056 13:21:23 INFO  [Path Analyzer](.) Running trail cleanup on database
4088 13:21:24 WARN  [Path Analyzer](.) SmartMergeAgent.Execute() returns. No missing date ranges to merge.
4424 13:21:24 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

5296 13:21:25 INFO  [Experience Analytics]: Reduce agent found zero sites to process
ManagedPoolThread #4 13:21:25 INFO  Job started: Sitecore.Tasks.CounterDumpAgent
ManagedPoolThread #9 13:21:25 WARN  Failed to create counter 'Sitecore.Caching\CacheClearings'. Sitecore has no necessary permissions for reading/creating counters
ManagedPoolThread #9 13:21:25 WARN  Failed to create counter 'Sitecore.Caching\DataCacheClearings'. Sitecore has no necessary permissions for reading/creating counters
ManagedPoolThread #8 13:21:25 WARN  Failed to create counter 'Sitecore.Caching\CacheMisses'. Sitecore has no necessary permissions for reading/creating counters
ManagedPoolThread #0 13:21:25 WARN  Failed to create counter 'Sitecore.Caching\CacheHits'. Sitecore has no necessary permissions for reading/creating counters
ManagedPoolThread #9 13:21:26 WARN  Failed to create counter 'Sitecore.Caching\DataCacheHits'. Sitecore has no necessary permissions for reading/creating counters
ManagedPoolThread #9 13:21:26 WARN  Failed to create counter 'Sitecore.Caching\HtmlCacheHits'. Sitecore has no necessary permissions for reading/creating counters
ManagedPoolThread #0 13:21:26 WARN  Failed to create counter 'Sitecore.Caching\HtmlCacheClearings'. Sitecore has no necessary permissions for reading/creating counters
ManagedPoolThread #0 13:21:26 WARN  Failed to create counter 'Sitecore.Caching\PathCacheClearings'. Sitecore has no necessary permissions for reading/creating counters
ManagedPoolThread #9 13:21:26 WARN  Failed to create counter 'Sitecore.Caching\HtmlCacheMisses'. Sitecore has no necessary permissions for reading/creating counters
ManagedPoolThread #0 13:21:26 WARN  Failed to create counter 'Sitecore.Caching\PathCacheHits'. Sitecore has no necessary permissions for reading/creating counters
ManagedPoolThread #9 13:21:26 WARN  Failed to create counter 'Sitecore.Caching\PathCacheMisses'. Sitecore has no necessary permissions for reading/creating counters
ManagedPoolThread #0 13:21:26 WARN  Failed to create counter 'Sitecore.Caching\RegistryCacheClearings'. Sitecore has no necessary permissions for reading/creating counters
ManagedPoolThread #0 13:21:26 WARN  Failed to create counter 'Sitecore.Caching\RegistryCacheMisses'. Sitecore has no necessary permissions for reading/creating counters
ManagedPoolThread #9 13:21:26 WARN  Failed to create counter 'Sitecore.Caching\RegistryCacheHits'. Sitecore has no necessary permissions for reading/creating counters
ManagedPoolThread #8 13:21:26 WARN  Failed to create counter 'Sitecore.Caching\DataCacheMisses'. Sitecore has no necessary permissions for reading/creating counters
ManagedPoolThread #8 13:21:26 WARN  Failed to create counter 'Sitecore.Caching\ViewStateCacheMisses'. Sitecore has no necessary permissions for reading/creating counters
ManagedPoolThread #9 13:21:26 WARN  Failed to create counter 'Sitecore.Caching\ViewStateCacheHits'. Sitecore has no necessary permissions for reading/creating counters
ManagedPoolThread #8 13:21:26 WARN  Failed to create counter 'Sitecore.Caching\XslCacheClearings'. Sitecore has no necessary permissions for reading/creating counters
ManagedPoolThread #9 13:21:26 WARN  Failed to create counter 'Sitecore.Caching\XslCacheHits'. Sitecore has no necessary permissions for reading/creating counters
ManagedPoolThread #8 13:21:26 WARN  Failed to create counter 'Sitecore.Caching\XslCacheMisses'. Sitecore has no necessary permissions for reading/creating counters
ManagedPoolThread #9 13:21:26 WARN  Failed to create counter 'Sitecore.Presentation\Context.SiteChanged'. Sitecore has no necessary permissions for reading/creating counters
ManagedPoolThread #0 13:21:26 WARN  Failed to create counter 'Sitecore.Caching\ViewStateCacheClearings'. Sitecore has no necessary permissions for reading/creating counters
ManagedPoolThread #9 13:21:26 WARN  Failed to create counter 'Sitecore.System\Exceptions.ExceptionsThrown'. Sitecore has no necessary permissions for reading/creating counters
ManagedPoolThread #0 13:21:26 WARN  Failed to create counter 'Sitecore.Data\Globalization.TextsTranslated'. Sitecore has no necessary permissions for reading/creating counters
ManagedPoolThread #8 13:21:26 WARN  Failed to create counter 'Sitecore.System\Events.EventsRaised'. Sitecore has no necessary permissions for reading/creating counters
ManagedPoolThread #9 13:21:26 WARN  Failed to create counter 'Sitecore.Data\Globalization.TranslateFailed'. Sitecore has no necessary permissions for reading/creating counters
ManagedPoolThread #0 13:21:26 WARN  Failed to create counter 'Sitecore.System\IO.FileWatcherEvents'. Sitecore has no necessary permissions for reading/creating counters
ManagedPoolThread #8 13:21:26 WARN  Failed to create counter 'Sitecore.Jobs\Jobs.JobsExecuted'. Sitecore has no necessary permissions for reading/creating counters
ManagedPoolThread #0 13:21:26 WARN  Failed to create counter 'Sitecore.Data\Links.DataRead'. Sitecore has no necessary permissions for reading/creating counters
ManagedPoolThread #9 13:21:26 WARN  Failed to create counter 'Sitecore.Data\Links.FieldsExamined'. Sitecore has no necessary permissions for reading/creating counters
ManagedPoolThread #0 13:21:26 WARN  Failed to create counter 'Sitecore.Data\Links.DataUpdated'. Sitecore has no necessary permissions for reading/creating counters
ManagedPoolThread #8 13:21:26 WARN  Failed to create counter 'Sitecore.System\Logging.ErrorsLogged'. Sitecore has no necessary permissions for reading/creating counters
ManagedPoolThread #8 13:21:26 WARN  Failed to create counter 'Sitecore.System\Logging.FatalsLogged'. Sitecore has no necessary permissions for reading/creating counters
ManagedPoolThread #9 13:21:26 WARN  Failed to create counter 'Sitecore.System\Logging.AuditsLogged'. Sitecore has no necessary permissions for reading/creating counters
ManagedPoolThread #9 13:21:26 WARN  Failed to create counter 'Sitecore.System\Logging.WarningsLogged'. Sitecore has no necessary permissions for reading/creating counters
ManagedPoolThread #8 13:21:26 WARN  Failed to create counter 'Sitecore.System\Logging.InformationsLogged'. Sitecore has no necessary permissions for reading/creating counters
Heartbeat 13:21:26 INFO  Health.PrivateBytes: 696,311,808
Heartbeat 13:21:26 INFO  Health.CacheInstances: 115
Heartbeat 13:21:26 INFO  Health.CacheTotalCount: 18,100
Heartbeat 13:21:26 INFO  Health.CacheTotalSize: 75,523,756
ManagedPoolThread #0 13:21:26 WARN  Failed to create counter 'Sitecore.Jobs\Publishing.IncrementalPublishings'. Sitecore has no necessary permissions for reading/creating counters
ManagedPoolThread #0 13:21:26 WARN  Failed to create counter 'Sitecore.Jobs\Publishing.ItemPublishings'. Sitecore has no necessary permissions for reading/creating counters
ManagedPoolThread #9 13:21:26 WARN  Failed to create counter 'Sitecore.Jobs\Publishing.FullPublishings'. Sitecore has no necessary permissions for reading/creating counters
ManagedPoolThread #9 13:21:26 WARN  Failed to create counter 'Sitecore.Jobs\Publishing.ItemsPublished'. Sitecore has no necessary permissions for reading/creating counters
ManagedPoolThread #0 13:21:26 WARN  Failed to create counter 'Sitecore.Jobs\Publishing.ItemsExamined'. Sitecore has no necessary permissions for reading/creating counters
ManagedPoolThread #0 13:21:26 WARN  Failed to create counter 'Sitecore.Jobs\Publishing.Replacements'. Sitecore has no necessary permissions for reading/creating counters
ManagedPoolThread #9 13:21:26 WARN  Failed to create counter 'Sitecore.Jobs\Publishing.ItemsQueued'. Sitecore has no necessary permissions for reading/creating counters
ManagedPoolThread #0 13:21:26 WARN  Failed to create counter 'Sitecore.Jobs\Publishing.TotalPublishings'. Sitecore has no necessary permissions for reading/creating counters
ManagedPoolThread #8 13:21:26 WARN  Failed to create counter 'Sitecore.Jobs\Publishing.SmartPublishings'. Sitecore has no necessary permissions for reading/creating counters
ManagedPoolThread #0 13:21:26 WARN  Failed to create counter 'Sitecore.System\Reflection.ObjectsCreated'. Sitecore has no necessary permissions for reading/creating counters
ManagedPoolThread #8 13:21:26 WARN  Failed to create counter 'Sitecore.System\Reflection.ObjectsNotCreated'. Sitecore has no necessary permissions for reading/creating counters
ManagedPoolThread #0 13:21:26 WARN  Failed to create counter 'Sitecore.System\Reflection.TypesResolved'. Sitecore has no necessary permissions for reading/creating counters
ManagedPoolThread #8 13:21:26 WARN  Failed to create counter 'Sitecore.System\Reflection.TypesNotResolved'. Sitecore has no necessary permissions for reading/creating counters
ManagedPoolThread #9 13:21:26 WARN  Failed to create counter 'Sitecore.System\Reflection.MethodsInvoked'. Sitecore has no necessary permissions for reading/creating counters
ManagedPoolThread #0 13:21:26 WARN  Failed to create counter 'Sitecore.Presentation\Rendering.ControlsRendered'. Sitecore has no necessary permissions for reading/creating counters
ManagedPoolThread #0 13:21:26 WARN  Failed to create counter 'Sitecore.Presentation\Rendering.RenderingsRendered'. Sitecore has no necessary permissions for reading/creating counters
ManagedPoolThread #9 13:21:26 WARN  Failed to create counter 'Sitecore.Presentation\Rendering.PagesGenerated'. Sitecore has no necessary permissions for reading/creating counters
ManagedPoolThread #0 13:21:26 WARN  Failed to create counter 'Sitecore.Presentation\Rendering.SublayoutsRendered'. Sitecore has no necessary permissions for reading/creating counters
ManagedPoolThread #9 13:21:26 WARN  Failed to create counter 'Sitecore.Presentation\Rendering.XmlControlsCompiled'. Sitecore has no necessary permissions for reading/creating counters
ManagedPoolThread #0 13:21:26 WARN  Failed to create counter 'Sitecore.Presentation\Rendering.XamlControlsCompiled'. Sitecore has no necessary permissions for reading/creating counters
ManagedPoolThread #9 13:21:26 WARN  Failed to create counter 'Sitecore.Presentation\Rendering.XslTransformsRendered'. Sitecore has no necessary permissions for reading/creating counters
ManagedPoolThread #8 13:21:26 WARN  Failed to create counter 'Sitecore.Presentation\Rendering.ControlsRenderedFromCache'. Sitecore has no necessary permissions for reading/creating counters
ManagedPoolThread #0 13:21:26 WARN  Failed to create counter 'Sitecore.Security\AccessDenied'. Sitecore has no necessary permissions for reading/creating counters
ManagedPoolThread #0 13:21:26 WARN  Failed to create counter 'Sitecore.Security\ModifyRequests'. Sitecore has no necessary permissions for reading/creating counters
ManagedPoolThread #0 13:21:26 WARN  Failed to create counter 'Sitecore.Security\ProgrammaticDisabling'. Sitecore has no necessary permissions for reading/creating counters
ManagedPoolThread #9 13:21:26 WARN  Failed to create counter 'Sitecore.Security\AccessGranted'. Sitecore has no necessary permissions for reading/creating counters
ManagedPoolThread #0 13:21:26 WARN  Failed to create counter 'Sitecore.Security\ProgrammaticEnabling'. Sitecore has no necessary permissions for reading/creating counters
ManagedPoolThread #9 13:21:26 WARN  Failed to create counter 'Sitecore.Security\ProgrammaticUserSwitch'. Sitecore has no necessary permissions for reading/creating counters
ManagedPoolThread #0 13:21:26 WARN  Failed to create counter 'Sitecore.Security\ReadRequests'. Sitecore has no necessary permissions for reading/creating counters
ManagedPoolThread #9 13:21:26 WARN  Failed to create counter 'Sitecore.Security\VirtualUsersBuilt'. Sitecore has no necessary permissions for reading/creating counters
ManagedPoolThread #8 13:21:26 WARN  Failed to create counter 'Sitecore.Security\AccessResolved'. Sitecore has no necessary permissions for reading/creating counters
ManagedPoolThread #9 13:21:26 WARN  Failed to create counter 'Sitecore.Data\Shadows.DataUpdated'. Sitecore has no necessary permissions for reading/creating counters
ManagedPoolThread #0 13:21:26 WARN  Failed to create counter 'Sitecore.Data\Shadows.DataRead'. Sitecore has no necessary permissions for reading/creating counters
ManagedPoolThread #9 13:21:26 WARN  Failed to create counter 'Sitecore.Jobs\Tasks.HtmlCacheClearings'. Sitecore has no necessary permissions for reading/creating counters
ManagedPoolThread #0 13:21:26 WARN  Failed to create counter 'Sitecore.Jobs\Tasks.ItemsArchived'. Sitecore has no necessary permissions for reading/creating counters
ManagedPoolThread #9 13:21:26 WARN  Failed to create counter 'Sitecore.Jobs\Tasks.Publishings'. Sitecore has no necessary permissions for reading/creating counters
ManagedPoolThread #0 13:21:26 WARN  Failed to create counter 'Sitecore.Jobs\Tasks.RemindersSent'. Sitecore has no necessary permissions for reading/creating counters
ManagedPoolThread #8 13:21:26 WARN  Failed to create counter 'Sitecore.Jobs\Tasks.FileCleanups'. Sitecore has no necessary permissions for reading/creating counters
ManagedPoolThread #9 13:21:26 WARN  Failed to create counter 'Sitecore.Jobs\Tasks.TasksExecuted'. Sitecore has no necessary permissions for reading/creating counters
ManagedPoolThread #9 13:21:26 WARN  Failed to create counter 'Sitecore.System\Threading.ThreadDataModified'. Sitecore has no necessary permissions for reading/creating counters
ManagedPoolThread #8 13:21:26 WARN  Failed to create counter 'Sitecore.System\Threading.ThreadDataRead'. Sitecore has no necessary permissions for reading/creating counters
ManagedPoolThread #0 13:21:26 WARN  Failed to create counter 'Sitecore.System\Threading.BackgroundThreadsStarted'. Sitecore has no necessary permissions for reading/creating counters
ManagedPoolThread #9 13:21:26 WARN  Failed to create counter 'Sitecore.Data\Workflow.SecurityResolved'. Sitecore has no necessary permissions for reading/creating counters
ManagedPoolThread #0 13:21:26 WARN  Failed to create counter 'Sitecore.Data\Workflow.StateChanges'. Sitecore has no necessary permissions for reading/creating counters
ManagedPoolThread #8 13:21:26 WARN  Failed to create counter 'Sitecore.Data\Workflow.ActionsExecuted'. Sitecore has no necessary permissions for reading/creating counters
ManagedPoolThread #8 13:21:26 WARN  Failed to create counter 'Sitecore.System\Xml.ItemNavigatorsCreated'. Sitecore has no necessary permissions for reading/creating counters
ManagedPoolThread #9 13:21:26 WARN  Failed to create counter 'Sitecore.System\Xml.PacketsCreated'. Sitecore has no necessary permissions for reading/creating counters
ManagedPoolThread #4 13:21:26 INFO  Job ended: Sitecore.Tasks.CounterDumpAgent (units processed: )
ManagedPoolThread #0 13:21:26 INFO  Job started: Sitecore.Analytics.Tasks.EmailReportsTask
ManagedPoolThread #0 13:21:26 INFO  EmailReportsTask started. Database: master
ManagedPoolThread #0 13:21:26 INFO  Job ended: Sitecore.Analytics.Tasks.EmailReportsTask (units processed: )
ManagedPoolThread #8 13:21:26 INFO  Job started: Sitecore.Social.Client.Tasks.PostFlaggedMessages
ManagedPoolThread #8 13:21:26 INFO  Sitecore.Social: Processing messages posting...
ManagedPoolThread #8 13:21:26 INFO  Sitecore.Social: Done.
ManagedPoolThread #8 13:21:26 INFO  Job ended: Sitecore.Social.Client.Tasks.PostFlaggedMessages (units processed: )
ManagedPoolThread #9 13:21:26 INFO  Job started: Sitecore.Social.Client.Tasks.UpdateMessagesStatistics
ManagedPoolThread #9 13:21:26 INFO  Sitecore.Social: Update messages statistics...
ManagedPoolThread #9 13:21:26 INFO  Sitecore.Social: The context database is: master
ManagedPoolThread #9 13:21:26 INFO  Sitecore.Social: No posted messages are found.
ManagedPoolThread #9 13:21:26 INFO  Sitecore.Social: Done.
ManagedPoolThread #9 13:21:26 INFO  Job ended: Sitecore.Social.Client.Tasks.UpdateMessagesStatistics (units processed: )
9120 13:21:30 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

 424 13:21:31 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #0 13:21:31 INFO  Job started: Sitecore.Tasks.UrlAgent
ManagedPoolThread #0 13:21:31 INFO  Scheduling.UrlAgent started. Url: http://gathercontent.dev/sitecore/service/keepalive.aspx
ManagedPoolThread #0 13:21:31 INFO  Scheduling.UrlAgent done (received: 561 bytes)
ManagedPoolThread #0 13:21:31 INFO  Job ended: Sitecore.Tasks.UrlAgent (units processed: )
ManagedPoolThread #9 13:21:31 INFO  Job started: Sitecore.Tasks.TaskDatabaseAgent
ManagedPoolThread #9 13:21:31 INFO  Processing tasks (count: 0)
ManagedPoolThread #9 13:21:31 INFO  Job ended: Sitecore.Tasks.TaskDatabaseAgent (units processed: )
ManagedPoolThread #8 13:21:31 INFO  Job started: Core_Database_Agent
ManagedPoolThread #8 13:21:31 INFO  Scheduling.DatabaseAgent started. Database: core
ManagedPoolThread #8 13:21:31 INFO  Examining schedules (count: 0)
ManagedPoolThread #8 13:21:31 INFO  Job ended: Core_Database_Agent (units processed: )
ManagedPoolThread #0 13:21:31 INFO  Job started: Master_Database_Agent
ManagedPoolThread #0 13:21:31 INFO  Scheduling.DatabaseAgent started. Database: master
ManagedPoolThread #0 13:21:31 INFO  Examining schedules (count: 5)
ManagedPoolThread #0 13:21:31 INFO  Starting: __Task Schedule
ManagedPoolThread #0 13:21:31 INFO  Ended: __Task Schedule
ManagedPoolThread #0 13:21:31 INFO  Not due: Calculate Statistical Relevancy
ManagedPoolThread #0 13:21:31 INFO  Not due: Rebuild Suggested Tests Index
ManagedPoolThread #0 13:21:31 INFO  Not due: Suspend Corrupted Tests
ManagedPoolThread #0 13:21:31 INFO  Not due: Try Finish Test
ManagedPoolThread #0 13:21:31 INFO  Job ended: Master_Database_Agent (units processed: 5)
ManagedPoolThread #4 13:21:31 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #4 13:21:31 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
2472 13:21:32 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Core.BackgroundService.Run()

6160 13:21:33 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

3600 13:21:36 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

7520 13:21:37 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

4424 13:21:39 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #8 13:21:41 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #8 13:21:41 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
9120 13:21:45 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

 424 13:21:46 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

2472 13:21:47 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Core.BackgroundService.Run()

6160 13:21:48 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #4 13:21:51 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #4 13:21:51 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
3600 13:21:51 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

7520 13:21:52 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

4424 13:21:54 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

5296 13:21:55 INFO  [Experience Analytics]: Reduce agent found zero sites to process
ManagedPoolThread #2 13:22:00 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
9120 13:22:00 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #6 13:22:01 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
 424 13:22:01 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #8 13:22:01 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #8 13:22:01 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
2472 13:22:02 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #11 13:22:02 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
6160 13:22:03 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #14 13:22:03 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #1 13:22:04 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #5 13:22:05 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #3 13:22:06 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
3600 13:22:06 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #19 13:22:07 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #13 13:22:08 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
4424 13:22:09 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #17 13:22:09 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #16 13:22:10 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #15 13:22:11 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #4 13:22:11 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #4 13:22:11 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
ManagedPoolThread #18 13:22:12 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #7 13:22:13 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
7520 13:22:14 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
7520 13:22:14 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.HandleDatabaseException(ExceptionBehavior exceptionBehavior, Exception ex)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

Nested Exception

Exception: MongoDB.Driver.MongoConnectionException
Message: Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
Source: MongoDB.Driver
   at MongoDB.Driver.Internal.DirectMongoServerProxy.Connect(TimeSpan timeout, ReadPreference readPreference)
   at MongoDB.Driver.Internal.DirectMongoServerProxy.ChooseServerInstance(ReadPreference readPreference)
   at MongoDB.Driver.MongoServer.AcquireConnection(ReadPreference readPreference)
   at MongoDB.Driver.MongoCollection.RunCommandAs[TCommandResult](IMongoCommand command, ReadPreference readPreference, IBsonSerializer resultSerializer, IBsonSerializationOptions resultSerializationOptions)
   at MongoDB.Driver.MongoCollection.RunCommandAs[TCommandResult](IMongoCommand command, ReadPreference readPreference)
   at MongoDB.Driver.MongoCollection.FindAndModify(FindAndModifyArgs args)
   at MongoDB.Driver.MongoCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.<>c__DisplayClass2c.<FindAndModify>b__2b()
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)

Nested Exception

Exception: System.Net.Sockets.SocketException
Message: No connection could be made because the target machine actively refused it 127.0.0.1:27017
Source: System
   at System.Net.Sockets.Socket.DoConnect(EndPoint endPointSnapshot, SocketAddress socketAddress)
   at System.Net.Sockets.Socket.Connect(EndPoint remoteEP)
   at System.Net.Sockets.TcpClient.Connect(IPEndPoint remoteEP)
   at MongoDB.Driver.Internal.MongoConnection.Open()
   at MongoDB.Driver.Internal.MongoConnection.SendMessage(BsonBuffer buffer, Int32 requestId)
   at MongoDB.Driver.Internal.MongoConnection.SendMessage(MongoRequestMessage message)
   at MongoDB.Driver.Operations.CommandOperation`1.Execute(MongoConnection connection)
   at MongoDB.Driver.MongoServerInstance.Ping(MongoConnection connection)
   at MongoDB.Driver.MongoServerInstance.Connect()
   at MongoDB.Driver.Internal.DirectMongoServerProxy.Connect(TimeSpan timeout, ReadPreference readPreference)



9120 13:22:15 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #12 13:22:15 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
 424 13:22:16 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #10 13:22:16 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
2472 13:22:17 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Core.BackgroundService.Run()

6160 13:22:18 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

3600 13:22:21 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #8 13:22:21 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #8 13:22:21 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
4424 13:22:24 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

5296 13:22:25 INFO  [Experience Analytics]: Reduce agent found zero sites to process
7520 13:22:29 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

9120 13:22:30 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

 424 13:22:31 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #9 13:22:31 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #9 13:22:31 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
2472 13:22:32 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Core.BackgroundService.Run()

6160 13:22:33 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

3600 13:22:36 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

4424 13:22:39 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #0 13:22:41 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #0 13:22:41 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
7520 13:22:44 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

9120 13:22:45 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

 424 13:22:46 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

2472 13:22:47 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Core.BackgroundService.Run()

6160 13:22:48 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

3600 13:22:51 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #9 13:22:51 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #9 13:22:51 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
4424 13:22:54 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

5296 13:22:55 INFO  [Experience Analytics]: Reduce agent found zero sites to process
7520 13:22:59 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

9120 13:23:00 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

 424 13:23:01 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #0 13:23:01 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #0 13:23:01 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
2472 13:23:02 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Core.BackgroundService.Run()

6160 13:23:03 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

3600 13:23:06 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

4424 13:23:09 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #6 13:23:11 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #8 13:23:12 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #8 13:23:12 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
ManagedPoolThread #11 13:23:12 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
Heartbeat 13:23:12 ERROR MongoDbDictionary.Store() has failed.
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Save(Object value)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbDictionary.Store(Object value)

ManagedPoolThread #14 13:23:13 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
7520 13:23:14 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #5 13:23:14 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
9120 13:23:15 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #1 13:23:15 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
 424 13:23:16 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #19 13:23:16 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
2472 13:23:17 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #3 13:23:18 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
6160 13:23:18 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #13 13:23:19 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #17 13:23:20 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #16 13:23:21 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
3600 13:23:21 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #4 13:23:22 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #4 13:23:22 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
ManagedPoolThread #15 13:23:22 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #12 13:23:23 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #10 13:23:24 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
4424 13:23:24 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #18 13:23:25 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
5296 13:23:25 INFO  [Experience Analytics]: Reduce agent found zero sites to process
ManagedPoolThread #7 13:23:26 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
7520 13:23:29 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

9120 13:23:30 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

 424 13:23:31 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #0 13:23:32 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #0 13:23:32 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
2472 13:23:32 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Core.BackgroundService.Run()

6160 13:23:33 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

3600 13:23:36 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

4424 13:23:39 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #9 13:23:42 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #9 13:23:42 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
7520 13:23:44 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

9120 13:23:45 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

 424 13:23:46 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

2472 13:23:47 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Core.BackgroundService.Run()

6160 13:23:48 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

3600 13:23:51 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #0 13:23:52 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #0 13:23:52 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
4424 13:23:54 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

5296 13:23:55 INFO  [Experience Analytics]: Reduce agent found zero sites to process
7520 13:23:59 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

9120 13:24:00 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

 424 13:24:01 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #9 13:24:02 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #9 13:24:02 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
2472 13:24:02 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Core.BackgroundService.Run()

6160 13:24:03 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

3600 13:24:06 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

4424 13:24:09 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #0 13:24:12 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #0 13:24:12 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
7520 13:24:14 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

9120 13:24:15 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

 424 13:24:16 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

2472 13:24:17 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Core.BackgroundService.Run()

6160 13:24:18 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #9 13:24:22 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #9 13:24:22 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
ManagedPoolThread #14 13:24:22 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #6 13:24:23 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
4424 13:24:24 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #5 13:24:24 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
5296 13:24:25 INFO  [Experience Analytics]: Reduce agent found zero sites to process
ManagedPoolThread #11 13:24:25 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #1 13:24:26 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #19 13:24:27 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #13 13:24:28 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #3 13:24:29 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
9120 13:24:30 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #17 13:24:30 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
 424 13:24:31 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #16 13:24:31 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #4 13:24:32 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #4 13:24:32 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
2472 13:24:32 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Core.BackgroundService.Run()

3600 13:24:32 ERROR Exception when executing agent aggregation/automationAggregator
Exception: MongoDB.Driver.MongoConnectionException
Message: Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
Source: MongoDB.Driver
   at MongoDB.Driver.Internal.DirectMongoServerProxy.Connect(TimeSpan timeout, ReadPreference readPreference)
   at MongoDB.Driver.Internal.DirectMongoServerProxy.ChooseServerInstance(ReadPreference readPreference)
   at MongoDB.Driver.MongoServer.AcquireConnection(ReadPreference readPreference)
   at MongoDB.Driver.MongoCursor`1.MongoCursorConnectionProvider.AcquireConnection()
   at MongoDB.Driver.Operations.QueryOperation`1.GetFirstBatch(IConnectionProvider connectionProvider)
   at MongoDB.Driver.Operations.QueryOperation`1.Execute(IConnectionProvider connectionProvider)
   at System.Linq.Buffer`1..ctor(IEnumerable`1 source)
   at System.Linq.Enumerable.ToArray[TSource](IEnumerable`1 source)
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

Nested Exception

Exception: System.Net.Sockets.SocketException
Message: No connection could be made because the target machine actively refused it 127.0.0.1:27017
Source: System
   at System.Net.Sockets.Socket.DoConnect(EndPoint endPointSnapshot, SocketAddress socketAddress)
   at System.Net.Sockets.Socket.Connect(EndPoint remoteEP)
   at System.Net.Sockets.TcpClient.Connect(IPEndPoint remoteEP)
   at MongoDB.Driver.Internal.MongoConnection.Open()
   at MongoDB.Driver.Internal.MongoConnection.SendMessage(BsonBuffer buffer, Int32 requestId)
   at MongoDB.Driver.Internal.MongoConnection.SendMessage(MongoRequestMessage message)
   at MongoDB.Driver.Operations.CommandOperation`1.Execute(MongoConnection connection)
   at MongoDB.Driver.MongoServerInstance.Ping(MongoConnection connection)
   at MongoDB.Driver.MongoServerInstance.Connect()
   at MongoDB.Driver.Internal.DirectMongoServerProxy.Connect(TimeSpan timeout, ReadPreference readPreference)


6160 13:24:33 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #15 13:24:33 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #18 13:24:34 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #7 13:24:35 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
7520 13:24:36 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
7520 13:24:36 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.HandleDatabaseException(ExceptionBehavior exceptionBehavior, Exception ex)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

Nested Exception

Exception: MongoDB.Driver.MongoConnectionException
Message: Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
Source: MongoDB.Driver
   at MongoDB.Driver.Internal.DirectMongoServerProxy.Connect(TimeSpan timeout, ReadPreference readPreference)
   at MongoDB.Driver.Internal.DirectMongoServerProxy.ChooseServerInstance(ReadPreference readPreference)
   at MongoDB.Driver.MongoServer.AcquireConnection(ReadPreference readPreference)
   at MongoDB.Driver.MongoCollection.RunCommandAs[TCommandResult](IMongoCommand command, ReadPreference readPreference, IBsonSerializer resultSerializer, IBsonSerializationOptions resultSerializationOptions)
   at MongoDB.Driver.MongoCollection.RunCommandAs[TCommandResult](IMongoCommand command, ReadPreference readPreference)
   at MongoDB.Driver.MongoCollection.FindAndModify(FindAndModifyArgs args)
   at MongoDB.Driver.MongoCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.<>c__DisplayClass2c.<FindAndModify>b__2b()
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)

Nested Exception

Exception: System.Net.Sockets.SocketException
Message: No connection could be made because the target machine actively refused it 127.0.0.1:27017
Source: System
   at System.Net.Sockets.Socket.DoConnect(EndPoint endPointSnapshot, SocketAddress socketAddress)
   at System.Net.Sockets.Socket.Connect(EndPoint remoteEP)
   at System.Net.Sockets.TcpClient.Connect(IPEndPoint remoteEP)
   at MongoDB.Driver.Internal.MongoConnection.Open()
   at MongoDB.Driver.Internal.MongoConnection.SendMessage(BsonBuffer buffer, Int32 requestId)
   at MongoDB.Driver.Internal.MongoConnection.SendMessage(MongoRequestMessage message)
   at MongoDB.Driver.Operations.CommandOperation`1.Execute(MongoConnection connection)
   at MongoDB.Driver.MongoServerInstance.Ping(MongoConnection connection)
   at MongoDB.Driver.MongoServerInstance.Connect()
   at MongoDB.Driver.Internal.DirectMongoServerProxy.Connect(TimeSpan timeout, ReadPreference readPreference)



ManagedPoolThread #12 13:24:37 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #10 13:24:38 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
4424 13:24:39 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #8 13:24:42 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #8 13:24:42 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
9120 13:24:45 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

 424 13:24:46 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

2472 13:24:47 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Core.BackgroundService.Run()

3600 13:24:47 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

6160 13:24:48 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

7520 13:24:51 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #4 13:24:52 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #4 13:24:52 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
4424 13:24:54 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

5296 13:24:55 INFO  [Experience Analytics]: Reduce agent found zero sites to process
9120 13:25:00 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

 424 13:25:01 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #8 13:25:02 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #8 13:25:02 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
2472 13:25:02 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Core.BackgroundService.Run()

3600 13:25:02 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

6160 13:25:03 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

7520 13:25:06 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

4424 13:25:09 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #4 13:25:12 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #4 13:25:12 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
Heartbeat 13:25:13 ERROR MongoDbDictionary.Store() has failed.
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Save(Object value)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbDictionary.Store(Object value)

9120 13:25:15 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

 424 13:25:16 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

2472 13:25:17 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Core.BackgroundService.Run()

3600 13:25:17 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

6160 13:25:18 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

7520 13:25:21 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #8 13:25:22 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #8 13:25:22 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
4424 13:25:24 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

5296 13:25:25 INFO  [Experience Analytics]: Reduce agent found zero sites to process
9120 13:25:30 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

 424 13:25:31 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #9 13:25:32 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #9 13:25:32 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
ManagedPoolThread #6 13:25:33 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
6160 13:25:33 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #19 13:25:34 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #11 13:25:35 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #13 13:25:36 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
7520 13:25:36 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #16 13:25:37 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #1 13:25:38 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #17 13:25:39 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
4424 13:25:39 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #5 13:25:40 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #3 13:25:41 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #0 13:25:42 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #0 13:25:42 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
ManagedPoolThread #14 13:25:42 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
2472 13:25:43 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: MongoDB.Driver.MongoConnectionException
Message: Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
Source: MongoDB.Driver
   at MongoDB.Driver.Internal.DirectMongoServerProxy.Connect(TimeSpan timeout, ReadPreference readPreference)
   at MongoDB.Driver.Internal.DirectMongoServerProxy.ChooseServerInstance(ReadPreference readPreference)
   at MongoDB.Driver.MongoServer.AcquireConnection(ReadPreference readPreference)
   at MongoDB.Driver.MongoCursor`1.MongoCursorConnectionProvider.AcquireConnection()
   at MongoDB.Driver.Operations.QueryOperation`1.GetFirstBatch(IConnectionProvider connectionProvider)
   at MongoDB.Driver.Operations.QueryOperation`1.Execute(IConnectionProvider connectionProvider)
   at System.Linq.Enumerable.FirstOrDefault[TSource](IEnumerable`1 source)
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Core.BackgroundService.Run()

Nested Exception

Exception: System.Net.Sockets.SocketException
Message: No connection could be made because the target machine actively refused it 127.0.0.1:27017
Source: System
   at System.Net.Sockets.Socket.DoConnect(EndPoint endPointSnapshot, SocketAddress socketAddress)
   at System.Net.Sockets.Socket.Connect(EndPoint remoteEP)
   at System.Net.Sockets.TcpClient.Connect(IPEndPoint remoteEP)
   at MongoDB.Driver.Internal.MongoConnection.Open()
   at MongoDB.Driver.Internal.MongoConnection.SendMessage(BsonBuffer buffer, Int32 requestId)
   at MongoDB.Driver.Internal.MongoConnection.SendMessage(MongoRequestMessage message)
   at MongoDB.Driver.Operations.CommandOperation`1.Execute(MongoConnection connection)
   at MongoDB.Driver.MongoServerInstance.Ping(MongoConnection connection)
   at MongoDB.Driver.MongoServerInstance.Connect()
   at MongoDB.Driver.Internal.DirectMongoServerProxy.Connect(TimeSpan timeout, ReadPreference readPreference)


3600 13:25:44 ERROR Exception when executing agent aggregation/automationAggregator
Exception: MongoDB.Driver.MongoConnectionException
Message: Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
Source: MongoDB.Driver
   at MongoDB.Driver.Internal.DirectMongoServerProxy.Connect(TimeSpan timeout, ReadPreference readPreference)
   at MongoDB.Driver.Internal.DirectMongoServerProxy.ChooseServerInstance(ReadPreference readPreference)
   at MongoDB.Driver.MongoServer.AcquireConnection(ReadPreference readPreference)
   at MongoDB.Driver.MongoCursor`1.MongoCursorConnectionProvider.AcquireConnection()
   at MongoDB.Driver.Operations.QueryOperation`1.GetFirstBatch(IConnectionProvider connectionProvider)
   at MongoDB.Driver.Operations.QueryOperation`1.Execute(IConnectionProvider connectionProvider)
   at System.Linq.Buffer`1..ctor(IEnumerable`1 source)
   at System.Linq.Enumerable.ToArray[TSource](IEnumerable`1 source)
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

Nested Exception

Exception: System.Net.Sockets.SocketException
Message: No connection could be made because the target machine actively refused it 127.0.0.1:27017
Source: System
   at System.Net.Sockets.Socket.DoConnect(EndPoint endPointSnapshot, SocketAddress socketAddress)
   at System.Net.Sockets.Socket.Connect(EndPoint remoteEP)
   at System.Net.Sockets.TcpClient.Connect(IPEndPoint remoteEP)
   at MongoDB.Driver.Internal.MongoConnection.Open()
   at MongoDB.Driver.Internal.MongoConnection.SendMessage(BsonBuffer buffer, Int32 requestId)
   at MongoDB.Driver.Internal.MongoConnection.SendMessage(MongoRequestMessage message)
   at MongoDB.Driver.Operations.CommandOperation`1.Execute(MongoConnection connection)
   at MongoDB.Driver.MongoServerInstance.Ping(MongoConnection connection)
   at MongoDB.Driver.MongoServerInstance.Connect()
   at MongoDB.Driver.Internal.DirectMongoServerProxy.Connect(TimeSpan timeout, ReadPreference readPreference)


ManagedPoolThread #15 13:25:45 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
9120 13:25:45 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #12 13:25:46 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
 424 13:25:46 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #10 13:25:47 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
6160 13:25:48 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #18 13:25:48 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #7 13:25:49 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
7520 13:25:51 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #9 13:25:52 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #9 13:25:52 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
4424 13:25:54 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

5296 13:25:55 INFO  [Experience Analytics]: Reduce agent found zero sites to process
2472 13:25:58 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Core.BackgroundService.Run()

3600 13:25:59 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

9120 13:26:00 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

 424 13:26:01 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #0 13:26:02 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #0 13:26:02 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
6160 13:26:03 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

7520 13:26:06 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

4424 13:26:09 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #8 13:26:12 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #8 13:26:12 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
2472 13:26:13 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Core.BackgroundService.Run()

3600 13:26:14 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

9120 13:26:15 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

 424 13:26:16 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

6160 13:26:18 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

7520 13:26:21 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #4 13:26:22 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #4 13:26:22 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
5056 13:26:23 INFO  [Path Analyzer](.) Running trail cleanup agent
5056 13:26:23 INFO  [Path Analyzer](.) Running trail cleanup on database
4424 13:26:24 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

5296 13:26:25 INFO  [Experience Analytics]: Reduce agent found zero sites to process
2472 13:26:28 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Core.BackgroundService.Run()

3600 13:26:29 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

9120 13:26:30 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

 424 13:26:31 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #8 13:26:32 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #8 13:26:32 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
6160 13:26:33 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

7520 13:26:36 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

4424 13:26:39 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #9 13:26:42 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #9 13:26:42 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
ManagedPoolThread #11 13:26:43 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
3600 13:26:44 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #13 13:26:44 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
9120 13:26:45 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #19 13:26:45 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
 424 13:26:46 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #6 13:26:46 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #1 13:26:47 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
6160 13:26:48 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #17 13:26:48 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #3 13:26:49 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #5 13:26:50 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #14 13:26:51 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #0 13:26:52 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #0 13:26:52 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
ManagedPoolThread #16 13:26:52 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
7092 13:26:54 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
4424 13:26:54 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

2472 13:26:55 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: MongoDB.Driver.MongoConnectionException
Message: Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
Source: MongoDB.Driver
   at MongoDB.Driver.Internal.DirectMongoServerProxy.Connect(TimeSpan timeout, ReadPreference readPreference)
   at MongoDB.Driver.Internal.DirectMongoServerProxy.ChooseServerInstance(ReadPreference readPreference)
   at MongoDB.Driver.MongoServer.AcquireConnection(ReadPreference readPreference)
   at MongoDB.Driver.MongoCursor`1.MongoCursorConnectionProvider.AcquireConnection()
   at MongoDB.Driver.Operations.QueryOperation`1.GetFirstBatch(IConnectionProvider connectionProvider)
   at MongoDB.Driver.Operations.QueryOperation`1.Execute(IConnectionProvider connectionProvider)
   at System.Linq.Enumerable.FirstOrDefault[TSource](IEnumerable`1 source)
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Core.BackgroundService.Run()

Nested Exception

Exception: System.Net.Sockets.SocketException
Message: No connection could be made because the target machine actively refused it 127.0.0.1:27017
Source: System
   at System.Net.Sockets.Socket.DoConnect(EndPoint endPointSnapshot, SocketAddress socketAddress)
   at System.Net.Sockets.Socket.Connect(EndPoint remoteEP)
   at System.Net.Sockets.TcpClient.Connect(IPEndPoint remoteEP)
   at MongoDB.Driver.Internal.MongoConnection.Open()
   at MongoDB.Driver.Internal.MongoConnection.SendMessage(BsonBuffer buffer, Int32 requestId)
   at MongoDB.Driver.Internal.MongoConnection.SendMessage(MongoRequestMessage message)
   at MongoDB.Driver.Operations.CommandOperation`1.Execute(MongoConnection connection)
   at MongoDB.Driver.MongoServerInstance.Ping(MongoConnection connection)
   at MongoDB.Driver.MongoServerInstance.Connect()
   at MongoDB.Driver.Internal.DirectMongoServerProxy.Connect(TimeSpan timeout, ReadPreference readPreference)


5296 13:26:55 INFO  [Experience Analytics]: Reduce agent found zero sites to process
ManagedPoolThread #15 13:26:56 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #18 13:26:57 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #7 13:26:58 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
7520 13:26:59 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
7520 13:26:59 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.HandleDatabaseException(ExceptionBehavior exceptionBehavior, Exception ex)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

Nested Exception

Exception: MongoDB.Driver.MongoConnectionException
Message: Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
Source: MongoDB.Driver
   at MongoDB.Driver.Internal.DirectMongoServerProxy.Connect(TimeSpan timeout, ReadPreference readPreference)
   at MongoDB.Driver.Internal.DirectMongoServerProxy.ChooseServerInstance(ReadPreference readPreference)
   at MongoDB.Driver.MongoServer.AcquireConnection(ReadPreference readPreference)
   at MongoDB.Driver.MongoCollection.RunCommandAs[TCommandResult](IMongoCommand command, ReadPreference readPreference, IBsonSerializer resultSerializer, IBsonSerializationOptions resultSerializationOptions)
   at MongoDB.Driver.MongoCollection.RunCommandAs[TCommandResult](IMongoCommand command, ReadPreference readPreference)
   at MongoDB.Driver.MongoCollection.FindAndModify(FindAndModifyArgs args)
   at MongoDB.Driver.MongoCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.<>c__DisplayClass2c.<FindAndModify>b__2b()
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)

Nested Exception

Exception: System.Net.Sockets.SocketException
Message: No connection could be made because the target machine actively refused it 127.0.0.1:27017
Source: System
   at System.Net.Sockets.Socket.DoConnect(EndPoint endPointSnapshot, SocketAddress socketAddress)
   at System.Net.Sockets.Socket.Connect(EndPoint remoteEP)
   at System.Net.Sockets.TcpClient.Connect(IPEndPoint remoteEP)
   at MongoDB.Driver.Internal.MongoConnection.Open()
   at MongoDB.Driver.Internal.MongoConnection.SendMessage(BsonBuffer buffer, Int32 requestId)
   at MongoDB.Driver.Internal.MongoConnection.SendMessage(MongoRequestMessage message)
   at MongoDB.Driver.Operations.CommandOperation`1.Execute(MongoConnection connection)
   at MongoDB.Driver.MongoServerInstance.Ping(MongoConnection connection)
   at MongoDB.Driver.MongoServerInstance.Connect()
   at MongoDB.Driver.Internal.DirectMongoServerProxy.Connect(TimeSpan timeout, ReadPreference readPreference)



3600 13:26:59 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #12 13:27:00 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
9120 13:27:00 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #10 13:27:01 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
 424 13:27:01 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #9 13:27:02 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #9 13:27:02 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
6160 13:27:03 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

4424 13:27:09 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

2472 13:27:10 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #0 13:27:12 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #0 13:27:12 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
7520 13:27:14 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

3600 13:27:14 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

Heartbeat 13:27:14 ERROR MongoDbDictionary.Store() has failed.
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Save(Object value)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbDictionary.Store(Object value)

9120 13:27:15 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

 424 13:27:16 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

6160 13:27:18 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #9 13:27:22 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #9 13:27:22 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
4424 13:27:24 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

2472 13:27:25 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Core.BackgroundService.Run()

5296 13:27:25 INFO  [Experience Analytics]: Reduce agent found zero sites to process
7520 13:27:29 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

3600 13:27:29 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

9120 13:27:30 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

 424 13:27:31 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #8 13:27:32 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #8 13:27:32 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
6160 13:27:33 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

4424 13:27:39 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

2472 13:27:40 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #4 13:27:42 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #4 13:27:42 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
7520 13:27:44 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

3600 13:27:44 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

9120 13:27:45 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

 424 13:27:46 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

6160 13:27:48 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #8 13:27:52 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #8 13:27:52 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
7092 13:27:55 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
5296 13:27:55 INFO  [Experience Analytics]: Reduce agent found zero sites to process
4424 13:27:56 ERROR Exception when executing agent aggregation/automationAggregator
Exception: MongoDB.Driver.MongoConnectionException
Message: Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
Source: MongoDB.Driver
   at MongoDB.Driver.Internal.DirectMongoServerProxy.Connect(TimeSpan timeout, ReadPreference readPreference)
   at MongoDB.Driver.Internal.DirectMongoServerProxy.ChooseServerInstance(ReadPreference readPreference)
   at MongoDB.Driver.MongoServer.AcquireConnection(ReadPreference readPreference)
   at MongoDB.Driver.MongoCursor`1.MongoCursorConnectionProvider.AcquireConnection()
   at MongoDB.Driver.Operations.QueryOperation`1.GetFirstBatch(IConnectionProvider connectionProvider)
   at MongoDB.Driver.Operations.QueryOperation`1.Execute(IConnectionProvider connectionProvider)
   at System.Linq.Buffer`1..ctor(IEnumerable`1 source)
   at System.Linq.Enumerable.ToArray[TSource](IEnumerable`1 source)
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

Nested Exception

Exception: System.Net.Sockets.SocketException
Message: No connection could be made because the target machine actively refused it 127.0.0.1:27017
Source: System
   at System.Net.Sockets.Socket.DoConnect(EndPoint endPointSnapshot, SocketAddress socketAddress)
   at System.Net.Sockets.Socket.Connect(EndPoint remoteEP)
   at System.Net.Sockets.TcpClient.Connect(IPEndPoint remoteEP)
   at MongoDB.Driver.Internal.MongoConnection.Open()
   at MongoDB.Driver.Internal.MongoConnection.SendMessage(BsonBuffer buffer, Int32 requestId)
   at MongoDB.Driver.Internal.MongoConnection.SendMessage(MongoRequestMessage message)
   at MongoDB.Driver.Operations.CommandOperation`1.Execute(MongoConnection connection)
   at MongoDB.Driver.MongoServerInstance.Ping(MongoConnection connection)
   at MongoDB.Driver.MongoServerInstance.Connect()
   at MongoDB.Driver.Internal.DirectMongoServerProxy.Connect(TimeSpan timeout, ReadPreference readPreference)


ManagedPoolThread #16 13:27:57 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #14 13:27:58 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #19 13:27:59 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
7520 13:27:59 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

3600 13:27:59 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #5 13:28:00 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
9120 13:28:00 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #3 13:28:01 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
 424 13:28:01 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #13 13:28:02 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #4 13:28:02 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #4 13:28:02 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
ManagedPoolThread #1 13:28:03 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
6160 13:28:03 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #6 13:28:04 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #17 13:28:05 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #11 13:28:06 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
2472 13:28:07 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: MongoDB.Driver.MongoConnectionException
Message: Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
Source: MongoDB.Driver
   at MongoDB.Driver.Internal.DirectMongoServerProxy.Connect(TimeSpan timeout, ReadPreference readPreference)
   at MongoDB.Driver.Internal.DirectMongoServerProxy.ChooseServerInstance(ReadPreference readPreference)
   at MongoDB.Driver.MongoServer.AcquireConnection(ReadPreference readPreference)
   at MongoDB.Driver.MongoCursor`1.MongoCursorConnectionProvider.AcquireConnection()
   at MongoDB.Driver.Operations.QueryOperation`1.GetFirstBatch(IConnectionProvider connectionProvider)
   at MongoDB.Driver.Operations.QueryOperation`1.Execute(IConnectionProvider connectionProvider)
   at System.Linq.Enumerable.FirstOrDefault[TSource](IEnumerable`1 source)
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Core.BackgroundService.Run()

Nested Exception

Exception: System.Net.Sockets.SocketException
Message: No connection could be made because the target machine actively refused it 127.0.0.1:27017
Source: System
   at System.Net.Sockets.Socket.DoConnect(EndPoint endPointSnapshot, SocketAddress socketAddress)
   at System.Net.Sockets.Socket.Connect(EndPoint remoteEP)
   at System.Net.Sockets.TcpClient.Connect(IPEndPoint remoteEP)
   at MongoDB.Driver.Internal.MongoConnection.Open()
   at MongoDB.Driver.Internal.MongoConnection.SendMessage(BsonBuffer buffer, Int32 requestId)
   at MongoDB.Driver.Internal.MongoConnection.SendMessage(MongoRequestMessage message)
   at MongoDB.Driver.Operations.CommandOperation`1.Execute(MongoConnection connection)
   at MongoDB.Driver.MongoServerInstance.Ping(MongoConnection connection)
   at MongoDB.Driver.MongoServerInstance.Connect()
   at MongoDB.Driver.Internal.DirectMongoServerProxy.Connect(TimeSpan timeout, ReadPreference readPreference)


ManagedPoolThread #15 13:28:08 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #12 13:28:09 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #10 13:28:10 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
4424 13:28:11 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #18 13:28:11 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #7 13:28:12 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #8 13:28:12 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #8 13:28:12 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
7520 13:28:14 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

3600 13:28:14 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

9120 13:28:15 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

 424 13:28:16 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

6160 13:28:18 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

2472 13:28:22 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #4 13:28:22 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #4 13:28:22 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
5296 13:28:25 INFO  [Experience Analytics]: Reduce agent found zero sites to process
4424 13:28:26 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

7520 13:28:29 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

3600 13:28:29 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

9120 13:28:30 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

 424 13:28:31 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #9 13:28:32 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #9 13:28:32 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
6160 13:28:33 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

2472 13:28:37 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Core.BackgroundService.Run()

4424 13:28:41 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #0 13:28:42 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #0 13:28:42 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
7520 13:28:44 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

3600 13:28:44 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

9120 13:28:45 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

 424 13:28:46 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

6160 13:28:48 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

2472 13:28:52 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #9 13:28:52 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #9 13:28:52 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
5296 13:28:55 INFO  [Experience Analytics]: Reduce agent found zero sites to process
4424 13:28:56 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

7520 13:28:59 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

3600 13:28:59 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

9120 13:29:00 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

 424 13:29:01 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #0 13:29:02 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #0 13:29:02 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
6160 13:29:03 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #19 13:29:07 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #5 13:29:08 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #14 13:29:09 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #16 13:29:10 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
4424 13:29:11 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #13 13:29:11 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #4 13:29:12 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #4 13:29:12 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
ManagedPoolThread #1 13:29:12 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #11 13:29:13 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
3600 13:29:14 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #3 13:29:14 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
9120 13:29:15 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #6 13:29:15 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
Heartbeat 13:29:16 ERROR MongoDbDictionary.Store() has failed.
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Save(Object value)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbDictionary.Store(Object value)

 424 13:29:16 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #17 13:29:16 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
2472 13:29:17 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: MongoDB.Driver.MongoConnectionException
Message: Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
Source: MongoDB.Driver
   at MongoDB.Driver.Internal.DirectMongoServerProxy.Connect(TimeSpan timeout, ReadPreference readPreference)
   at MongoDB.Driver.Internal.DirectMongoServerProxy.ChooseServerInstance(ReadPreference readPreference)
   at MongoDB.Driver.MongoServer.AcquireConnection(ReadPreference readPreference)
   at MongoDB.Driver.MongoCursor`1.MongoCursorConnectionProvider.AcquireConnection()
   at MongoDB.Driver.Operations.QueryOperation`1.GetFirstBatch(IConnectionProvider connectionProvider)
   at MongoDB.Driver.Operations.QueryOperation`1.Execute(IConnectionProvider connectionProvider)
   at System.Linq.Enumerable.FirstOrDefault[TSource](IEnumerable`1 source)
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Core.BackgroundService.Run()

Nested Exception

Exception: System.Net.Sockets.SocketException
Message: No connection could be made because the target machine actively refused it 127.0.0.1:27017
Source: System
   at System.Net.Sockets.Socket.DoConnect(EndPoint endPointSnapshot, SocketAddress socketAddress)
   at System.Net.Sockets.Socket.Connect(EndPoint remoteEP)
   at System.Net.Sockets.TcpClient.Connect(IPEndPoint remoteEP)
   at MongoDB.Driver.Internal.MongoConnection.Open()
   at MongoDB.Driver.Internal.MongoConnection.SendMessage(BsonBuffer buffer, Int32 requestId)
   at MongoDB.Driver.Internal.MongoConnection.SendMessage(MongoRequestMessage message)
   at MongoDB.Driver.Operations.CommandOperation`1.Execute(MongoConnection connection)
   at MongoDB.Driver.MongoServerInstance.Ping(MongoConnection connection)
   at MongoDB.Driver.MongoServerInstance.Connect()
   at MongoDB.Driver.Internal.DirectMongoServerProxy.Connect(TimeSpan timeout, ReadPreference readPreference)


6160 13:29:18 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #15 13:29:18 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #18 13:29:19 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #7 13:29:20 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
7520 13:29:21 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
7520 13:29:21 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.HandleDatabaseException(ExceptionBehavior exceptionBehavior, Exception ex)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

Nested Exception

Exception: MongoDB.Driver.MongoConnectionException
Message: Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
Source: MongoDB.Driver
   at MongoDB.Driver.Internal.DirectMongoServerProxy.Connect(TimeSpan timeout, ReadPreference readPreference)
   at MongoDB.Driver.Internal.DirectMongoServerProxy.ChooseServerInstance(ReadPreference readPreference)
   at MongoDB.Driver.MongoServer.AcquireConnection(ReadPreference readPreference)
   at MongoDB.Driver.MongoCollection.RunCommandAs[TCommandResult](IMongoCommand command, ReadPreference readPreference, IBsonSerializer resultSerializer, IBsonSerializationOptions resultSerializationOptions)
   at MongoDB.Driver.MongoCollection.RunCommandAs[TCommandResult](IMongoCommand command, ReadPreference readPreference)
   at MongoDB.Driver.MongoCollection.FindAndModify(FindAndModifyArgs args)
   at MongoDB.Driver.MongoCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.<>c__DisplayClass2c.<FindAndModify>b__2b()
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)

Nested Exception

Exception: System.Net.Sockets.SocketException
Message: No connection could be made because the target machine actively refused it 127.0.0.1:27017
Source: System
   at System.Net.Sockets.Socket.DoConnect(EndPoint endPointSnapshot, SocketAddress socketAddress)
   at System.Net.Sockets.Socket.Connect(EndPoint remoteEP)
   at System.Net.Sockets.TcpClient.Connect(IPEndPoint remoteEP)
   at MongoDB.Driver.Internal.MongoConnection.Open()
   at MongoDB.Driver.Internal.MongoConnection.SendMessage(BsonBuffer buffer, Int32 requestId)
   at MongoDB.Driver.Internal.MongoConnection.SendMessage(MongoRequestMessage message)
   at MongoDB.Driver.Operations.CommandOperation`1.Execute(MongoConnection connection)
   at MongoDB.Driver.MongoServerInstance.Ping(MongoConnection connection)
   at MongoDB.Driver.MongoServerInstance.Connect()
   at MongoDB.Driver.Internal.DirectMongoServerProxy.Connect(TimeSpan timeout, ReadPreference readPreference)



ManagedPoolThread #8 13:29:22 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #8 13:29:22 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
ManagedPoolThread #12 13:29:22 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #10 13:29:23 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
5296 13:29:25 INFO  [Experience Analytics]: Reduce agent found zero sites to process
4424 13:29:26 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

3600 13:29:29 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

9120 13:29:30 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

 424 13:29:31 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #0 13:29:32 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #0 13:29:32 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
2472 13:29:32 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Core.BackgroundService.Run()

6160 13:29:33 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

7520 13:29:36 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

4424 13:29:41 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #9 13:29:42 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #9 13:29:42 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
3600 13:29:44 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

9120 13:29:45 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

 424 13:29:46 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

2472 13:29:47 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Core.BackgroundService.Run()

6160 13:29:48 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

7520 13:29:51 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #0 13:29:52 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #0 13:29:52 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
5296 13:29:55 INFO  [Experience Analytics]: Reduce agent found zero sites to process
4424 13:29:56 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

3600 13:29:59 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

9120 13:30:00 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

 424 13:30:01 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #9 13:30:02 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #9 13:30:02 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
2472 13:30:02 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Core.BackgroundService.Run()

6160 13:30:03 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

7520 13:30:06 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

4424 13:30:11 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #0 13:30:12 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #0 13:30:12 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
3600 13:30:14 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

9120 13:30:15 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

 424 13:30:16 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #19 13:30:18 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
6160 13:30:18 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #5 13:30:19 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #14 13:30:20 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #13 13:30:21 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
7520 13:30:21 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #16 13:30:22 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #9 13:30:22 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #9 13:30:22 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
ManagedPoolThread #3 13:30:23 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #1 13:30:24 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #11 13:30:25 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
5296 13:30:25 INFO  [Experience Analytics]: Reduce agent found zero sites to process
4424 13:30:26 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #6 13:30:26 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #17 13:30:27 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
2472 13:30:28 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: MongoDB.Driver.MongoConnectionException
Message: Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
Source: MongoDB.Driver
   at MongoDB.Driver.Internal.DirectMongoServerProxy.Connect(TimeSpan timeout, ReadPreference readPreference)
   at MongoDB.Driver.Internal.DirectMongoServerProxy.ChooseServerInstance(ReadPreference readPreference)
   at MongoDB.Driver.MongoServer.AcquireConnection(ReadPreference readPreference)
   at MongoDB.Driver.MongoCursor`1.MongoCursorConnectionProvider.AcquireConnection()
   at MongoDB.Driver.Operations.QueryOperation`1.GetFirstBatch(IConnectionProvider connectionProvider)
   at MongoDB.Driver.Operations.QueryOperation`1.Execute(IConnectionProvider connectionProvider)
   at System.Linq.Enumerable.FirstOrDefault[TSource](IEnumerable`1 source)
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Core.BackgroundService.Run()

Nested Exception

Exception: System.Net.Sockets.SocketException
Message: No connection could be made because the target machine actively refused it 127.0.0.1:27017
Source: System
   at System.Net.Sockets.Socket.DoConnect(EndPoint endPointSnapshot, SocketAddress socketAddress)
   at System.Net.Sockets.Socket.Connect(EndPoint remoteEP)
   at System.Net.Sockets.TcpClient.Connect(IPEndPoint remoteEP)
   at MongoDB.Driver.Internal.MongoConnection.Open()
   at MongoDB.Driver.Internal.MongoConnection.SendMessage(BsonBuffer buffer, Int32 requestId)
   at MongoDB.Driver.Internal.MongoConnection.SendMessage(MongoRequestMessage message)
   at MongoDB.Driver.Operations.CommandOperation`1.Execute(MongoConnection connection)
   at MongoDB.Driver.MongoServerInstance.Ping(MongoConnection connection)
   at MongoDB.Driver.MongoServerInstance.Connect()
   at MongoDB.Driver.Internal.DirectMongoServerProxy.Connect(TimeSpan timeout, ReadPreference readPreference)


ManagedPoolThread #15 13:30:29 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
3600 13:30:29 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #12 13:30:30 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
9120 13:30:30 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #10 13:30:31 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
 424 13:30:31 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #18 13:30:32 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #8 13:30:32 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #8 13:30:32 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
ManagedPoolThread #7 13:30:33 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
6160 13:30:33 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

7520 13:30:36 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

4424 13:30:41 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #4 13:30:42 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #4 13:30:42 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
2472 13:30:43 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Core.BackgroundService.Run()

3600 13:30:44 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

9120 13:30:45 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

 424 13:30:46 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

6160 13:30:48 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

7520 13:30:51 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #8 13:30:52 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #8 13:30:52 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
5296 13:30:55 INFO  [Experience Analytics]: Reduce agent found zero sites to process
4424 13:30:56 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

2472 13:30:58 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Core.BackgroundService.Run()

3600 13:30:59 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

9120 13:31:00 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

 424 13:31:01 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #4 13:31:02 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #4 13:31:02 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
6160 13:31:03 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

7520 13:31:06 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

4424 13:31:11 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #8 13:31:12 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #8 13:31:12 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
2472 13:31:13 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Core.BackgroundService.Run()

3600 13:31:14 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

9120 13:31:15 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

 424 13:31:16 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

Heartbeat 13:31:17 ERROR MongoDbDictionary.Store() has failed.
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Save(Object value)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbDictionary.Store(Object value)

6160 13:31:18 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

7520 13:31:21 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #4 13:31:22 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #4 13:31:22 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
5056 13:31:24 INFO  [Path Analyzer](.) Running trail cleanup agent
5056 13:31:24 INFO  [Path Analyzer](.) Running trail cleanup on database
5296 13:31:25 INFO  [Experience Analytics]: Reduce agent found zero sites to process
4424 13:31:26 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

Heartbeat 13:31:27 INFO  Health.PrivateBytes: 703,488,000
Heartbeat 13:31:27 INFO  Health.CacheInstances: 115
Heartbeat 13:31:27 INFO  Health.CacheTotalCount: 18,166
Heartbeat 13:31:27 INFO  Health.CacheTotalSize: 75,715,784
ManagedPoolThread #19 13:31:28 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
3600 13:31:29 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #14 13:31:29 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #13 13:31:30 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
9120 13:31:30 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #5 13:31:31 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
 424 13:31:31 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #3 13:31:32 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #8 13:31:32 INFO  Job started: Sitecore.Tasks.TaskDatabaseAgent
ManagedPoolThread #8 13:31:32 INFO  Processing tasks (count: 0)
ManagedPoolThread #8 13:31:32 INFO  Job ended: Sitecore.Tasks.TaskDatabaseAgent (units processed: )
ManagedPoolThread #8 13:31:32 INFO  Job started: Core_Database_Agent
ManagedPoolThread #8 13:31:32 INFO  Scheduling.DatabaseAgent started. Database: core
ManagedPoolThread #8 13:31:32 INFO  Examining schedules (count: 0)
ManagedPoolThread #8 13:31:32 INFO  Job ended: Core_Database_Agent (units processed: )
ManagedPoolThread #8 13:31:32 INFO  Job started: Master_Database_Agent
ManagedPoolThread #8 13:31:32 INFO  Scheduling.DatabaseAgent started. Database: master
ManagedPoolThread #8 13:31:32 INFO  Examining schedules (count: 5)
ManagedPoolThread #8 13:31:32 INFO  Starting: __Task Schedule
ManagedPoolThread #8 13:31:32 INFO  Ended: __Task Schedule
ManagedPoolThread #8 13:31:33 INFO  Not due: Calculate Statistical Relevancy
ManagedPoolThread #8 13:31:33 INFO  Starting: Rebuild Suggested Tests Index
ManagedPoolThread #0 13:31:33 INFO  Job started: Index_Update_IndexName=sitecore_suggested_test_index
ManagedPoolThread #8 13:31:33 INFO  Ended: Rebuild Suggested Tests Index
ManagedPoolThread #8 13:31:33 INFO  Starting: Suspend Corrupted Tests (asynchronously)
ManagedPoolThread #9 13:31:33 INFO  Job started: ScheduleCommand '{0B3BCF9C-A055-4363-80F5-B86C471F2C4A}'
ManagedPoolThread #9 13:31:33 INFO  Job ended: ScheduleCommand '{0B3BCF9C-A055-4363-80F5-B86C471F2C4A}' (units processed: )
6160 13:31:33 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #8 13:31:33 INFO  Ended: Suspend Corrupted Tests
ManagedPoolThread #8 13:31:33 INFO  Starting: Try Finish Test (asynchronously)
ManagedPoolThread #9 13:31:33 INFO  Job started: ScheduleCommand '{FD32AD12-69E6-41B6-82B8-712D9DA96DDC}'
ManagedPoolThread #9 13:31:33 INFO  Job ended: ScheduleCommand '{FD32AD12-69E6-41B6-82B8-712D9DA96DDC}' (units processed: )
ManagedPoolThread #8 13:31:33 INFO  Ended: Try Finish Test
ManagedPoolThread #8 13:31:33 INFO  Job ended: Master_Database_Agent (units processed: 5)
ManagedPoolThread #9 13:31:33 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #9 13:31:33 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
ManagedPoolThread #16 13:31:33 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #0 13:31:34 INFO  Job ended: Index_Update_IndexName=sitecore_suggested_test_index (units processed: 1)
ManagedPoolThread #11 13:31:34 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #1 13:31:35 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #6 13:31:36 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #17 13:31:37 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
2472 13:31:38 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: MongoDB.Driver.MongoConnectionException
Message: Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
Source: MongoDB.Driver
   at MongoDB.Driver.Internal.DirectMongoServerProxy.Connect(TimeSpan timeout, ReadPreference readPreference)
   at MongoDB.Driver.Internal.DirectMongoServerProxy.ChooseServerInstance(ReadPreference readPreference)
   at MongoDB.Driver.MongoServer.AcquireConnection(ReadPreference readPreference)
   at MongoDB.Driver.MongoCursor`1.MongoCursorConnectionProvider.AcquireConnection()
   at MongoDB.Driver.Operations.QueryOperation`1.GetFirstBatch(IConnectionProvider connectionProvider)
   at MongoDB.Driver.Operations.QueryOperation`1.Execute(IConnectionProvider connectionProvider)
   at System.Linq.Enumerable.FirstOrDefault[TSource](IEnumerable`1 source)
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Core.BackgroundService.Run()

Nested Exception

Exception: System.Net.Sockets.SocketException
Message: No connection could be made because the target machine actively refused it 127.0.0.1:27017
Source: System
   at System.Net.Sockets.Socket.DoConnect(EndPoint endPointSnapshot, SocketAddress socketAddress)
   at System.Net.Sockets.Socket.Connect(EndPoint remoteEP)
   at System.Net.Sockets.TcpClient.Connect(IPEndPoint remoteEP)
   at MongoDB.Driver.Internal.MongoConnection.Open()
   at MongoDB.Driver.Internal.MongoConnection.SendMessage(BsonBuffer buffer, Int32 requestId)
   at MongoDB.Driver.Internal.MongoConnection.SendMessage(MongoRequestMessage message)
   at MongoDB.Driver.Operations.CommandOperation`1.Execute(MongoConnection connection)
   at MongoDB.Driver.MongoServerInstance.Ping(MongoConnection connection)
   at MongoDB.Driver.MongoServerInstance.Connect()
   at MongoDB.Driver.Internal.DirectMongoServerProxy.Connect(TimeSpan timeout, ReadPreference readPreference)


ManagedPoolThread #15 13:31:39 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #18 13:31:40 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
4424 13:31:41 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #7 13:31:41 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
7520 13:31:42 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
7520 13:31:42 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.HandleDatabaseException(ExceptionBehavior exceptionBehavior, Exception ex)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

Nested Exception

Exception: MongoDB.Driver.MongoConnectionException
Message: Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
Source: MongoDB.Driver
   at MongoDB.Driver.Internal.DirectMongoServerProxy.Connect(TimeSpan timeout, ReadPreference readPreference)
   at MongoDB.Driver.Internal.DirectMongoServerProxy.ChooseServerInstance(ReadPreference readPreference)
   at MongoDB.Driver.MongoServer.AcquireConnection(ReadPreference readPreference)
   at MongoDB.Driver.MongoCollection.RunCommandAs[TCommandResult](IMongoCommand command, ReadPreference readPreference, IBsonSerializer resultSerializer, IBsonSerializationOptions resultSerializationOptions)
   at MongoDB.Driver.MongoCollection.RunCommandAs[TCommandResult](IMongoCommand command, ReadPreference readPreference)
   at MongoDB.Driver.MongoCollection.FindAndModify(FindAndModifyArgs args)
   at MongoDB.Driver.MongoCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.<>c__DisplayClass2c.<FindAndModify>b__2b()
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)

Nested Exception

Exception: System.Net.Sockets.SocketException
Message: No connection could be made because the target machine actively refused it 127.0.0.1:27017
Source: System
   at System.Net.Sockets.Socket.DoConnect(EndPoint endPointSnapshot, SocketAddress socketAddress)
   at System.Net.Sockets.Socket.Connect(EndPoint remoteEP)
   at System.Net.Sockets.TcpClient.Connect(IPEndPoint remoteEP)
   at MongoDB.Driver.Internal.MongoConnection.Open()
   at MongoDB.Driver.Internal.MongoConnection.SendMessage(BsonBuffer buffer, Int32 requestId)
   at MongoDB.Driver.Internal.MongoConnection.SendMessage(MongoRequestMessage message)
   at MongoDB.Driver.Operations.CommandOperation`1.Execute(MongoConnection connection)
   at MongoDB.Driver.MongoServerInstance.Ping(MongoConnection connection)
   at MongoDB.Driver.MongoServerInstance.Connect()
   at MongoDB.Driver.Internal.DirectMongoServerProxy.Connect(TimeSpan timeout, ReadPreference readPreference)



ManagedPoolThread #12 13:31:43 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
3600 13:31:44 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #10 13:31:44 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
9120 13:31:45 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

 424 13:31:46 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

6160 13:31:48 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

2472 13:31:53 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Core.BackgroundService.Run()

5296 13:31:55 INFO  [Experience Analytics]: Reduce agent found zero sites to process
4424 13:31:56 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

7520 13:31:57 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

3600 13:31:59 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

9120 13:32:00 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

 424 13:32:01 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

6160 13:32:03 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

2472 13:32:08 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Core.BackgroundService.Run()

4424 13:32:11 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

7520 13:32:12 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

3600 13:32:14 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

9120 13:32:15 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

 424 13:32:16 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

6160 13:32:18 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

2472 13:32:23 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Core.BackgroundService.Run()

5296 13:32:25 INFO  [Experience Analytics]: Reduce agent found zero sites to process
4424 13:32:26 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

7520 13:32:27 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

3600 13:32:29 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

9120 13:32:30 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

 424 13:32:31 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

6160 13:32:33 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #9 13:32:38 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #8 13:32:39 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #5 13:32:40 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
4424 13:32:41 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #13 13:32:41 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
7520 13:32:42 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #19 13:32:42 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #14 13:32:43 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
3600 13:32:44 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #1 13:32:44 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
9120 13:32:45 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #11 13:32:45 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
 424 13:32:46 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #16 13:32:46 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #3 13:32:47 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
6160 13:32:48 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #6 13:32:48 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #17 13:32:49 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #4 13:32:51 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #0 13:32:52 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
2472 13:32:53 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: MongoDB.Driver.MongoConnectionException
Message: Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
Source: MongoDB.Driver
   at MongoDB.Driver.Internal.DirectMongoServerProxy.Connect(TimeSpan timeout, ReadPreference readPreference)
   at MongoDB.Driver.Internal.DirectMongoServerProxy.ChooseServerInstance(ReadPreference readPreference)
   at MongoDB.Driver.MongoServer.AcquireConnection(ReadPreference readPreference)
   at MongoDB.Driver.MongoCursor`1.MongoCursorConnectionProvider.AcquireConnection()
   at MongoDB.Driver.Operations.QueryOperation`1.GetFirstBatch(IConnectionProvider connectionProvider)
   at MongoDB.Driver.Operations.QueryOperation`1.Execute(IConnectionProvider connectionProvider)
   at System.Linq.Enumerable.FirstOrDefault[TSource](IEnumerable`1 source)
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Core.BackgroundService.Run()

Nested Exception

Exception: System.Net.Sockets.SocketException
Message: No connection could be made because the target machine actively refused it 127.0.0.1:27017
Source: System
   at System.Net.Sockets.Socket.DoConnect(EndPoint endPointSnapshot, SocketAddress socketAddress)
   at System.Net.Sockets.Socket.Connect(EndPoint remoteEP)
   at System.Net.Sockets.TcpClient.Connect(IPEndPoint remoteEP)
   at MongoDB.Driver.Internal.MongoConnection.Open()
   at MongoDB.Driver.Internal.MongoConnection.SendMessage(BsonBuffer buffer, Int32 requestId)
   at MongoDB.Driver.Internal.MongoConnection.SendMessage(MongoRequestMessage message)
   at MongoDB.Driver.Operations.CommandOperation`1.Execute(MongoConnection connection)
   at MongoDB.Driver.MongoServerInstance.Ping(MongoConnection connection)
   at MongoDB.Driver.MongoServerInstance.Connect()
   at MongoDB.Driver.Internal.DirectMongoServerProxy.Connect(TimeSpan timeout, ReadPreference readPreference)


ManagedPoolThread #15 13:32:54 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #12 13:32:55 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
5296 13:32:55 INFO  [Experience Analytics]: Reduce agent found zero sites to process
ManagedPoolThread #10 13:32:56 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
4424 13:32:56 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #18 13:32:57 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
7520 13:32:57 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #7 13:32:58 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
3600 13:32:59 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

9120 13:33:00 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

 424 13:33:01 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

6160 13:33:03 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

2472 13:33:08 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Core.BackgroundService.Run()

4424 13:33:11 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

7520 13:33:12 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

3600 13:33:14 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

9120 13:33:15 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

 424 13:33:16 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

Heartbeat 13:33:18 ERROR MongoDbDictionary.Store() has failed.
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Save(Object value)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbDictionary.Store(Object value)

6160 13:33:18 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

2472 13:33:23 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Core.BackgroundService.Run()

5296 13:33:25 INFO  [Experience Analytics]: Reduce agent found zero sites to process
4424 13:33:26 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

7520 13:33:27 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

3600 13:33:29 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

9120 13:33:30 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

 424 13:33:31 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

6160 13:33:33 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

2472 13:33:38 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Core.BackgroundService.Run()

4424 13:33:41 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

7520 13:33:42 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

3600 13:33:44 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

9120 13:33:45 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

 424 13:33:46 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

6160 13:33:48 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #6 13:33:53 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #3 13:33:54 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #17 13:33:55 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
5296 13:33:55 INFO  [Experience Analytics]: Reduce agent found zero sites to process
4424 13:33:56 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #16 13:33:56 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #14 13:33:57 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
7520 13:33:57 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #11 13:33:58 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #1 13:33:59 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
3600 13:33:59 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #5 13:34:00 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
9120 13:34:00 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #19 13:34:01 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
 424 13:34:01 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #13 13:34:02 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
6160 13:34:03 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #9 13:34:03 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #4 13:34:04 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #8 13:34:05 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #0 13:34:06 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
2472 13:34:07 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: MongoDB.Driver.MongoConnectionException
Message: Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
Source: MongoDB.Driver
   at MongoDB.Driver.Internal.DirectMongoServerProxy.Connect(TimeSpan timeout, ReadPreference readPreference)
   at MongoDB.Driver.Internal.DirectMongoServerProxy.ChooseServerInstance(ReadPreference readPreference)
   at MongoDB.Driver.MongoServer.AcquireConnection(ReadPreference readPreference)
   at MongoDB.Driver.MongoCursor`1.MongoCursorConnectionProvider.AcquireConnection()
   at MongoDB.Driver.Operations.QueryOperation`1.GetFirstBatch(IConnectionProvider connectionProvider)
   at MongoDB.Driver.Operations.QueryOperation`1.Execute(IConnectionProvider connectionProvider)
   at System.Linq.Enumerable.FirstOrDefault[TSource](IEnumerable`1 source)
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Core.BackgroundService.Run()

Nested Exception

Exception: System.Net.Sockets.SocketException
Message: No connection could be made because the target machine actively refused it 127.0.0.1:27017
Source: System
   at System.Net.Sockets.Socket.DoConnect(EndPoint endPointSnapshot, SocketAddress socketAddress)
   at System.Net.Sockets.Socket.Connect(EndPoint remoteEP)
   at System.Net.Sockets.TcpClient.Connect(IPEndPoint remoteEP)
   at MongoDB.Driver.Internal.MongoConnection.Open()
   at MongoDB.Driver.Internal.MongoConnection.SendMessage(BsonBuffer buffer, Int32 requestId)
   at MongoDB.Driver.Internal.MongoConnection.SendMessage(MongoRequestMessage message)
   at MongoDB.Driver.Operations.CommandOperation`1.Execute(MongoConnection connection)
   at MongoDB.Driver.MongoServerInstance.Ping(MongoConnection connection)
   at MongoDB.Driver.MongoServerInstance.Connect()
   at MongoDB.Driver.Internal.DirectMongoServerProxy.Connect(TimeSpan timeout, ReadPreference readPreference)


ManagedPoolThread #15 13:34:08 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #18 13:34:09 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #7 13:34:10 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
4424 13:34:11 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #12 13:34:11 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #10 13:34:12 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
7520 13:34:12 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

3600 13:34:14 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

9120 13:34:15 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

 424 13:34:16 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

6160 13:34:18 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

2472 13:34:22 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Core.BackgroundService.Run()

5296 13:34:25 INFO  [Experience Analytics]: Reduce agent found zero sites to process
4424 13:34:26 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

7520 13:34:27 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

3600 13:34:29 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

9120 13:34:30 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

 424 13:34:31 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

6160 13:34:33 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

2472 13:34:37 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Core.BackgroundService.Run()

4424 13:34:41 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

7520 13:34:42 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

3600 13:34:44 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

9120 13:34:45 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

 424 13:34:46 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

6160 13:34:48 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

2472 13:34:52 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Core.BackgroundService.Run()

5296 13:34:55 INFO  [Experience Analytics]: Reduce agent found zero sites to process
4424 13:34:56 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

7520 13:34:57 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

3600 13:34:59 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

9120 13:35:00 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

 424 13:35:01 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

6160 13:35:03 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #16 13:35:08 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #14 13:35:09 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #6 13:35:10 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #17 13:35:11 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
4424 13:35:11 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #3 13:35:12 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #5 13:35:13 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #1 13:35:14 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
3600 13:35:14 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #11 13:35:15 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
9120 13:35:15 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #19 13:35:16 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
 424 13:35:16 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #13 13:35:17 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #9 13:35:18 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
6160 13:35:18 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

Heartbeat 13:35:19 ERROR MongoDbDictionary.Store() has failed.
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Save(Object value)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbDictionary.Store(Object value)

ManagedPoolThread #4 13:35:19 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #8 13:35:20 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #0 13:35:21 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
2472 13:35:22 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: MongoDB.Driver.MongoConnectionException
Message: Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
Source: MongoDB.Driver
   at MongoDB.Driver.Internal.DirectMongoServerProxy.Connect(TimeSpan timeout, ReadPreference readPreference)
   at MongoDB.Driver.Internal.DirectMongoServerProxy.ChooseServerInstance(ReadPreference readPreference)
   at MongoDB.Driver.MongoServer.AcquireConnection(ReadPreference readPreference)
   at MongoDB.Driver.MongoCursor`1.MongoCursorConnectionProvider.AcquireConnection()
   at MongoDB.Driver.Operations.QueryOperation`1.GetFirstBatch(IConnectionProvider connectionProvider)
   at MongoDB.Driver.Operations.QueryOperation`1.Execute(IConnectionProvider connectionProvider)
   at System.Linq.Enumerable.FirstOrDefault[TSource](IEnumerable`1 source)
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Core.BackgroundService.Run()

Nested Exception

Exception: System.Net.Sockets.SocketException
Message: No connection could be made because the target machine actively refused it 127.0.0.1:27017
Source: System
   at System.Net.Sockets.Socket.DoConnect(EndPoint endPointSnapshot, SocketAddress socketAddress)
   at System.Net.Sockets.Socket.Connect(EndPoint remoteEP)
   at System.Net.Sockets.TcpClient.Connect(IPEndPoint remoteEP)
   at MongoDB.Driver.Internal.MongoConnection.Open()
   at MongoDB.Driver.Internal.MongoConnection.SendMessage(BsonBuffer buffer, Int32 requestId)
   at MongoDB.Driver.Internal.MongoConnection.SendMessage(MongoRequestMessage message)
   at MongoDB.Driver.Operations.CommandOperation`1.Execute(MongoConnection connection)
   at MongoDB.Driver.MongoServerInstance.Ping(MongoConnection connection)
   at MongoDB.Driver.MongoServerInstance.Connect()
   at MongoDB.Driver.Internal.DirectMongoServerProxy.Connect(TimeSpan timeout, ReadPreference readPreference)


ManagedPoolThread #15 13:35:23 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #12 13:35:24 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #10 13:35:25 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
5296 13:35:25 INFO  [Experience Analytics]: Reduce agent found zero sites to process
7520 13:35:26 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
7520 13:35:26 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.HandleDatabaseException(ExceptionBehavior exceptionBehavior, Exception ex)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

Nested Exception

Exception: MongoDB.Driver.MongoConnectionException
Message: Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
Source: MongoDB.Driver
   at MongoDB.Driver.Internal.DirectMongoServerProxy.Connect(TimeSpan timeout, ReadPreference readPreference)
   at MongoDB.Driver.Internal.DirectMongoServerProxy.ChooseServerInstance(ReadPreference readPreference)
   at MongoDB.Driver.MongoServer.AcquireConnection(ReadPreference readPreference)
   at MongoDB.Driver.MongoCollection.RunCommandAs[TCommandResult](IMongoCommand command, ReadPreference readPreference, IBsonSerializer resultSerializer, IBsonSerializationOptions resultSerializationOptions)
   at MongoDB.Driver.MongoCollection.RunCommandAs[TCommandResult](IMongoCommand command, ReadPreference readPreference)
   at MongoDB.Driver.MongoCollection.FindAndModify(FindAndModifyArgs args)
   at MongoDB.Driver.MongoCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.<>c__DisplayClass2c.<FindAndModify>b__2b()
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)

Nested Exception

Exception: System.Net.Sockets.SocketException
Message: No connection could be made because the target machine actively refused it 127.0.0.1:27017
Source: System
   at System.Net.Sockets.Socket.DoConnect(EndPoint endPointSnapshot, SocketAddress socketAddress)
   at System.Net.Sockets.Socket.Connect(EndPoint remoteEP)
   at System.Net.Sockets.TcpClient.Connect(IPEndPoint remoteEP)
   at MongoDB.Driver.Internal.MongoConnection.Open()
   at MongoDB.Driver.Internal.MongoConnection.SendMessage(BsonBuffer buffer, Int32 requestId)
   at MongoDB.Driver.Internal.MongoConnection.SendMessage(MongoRequestMessage message)
   at MongoDB.Driver.Operations.CommandOperation`1.Execute(MongoConnection connection)
   at MongoDB.Driver.MongoServerInstance.Ping(MongoConnection connection)
   at MongoDB.Driver.MongoServerInstance.Connect()
   at MongoDB.Driver.Internal.DirectMongoServerProxy.Connect(TimeSpan timeout, ReadPreference readPreference)



4424 13:35:26 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #18 13:35:27 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #7 13:35:28 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
3600 13:35:29 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

9120 13:35:30 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

 424 13:35:31 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

6160 13:35:33 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

2472 13:35:37 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Core.BackgroundService.Run()

7520 13:35:41 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

4424 13:35:41 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

3600 13:35:44 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

9120 13:35:45 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

 424 13:35:46 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

6160 13:35:48 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

2472 13:35:52 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Core.BackgroundService.Run()

5296 13:35:55 INFO  [Experience Analytics]: Reduce agent found zero sites to process
7520 13:35:56 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

4424 13:35:56 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

3600 13:35:59 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

9120 13:36:00 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

 424 13:36:01 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

6160 13:36:03 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

2472 13:36:07 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Core.BackgroundService.Run()

7520 13:36:11 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

4424 13:36:11 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

3600 13:36:14 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

9120 13:36:15 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

 424 13:36:16 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

6160 13:36:18 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #16 13:36:22 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #14 13:36:23 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
5056 13:36:24 INFO  [Path Analyzer](.) Running trail cleanup agent
5056 13:36:24 INFO  [Path Analyzer](.) Running trail cleanup on database
4088 13:36:24 WARN  [Path Analyzer](.) SmartMergeAgent.Execute() returns. No missing date ranges to merge.
ManagedPoolThread #6 13:36:24 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #19 13:36:25 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
5296 13:36:25 INFO  [Experience Analytics]: Reduce agent found zero sites to process
7520 13:36:26 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

4424 13:36:26 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #5 13:36:26 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #13 13:36:27 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #1 13:36:28 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #11 13:36:29 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
3600 13:36:29 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #17 13:36:30 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
9120 13:36:30 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #3 13:36:31 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
 424 13:36:31 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #9 13:36:32 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
6160 13:36:33 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #0 13:36:33 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #8 13:36:34 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #4 13:36:35 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
2472 13:36:36 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: MongoDB.Driver.MongoConnectionException
Message: Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
Source: MongoDB.Driver
   at MongoDB.Driver.Internal.DirectMongoServerProxy.Connect(TimeSpan timeout, ReadPreference readPreference)
   at MongoDB.Driver.Internal.DirectMongoServerProxy.ChooseServerInstance(ReadPreference readPreference)
   at MongoDB.Driver.MongoServer.AcquireConnection(ReadPreference readPreference)
   at MongoDB.Driver.MongoCursor`1.MongoCursorConnectionProvider.AcquireConnection()
   at MongoDB.Driver.Operations.QueryOperation`1.GetFirstBatch(IConnectionProvider connectionProvider)
   at MongoDB.Driver.Operations.QueryOperation`1.Execute(IConnectionProvider connectionProvider)
   at System.Linq.Enumerable.FirstOrDefault[TSource](IEnumerable`1 source)
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Core.BackgroundService.Run()

Nested Exception

Exception: System.Net.Sockets.SocketException
Message: No connection could be made because the target machine actively refused it 127.0.0.1:27017
Source: System
   at System.Net.Sockets.Socket.DoConnect(EndPoint endPointSnapshot, SocketAddress socketAddress)
   at System.Net.Sockets.Socket.Connect(EndPoint remoteEP)
   at System.Net.Sockets.TcpClient.Connect(IPEndPoint remoteEP)
   at MongoDB.Driver.Internal.MongoConnection.Open()
   at MongoDB.Driver.Internal.MongoConnection.SendMessage(BsonBuffer buffer, Int32 requestId)
   at MongoDB.Driver.Internal.MongoConnection.SendMessage(MongoRequestMessage message)
   at MongoDB.Driver.Operations.CommandOperation`1.Execute(MongoConnection connection)
   at MongoDB.Driver.MongoServerInstance.Ping(MongoConnection connection)
   at MongoDB.Driver.MongoServerInstance.Connect()
   at MongoDB.Driver.Internal.DirectMongoServerProxy.Connect(TimeSpan timeout, ReadPreference readPreference)


ManagedPoolThread #15 13:36:37 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #18 13:36:38 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #7 13:36:39 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #12 13:36:40 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
7520 13:36:41 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

4424 13:36:41 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #10 13:36:41 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
3600 13:36:44 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

9120 13:36:45 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

 424 13:36:46 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

6160 13:36:48 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

2472 13:36:51 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Core.BackgroundService.Run()

5296 13:36:55 INFO  [Experience Analytics]: Reduce agent found zero sites to process
7520 13:36:56 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

4424 13:36:56 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

3600 13:36:59 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

9120 13:37:00 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

 424 13:37:01 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

6160 13:37:03 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

2472 13:37:06 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Core.BackgroundService.Run()

4424 13:37:11 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

7520 13:37:11 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

3600 13:37:14 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

9120 13:37:15 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

 424 13:37:16 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

6160 13:37:18 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

Heartbeat 13:37:19 ERROR MongoDbDictionary.Store() has failed.
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Save(Object value)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbDictionary.Store(Object value)

2472 13:37:21 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Core.BackgroundService.Run()

5296 13:37:25 INFO  [Experience Analytics]: Reduce agent found zero sites to process
7520 13:37:26 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

4424 13:37:26 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

3600 13:37:29 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

9120 13:37:30 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

 424 13:37:31 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

6160 13:37:33 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #14 13:37:37 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #6 13:37:38 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #16 13:37:39 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #19 13:37:40 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
7520 13:37:41 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

4424 13:37:41 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #5 13:37:41 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #13 13:37:42 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #1 13:37:43 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #11 13:37:44 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
3600 13:37:44 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #3 13:37:45 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
9120 13:37:45 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #17 13:37:46 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
 424 13:37:46 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #9 13:37:47 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #0 13:37:48 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
6160 13:37:48 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #8 13:37:49 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #4 13:37:50 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
2472 13:37:51 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: MongoDB.Driver.MongoConnectionException
Message: Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
Source: MongoDB.Driver
   at MongoDB.Driver.Internal.DirectMongoServerProxy.Connect(TimeSpan timeout, ReadPreference readPreference)
   at MongoDB.Driver.Internal.DirectMongoServerProxy.ChooseServerInstance(ReadPreference readPreference)
   at MongoDB.Driver.MongoServer.AcquireConnection(ReadPreference readPreference)
   at MongoDB.Driver.MongoCursor`1.MongoCursorConnectionProvider.AcquireConnection()
   at MongoDB.Driver.Operations.QueryOperation`1.GetFirstBatch(IConnectionProvider connectionProvider)
   at MongoDB.Driver.Operations.QueryOperation`1.Execute(IConnectionProvider connectionProvider)
   at System.Linq.Enumerable.FirstOrDefault[TSource](IEnumerable`1 source)
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Core.BackgroundService.Run()

Nested Exception

Exception: System.Net.Sockets.SocketException
Message: No connection could be made because the target machine actively refused it 127.0.0.1:27017
Source: System
   at System.Net.Sockets.Socket.DoConnect(EndPoint endPointSnapshot, SocketAddress socketAddress)
   at System.Net.Sockets.Socket.Connect(EndPoint remoteEP)
   at System.Net.Sockets.TcpClient.Connect(IPEndPoint remoteEP)
   at MongoDB.Driver.Internal.MongoConnection.Open()
   at MongoDB.Driver.Internal.MongoConnection.SendMessage(BsonBuffer buffer, Int32 requestId)
   at MongoDB.Driver.Internal.MongoConnection.SendMessage(MongoRequestMessage message)
   at MongoDB.Driver.Operations.CommandOperation`1.Execute(MongoConnection connection)
   at MongoDB.Driver.MongoServerInstance.Ping(MongoConnection connection)
   at MongoDB.Driver.MongoServerInstance.Connect()
   at MongoDB.Driver.Internal.DirectMongoServerProxy.Connect(TimeSpan timeout, ReadPreference readPreference)


ManagedPoolThread #15 13:37:52 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #12 13:37:53 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #10 13:37:54 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #18 13:37:55 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
5296 13:37:55 INFO  [Experience Analytics]: Reduce agent found zero sites to process
7520 13:37:56 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

4424 13:37:56 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #7 13:37:56 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
3600 13:37:59 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

9120 13:38:00 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

 424 13:38:01 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

6160 13:38:03 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

2472 13:38:06 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Core.BackgroundService.Run()

7520 13:38:11 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

4424 13:38:11 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

3600 13:38:14 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

9120 13:38:15 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

 424 13:38:16 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

6160 13:38:18 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

2472 13:38:21 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Core.BackgroundService.Run()

5296 13:38:25 INFO  [Experience Analytics]: Reduce agent found zero sites to process
4424 13:38:26 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

7520 13:38:26 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

3600 13:38:29 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

9120 13:38:30 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

 424 13:38:31 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

6160 13:38:33 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

2472 13:38:36 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Core.BackgroundService.Run()

7520 13:38:41 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

4424 13:38:41 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

3600 13:38:44 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

9120 13:38:45 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

 424 13:38:46 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

6160 13:38:48 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #11 13:38:51 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #13 13:38:52 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #6 13:38:53 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #1 13:38:54 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #5 13:38:55 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
5296 13:38:55 INFO  [Experience Analytics]: Reduce agent found zero sites to process
7520 13:38:56 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

4424 13:38:56 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #3 13:38:56 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #14 13:38:57 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #19 13:38:58 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
3600 13:38:59 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #17 13:38:59 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #16 13:39:00 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
9120 13:39:01 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #9 13:39:01 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
 424 13:39:01 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #0 13:39:02 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
6160 13:39:03 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #4 13:39:03 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #8 13:39:04 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #2 13:39:06 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
2472 13:39:07 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: MongoDB.Driver.MongoConnectionException
Message: Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
Source: MongoDB.Driver
   at MongoDB.Driver.Internal.DirectMongoServerProxy.Connect(TimeSpan timeout, ReadPreference readPreference)
   at MongoDB.Driver.Internal.DirectMongoServerProxy.ChooseServerInstance(ReadPreference readPreference)
   at MongoDB.Driver.MongoServer.AcquireConnection(ReadPreference readPreference)
   at MongoDB.Driver.MongoCursor`1.MongoCursorConnectionProvider.AcquireConnection()
   at MongoDB.Driver.Operations.QueryOperation`1.GetFirstBatch(IConnectionProvider connectionProvider)
   at MongoDB.Driver.Operations.QueryOperation`1.Execute(IConnectionProvider connectionProvider)
   at System.Linq.Enumerable.FirstOrDefault[TSource](IEnumerable`1 source)
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Core.BackgroundService.Run()

Nested Exception

Exception: System.Net.Sockets.SocketException
Message: No connection could be made because the target machine actively refused it 127.0.0.1:27017
Source: System
   at System.Net.Sockets.Socket.DoConnect(EndPoint endPointSnapshot, SocketAddress socketAddress)
   at System.Net.Sockets.Socket.Connect(EndPoint remoteEP)
   at System.Net.Sockets.TcpClient.Connect(IPEndPoint remoteEP)
   at MongoDB.Driver.Internal.MongoConnection.Open()
   at MongoDB.Driver.Internal.MongoConnection.SendMessage(BsonBuffer buffer, Int32 requestId)
   at MongoDB.Driver.Internal.MongoConnection.SendMessage(MongoRequestMessage message)
   at MongoDB.Driver.Operations.CommandOperation`1.Execute(MongoConnection connection)
   at MongoDB.Driver.MongoServerInstance.Ping(MongoConnection connection)
   at MongoDB.Driver.MongoServerInstance.Connect()
   at MongoDB.Driver.Internal.DirectMongoServerProxy.Connect(TimeSpan timeout, ReadPreference readPreference)


ManagedPoolThread #15 13:39:08 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #18 13:39:09 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #7 13:39:10 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #12 13:39:11 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
7520 13:39:11 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

4424 13:39:11 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #10 13:39:12 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
3600 13:39:14 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

9120 13:39:16 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

 424 13:39:16 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

6160 13:39:18 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

Heartbeat 13:39:20 ERROR MongoDbDictionary.Store() has failed.
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Save(Object value)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbDictionary.Store(Object value)

2472 13:39:22 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Core.BackgroundService.Run()

5296 13:39:25 INFO  [Experience Analytics]: Reduce agent found zero sites to process
4424 13:39:26 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

7520 13:39:26 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

3600 13:39:29 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

9120 13:39:31 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

 424 13:39:31 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

6160 13:39:33 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

2472 13:39:37 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Core.BackgroundService.Run()

4424 13:39:41 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

7520 13:39:41 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

3600 13:39:44 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

9120 13:39:46 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

 424 13:39:46 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

6160 13:39:48 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

2472 13:39:52 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Core.BackgroundService.Run()

5296 13:39:55 INFO  [Experience Analytics]: Reduce agent found zero sites to process
7520 13:39:56 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

4424 13:39:56 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

3600 13:39:59 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

9120 13:40:01 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

 424 13:40:01 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

6160 13:40:03 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #2 13:40:07 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #11 13:40:08 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #6 13:40:09 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #13 13:40:10 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #1 13:40:11 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
4424 13:40:11 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

7520 13:40:11 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #5 13:40:12 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #3 13:40:13 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #14 13:40:14 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
3600 13:40:14 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #16 13:40:15 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
9120 13:40:16 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #17 13:40:16 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
 424 13:40:16 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #19 13:40:17 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #9 13:40:18 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
6160 13:40:18 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #0 13:40:19 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #4 13:40:20 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #8 13:40:21 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
2472 13:40:22 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: MongoDB.Driver.MongoConnectionException
Message: Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
Source: MongoDB.Driver
   at MongoDB.Driver.Internal.DirectMongoServerProxy.Connect(TimeSpan timeout, ReadPreference readPreference)
   at MongoDB.Driver.Internal.DirectMongoServerProxy.ChooseServerInstance(ReadPreference readPreference)
   at MongoDB.Driver.MongoServer.AcquireConnection(ReadPreference readPreference)
   at MongoDB.Driver.MongoCursor`1.MongoCursorConnectionProvider.AcquireConnection()
   at MongoDB.Driver.Operations.QueryOperation`1.GetFirstBatch(IConnectionProvider connectionProvider)
   at MongoDB.Driver.Operations.QueryOperation`1.Execute(IConnectionProvider connectionProvider)
   at System.Linq.Enumerable.FirstOrDefault[TSource](IEnumerable`1 source)
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Core.BackgroundService.Run()

Nested Exception

Exception: System.Net.Sockets.SocketException
Message: No connection could be made because the target machine actively refused it 127.0.0.1:27017
Source: System
   at System.Net.Sockets.Socket.DoConnect(EndPoint endPointSnapshot, SocketAddress socketAddress)
   at System.Net.Sockets.Socket.Connect(EndPoint remoteEP)
   at System.Net.Sockets.TcpClient.Connect(IPEndPoint remoteEP)
   at MongoDB.Driver.Internal.MongoConnection.Open()
   at MongoDB.Driver.Internal.MongoConnection.SendMessage(BsonBuffer buffer, Int32 requestId)
   at MongoDB.Driver.Internal.MongoConnection.SendMessage(MongoRequestMessage message)
   at MongoDB.Driver.Operations.CommandOperation`1.Execute(MongoConnection connection)
   at MongoDB.Driver.MongoServerInstance.Ping(MongoConnection connection)
   at MongoDB.Driver.MongoServerInstance.Connect()
   at MongoDB.Driver.Internal.DirectMongoServerProxy.Connect(TimeSpan timeout, ReadPreference readPreference)


ManagedPoolThread #15 13:40:23 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #12 13:40:24 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #10 13:40:25 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
5296 13:40:25 INFO  [Experience Analytics]: Reduce agent found zero sites to process
ManagedPoolThread #18 13:40:26 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
7520 13:40:26 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

4424 13:40:26 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #7 13:40:27 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
3600 13:40:29 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

9120 13:40:31 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

 424 13:40:32 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

6160 13:40:33 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

2472 13:40:37 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Core.BackgroundService.Run()

7520 13:40:41 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

4424 13:40:41 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

3600 13:40:44 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

9120 13:40:46 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

 424 13:40:47 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

6160 13:40:48 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

2472 13:40:52 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Core.BackgroundService.Run()

5296 13:40:55 INFO  [Experience Analytics]: Reduce agent found zero sites to process
7520 13:40:56 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

4424 13:40:56 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

3600 13:40:59 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

9120 13:41:01 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

 424 13:41:02 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

6160 13:41:03 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

2472 13:41:07 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Core.BackgroundService.Run()

7520 13:41:11 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

4424 13:41:11 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

3600 13:41:14 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

9120 13:41:16 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

 424 13:41:17 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

6160 13:41:18 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #13 13:41:22 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #11 13:41:23 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
5056 13:41:24 INFO  [Path Analyzer](.) Running trail cleanup agent
5056 13:41:24 INFO  [Path Analyzer](.) Running trail cleanup on database
ManagedPoolThread #5 13:41:24 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #6 13:41:25 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
5296 13:41:25 INFO  [Experience Analytics]: Reduce agent found zero sites to process
7520 13:41:26 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

4424 13:41:26 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #1 13:41:26 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #3 13:41:27 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #16 13:41:28 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
3600 13:41:29 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #14 13:41:29 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #17 13:41:30 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
9120 13:41:31 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #19 13:41:31 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
 424 13:41:32 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #4 13:41:32 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
6160 13:41:33 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #0 13:41:33 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #9 13:41:34 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #8 13:41:35 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
Heartbeat 13:41:36 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
Heartbeat 13:41:36 ERROR MongoDbDictionary.Store() has failed.
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.HandleDatabaseException(ExceptionBehavior exceptionBehavior, Exception ex)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Save(Object value)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbDictionary.Store(Object value)

Nested Exception

Exception: MongoDB.Driver.MongoConnectionException
Message: Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
Source: MongoDB.Driver
   at MongoDB.Driver.Internal.DirectMongoServerProxy.Connect(TimeSpan timeout, ReadPreference readPreference)
   at MongoDB.Driver.Internal.DirectMongoServerProxy.ChooseServerInstance(ReadPreference readPreference)
   at MongoDB.Driver.MongoServer.AcquireConnection(ReadPreference readPreference)
   at MongoDB.Driver.MongoCollection.Update(IMongoQuery query, IMongoUpdate update, MongoUpdateOptions options)
   at MongoDB.Driver.MongoCollection.Save(Type nominalType, Object document, MongoInsertOptions options)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.<>c__DisplayClass3c.<Save>b__3b()
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)

Nested Exception

Exception: System.Net.Sockets.SocketException
Message: No connection could be made because the target machine actively refused it 127.0.0.1:27017
Source: System
   at System.Net.Sockets.Socket.DoConnect(EndPoint endPointSnapshot, SocketAddress socketAddress)
   at System.Net.Sockets.Socket.Connect(EndPoint remoteEP)
   at System.Net.Sockets.TcpClient.Connect(IPEndPoint remoteEP)
   at MongoDB.Driver.Internal.MongoConnection.Open()
   at MongoDB.Driver.Internal.MongoConnection.SendMessage(BsonBuffer buffer, Int32 requestId)
   at MongoDB.Driver.Internal.MongoConnection.SendMessage(MongoRequestMessage message)
   at MongoDB.Driver.Operations.CommandOperation`1.Execute(MongoConnection connection)
   at MongoDB.Driver.MongoServerInstance.Ping(MongoConnection connection)
   at MongoDB.Driver.MongoServerInstance.Connect()
   at MongoDB.Driver.Internal.DirectMongoServerProxy.Connect(TimeSpan timeout, ReadPreference readPreference)



Heartbeat 13:41:37 INFO  Health.PrivateBytes: 705,921,024
Heartbeat 13:41:37 INFO  Health.CacheInstances: 115
Heartbeat 13:41:37 INFO  Health.CacheTotalCount: 18,462
Heartbeat 13:41:37 INFO  Health.CacheTotalSize: 76,622,426
2472 13:41:38 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: MongoDB.Driver.MongoConnectionException
Message: Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
Source: MongoDB.Driver
   at MongoDB.Driver.Internal.DirectMongoServerProxy.Connect(TimeSpan timeout, ReadPreference readPreference)
   at MongoDB.Driver.Internal.DirectMongoServerProxy.ChooseServerInstance(ReadPreference readPreference)
   at MongoDB.Driver.MongoServer.AcquireConnection(ReadPreference readPreference)
   at MongoDB.Driver.MongoCursor`1.MongoCursorConnectionProvider.AcquireConnection()
   at MongoDB.Driver.Operations.QueryOperation`1.GetFirstBatch(IConnectionProvider connectionProvider)
   at MongoDB.Driver.Operations.QueryOperation`1.Execute(IConnectionProvider connectionProvider)
   at System.Linq.Enumerable.FirstOrDefault[TSource](IEnumerable`1 source)
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Core.BackgroundService.Run()

Nested Exception

Exception: System.Net.Sockets.SocketException
Message: No connection could be made because the target machine actively refused it 127.0.0.1:27017
Source: System
   at System.Net.Sockets.Socket.DoConnect(EndPoint endPointSnapshot, SocketAddress socketAddress)
   at System.Net.Sockets.Socket.Connect(EndPoint remoteEP)
   at System.Net.Sockets.TcpClient.Connect(IPEndPoint remoteEP)
   at MongoDB.Driver.Internal.MongoConnection.Open()
   at MongoDB.Driver.Internal.MongoConnection.SendMessage(BsonBuffer buffer, Int32 requestId)
   at MongoDB.Driver.Internal.MongoConnection.SendMessage(MongoRequestMessage message)
   at MongoDB.Driver.Operations.CommandOperation`1.Execute(MongoConnection connection)
   at MongoDB.Driver.MongoServerInstance.Ping(MongoConnection connection)
   at MongoDB.Driver.MongoServerInstance.Connect()
   at MongoDB.Driver.Internal.DirectMongoServerProxy.Connect(TimeSpan timeout, ReadPreference readPreference)


ManagedPoolThread #15 13:41:39 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #18 13:41:40 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #7 13:41:41 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
7520 13:41:41 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

4424 13:41:41 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #12 13:41:42 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #10 13:41:43 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
3600 13:41:44 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

9120 13:41:46 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

 424 13:41:47 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

6160 13:41:48 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

2472 13:41:53 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Core.BackgroundService.Run()

5296 13:41:55 INFO  [Experience Analytics]: Reduce agent found zero sites to process
7520 13:41:56 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

4424 13:41:56 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

3600 13:41:59 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

9120 13:42:01 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

 424 13:42:02 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

6160 13:42:03 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

2472 13:42:08 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Core.BackgroundService.Run()

7520 13:42:11 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

4424 13:42:11 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

3600 13:42:14 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

9120 13:42:16 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

 424 13:42:17 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

6160 13:42:18 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

2472 13:42:23 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Core.BackgroundService.Run()

5296 13:42:25 INFO  [Experience Analytics]: Reduce agent found zero sites to process
7520 13:42:26 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

4424 13:42:26 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

3600 13:42:29 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

9120 13:42:31 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

 424 13:42:32 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

6160 13:42:33 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #6 13:42:38 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #11 13:42:39 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #1 13:42:40 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #13 13:42:41 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
7520 13:42:41 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

4424 13:42:41 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #5 13:42:42 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #3 13:42:43 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #17 13:42:44 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
3600 13:42:44 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #14 13:42:45 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
9120 13:42:46 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #19 13:42:46 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
 424 13:42:47 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #16 13:42:47 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #2 13:42:48 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
6160 13:42:48 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #9 13:42:49 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #8 13:42:50 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #4 13:42:51 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #0 13:42:52 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
2472 13:42:53 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: MongoDB.Driver.MongoConnectionException
Message: Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
Source: MongoDB.Driver
   at MongoDB.Driver.Internal.DirectMongoServerProxy.Connect(TimeSpan timeout, ReadPreference readPreference)
   at MongoDB.Driver.Internal.DirectMongoServerProxy.ChooseServerInstance(ReadPreference readPreference)
   at MongoDB.Driver.MongoServer.AcquireConnection(ReadPreference readPreference)
   at MongoDB.Driver.MongoCursor`1.MongoCursorConnectionProvider.AcquireConnection()
   at MongoDB.Driver.Operations.QueryOperation`1.GetFirstBatch(IConnectionProvider connectionProvider)
   at MongoDB.Driver.Operations.QueryOperation`1.Execute(IConnectionProvider connectionProvider)
   at System.Linq.Enumerable.FirstOrDefault[TSource](IEnumerable`1 source)
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Core.BackgroundService.Run()

Nested Exception

Exception: System.Net.Sockets.SocketException
Message: No connection could be made because the target machine actively refused it 127.0.0.1:27017
Source: System
   at System.Net.Sockets.Socket.DoConnect(EndPoint endPointSnapshot, SocketAddress socketAddress)
   at System.Net.Sockets.Socket.Connect(EndPoint remoteEP)
   at System.Net.Sockets.TcpClient.Connect(IPEndPoint remoteEP)
   at MongoDB.Driver.Internal.MongoConnection.Open()
   at MongoDB.Driver.Internal.MongoConnection.SendMessage(BsonBuffer buffer, Int32 requestId)
   at MongoDB.Driver.Internal.MongoConnection.SendMessage(MongoRequestMessage message)
   at MongoDB.Driver.Operations.CommandOperation`1.Execute(MongoConnection connection)
   at MongoDB.Driver.MongoServerInstance.Ping(MongoConnection connection)
   at MongoDB.Driver.MongoServerInstance.Connect()
   at MongoDB.Driver.Internal.DirectMongoServerProxy.Connect(TimeSpan timeout, ReadPreference readPreference)


ManagedPoolThread #15 13:42:54 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #12 13:42:55 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
5296 13:42:55 INFO  [Experience Analytics]: Reduce agent found zero sites to process
4424 13:42:56 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #10 13:42:56 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #18 13:42:57 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #7 13:42:58 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
7520 13:42:59 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
7520 13:42:59 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.HandleDatabaseException(ExceptionBehavior exceptionBehavior, Exception ex)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

Nested Exception

Exception: MongoDB.Driver.MongoConnectionException
Message: Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
Source: MongoDB.Driver
   at MongoDB.Driver.Internal.DirectMongoServerProxy.Connect(TimeSpan timeout, ReadPreference readPreference)
   at MongoDB.Driver.Internal.DirectMongoServerProxy.ChooseServerInstance(ReadPreference readPreference)
   at MongoDB.Driver.MongoServer.AcquireConnection(ReadPreference readPreference)
   at MongoDB.Driver.MongoCollection.RunCommandAs[TCommandResult](IMongoCommand command, ReadPreference readPreference, IBsonSerializer resultSerializer, IBsonSerializationOptions resultSerializationOptions)
   at MongoDB.Driver.MongoCollection.RunCommandAs[TCommandResult](IMongoCommand command, ReadPreference readPreference)
   at MongoDB.Driver.MongoCollection.FindAndModify(FindAndModifyArgs args)
   at MongoDB.Driver.MongoCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.<>c__DisplayClass2c.<FindAndModify>b__2b()
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)

Nested Exception

Exception: System.Net.Sockets.SocketException
Message: No connection could be made because the target machine actively refused it 127.0.0.1:27017
Source: System
   at System.Net.Sockets.Socket.DoConnect(EndPoint endPointSnapshot, SocketAddress socketAddress)
   at System.Net.Sockets.Socket.Connect(EndPoint remoteEP)
   at System.Net.Sockets.TcpClient.Connect(IPEndPoint remoteEP)
   at MongoDB.Driver.Internal.MongoConnection.Open()
   at MongoDB.Driver.Internal.MongoConnection.SendMessage(BsonBuffer buffer, Int32 requestId)
   at MongoDB.Driver.Internal.MongoConnection.SendMessage(MongoRequestMessage message)
   at MongoDB.Driver.Operations.CommandOperation`1.Execute(MongoConnection connection)
   at MongoDB.Driver.MongoServerInstance.Ping(MongoConnection connection)
   at MongoDB.Driver.MongoServerInstance.Connect()
   at MongoDB.Driver.Internal.DirectMongoServerProxy.Connect(TimeSpan timeout, ReadPreference readPreference)



3600 13:42:59 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

9120 13:43:01 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

 424 13:43:02 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

6160 13:43:03 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

2472 13:43:08 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Core.BackgroundService.Run()

4424 13:43:11 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

7520 13:43:14 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

3600 13:43:15 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

9120 13:43:16 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

 424 13:43:17 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

6160 13:43:18 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

2472 13:43:23 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Core.BackgroundService.Run()

Heartbeat 13:43:23 ERROR MongoDbDictionary.Store() has failed.
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Save(Object value)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbDictionary.Store(Object value)

5296 13:43:26 INFO  [Experience Analytics]: Reduce agent found zero sites to process
4424 13:43:26 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

7520 13:43:29 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

3600 13:43:30 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

9120 13:43:31 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

 424 13:43:32 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

6160 13:43:33 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

2472 13:43:38 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Core.BackgroundService.Run()

4424 13:43:41 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

7520 13:43:44 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

3600 13:43:45 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

9120 13:43:46 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

 424 13:43:47 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

6160 13:43:48 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #6 13:43:53 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #17 13:43:54 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #13 13:43:56 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
5296 13:43:56 INFO  [Experience Analytics]: Reduce agent found zero sites to process
4424 13:43:56 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #14 13:43:57 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #3 13:43:58 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #5 13:43:59 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #11 13:44:00 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
3600 13:44:00 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #19 13:44:01 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
9120 13:44:01 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #1 13:44:02 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
 424 13:44:02 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #9 13:44:03 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
6160 13:44:03 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #16 13:44:04 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #8 13:44:05 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #0 13:44:06 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #4 13:44:07 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
2472 13:44:08 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: MongoDB.Driver.MongoConnectionException
Message: Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
Source: MongoDB.Driver
   at MongoDB.Driver.Internal.DirectMongoServerProxy.Connect(TimeSpan timeout, ReadPreference readPreference)
   at MongoDB.Driver.Internal.DirectMongoServerProxy.ChooseServerInstance(ReadPreference readPreference)
   at MongoDB.Driver.MongoServer.AcquireConnection(ReadPreference readPreference)
   at MongoDB.Driver.MongoCursor`1.MongoCursorConnectionProvider.AcquireConnection()
   at MongoDB.Driver.Operations.QueryOperation`1.GetFirstBatch(IConnectionProvider connectionProvider)
   at MongoDB.Driver.Operations.QueryOperation`1.Execute(IConnectionProvider connectionProvider)
   at System.Linq.Enumerable.FirstOrDefault[TSource](IEnumerable`1 source)
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Core.BackgroundService.Run()

Nested Exception

Exception: System.Net.Sockets.SocketException
Message: No connection could be made because the target machine actively refused it 127.0.0.1:27017
Source: System
   at System.Net.Sockets.Socket.DoConnect(EndPoint endPointSnapshot, SocketAddress socketAddress)
   at System.Net.Sockets.Socket.Connect(EndPoint remoteEP)
   at System.Net.Sockets.TcpClient.Connect(IPEndPoint remoteEP)
   at MongoDB.Driver.Internal.MongoConnection.Open()
   at MongoDB.Driver.Internal.MongoConnection.SendMessage(BsonBuffer buffer, Int32 requestId)
   at MongoDB.Driver.Internal.MongoConnection.SendMessage(MongoRequestMessage message)
   at MongoDB.Driver.Operations.CommandOperation`1.Execute(MongoConnection connection)
   at MongoDB.Driver.MongoServerInstance.Ping(MongoConnection connection)
   at MongoDB.Driver.MongoServerInstance.Connect()
   at MongoDB.Driver.Internal.DirectMongoServerProxy.Connect(TimeSpan timeout, ReadPreference readPreference)


ManagedPoolThread #15 13:44:09 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #18 13:44:10 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
7520 13:44:11 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
7520 13:44:11 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.HandleDatabaseException(ExceptionBehavior exceptionBehavior, Exception ex)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

Nested Exception

Exception: MongoDB.Driver.MongoConnectionException
Message: Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
Source: MongoDB.Driver
   at MongoDB.Driver.Internal.DirectMongoServerProxy.Connect(TimeSpan timeout, ReadPreference readPreference)
   at MongoDB.Driver.Internal.DirectMongoServerProxy.ChooseServerInstance(ReadPreference readPreference)
   at MongoDB.Driver.MongoServer.AcquireConnection(ReadPreference readPreference)
   at MongoDB.Driver.MongoCollection.RunCommandAs[TCommandResult](IMongoCommand command, ReadPreference readPreference, IBsonSerializer resultSerializer, IBsonSerializationOptions resultSerializationOptions)
   at MongoDB.Driver.MongoCollection.RunCommandAs[TCommandResult](IMongoCommand command, ReadPreference readPreference)
   at MongoDB.Driver.MongoCollection.FindAndModify(FindAndModifyArgs args)
   at MongoDB.Driver.MongoCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.<>c__DisplayClass2c.<FindAndModify>b__2b()
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)

Nested Exception

Exception: System.Net.Sockets.SocketException
Message: No connection could be made because the target machine actively refused it 127.0.0.1:27017
Source: System
   at System.Net.Sockets.Socket.DoConnect(EndPoint endPointSnapshot, SocketAddress socketAddress)
   at System.Net.Sockets.Socket.Connect(EndPoint remoteEP)
   at System.Net.Sockets.TcpClient.Connect(IPEndPoint remoteEP)
   at MongoDB.Driver.Internal.MongoConnection.Open()
   at MongoDB.Driver.Internal.MongoConnection.SendMessage(BsonBuffer buffer, Int32 requestId)
   at MongoDB.Driver.Internal.MongoConnection.SendMessage(MongoRequestMessage message)
   at MongoDB.Driver.Operations.CommandOperation`1.Execute(MongoConnection connection)
   at MongoDB.Driver.MongoServerInstance.Ping(MongoConnection connection)
   at MongoDB.Driver.MongoServerInstance.Connect()
   at MongoDB.Driver.Internal.DirectMongoServerProxy.Connect(TimeSpan timeout, ReadPreference readPreference)



4424 13:44:11 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #12 13:44:12 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #10 13:44:13 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #7 13:44:14 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
3600 13:44:15 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

9120 13:44:16 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

 424 13:44:17 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

6160 13:44:18 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

2472 13:44:23 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Core.BackgroundService.Run()

5296 13:44:26 INFO  [Experience Analytics]: Reduce agent found zero sites to process
7520 13:44:26 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

4424 13:44:26 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

3600 13:44:30 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

9120 13:44:31 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

 424 13:44:32 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

6160 13:44:33 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

2472 13:44:38 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Core.BackgroundService.Run()

7520 13:44:41 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

4424 13:44:41 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

3600 13:44:45 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

9120 13:44:46 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

 424 13:44:47 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

6160 13:44:48 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

2472 13:44:53 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Core.BackgroundService.Run()

5296 13:44:56 INFO  [Experience Analytics]: Reduce agent found zero sites to process
7520 13:44:56 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

4424 13:44:56 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

3600 13:45:00 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

9120 13:45:01 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

 424 13:45:02 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

6160 13:45:03 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #13 13:45:08 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #6 13:45:09 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #11 13:45:10 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
7520 13:45:11 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

4424 13:45:11 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #19 13:45:11 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #14 13:45:12 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #3 13:45:13 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #5 13:45:14 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
3600 13:45:15 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #16 13:45:15 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
9120 13:45:16 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #1 13:45:16 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
 424 13:45:17 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #17 13:45:17 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #4 13:45:18 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
6160 13:45:18 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #8 13:45:19 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #9 13:45:20 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #0 13:45:21 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
2472 13:45:22 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: MongoDB.Driver.MongoConnectionException
Message: Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
Source: MongoDB.Driver
   at MongoDB.Driver.Internal.DirectMongoServerProxy.Connect(TimeSpan timeout, ReadPreference readPreference)
   at MongoDB.Driver.Internal.DirectMongoServerProxy.ChooseServerInstance(ReadPreference readPreference)
   at MongoDB.Driver.MongoServer.AcquireConnection(ReadPreference readPreference)
   at MongoDB.Driver.MongoCursor`1.MongoCursorConnectionProvider.AcquireConnection()
   at MongoDB.Driver.Operations.QueryOperation`1.GetFirstBatch(IConnectionProvider connectionProvider)
   at MongoDB.Driver.Operations.QueryOperation`1.Execute(IConnectionProvider connectionProvider)
   at System.Linq.Enumerable.FirstOrDefault[TSource](IEnumerable`1 source)
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Core.BackgroundService.Run()

Nested Exception

Exception: System.Net.Sockets.SocketException
Message: No connection could be made because the target machine actively refused it 127.0.0.1:27017
Source: System
   at System.Net.Sockets.Socket.DoConnect(EndPoint endPointSnapshot, SocketAddress socketAddress)
   at System.Net.Sockets.Socket.Connect(EndPoint remoteEP)
   at System.Net.Sockets.TcpClient.Connect(IPEndPoint remoteEP)
   at MongoDB.Driver.Internal.MongoConnection.Open()
   at MongoDB.Driver.Internal.MongoConnection.SendMessage(BsonBuffer buffer, Int32 requestId)
   at MongoDB.Driver.Internal.MongoConnection.SendMessage(MongoRequestMessage message)
   at MongoDB.Driver.Operations.CommandOperation`1.Execute(MongoConnection connection)
   at MongoDB.Driver.MongoServerInstance.Ping(MongoConnection connection)
   at MongoDB.Driver.MongoServerInstance.Connect()
   at MongoDB.Driver.Internal.DirectMongoServerProxy.Connect(TimeSpan timeout, ReadPreference readPreference)


ManagedPoolThread #2 13:45:23 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
Heartbeat 13:45:24 ERROR MongoDbDictionary.Store() has failed.
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Save(Object value)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbDictionary.Store(Object value)

ManagedPoolThread #15 13:45:24 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #12 13:45:26 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
5296 13:45:26 INFO  [Experience Analytics]: Reduce agent found zero sites to process
4424 13:45:26 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #7 13:45:27 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #18 13:45:28 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #10 13:45:29 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
7520 13:45:30 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
7520 13:45:30 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.HandleDatabaseException(ExceptionBehavior exceptionBehavior, Exception ex)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

Nested Exception

Exception: MongoDB.Driver.MongoConnectionException
Message: Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
Source: MongoDB.Driver
   at MongoDB.Driver.Internal.DirectMongoServerProxy.Connect(TimeSpan timeout, ReadPreference readPreference)
   at MongoDB.Driver.Internal.DirectMongoServerProxy.ChooseServerInstance(ReadPreference readPreference)
   at MongoDB.Driver.MongoServer.AcquireConnection(ReadPreference readPreference)
   at MongoDB.Driver.MongoCollection.RunCommandAs[TCommandResult](IMongoCommand command, ReadPreference readPreference, IBsonSerializer resultSerializer, IBsonSerializationOptions resultSerializationOptions)
   at MongoDB.Driver.MongoCollection.RunCommandAs[TCommandResult](IMongoCommand command, ReadPreference readPreference)
   at MongoDB.Driver.MongoCollection.FindAndModify(FindAndModifyArgs args)
   at MongoDB.Driver.MongoCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.<>c__DisplayClass2c.<FindAndModify>b__2b()
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)

Nested Exception

Exception: System.Net.Sockets.SocketException
Message: No connection could be made because the target machine actively refused it 127.0.0.1:27017
Source: System
   at System.Net.Sockets.Socket.DoConnect(EndPoint endPointSnapshot, SocketAddress socketAddress)
   at System.Net.Sockets.Socket.Connect(EndPoint remoteEP)
   at System.Net.Sockets.TcpClient.Connect(IPEndPoint remoteEP)
   at MongoDB.Driver.Internal.MongoConnection.Open()
   at MongoDB.Driver.Internal.MongoConnection.SendMessage(BsonBuffer buffer, Int32 requestId)
   at MongoDB.Driver.Internal.MongoConnection.SendMessage(MongoRequestMessage message)
   at MongoDB.Driver.Operations.CommandOperation`1.Execute(MongoConnection connection)
   at MongoDB.Driver.MongoServerInstance.Ping(MongoConnection connection)
   at MongoDB.Driver.MongoServerInstance.Connect()
   at MongoDB.Driver.Internal.DirectMongoServerProxy.Connect(TimeSpan timeout, ReadPreference readPreference)



3600 13:45:30 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

9120 13:45:31 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

 424 13:45:32 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

6160 13:45:33 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

2472 13:45:37 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Core.BackgroundService.Run()

2180 13:45:38 INFO  AUDIT (sitecore\admin): Logout
2180 13:45:38 WARN  Protected page accessed with no current user
4424 13:45:41 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

3452 13:45:41 INFO  AUDIT (sitecore\admin): Login
3980 13:45:41 INFO  Cache created: 'WebUtil.QueryStringCache' (max size: 19KB, running total: 2328MB)
3980 13:45:43 INFO  Cache created: 'SocialMessagesByContainerCache' (max size: 10MB, running total: 2338MB)
7520 13:45:45 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

2092 13:45:45 INFO  HttpModule is being initialized
3600 13:45:45 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

9120 13:45:46 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

 424 13:45:47 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

6160 13:45:49 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

2472 13:45:52 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Core.BackgroundService.Run()

5296 13:45:56 INFO  [Experience Analytics]: Reduce agent found zero sites to process
4424 13:45:56 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

7520 13:46:00 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

3600 13:46:00 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

9120 13:46:01 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

 424 13:46:02 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

6160 13:46:04 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

2472 13:46:07 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Core.BackgroundService.Run()

4424 13:46:11 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

7520 13:46:15 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

3600 13:46:15 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

9120 13:46:16 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

 424 13:46:17 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

6160 13:46:19 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

2472 13:46:22 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Core.BackgroundService.Run()

5056 13:46:24 INFO  [Path Analyzer](.) Running trail cleanup agent
5056 13:46:24 INFO  [Path Analyzer](.) Running trail cleanup on database
ManagedPoolThread #2 13:46:24 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #3 13:46:26 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
5296 13:46:26 INFO  [Experience Analytics]: Reduce agent found zero sites to process
4424 13:46:26 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #13 13:46:27 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #1 13:46:28 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #11 13:46:29 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #14 13:46:30 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
3600 13:46:30 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #16 13:46:31 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
9120 13:46:31 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #5 13:46:32 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
 424 13:46:32 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #6 13:46:33 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
6160 13:46:34 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #19 13:46:34 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #17 13:46:35 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #4 13:46:36 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #0 13:46:37 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
2472 13:46:37 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #9 13:46:38 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #8 13:46:39 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #15 13:46:40 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #18 13:46:41 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
4424 13:46:41 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

7520 13:46:42 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
7520 13:46:42 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.HandleDatabaseException(ExceptionBehavior exceptionBehavior, Exception ex)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

Nested Exception

Exception: MongoDB.Driver.MongoConnectionException
Message: Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
Source: MongoDB.Driver
   at MongoDB.Driver.Internal.DirectMongoServerProxy.Connect(TimeSpan timeout, ReadPreference readPreference)
   at MongoDB.Driver.Internal.DirectMongoServerProxy.ChooseServerInstance(ReadPreference readPreference)
   at MongoDB.Driver.MongoServer.AcquireConnection(ReadPreference readPreference)
   at MongoDB.Driver.MongoCollection.RunCommandAs[TCommandResult](IMongoCommand command, ReadPreference readPreference, IBsonSerializer resultSerializer, IBsonSerializationOptions resultSerializationOptions)
   at MongoDB.Driver.MongoCollection.RunCommandAs[TCommandResult](IMongoCommand command, ReadPreference readPreference)
   at MongoDB.Driver.MongoCollection.FindAndModify(FindAndModifyArgs args)
   at MongoDB.Driver.MongoCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.<>c__DisplayClass2c.<FindAndModify>b__2b()
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)

Nested Exception

Exception: System.Net.Sockets.SocketException
Message: No connection could be made because the target machine actively refused it 127.0.0.1:27017
Source: System
   at System.Net.Sockets.Socket.DoConnect(EndPoint endPointSnapshot, SocketAddress socketAddress)
   at System.Net.Sockets.Socket.Connect(EndPoint remoteEP)
   at System.Net.Sockets.TcpClient.Connect(IPEndPoint remoteEP)
   at MongoDB.Driver.Internal.MongoConnection.Open()
   at MongoDB.Driver.Internal.MongoConnection.SendMessage(BsonBuffer buffer, Int32 requestId)
   at MongoDB.Driver.Internal.MongoConnection.SendMessage(MongoRequestMessage message)
   at MongoDB.Driver.Operations.CommandOperation`1.Execute(MongoConnection connection)
   at MongoDB.Driver.MongoServerInstance.Ping(MongoConnection connection)
   at MongoDB.Driver.MongoServerInstance.Connect()
   at MongoDB.Driver.Internal.DirectMongoServerProxy.Connect(TimeSpan timeout, ReadPreference readPreference)



ManagedPoolThread #12 13:46:43 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #7 13:46:44 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
3600 13:46:45 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #10 13:46:45 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
9120 13:46:46 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

 424 13:46:47 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

6160 13:46:49 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

2472 13:46:52 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Core.BackgroundService.Run()

5296 13:46:56 INFO  [Experience Analytics]: Reduce agent found zero sites to process
4424 13:46:56 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

7520 13:46:57 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

3600 13:47:00 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

9120 13:47:01 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

 424 13:47:02 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

6160 13:47:04 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

2472 13:47:07 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Core.BackgroundService.Run()

4424 13:47:11 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

7520 13:47:12 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

3600 13:47:15 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

9120 13:47:16 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

 424 13:47:17 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

6160 13:47:19 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

2472 13:47:22 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Core.BackgroundService.Run()

Heartbeat 13:47:25 ERROR MongoDbDictionary.Store() has failed.
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Save(Object value)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbDictionary.Store(Object value)

5296 13:47:26 INFO  [Experience Analytics]: Reduce agent found zero sites to process
4424 13:47:26 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

7520 13:47:27 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

3600 13:47:30 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

9120 13:47:31 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

 424 13:47:32 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

6160 13:47:34 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

2472 13:47:37 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #3 13:47:40 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #13 13:47:41 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
4424 13:47:41 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

7520 13:47:42 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #1 13:47:42 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #11 13:47:43 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #16 13:47:44 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
3600 13:47:45 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #5 13:47:45 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
9120 13:47:46 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #6 13:47:46 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
 424 13:47:47 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #14 13:47:47 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #17 13:47:48 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
6160 13:47:49 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #19 13:47:49 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #8 13:47:50 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #0 13:47:51 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #9 13:47:52 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
2472 13:47:52 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #4 13:47:53 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #15 13:47:54 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #12 13:47:55 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
5296 13:47:56 INFO  [Experience Analytics]: Reduce agent found zero sites to process
4424 13:47:56 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #10 13:47:56 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
7520 13:47:57 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #18 13:47:57 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #7 13:47:58 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
3600 13:48:00 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

9120 13:48:01 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

 424 13:48:02 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

6160 13:48:04 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

2472 13:48:07 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Core.BackgroundService.Run()

4424 13:48:11 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

7520 13:48:12 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

3600 13:48:15 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

9120 13:48:16 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

 424 13:48:17 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

6160 13:48:19 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

2472 13:48:22 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Core.BackgroundService.Run()

5296 13:48:26 INFO  [Experience Analytics]: Reduce agent found zero sites to process
4424 13:48:26 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

7520 13:48:27 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

3600 13:48:30 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

9120 13:48:31 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

 424 13:48:32 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

6160 13:48:34 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

2472 13:48:37 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Core.BackgroundService.Run()

4424 13:48:41 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

7520 13:48:42 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

3600 13:48:45 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

9120 13:48:46 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

 424 13:48:47 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

6160 13:48:49 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

2472 13:48:53 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #3 13:48:55 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
5296 13:48:56 INFO  [Experience Analytics]: Reduce agent found zero sites to process
ManagedPoolThread #1 13:48:56 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
4424 13:48:56 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

7520 13:48:57 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #13 13:48:57 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #11 13:48:58 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #16 13:48:59 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
3600 13:49:00 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #17 13:49:00 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
9120 13:49:01 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #6 13:49:01 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
 424 13:49:02 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #14 13:49:02 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #5 13:49:03 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
6160 13:49:04 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #19 13:49:04 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #4 13:49:05 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #8 13:49:06 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #9 13:49:07 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
2472 13:49:08 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #0 13:49:08 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #15 13:49:09 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #2 13:49:10 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #18 13:49:11 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
4424 13:49:11 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #7 13:49:12 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #12 13:49:13 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #10 13:49:14 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
3600 13:49:15 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

7520 13:49:15 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
7520 13:49:15 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.HandleDatabaseException(ExceptionBehavior exceptionBehavior, Exception ex)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

Nested Exception

Exception: MongoDB.Driver.MongoConnectionException
Message: Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
Source: MongoDB.Driver
   at MongoDB.Driver.Internal.DirectMongoServerProxy.Connect(TimeSpan timeout, ReadPreference readPreference)
   at MongoDB.Driver.Internal.DirectMongoServerProxy.ChooseServerInstance(ReadPreference readPreference)
   at MongoDB.Driver.MongoServer.AcquireConnection(ReadPreference readPreference)
   at MongoDB.Driver.MongoCollection.RunCommandAs[TCommandResult](IMongoCommand command, ReadPreference readPreference, IBsonSerializer resultSerializer, IBsonSerializationOptions resultSerializationOptions)
   at MongoDB.Driver.MongoCollection.RunCommandAs[TCommandResult](IMongoCommand command, ReadPreference readPreference)
   at MongoDB.Driver.MongoCollection.FindAndModify(FindAndModifyArgs args)
   at MongoDB.Driver.MongoCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.<>c__DisplayClass2c.<FindAndModify>b__2b()
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)

Nested Exception

Exception: System.Net.Sockets.SocketException
Message: No connection could be made because the target machine actively refused it 127.0.0.1:27017
Source: System
   at System.Net.Sockets.Socket.DoConnect(EndPoint endPointSnapshot, SocketAddress socketAddress)
   at System.Net.Sockets.Socket.Connect(EndPoint remoteEP)
   at System.Net.Sockets.TcpClient.Connect(IPEndPoint remoteEP)
   at MongoDB.Driver.Internal.MongoConnection.Open()
   at MongoDB.Driver.Internal.MongoConnection.SendMessage(BsonBuffer buffer, Int32 requestId)
   at MongoDB.Driver.Internal.MongoConnection.SendMessage(MongoRequestMessage message)
   at MongoDB.Driver.Operations.CommandOperation`1.Execute(MongoConnection connection)
   at MongoDB.Driver.MongoServerInstance.Ping(MongoConnection connection)
   at MongoDB.Driver.MongoServerInstance.Connect()
   at MongoDB.Driver.Internal.DirectMongoServerProxy.Connect(TimeSpan timeout, ReadPreference readPreference)



9120 13:49:16 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

 424 13:49:17 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

6160 13:49:19 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

2472 13:49:23 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Core.BackgroundService.Run()

5296 13:49:26 INFO  [Experience Analytics]: Reduce agent found zero sites to process
Heartbeat 13:49:26 ERROR MongoDbDictionary.Store() has failed.
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Save(Object value)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbDictionary.Store(Object value)

4424 13:49:26 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

3600 13:49:30 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

7520 13:49:30 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

9120 13:49:31 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

 424 13:49:32 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

6160 13:49:34 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

2472 13:49:38 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Core.BackgroundService.Run()

4424 13:49:41 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

3600 13:49:45 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

7520 13:49:45 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

9120 13:49:46 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

 424 13:49:47 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

6160 13:49:49 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

2472 13:49:53 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Core.BackgroundService.Run()

5296 13:49:56 INFO  [Experience Analytics]: Reduce agent found zero sites to process
4424 13:49:56 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

3600 13:50:00 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

7520 13:50:00 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

9120 13:50:01 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

 424 13:50:02 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

6160 13:50:04 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

2472 13:50:08 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #15 13:50:10 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #2 13:50:11 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
4424 13:50:11 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

7092 13:50:12 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
7740 13:50:13 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #1 13:50:14 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
3600 13:50:15 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #13 13:50:15 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
9120 13:50:16 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #3 13:50:16 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
 424 13:50:17 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #11 13:50:17 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #16 13:50:18 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
6160 13:50:19 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #17 13:50:19 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #5 13:50:20 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #19 13:50:21 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #6 13:50:22 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
2472 13:50:23 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #14 13:50:23 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #4 13:50:24 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #9 13:50:25 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
5296 13:50:26 INFO  [Experience Analytics]: Reduce agent found zero sites to process
4424 13:50:26 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #8 13:50:26 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #0 13:50:27 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #12 13:50:29 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
2820 13:50:29 INFO  **************************************************
2820 13:50:29 WARN  Sitecore shutting down
2820 13:50:29 WARN  Shutdown message: Change Notification for critical directories.
bin dir change or directory rename
HostingEnvironment initiated shutdown
Change Notification for critical directories.
bin dir change or directory rename
Change Notification for critical directories.
bin dir change or directory rename
Change Notification for critical directories.
bin dir change or directory rename
ManagedPoolThread #18 13:50:31 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #7 13:50:32 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #10 13:50:33 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
3452 13:50:59 ERROR An error occurred while reading an automation state document related to contact {F6ED8EBC-62D3-4514-9C11-46183AC3B445} was found in the AutomationStates collection. Mongo collection returned null.
