ManagedPoolThread #2 14:54:13 WARN  Failed to create counter 'Sitecore.System\Reflection | Objects Not Created / sec'. Sitecore has no necessary permissions for reading/creating counters
ManagedPoolThread #0 14:54:13 WARN  Failed to create counter 'Sitecore.System\Reflection | Objects Created / sec'. Sitecore has no necessary permissions for reading/creating counters
ManagedPoolThread #10 14:54:13 WARN  Failed to create counter 'Sitecore.System\Reflection | Methods Invoked / sec'. Sitecore has no necessary permissions for reading/creating counters
ManagedPoolThread #15 14:54:13 WARN  Failed to create counter 'Sitecore.System\Logging | Errors Logged / sec'. Sitecore has no necessary permissions for reading/creating counters
ManagedPoolThread #12 14:54:13 WARN  Failed to create counter 'Sitecore.System\Logging | Warnings Logged / sec'. Sitecore has no necessary permissions for reading/creating counters
ManagedPoolThread #11 14:54:13 WARN  Failed to create counter 'Sitecore.System\Logging | Audits Logged / sec'. Sitecore has no necessary permissions for reading/creating counters
7100 14:54:13 INFO  HttpModule is being initialized
ManagedPoolThread #14 14:54:13 WARN  Failed to create counter 'Sitecore.System\Logging | Fatals Logged / sec'. Sitecore has no necessary permissions for reading/creating counters
ManagedPoolThread #3 14:54:13 WARN  Failed to create counter 'Sitecore.System\Reflection | Types Resolved / sec'. Sitecore has no necessary permissions for reading/creating counters
ManagedPoolThread #13 14:54:13 WARN  Failed to create counter 'Sitecore.System\Logging | Informations Logged / sec'. Sitecore has no necessary permissions for reading/creating counters
ManagedPoolThread #5 14:54:13 WARN  Failed to create counter 'Sitecore.System\Threading | Background Threads Started / sec'. Sitecore has no necessary permissions for reading/creating counters
ManagedPoolThread #4 14:54:13 WARN  Failed to create counter 'Sitecore.System\Reflection | Types Not Resolved / sec'. Sitecore has no necessary permissions for reading/creating counters
ManagedPoolThread #6 14:54:13 WARN  Failed to create counter 'Sitecore.System\Xml | Packets Created / sec'. Sitecore has no necessary permissions for reading/creating counters
ManagedPoolThread #1 14:54:13 WARN  Failed to create counter 'Sitecore.System\Events | Events Raised / sec'. Sitecore has no necessary permissions for reading/creating counters
ManagedPoolThread #16 14:54:13 WARN  Failed to create counter 'Sitecore.System\IO | File Watcher Events / sec'. Sitecore has no necessary permissions for reading/creating counters
7100 14:54:13 INFO  
7100 14:54:13 INFO  **********************************************************************
7100 14:54:13 INFO  **********************************************************************
7100 14:54:13 INFO  Sitecore started
7100 14:54:13 INFO  Sitecore.NET 8.1 (rev. 151003)
7100 14:54:13 INFO  
7100 14:54:13 INFO  d:\projects\gathercontent\sitecore\website\bin\antlr3.runtime.dll (Antlr3.Runtime)
7100 14:54:13 INFO  d:\projects\gathercontent\sitecore\website\bin\componentart.web.ui.dll ()
7100 14:54:13 INFO  d:\projects\gathercontent\sitecore\website\bin\csquery.dll (CsQuery, CsQuery is a CSS selector engine and jQuery port for .NET 4 and C#)
7100 14:54:13 INFO  d:\projects\gathercontent\sitecore\website\bin\customfields.accountselector.dll (AccountSelectorAssembly)
7100 14:54:13 INFO  d:\projects\gathercontent\sitecore\website\bin\dotnetopenauth.dll (DotNetOpenAuth, 1c99bf16c5b570cadcf27d0b9ce3d598d06b34ca)
7100 14:54:13 INFO  d:\projects\gathercontent\sitecore\website\bin\ecmascript.net.dll (Modified version of the EcmaScript.NET assembly)
7100 14:54:13 INFO  d:\projects\gathercontent\sitecore\website\bin\facebook.dll (Facebook C# SDK, Facebook C# SDK)
7100 14:54:13 INFO  d:\projects\gathercontent\sitecore\website\bin\facebookapi.dll (FacebookAPI)
7100 14:54:13 INFO  d:\projects\gathercontent\sitecore\website\bin\gathercontent.connector.service.dll (GatherContent.Connector.Service)
7100 14:54:13 INFO  d:\projects\gathercontent\sitecore\website\bin\gathercontent.connector.website.dll (GatherContent.Connector.Website)
7100 14:54:13 INFO  d:\projects\gathercontent\sitecore\website\bin\google.apis.authentication.oauth2.dll (OAuth2 Authentication Library)
7100 14:54:13 INFO  d:\projects\gathercontent\sitecore\website\bin\google.apis.dll ()
7100 14:54:13 INFO  d:\projects\gathercontent\sitecore\website\bin\google.apis.plus.v1.dll (Google.Apis.Plus.v1)
7100 14:54:13 INFO  d:\projects\gathercontent\sitecore\website\bin\hammock.clientprofile.dll (Hammock)
7100 14:54:13 INFO  d:\projects\gathercontent\sitecore\website\bin\htmlagilitypack.dll (Html Agility Pack, 1.4.6.0)
7100 14:54:13 INFO  d:\projects\gathercontent\sitecore\website\bin\iesi.collections.dll (Iesi.Collections, Enhanced Collections for .NET.  Code was published at http://www.codeproject.com/csharp/sets.asp, 1.0)
7100 14:54:13 INFO  d:\projects\gathercontent\sitecore\website\bin\ithit.webdav.server.dll (WebDav Server .Net v2, IT Hit WebDAV Server .Net v2)
7100 14:54:13 INFO  d:\projects\gathercontent\sitecore\website\bin\lucene.net.contrib.analyzers.dll (Lucene.Net.Contrib.Analyzers)
7100 14:54:13 INFO  d:\projects\gathercontent\sitecore\website\bin\lucene.net.contrib.core.dll (Lucene.Net.Contrib.Core, Contributions to the Lucene.Net core library)
7100 14:54:13 INFO  d:\projects\gathercontent\sitecore\website\bin\lucene.net.contrib.fastvectorhighlighter.dll (Lucene.Net.Contrib.FastVectorHighlighter, FastVectorHighlighter for Lucene.Net)
7100 14:54:13 INFO  d:\projects\gathercontent\sitecore\website\bin\lucene.net.contrib.highlighter.dll (Lucene.Net.Contrib.Highlighter, The Apache Software Foundation Lucene.Net a full-text search engine library, 2.3.2)
7100 14:54:13 INFO  d:\projects\gathercontent\sitecore\website\bin\lucene.net.contrib.memory.dll (Contrib.Memory)
7100 14:54:13 INFO  d:\projects\gathercontent\sitecore\website\bin\lucene.net.contrib.queries.dll (Lucene.Net.Contrib.Queries)
7100 14:54:13 INFO  d:\projects\gathercontent\sitecore\website\bin\lucene.net.contrib.regex.dll (Lucene.Net.Contrib.Regex)
7100 14:54:13 INFO  d:\projects\gathercontent\sitecore\website\bin\lucene.net.contrib.simplefacetedsearch.dll (Lucene.Net.SimpleFacetedSearch, SimpleFacetedSearch for Lucene.Net)
7100 14:54:13 INFO  d:\projects\gathercontent\sitecore\website\bin\lucene.net.contrib.snowball.dll (Lucene.Net.Contrib.Snowball, The Apache Software Foundation Lucene.Net a full-text search engine library, 2.0)
7100 14:54:13 INFO  d:\projects\gathercontent\sitecore\website\bin\lucene.net.contrib.spellchecker.dll (SpellChecker.Net, The Apache Software Foundation Lucene.Net a full-text search engine library, 3.0.3)
7100 14:54:13 INFO  d:\projects\gathercontent\sitecore\website\bin\lucene.net.dll (Lucene.Net, The Apache Software Foundation Lucene.Net a full-text search engine library, 3.0.3)
7100 14:54:13 INFO  d:\projects\gathercontent\sitecore\website\bin\microsoft.web.infrastructure.dll (Microsoft ASP.Net WebPages)
7100 14:54:13 INFO  d:\projects\gathercontent\sitecore\website\bin\mongodb.bson.dll (MongoDB.Bson, Official MongoDB supported BSON library. See http://www.mongodb.org/display/DOCS/CSharp+Language+Center for more details, { version: '1.10.0.62', semver: '1.10.0', commit: '2df664a15859899b9bb0a457e237ec32c7d31e48', commitDate: '2015-01-29 15:41:46' })
7100 14:54:13 INFO  d:\projects\gathercontent\sitecore\website\bin\mongodb.driver.dll (MongoDB.Driver, Official MongoDB supported driver for MongoDB.  See http://www.mongodb.org/display/DOCS/CSharp+Language+Center for more details, { version: '1.10.0.62', semver: '1.10.0', commit: '2df664a15859899b9bb0a457e237ec32c7d31e48', commitDate: '2015-01-29 15:41:46' })
7100 14:54:13 INFO  d:\projects\gathercontent\sitecore\website\bin\mvp.xml.dll (MVP XML Library)
7100 14:54:13 INFO  d:\projects\gathercontent\sitecore\website\bin\netbiscuits.onpremise.dll (OnPremise)
7100 14:54:13 INFO  d:\projects\gathercontent\sitecore\website\bin\newtonsoft.json.dll (Json.NET, Json.NET is a popular high-performance JSON framework for .NET)
7100 14:54:13 INFO  d:\projects\gathercontent\sitecore\website\bin\oauthlinkedin.dll (OAuthLinkedIn)
7100 14:54:13 INFO  d:\projects\gathercontent\sitecore\website\bin\protobuf-net.dll (protobuf-net, Protocol Buffers for .NET)
7100 14:54:13 INFO  d:\projects\gathercontent\sitecore\website\bin\radeditor.net2.dll (RadEditor, Telerik RadEditor)
7100 14:54:13 INFO  d:\projects\gathercontent\sitecore\website\bin\sitecore.abstractions.dll (Sitecore CMS, 8.1.0 rev. 151003)
7100 14:54:13 INFO  d:\projects\gathercontent\sitecore\website\bin\sitecore.analytics.aggregation.dll (Sitecore DMS, 8.1.0 rev. 151003)
7100 14:54:13 INFO  d:\projects\gathercontent\sitecore\website\bin\sitecore.analytics.automation.aggregation.dll (Sitecore DMS, 8.1.0 rev. 151003)
7100 14:54:13 INFO  d:\projects\gathercontent\sitecore\website\bin\sitecore.analytics.automation.dll (Sitecore EAS, Sitecore Engagement Automation Suite, 8.1.0 rev. 151003)
7100 14:54:13 INFO  d:\projects\gathercontent\sitecore\website\bin\sitecore.analytics.automation.mongodb.dll (Sitecore DMS, 8.1.0 rev. 151003)
7100 14:54:13 INFO  d:\projects\gathercontent\sitecore\website\bin\sitecore.analytics.core.dll (Sitecore DMS, 8.1.0 rev. 151003)
7100 14:54:13 INFO  d:\projects\gathercontent\sitecore\website\bin\sitecore.analytics.dataaccess.dll (Sitecore DMS, 8.1.0 rev. 151003)
7100 14:54:13 INFO  d:\projects\gathercontent\sitecore\website\bin\sitecore.analytics.dll (Sitecore DMS, Sitecore Digital Marketing System, 8.1.0 rev. 151003)
7100 14:54:13 INFO  d:\projects\gathercontent\sitecore\website\bin\sitecore.analytics.model.dll (Sitecore DMS, 8.1.0 rev. 151003)
7100 14:54:13 INFO  d:\projects\gathercontent\sitecore\website\bin\sitecore.analytics.mongodb.dll (Sitecore DMS, Sitecore Digital Marketing System MongoDB Connector, 8.1.0 rev. 151003)
7100 14:54:13 INFO  d:\projects\gathercontent\sitecore\website\bin\sitecore.analytics.omnichannel.dll (Sitecore DMS, 8.1.0 rev. 151003)
7100 14:54:13 INFO  d:\projects\gathercontent\sitecore\website\bin\sitecore.analytics.outcome.dll (Sitecore DMS, 8.1.0 rev. 151003)
7100 14:54:13 INFO  d:\projects\gathercontent\sitecore\website\bin\sitecore.analytics.processing.dll (Sitecore DMS, 8.1.0 rev. 151003)
7100 14:54:13 INFO  d:\projects\gathercontent\sitecore\website\bin\sitecore.analytics.robotdetection.dll (Sitecore Robot Detection, 1.0.0 rev. 150922)
7100 14:54:13 INFO  d:\projects\gathercontent\sitecore\website\bin\sitecore.analytics.sql.dll (Sitecore DMS, 8.1.0 rev. 151003)
7100 14:54:13 INFO  d:\projects\gathercontent\sitecore\website\bin\sitecore.apps.loader.dll (Sitecore.Apps.Loader, Sitecore.Apps.Loader, 1.0.0 rev. 150907)
7100 14:54:13 INFO  d:\projects\gathercontent\sitecore\website\bin\sitecore.apps.taginjection.dll (Sitecore Tag Management, 1.0.0 rev. 140814)
7100 14:54:13 INFO  d:\projects\gathercontent\sitecore\website\bin\sitecore.buckets.client.dll (Sitecore Buckets, The assembly can be used to have Sitecore queries driven via a query, 1.0.0 rev. 150924)
7100 14:54:13 INFO  d:\projects\gathercontent\sitecore\website\bin\sitecore.buckets.dll (Sitecore Buckets, The assembly can be used to have Sitecore queries driven via search providers, 1.0.0 rev. 150924)
7100 14:54:13 INFO  d:\projects\gathercontent\sitecore\website\bin\sitecore.ces.devicedetection.dll (Sitecore Device Detection Client, 1.0.0 rev. 150803)
7100 14:54:13 INFO  d:\projects\gathercontent\sitecore\website\bin\sitecore.ces.devicedetection.rules.dll (Sitecore Device Detection Client, 1.0.0 rev. 150803)
7100 14:54:13 INFO  d:\projects\gathercontent\sitecore\website\bin\sitecore.ces.dll (Sitecore IP Geolocation Service Client, 1.3 rev. 150626)
7100 14:54:13 INFO  d:\projects\gathercontent\sitecore\website\bin\sitecore.ces.geoip.dll (Sitecore IP Geolocation Service Client, 1.3 rev. 150626)
7100 14:54:13 INFO  d:\projects\gathercontent\sitecore\website\bin\sitecore.ces.geoip.legacylocation.dll (Sitecore IP Geolocation Service Client, 1.3 rev. 150626)
7100 14:54:13 INFO  d:\projects\gathercontent\sitecore\website\bin\sitecore.cintel.client.dll (Sitecore Experience Profile, 1.0.0 rev. 150925)
7100 14:54:13 INFO  d:\projects\gathercontent\sitecore\website\bin\sitecore.cintel.dll (Sitecore Experience Profile, 1.0.0 rev. 150925)
7100 14:54:13 INFO  d:\projects\gathercontent\sitecore\website\bin\sitecore.client.dll (Sitecore CMS, Sitecore Client Application, 8.1.0 rev. 151003)
7100 14:54:13 INFO  d:\projects\gathercontent\sitecore\website\bin\sitecore.client.licenseoptions.dll (Sitecore Speak Applications, 1.3.1 rev. 150924)
7100 14:54:13 INFO  d:\projects\gathercontent\sitecore\website\bin\sitecore.cloud.contentsearch.dll (Sitecore Cloud ContentSearch, 8.1.0 rev. 150925)
7100 14:54:13 INFO  d:\projects\gathercontent\sitecore\website\bin\sitecore.cloud.nexus.dll (Sitecore Cloud Services)
7100 14:54:13 INFO  d:\projects\gathercontent\sitecore\website\bin\sitecore.cloud.restclient.dll (Sitecore Cloud Services)
7100 14:54:13 INFO  d:\projects\gathercontent\sitecore\website\bin\sitecore.cloud.servicemodel.dll (Sitecore Cloud Services)
7100 14:54:13 INFO  d:\projects\gathercontent\sitecore\website\bin\sitecore.cloud.xdb.dll (Sitecore Cloud Xdb, 8.1.0 rev. 150911)
7100 14:54:13 INFO  d:\projects\gathercontent\sitecore\website\bin\sitecore.contentsearch.analytics.client.dll (Sitecore Buckets, 1.0.0 rev. 150924)
7100 14:54:13 INFO  d:\projects\gathercontent\sitecore\website\bin\sitecore.contentsearch.analytics.dll (Sitecore Buckets, 1.0.0 rev. 150924)
7100 14:54:13 INFO  d:\projects\gathercontent\sitecore\website\bin\sitecore.contentsearch.client.dll (Sitecore Buckets, 1.0.0 rev. 150924)
7100 14:54:13 INFO  d:\projects\gathercontent\sitecore\website\bin\sitecore.contentsearch.dll (Sitecore Buckets, Sitecore CMS Search, 1.0.0 rev. 150924)
7100 14:54:13 INFO  d:\projects\gathercontent\sitecore\website\bin\sitecore.contentsearch.linq.dll (Sitecore Buckets, Sitecore CMS Search, 1.0.0 rev. 150924)
7100 14:54:13 INFO  d:\projects\gathercontent\sitecore\website\bin\sitecore.contentsearch.linq.lucene.dll (Sitecore Buckets, 1.0.0 rev. 150924)
7100 14:54:13 INFO  d:\projects\gathercontent\sitecore\website\bin\sitecore.contentsearch.luceneprovider.dll (Sitecore Buckets, Sitecore CMS Search, 1.0.0 rev. 150924)
7100 14:54:13 INFO  d:\projects\gathercontent\sitecore\website\bin\sitecore.contenttesting.dll (Sitecore Content Testing, 8.1.0 rev. 150924)
7100 14:54:13 INFO  d:\projects\gathercontent\sitecore\website\bin\sitecore.contenttesting.intelligence.dll (Sitecore Content Testing, 8.1.0 rev. 150924)
7100 14:54:13 INFO  d:\projects\gathercontent\sitecore\website\bin\sitecore.contenttesting.model.dll (Sitecore Content Testing, 8.1.0 rev. 150924)
7100 14:54:13 INFO  d:\projects\gathercontent\sitecore\website\bin\sitecore.contenttesting.mvc.dll (Sitecore Content Testing, 8.1.0 rev. 150924)
7100 14:54:13 INFO  d:\projects\gathercontent\sitecore\website\bin\sitecore.controlpanel.dll (Sitecore Speak Applications, 1.3.1 rev. 150924)
7100 14:54:13 INFO  d:\projects\gathercontent\sitecore\website\bin\sitecore.experienceanalytics.client.dll (Sitecore Experience Analytics, 1.1.0 rev. 151001)
7100 14:54:13 INFO  d:\projects\gathercontent\sitecore\website\bin\sitecore.experienceanalytics.dll (Sitecore Experience Analytics, 1.1.0 rev. 151001)
7100 14:54:13 INFO  d:\projects\gathercontent\sitecore\website\bin\sitecore.experienceeditor.dll (Sitecore Experience Editor, 2.0.0 rev. 150914)
7100 14:54:13 INFO  d:\projects\gathercontent\sitecore\website\bin\sitecore.experienceeditor.speak.dll (Sitecore Experience Editor, 2.0.0 rev. 150914)
7100 14:54:13 INFO  d:\projects\gathercontent\sitecore\website\bin\sitecore.experienceeditor.speak.ribbon.dll (Sitecore Experience Editor, 2.0.0 rev. 150914)
7100 14:54:13 INFO  d:\projects\gathercontent\sitecore\website\bin\sitecore.experienceexplorer.business.dll (Sitecore Experience Explorer, 2.0.0 rev. 150930)
7100 14:54:13 INFO  d:\projects\gathercontent\sitecore\website\bin\sitecore.experienceexplorer.web.dll (Sitecore Experience Explorer, 2.0.0 rev. 150930)
7100 14:54:13 INFO  d:\projects\gathercontent\sitecore\website\bin\sitecore.fxm.client.dll (Sitecore Federated Experience Manager, 2.0.0 rev. 150928 )
7100 14:54:13 INFO  d:\projects\gathercontent\sitecore\website\bin\sitecore.fxm.dll (Sitecore Federated Experience Manager, 2.0.0 rev. 150928 )
7100 14:54:13 INFO  d:\projects\gathercontent\sitecore\website\bin\sitecore.fxm.service.dll (Sitecore Federated Experience Manager, 2.0.0 rev. 150928 )
7100 14:54:13 INFO  d:\projects\gathercontent\sitecore\website\bin\sitecore.fxm.speak.dll (Sitecore Federated Experience Manager, 2.0.0 rev. 150928 )
7100 14:54:13 INFO  d:\projects\gathercontent\sitecore\website\bin\sitecore.itemwebapi.dll (Sitecore Item Web API, 1.2.0 rev. 141016)
7100 14:54:13 INFO  d:\projects\gathercontent\sitecore\website\bin\sitecore.kernel.dll (Sitecore CMS, Sitecore CMS Kernel Library, 8.1.0 rev. 151003)
7100 14:54:13 INFO  d:\projects\gathercontent\sitecore\website\bin\sitecore.launchpad.dll (Sitecore LaunchPad, 1.0 rev. 150925)
7100 14:54:13 INFO  d:\projects\gathercontent\sitecore\website\bin\sitecore.listmanagement.analytics.dll (Sitecore List Manager, 1.1.0 rev. 150925)
7100 14:54:13 INFO  d:\projects\gathercontent\sitecore\website\bin\sitecore.listmanagement.client.dll (Sitecore List Manager, 1.1.0 rev. 150925)
7100 14:54:13 INFO  d:\projects\gathercontent\sitecore\website\bin\sitecore.listmanagement.contentsearch.dll (Sitecore List Manager, 1.1.0 rev. 150925)
7100 14:54:13 INFO  d:\projects\gathercontent\sitecore\website\bin\sitecore.listmanagement.dll (Sitecore List Manager, 1.1.0 rev. 150925)
7100 14:54:13 INFO  d:\projects\gathercontent\sitecore\website\bin\sitecore.listmanagement.services.dll (Sitecore List Manager, 1.1.0 rev. 150925)
7100 14:54:13 INFO  d:\projects\gathercontent\sitecore\website\bin\sitecore.logging.client.dll (Sitecore CMS, Lets you insert loggers in your JavaScript, and automatically sends the log messages to a server side component that stores them in your existing server side logs. Interfaces with Sitecore.Logging.

Ideal for logging JavaScript exceptions to the server, including a stack trace. Documentation and examples are at jsnlog.com)
7100 14:54:13 INFO  d:\projects\gathercontent\sitecore\website\bin\sitecore.logging.dll (Sitecore CMS, Sitecore Logging Framework, 8.0 rev. 141020)
7100 14:54:13 INFO  d:\projects\gathercontent\sitecore\website\bin\sitecore.marketing.campaigns.client.dll (Sitecore Campaign Manager, 1.1 rev. 150925)
7100 14:54:13 INFO  d:\projects\gathercontent\sitecore\website\bin\sitecore.marketing.campaigns.services.dll (Sitecore Campaign Manager, 1.1 rev. 150925)
7100 14:54:13 INFO  d:\projects\gathercontent\sitecore\website\bin\sitecore.marketing.client.dll (Sitecore Marketing Client, 1.0.0 rev. 150915)
7100 14:54:13 INFO  d:\projects\gathercontent\sitecore\website\bin\sitecore.marketing.core.dll (Sitecore Marketing Operations API, 8.1.0 rev. 151003)
7100 14:54:13 INFO  d:\projects\gathercontent\sitecore\website\bin\sitecore.marketing.definitions.marketingassets.repositories.dll (Sitecore Marketing Asset Repositories, 1.0.0 rev. 150701)
7100 14:54:13 INFO  d:\projects\gathercontent\sitecore\website\bin\sitecore.marketing.dll (Sitecore Marketing Operations API, 8.1.0 rev. 151003)
7100 14:54:13 INFO  d:\projects\gathercontent\sitecore\website\bin\sitecore.marketing.search.dll (Sitecore Marketing Operations, 1.0.0 rev. 150928)
7100 14:54:13 INFO  d:\projects\gathercontent\sitecore\website\bin\sitecore.marketing.taxonomy.dll (Sitecore Marketing Operations API, 8.1.0 rev. 151003)
7100 14:54:13 INFO  d:\projects\gathercontent\sitecore\website\bin\sitecore.mvc.analytics.dll (Sitecore Mvc Analytics, 1.1.0 rev. 150618)
7100 14:54:13 INFO  d:\projects\gathercontent\sitecore\website\bin\sitecore.mvc.devicesimulator.dll (Sitecore Mvc Device Simulators, 1.0.0 rev. 150909)
7100 14:54:13 INFO  d:\projects\gathercontent\sitecore\website\bin\sitecore.mvc.dll (Sitecore Mvc, 1.0.0 rev. 150625)
7100 14:54:13 INFO  d:\projects\gathercontent\sitecore\website\bin\sitecore.mvc.experienceeditor.dll (Sitecore Mvc Experience Editor, 2.0.0 rev. 150710)
7100 14:54:13 INFO  d:\projects\gathercontent\sitecore\website\bin\sitecore.nexus.dll (Sitecore.Nexus)
7100 14:54:13 INFO  d:\projects\gathercontent\sitecore\website\bin\sitecore.nvelocity.dll (Sitecore CMS, Sitecore Macro Expansion Library, 6.6.0 rev. 120918)
7100 14:54:13 INFO  d:\projects\gathercontent\sitecore\website\bin\sitecore.oracle.dll (Sitecore CMS, Oracle Data Provider for Sitecore, 8.1.0 rev. 151003)
7100 14:54:13 INFO  d:\projects\gathercontent\sitecore\website\bin\sitecore.pathanalyzer.client.dll (Sitecore Path Analyzer, 1.1.0 rev. 150828)
7100 14:54:13 INFO  d:\projects\gathercontent\sitecore\website\bin\sitecore.pathanalyzer.dll (Sitecore Path Analyzer, 1.1.0 rev. 150828)
7100 14:54:13 INFO  d:\projects\gathercontent\sitecore\website\bin\sitecore.pathanalyzer.services.dll (Sitecore Path Analyzer, 1.1.0 rev. 150828)
7100 14:54:13 INFO  d:\projects\gathercontent\sitecore\website\bin\sitecore.publishing.webdeploy.dll (Sitecore CMS, Sitecore publishing infrastructure based on Web Deployment Tool, 8.1.0 rev. 151003)
7100 14:54:13 INFO  d:\projects\gathercontent\sitecore\website\bin\sitecore.security.anticsrf.dll (Sitecore AntiCSRF Module, 1.0.0 rev. 150806)
7100 14:54:13 INFO  d:\projects\gathercontent\sitecore\website\bin\sitecore.segmentbuilder.dll (Sitecore Segment Builder, 1.0.0 rev. 150625)
7100 14:54:13 INFO  d:\projects\gathercontent\sitecore\website\bin\sitecore.sequenceanalyzer.dll (Sitecore Path Analyzer, 1.1.0 rev. 150828)
7100 14:54:13 INFO  d:\projects\gathercontent\sitecore\website\bin\sitecore.services.client.dll (Sitecore Services 1.0.0, Sitecore Services, 1.0.0)
7100 14:54:13 INFO  d:\projects\gathercontent\sitecore\website\bin\sitecore.services.core.dll (Sitecore Services 1.0.0, Sitecore Services, 1.0 rev. 141114)
7100 14:54:13 INFO  d:\projects\gathercontent\sitecore\website\bin\sitecore.services.infrastructure.dll (Sitecore Services 1.0.0, Sitecore Services, 1.0 rev. 141114)
7100 14:54:13 INFO  d:\projects\gathercontent\sitecore\website\bin\sitecore.services.infrastructure.sitecore.dll (Sitecore Services 1.0.0, Sitecore Services, 1.0 rev. 141114)
7100 14:54:13 INFO  d:\projects\gathercontent\sitecore\website\bin\sitecore.sessionprovider.dll (Sitecore CMS, 8.1.0 rev. 151003)
7100 14:54:13 INFO  d:\projects\gathercontent\sitecore\website\bin\sitecore.sessionprovider.memory.dll (Sitecore CMS, 8.1.0 rev. 151003)
7100 14:54:13 INFO  d:\projects\gathercontent\sitecore\website\bin\sitecore.sessionprovider.mongodb.dll (Sitecore CMS, 8.1.0 rev. 151003)
7100 14:54:13 INFO  d:\projects\gathercontent\sitecore\website\bin\sitecore.sessionprovider.sql.dll (Sitecore CMS, 8.1.0 rev. 151003)
7100 14:54:13 INFO  d:\projects\gathercontent\sitecore\website\bin\sitecore.shell.marketingautomation.dll (Sitecore Engagement Automation Suite, 1.0.0 rev. 150731)
7100 14:54:13 INFO  d:\projects\gathercontent\sitecore\website\bin\sitecore.social.api.dll (Social Connected Module, 8.1 rev. 150720)
7100 14:54:13 INFO  d:\projects\gathercontent\sitecore\website\bin\sitecore.social.client.api.dll (Social Connected Module, 8.1 rev. 150720)
7100 14:54:13 INFO  d:\projects\gathercontent\sitecore\website\bin\sitecore.social.client.common.dll (Social Connected Module, 8.1 rev. 150720)
7100 14:54:13 INFO  d:\projects\gathercontent\sitecore\website\bin\sitecore.social.client.dll (Social Connected Module, 8.1 rev. 150720)
7100 14:54:13 INFO  d:\projects\gathercontent\sitecore\website\bin\sitecore.social.client.domain.dll (Social Connected Module, 8.1 rev. 150720)
7100 14:54:13 INFO  d:\projects\gathercontent\sitecore\website\bin\sitecore.social.client.mvc.dll (Social Connected Module, 8.1 rev. 150720)
7100 14:54:13 INFO  d:\projects\gathercontent\sitecore\website\bin\sitecore.social.client.speak.dll (Social Connected Module, 8.1 rev. 150720)
7100 14:54:13 INFO  d:\projects\gathercontent\sitecore\website\bin\sitecore.social.configuration.dll (Social Connected Module, 8.1 rev. 150720)
7100 14:54:13 INFO  d:\projects\gathercontent\sitecore\website\bin\sitecore.social.dll (Social Connected Module, 8.1 rev. 150720)
7100 14:54:13 INFO  d:\projects\gathercontent\sitecore\website\bin\sitecore.social.domain.dll (Social Connected Module, 8.1 rev. 150720)
7100 14:54:13 INFO  d:\projects\gathercontent\sitecore\website\bin\sitecore.social.experienceprofile.client.dll (Social Connected Module, 8.1 rev. 150720)
7100 14:54:13 INFO  d:\projects\gathercontent\sitecore\website\bin\sitecore.social.facebook.api.dll (Social Connected Module, 8.1 rev. 150720)
7100 14:54:13 INFO  d:\projects\gathercontent\sitecore\website\bin\sitecore.social.facebook.client.dll (Social Connected Module, 8.1 rev. 150720)
7100 14:54:13 INFO  d:\projects\gathercontent\sitecore\website\bin\sitecore.social.facebook.client.mvc.dll (Social Connected Module, 8.1 rev. 150720)
7100 14:54:13 INFO  d:\projects\gathercontent\sitecore\website\bin\sitecore.social.facebook.dll (Social Connected Module, 8.1 rev. 150720)
7100 14:54:13 INFO  d:\projects\gathercontent\sitecore\website\bin\sitecore.social.googleplus.client.dll (Social Connected Module, 8.1 rev. 150720)
7100 14:54:13 INFO  d:\projects\gathercontent\sitecore\website\bin\sitecore.social.googleplus.client.mvc.dll (Social Connected Module, 8.1 rev. 150720)
7100 14:54:13 INFO  d:\projects\gathercontent\sitecore\website\bin\sitecore.social.googleplus.dll (Social Connected Module, 8.1 rev. 150720)
7100 14:54:13 INFO  d:\projects\gathercontent\sitecore\website\bin\sitecore.social.infrastructure.dll (Social Connected Module, 8.1 rev. 150720)
7100 14:54:13 INFO  d:\projects\gathercontent\sitecore\website\bin\sitecore.social.infrastructure.logging.dll (Social Connected Module, 8.1 rev. 150720)
7100 14:54:13 INFO  d:\projects\gathercontent\sitecore\website\bin\sitecore.social.installation.dll (Social Connected Module, 8.1 rev. 150720)
7100 14:54:13 INFO  d:\projects\gathercontent\sitecore\website\bin\sitecore.social.klout.api.dll (Social Connected Module, 8.1 rev. 150720)
7100 14:54:13 INFO  d:\projects\gathercontent\sitecore\website\bin\sitecore.social.klout.client.dll (Social Connected Module, 8.1 rev. 150720)
7100 14:54:13 INFO  d:\projects\gathercontent\sitecore\website\bin\sitecore.social.linkedin.client.dll (Social Connected Module, 8.1 rev. 150720)
7100 14:54:13 INFO  d:\projects\gathercontent\sitecore\website\bin\sitecore.social.linkedin.client.mvc.dll (Social Connected Module, 8.1 rev. 150720)
7100 14:54:13 INFO  d:\projects\gathercontent\sitecore\website\bin\sitecore.social.linkedin.dll (Social Connected Module, 8.1 rev. 150720)
7100 14:54:13 INFO  d:\projects\gathercontent\sitecore\website\bin\sitecore.social.networkproviders.dll (Social Connected Module, 8.1 rev. 150720)
7100 14:54:13 INFO  d:\projects\gathercontent\sitecore\website\bin\sitecore.social.sitecoreaccess.dll (Social Connected Module, 8.1 rev. 150720)
7100 14:54:13 INFO  d:\projects\gathercontent\sitecore\website\bin\sitecore.social.socialmarketer.api.dll (Social Connected Module, 8.1 rev. 150720)
7100 14:54:13 INFO  d:\projects\gathercontent\sitecore\website\bin\sitecore.social.socialmarketer.client.dll (Social Connected Module, 8.1 rev. 150720)
7100 14:54:13 INFO  d:\projects\gathercontent\sitecore\website\bin\sitecore.social.socialmarketer.dll (Social Connected Module, 8.1 rev. 150720)
7100 14:54:13 INFO  d:\projects\gathercontent\sitecore\website\bin\sitecore.social.twitter.api.dll (Social Connected Module, 8.1 rev. 150720)
7100 14:54:13 INFO  d:\projects\gathercontent\sitecore\website\bin\sitecore.social.twitter.client.dll (Social Connected Module, 8.1 rev. 150720)
7100 14:54:13 INFO  d:\projects\gathercontent\sitecore\website\bin\sitecore.social.twitter.client.mvc.dll (Social Connected Module, 8.1 rev. 150720)
7100 14:54:13 INFO  d:\projects\gathercontent\sitecore\website\bin\sitecore.social.twitter.dll (Social Connected Module, 8.1 rev. 150720)
7100 14:54:13 INFO  d:\projects\gathercontent\sitecore\website\bin\sitecore.speak.applications.dll (Sitecore Speak Applications, 1.3.1 rev. 150924)
7100 14:54:13 INFO  d:\projects\gathercontent\sitecore\website\bin\sitecore.speak.charting.dll (Sitecore Speak Charting, 1.1.0 rev. 150820)
7100 14:54:13 INFO  d:\projects\gathercontent\sitecore\website\bin\sitecore.speak.client.dll (Sitecore Speak, 2.0.0 rev. 150715)
7100 14:54:13 INFO  d:\projects\gathercontent\sitecore\website\bin\sitecore.speak.components.dll (Sitecore Speak Components, 2.0.0 rev. 150715)
7100 14:54:13 INFO  d:\projects\gathercontent\sitecore\website\bin\sitecore.speak.components.guidance.dll (Sitecore Speak Components, 2.0.0 rev. 150715)
7100 14:54:13 INFO  d:\projects\gathercontent\sitecore\website\bin\sitecore.speak.components.web.dll (Sitecore Speak Components, 2.0.0 rev. 150715)
7100 14:54:13 INFO  d:\projects\gathercontent\sitecore\website\bin\sitecore.speak.itemwebapi.dll (Sitecore Speak, 2.0.0 rev. 150715)
7100 14:54:13 INFO  d:\projects\gathercontent\sitecore\website\bin\sitecore.speak.mvc.dll (Sitecore Speak, 2.0.0 rev. 150715)
7100 14:54:13 INFO  d:\projects\gathercontent\sitecore\website\bin\sitecore.speak.web.dll (Sitecore Speak, 2.0.0 rev. 150715)
7100 14:54:13 INFO  d:\projects\gathercontent\sitecore\website\bin\sitecore.update.dll (Sitecore Update Installation Wizard, 1.0.0 rev. 150930)
7100 14:54:13 INFO  d:\projects\gathercontent\sitecore\website\bin\sitecore.web.dll (Sitecore.Web 1.1.0, 1.1.0 rev. 150708)
7100 14:54:13 INFO  d:\projects\gathercontent\sitecore\website\bin\sitecore.xdb.configuration.dll (Sitecore DMS, 8.1.0 rev. 151003)
7100 14:54:13 INFO  d:\projects\gathercontent\sitecore\website\bin\sitecore.zip.dll (Sitecore CMS, ZIP support for Sitecore, 8.1.0 rev. 150714)
7100 14:54:13 INFO  d:\projects\gathercontent\sitecore\website\bin\stimulsoft.base.dll (Stimulsoft Reports, Stimulsoft Base)
7100 14:54:13 INFO  d:\projects\gathercontent\sitecore\website\bin\stimulsoft.database.dll (Stimulsoft Reports, Stimulsoft Reports Database Helper)
7100 14:54:13 INFO  d:\projects\gathercontent\sitecore\website\bin\stimulsoft.report.dll (Stimulsoft Reports, Stimulsoft Reports Engine)
7100 14:54:13 INFO  d:\projects\gathercontent\sitecore\website\bin\stimulsoft.report.web.dll (Stimulsoft Reports.Web, Stimulsoft Reports.Web Viewer)
7100 14:54:13 INFO  d:\projects\gathercontent\sitecore\website\bin\stimulsoft.report.webdesign.dll (Stimulsoft Reports Designer.Web, Stimulsoft Reports Designer.Web)
7100 14:54:13 INFO  d:\projects\gathercontent\sitecore\website\bin\system.net.http.dll (Microsoft® .NET Framework, System.Net.Http.dll, 4.0.30319.33440)
7100 14:54:13 INFO  d:\projects\gathercontent\sitecore\website\bin\system.net.http.formatting.dll (Microsoft ASP.NET MVC, 5.2.3-30128 (0e974218e12a67d4b1f25422119e40cfe6953e46))
7100 14:54:13 INFO  d:\projects\gathercontent\sitecore\website\bin\system.net.http.webrequest.dll (Microsoft® .NET Framework, System.Net.Http.WebRequest.dll, 4.0.30319.33440)
7100 14:54:13 INFO  d:\projects\gathercontent\sitecore\website\bin\system.web.cors.dll (Microsoft ASP.NET MVC, 5.1.0-20110)
7100 14:54:13 INFO  d:\projects\gathercontent\sitecore\website\bin\system.web.helpers.dll (Microsoft ASP.NET Web Pages, 3.0.3-30128 (0e974218e12a67d4b1f25422119e40cfe6953e46))
7100 14:54:13 INFO  d:\projects\gathercontent\sitecore\website\bin\system.web.http.cors.dll (Microsoft ASP.NET MVC, 5.1.0-20110)
7100 14:54:13 INFO  d:\projects\gathercontent\sitecore\website\bin\system.web.http.dll (Microsoft ASP.NET MVC, 5.2.3-30128 (0e974218e12a67d4b1f25422119e40cfe6953e46))
7100 14:54:13 INFO  d:\projects\gathercontent\sitecore\website\bin\system.web.http.webhost.dll (Microsoft ASP.NET MVC, 5.2.3-30128 (0e974218e12a67d4b1f25422119e40cfe6953e46))
7100 14:54:13 INFO  d:\projects\gathercontent\sitecore\website\bin\system.web.mvc.dll (Microsoft ASP.NET MVC, System.Web.Mvc.dll, 5.2.3-30128 (0e974218e12a67d4b1f25422119e40cfe6953e46))
7100 14:54:13 INFO  d:\projects\gathercontent\sitecore\website\bin\system.web.optimization.dll (System.Web.Optimization)
7100 14:54:13 INFO  d:\projects\gathercontent\sitecore\website\bin\system.web.razor.dll (Microsoft ASP.NET Web Pages, 3.0.3-30128 (0e974218e12a67d4b1f25422119e40cfe6953e46))
7100 14:54:13 INFO  d:\projects\gathercontent\sitecore\website\bin\system.web.webpages.deployment.dll (Microsoft ASP.NET Web Pages, 3.0.3-30128 (0e974218e12a67d4b1f25422119e40cfe6953e46))
7100 14:54:13 INFO  d:\projects\gathercontent\sitecore\website\bin\system.web.webpages.dll (Microsoft ASP.NET Web Pages, 3.0.3-30128 (0e974218e12a67d4b1f25422119e40cfe6953e46))
7100 14:54:13 INFO  d:\projects\gathercontent\sitecore\website\bin\system.web.webpages.razor.dll (Microsoft ASP.NET Web Pages, 3.0.3-30128 (0e974218e12a67d4b1f25422119e40cfe6953e46))
7100 14:54:13 INFO  d:\projects\gathercontent\sitecore\website\bin\telerik.web.ui.dll (Telerik.Web.UI, Telerik UI for ASP.NET AJAX)
7100 14:54:13 INFO  d:\projects\gathercontent\sitecore\website\bin\telerik.web.ui.skins.dll (Telerik.Web.UI.Skins, Telerik UI for ASP.NET AJAX Ajax Skins)
7100 14:54:13 INFO  d:\projects\gathercontent\sitecore\website\bin\tweetsharp.dll (TweetSharp)
7100 14:54:13 INFO  d:\projects\gathercontent\sitecore\website\bin\webgrease.dll (WebGrease)
7100 14:54:13 INFO  d:\projects\gathercontent\sitecore\website\bin\yahoo.yui.compressor.dll (YUI Compressor, A .NET port of the Yahoo! YUI Compressor project)
7100 14:54:13 INFO  
7100 14:54:13 INFO  Operating system Microsoft Windows NT 6.3.9600.0
7100 14:54:13 INFO  
7100 14:54:13 INFO  Microsoft.NET version 4.0.30319.34209
7100 14:54:13 INFO  
7100 14:54:13 INFO  UTC offset: 03:00:00
7100 14:54:13 INFO  Machine name: brimit-dpa
7100 14:54:13 INFO  App pool ID: GatherContent.dev
7100 14:54:13 INFO  
7100 14:54:13 INFO  Process ID: 4288
7100 14:54:13 INFO  Windows identity used by the process: IIS APPPOOL\GatherContent.dev. Impersonation: False
7100 14:54:13 INFO  Managed pipeline mode: Integrated
7100 14:54:13 INFO  
7100 14:54:13 INFO  EventQueues enabled: True
7100 14:54:13 INFO  Instance Name:BRIMIT-DPA-GatherContent.dev
7100 14:54:13 INFO  
7100 14:54:13 INFO  Threshold settings
7100 14:54:13 INFO    Show threshold warnings: False
7100 14:54:13 INFO  
7100 14:54:13 INFO  Databases
7100 14:54:13 INFO    core
7100 14:54:13 INFO    master
7100 14:54:13 INFO    web
7100 14:54:13 INFO    filesystem
7100 14:54:13 INFO  
7100 14:54:13 INFO  Domains
7100 14:54:13 INFO  Heartbeat - Initializing
7100 14:54:13 INFO  Heartbeat - Interval set to: 00:00:02
7100 14:54:13 INFO  Heartbeat - Worker thread started
7100 14:54:13 INFO  Trying to load XML configuration /App_Config/Security/Domains.config
7100 14:54:13 INFO    sitecore
7100 14:54:13 INFO    extranet
7100 14:54:13 INFO    default
7100 14:54:13 INFO  **********************************************************************
7100 14:54:13 INFO  **********************************************************************
ManagedPoolThread #9 14:54:13 WARN  Failed to create counter 'Sitecore.Jobs\Jobs | Jobs Executed / sec'. Sitecore has no necessary permissions for reading/creating counters
ManagedPoolThread #7 14:54:13 WARN  Failed to create counter 'Sitecore.Jobs\Pipelines | Pipelines Aborted / sec'. Sitecore has no necessary permissions for reading/creating counters
ManagedPoolThread #19 14:54:13 WARN  Failed to create counter 'Sitecore.Jobs\Pipelines | Pipelines Executed / sec'. Sitecore has no necessary permissions for reading/creating counters
ManagedPoolThread #8 14:54:13 WARN  Failed to create counter 'Sitecore.Jobs\Pipelines | Processors Executed / sec'. Sitecore has no necessary permissions for reading/creating counters
ManagedPoolThread #18 14:54:13 WARN  Failed to create counter 'Sitecore.Jobs\Publishing | Items Queued / sec'. Sitecore has no necessary permissions for reading/creating counters
ManagedPoolThread #17 14:54:13 WARN  Failed to create counter 'Sitecore.Jobs\Publishing | Replacements / sec'. Sitecore has no necessary permissions for reading/creating counters
ManagedPoolThread #2 14:54:13 WARN  Failed to create counter 'Sitecore.Jobs\Tasks | File Cleanups / sec'. Sitecore has no necessary permissions for reading/creating counters
ManagedPoolThread #12 14:54:13 WARN  Failed to create counter 'Sitecore.Jobs\Tasks | Html Cache Clearings / sec'. Sitecore has no necessary permissions for reading/creating counters
ManagedPoolThread #0 14:54:13 WARN  Failed to create counter 'Sitecore.Jobs\Tasks | Publishings / sec'. Sitecore has no necessary permissions for reading/creating counters
ManagedPoolThread #10 14:54:13 WARN  Failed to create counter 'Sitecore.Jobs\Tasks | Reminders Sent / sec'. Sitecore has no necessary permissions for reading/creating counters
ManagedPoolThread #11 14:54:13 WARN  Failed to create counter 'Sitecore.Jobs\Tasks | Tasks Executed / sec'. Sitecore has no necessary permissions for reading/creating counters
7100 14:54:13 INFO  
7100 14:54:13 INFO  **********************************************************************
7100 14:54:13 INFO  **********************************************************************
7100 14:54:13 INFO  
7100 14:54:13 INFO  xDB is enabled.
7100 14:54:13 INFO  
7100 14:54:13 INFO  Tracking is enabled.
7100 14:54:13 INFO  
7100 14:54:13 INFO  **********************************************************************
7100 14:54:13 INFO  **********************************************************************
7100 14:54:13 INFO  Attempting to get ASP.NET process history
7100 14:54:13 WARN  No process history available
7100 14:54:13 INFO  Cache created: 'LanguageProvider - Languages' (max size: 100KB, running total: 100KB)
7100 14:54:13 INFO  Cache created: 'DeviceItemsCache' (max size: 50MB, running total: 50MB)
7100 14:54:13 INFO  Cache created: 'core[data]' (max size: 100MB, running total: 150MB)
ManagedPoolThread #14 14:54:13 WARN  Failed to create counter 'Sitecore.Caching\Cache Clearings / sec'. Sitecore has no necessary permissions for reading/creating counters
ManagedPoolThread #3 14:54:13 WARN  Failed to create counter 'Sitecore.Caching\Cache Hits / sec'. Sitecore has no necessary permissions for reading/creating counters
ManagedPoolThread #13 14:54:13 WARN  Failed to create counter 'Sitecore.Caching\Cache Misses / sec'. Sitecore has no necessary permissions for reading/creating counters
ManagedPoolThread #15 14:54:13 WARN  Failed to create counter 'Sitecore.Caching\Data Cache Clearings / sec'. Sitecore has no necessary permissions for reading/creating counters
ManagedPoolThread #5 14:54:13 WARN  Failed to create counter 'Sitecore.Caching\Data Cache Hits / sec'. Sitecore has no necessary permissions for reading/creating counters
ManagedPoolThread #4 14:54:13 WARN  Failed to create counter 'Sitecore.Caching\Data Cache Misses / sec'. Sitecore has no necessary permissions for reading/creating counters
ManagedPoolThread #6 14:54:13 WARN  Failed to create counter 'Sitecore.Caching\Html Cache Clearings / sec'. Sitecore has no necessary permissions for reading/creating counters
ManagedPoolThread #1 14:54:13 WARN  Failed to create counter 'Sitecore.Caching\Html Cache Hits / sec'. Sitecore has no necessary permissions for reading/creating counters
ManagedPoolThread #16 14:54:13 WARN  Failed to create counter 'Sitecore.Caching\Html Cache Misses / sec'. Sitecore has no necessary permissions for reading/creating counters
ManagedPoolThread #9 14:54:13 WARN  Failed to create counter 'Sitecore.Caching\Path Cache Clearings / sec'. Sitecore has no necessary permissions for reading/creating counters
ManagedPoolThread #7 14:54:13 WARN  Failed to create counter 'Sitecore.Caching\Path Cache Hits / sec'. Sitecore has no necessary permissions for reading/creating counters
ManagedPoolThread #19 14:54:13 WARN  Failed to create counter 'Sitecore.Caching\Path Cache Misses / sec'. Sitecore has no necessary permissions for reading/creating counters
ManagedPoolThread #8 14:54:13 WARN  Failed to create counter 'Sitecore.Caching\Registry Cache Clearings / sec'. Sitecore has no necessary permissions for reading/creating counters
ManagedPoolThread #18 14:54:13 WARN  Failed to create counter 'Sitecore.Caching\Registry Cache Hits / sec'. Sitecore has no necessary permissions for reading/creating counters
ManagedPoolThread #17 14:54:13 WARN  Failed to create counter 'Sitecore.Caching\Registry Cache Misses / sec'. Sitecore has no necessary permissions for reading/creating counters
ManagedPoolThread #2 14:54:13 WARN  Failed to create counter 'Sitecore.Caching\View State Cache Clearings / sec'. Sitecore has no necessary permissions for reading/creating counters
ManagedPoolThread #12 14:54:13 WARN  Failed to create counter 'Sitecore.Caching\View State Cache Hits / sec'. Sitecore has no necessary permissions for reading/creating counters
ManagedPoolThread #0 14:54:13 WARN  Failed to create counter 'Sitecore.Caching\View State Cache Misses / sec'. Sitecore has no necessary permissions for reading/creating counters
ManagedPoolThread #10 14:54:13 WARN  Failed to create counter 'Sitecore.Caching\XslCache Clearings / sec'. Sitecore has no necessary permissions for reading/creating counters
ManagedPoolThread #11 14:54:13 WARN  Failed to create counter 'Sitecore.Caching\XslCache Hits / sec'. Sitecore has no necessary permissions for reading/creating counters
ManagedPoolThread #14 14:54:13 WARN  Failed to create counter 'Sitecore.Caching\XslCache Misses / sec'. Sitecore has no necessary permissions for reading/creating counters
7100 14:54:13 INFO  Cache created: 'core[items]' (max size: 50MB, running total: 200MB)
7100 14:54:13 INFO  Cache created: 'core[paths]' (max size: 2MB, running total: 202MB)
7100 14:54:13 INFO  Cache created: 'core[standardValues]' (max size: 2MB, running total: 204MB)
7100 14:54:13 INFO  Cache created: 'core[languageFallback]' (max size: 20MB, running total: 224MB)
7100 14:54:13 INFO  Cache created: 'core[isLanguageFallbackValid]' (max size: 100KB, running total: 225MB)
7100 14:54:13 INFO  Cache created: 'core[itempaths]' (max size: 50MB, running total: 275MB)
7100 14:54:13 INFO  Cache created: 'core[blobIDs]' (max size: 500KB, running total: 275MB)
7100 14:54:13 INFO  Cache created: 'master[data]' (max size: 100MB, running total: 375MB)
7100 14:54:13 INFO  Cache created: 'master[items]' (max size: 50MB, running total: 425MB)
7100 14:54:13 INFO  Cache created: 'master[paths]' (max size: 2MB, running total: 428MB)
7100 14:54:13 INFO  Cache created: 'master[standardValues]' (max size: 2MB, running total: 430MB)
7100 14:54:13 INFO  Cache created: 'master[languageFallback]' (max size: 20MB, running total: 450MB)
7100 14:54:13 INFO  Cache created: 'master[isLanguageFallbackValid]' (max size: 100KB, running total: 450MB)
7100 14:54:13 INFO  Cache created: 'master[itempaths]' (max size: 50MB, running total: 500MB)
7100 14:54:13 INFO  Cache created: 'master[blobIDs]' (max size: 500KB, running total: 501MB)
7100 14:54:13 INFO  Cache created: 'web[data]' (max size: 100MB, running total: 601MB)
7100 14:54:13 INFO  Cache created: 'web[items]' (max size: 50MB, running total: 651MB)
7100 14:54:13 INFO  Cache created: 'web[paths]' (max size: 2MB, running total: 653MB)
7100 14:54:13 INFO  Cache created: 'web[standardValues]' (max size: 2MB, running total: 655MB)
7100 14:54:13 INFO  Cache created: 'web[languageFallback]' (max size: 20MB, running total: 675MB)
7100 14:54:13 INFO  Cache created: 'web[isLanguageFallbackValid]' (max size: 100KB, running total: 676MB)
7100 14:54:13 INFO  Cache created: 'web[itempaths]' (max size: 50MB, running total: 726MB)
7100 14:54:13 INFO  Cache created: 'web[blobIDs]' (max size: 500KB, running total: 726MB)
7100 14:54:13 INFO  Cache created: 'filesystem[data]' (max size: 0 bytes, running total: 726MB)
7100 14:54:13 INFO  Cache created: 'filesystem[items]' (max size: 0 bytes, running total: 726MB)
7100 14:54:13 INFO  Cache created: 'filesystem[paths]' (max size: 0 bytes, running total: 726MB)
7100 14:54:13 INFO  Cache created: 'filesystem[standardValues]' (max size: 0 bytes, running total: 726MB)
7100 14:54:13 INFO  Cache created: 'filesystem[languageFallback]' (max size: 20MB, running total: 746MB)
7100 14:54:13 INFO  Cache created: 'filesystem[isLanguageFallbackValid]' (max size: 100KB, running total: 746MB)
7100 14:54:13 INFO  Cache created: 'filesystem[itempaths]' (max size: 50MB, running total: 796MB)
7100 14:54:13 INFO  Cache created: 'filesystem[blobIDs]' (max size: 500KB, running total: 797MB)
ManagedPoolThread #15 14:54:13 WARN  Failed to create counter 'Sitecore.Data\Data.ItemsAccessed'. Sitecore has no necessary permissions for reading/creating counters
ManagedPoolThread #5 14:54:13 WARN  Failed to create counter 'Sitecore.Data\Data.PhysicalReads'. Sitecore has no necessary permissions for reading/creating counters
ManagedPoolThread #3 14:54:13 WARN  Failed to create counter 'Sitecore.Data\Data.ClientDataReads'. Sitecore has no necessary permissions for reading/creating counters
ManagedPoolThread #15 14:54:13 WARN  Failed to create counter 'Sitecore.Data\Data.PhysicalWrites'. Sitecore has no necessary permissions for reading/creating counters
ManagedPoolThread #6 14:54:13 WARN  Failed to create counter 'Sitecore.Data\StreamSharer.OpenStreams'. Sitecore has no necessary permissions for reading/creating counters
ManagedPoolThread #1 14:54:13 WARN  Failed to create counter 'Sitecore.Data\SqlServerStream.OpenStreams'. Sitecore has no necessary permissions for reading/creating counters
ManagedPoolThread #13 14:54:13 WARN  Failed to create counter 'Sitecore.Data\Data.ClientDataWrites'. Sitecore has no necessary permissions for reading/creating counters
ManagedPoolThread #16 14:54:14 WARN  Failed to create counter 'Sitecore.Data\Data | Client Data Reads / sec'. Sitecore has no necessary permissions for reading/creating counters
ManagedPoolThread #9 14:54:14 WARN  Failed to create counter 'Sitecore.Data\Data | Client Data Writes / sec'. Sitecore has no necessary permissions for reading/creating counters
ManagedPoolThread #16 14:54:14 WARN  Failed to create counter 'Sitecore.Data\Data | Items Accessed / sec'. Sitecore has no necessary permissions for reading/creating counters
ManagedPoolThread #9 14:54:14 WARN  Failed to create counter 'Sitecore.Data\Data | Physical Writes / sec'. Sitecore has no necessary permissions for reading/creating counters
ManagedPoolThread #19 14:54:14 WARN  Failed to create counter 'Sitecore.Data\Data | Physical Reads / sec'. Sitecore has no necessary permissions for reading/creating counters
ManagedPoolThread #9 14:54:14 WARN  Failed to create counter 'Sitecore.Data\Globalization | Translate Failed / sec'. Sitecore has no necessary permissions for reading/creating counters
ManagedPoolThread #19 14:54:14 WARN  Failed to create counter 'Sitecore.Data\Links | Fields Examined / sec'. Sitecore has no necessary permissions for reading/creating counters
ManagedPoolThread #9 14:54:14 WARN  Failed to create counter 'Sitecore.Data\Links | Data Read / sec'. Sitecore has no necessary permissions for reading/creating counters
ManagedPoolThread #10 14:54:14 WARN  Failed to create counter 'Sitecore.Data\SqlServerStream | Open Streams / sec'. Sitecore has no necessary permissions for reading/creating counters
ManagedPoolThread #11 14:54:14 WARN  Failed to create counter 'Sitecore.Data\StreamSharer | Open Streams / sec'. Sitecore has no necessary permissions for reading/creating counters
ManagedPoolThread #19 14:54:14 WARN  Failed to create counter 'Sitecore.Data\Links | Data Updated / sec'. Sitecore has no necessary permissions for reading/creating counters
ManagedPoolThread #4 14:54:14 WARN  Failed to create counter 'Sitecore.Data\Workflow | Security Resolved / sec'. Sitecore has no necessary permissions for reading/creating counters
ManagedPoolThread #3 14:54:14 WARN  Failed to create counter 'Sitecore.Data\Workflow | State Changes / sec'. Sitecore has no necessary permissions for reading/creating counters
ManagedPoolThread #16 14:54:14 WARN  Failed to create counter 'Sitecore.Data\Globalization | Texts Translated / sec'. Sitecore has no necessary permissions for reading/creating counters
ManagedPoolThread #11 14:54:14 WARN  Failed to create counter 'Sitecore.Data\Workflow | Actions Executed / sec'. Sitecore has no necessary permissions for reading/creating counters
ManagedPoolThread #15 14:54:15 INFO  Trying to load XML configuration /App_Config/Security/Domains.config
Heartbeat 14:54:17 INFO  Cache created: 'SqlDataProvider - Property data(core)' (max size: 500KB, running total: 797MB)
Heartbeat 14:54:17 INFO  Cache created: 'SqlDataProvider - Property data(master)' (max size: 500KB, running total: 798MB)
7100 14:54:17 INFO  Cache created: 'SqlDataProvider - Prefetch data(core)' (max size: 50MB, running total: 848MB)
Heartbeat 14:54:17 INFO  Cache created: 'SqlDataProvider - Property data(web)' (max size: 500KB, running total: 848MB)
7100 14:54:17 INFO  Cache created: 'ItemCloningRelations' (max size: 50MB, running total: 898MB)
7100 14:54:17 INFO  Cache created: 'AccessResultCache' (max size: 10MB, running total: 908MB)
ManagedPoolThread #5 14:54:17 WARN  Failed to create counter 'Sitecore.Security\Access Denied / sec'. Sitecore has no necessary permissions for reading/creating counters
ManagedPoolThread #6 14:54:17 WARN  Failed to create counter 'Sitecore.Security\Access Granted / sec'. Sitecore has no necessary permissions for reading/creating counters
ManagedPoolThread #13 14:54:17 WARN  Failed to create counter 'Sitecore.Security\Modify Requests / sec'. Sitecore has no necessary permissions for reading/creating counters
ManagedPoolThread #1 14:54:17 WARN  Failed to create counter 'Sitecore.Security\Access Resolved / sec'. Sitecore has no necessary permissions for reading/creating counters
ManagedPoolThread #8 14:54:17 WARN  Failed to create counter 'Sitecore.Security\Programmatic Enabling / sec'. Sitecore has no necessary permissions for reading/creating counters
ManagedPoolThread #7 14:54:17 WARN  Failed to create counter 'Sitecore.Security\Programmatic Disabling / sec'. Sitecore has no necessary permissions for reading/creating counters
ManagedPoolThread #8 14:54:17 WARN  Failed to create counter 'Sitecore.Security\Programmatic User Switch / sec'. Sitecore has no necessary permissions for reading/creating counters
ManagedPoolThread #17 14:54:17 WARN  Failed to create counter 'Sitecore.Security\Read Requests / sec'. Sitecore has no necessary permissions for reading/creating counters
ManagedPoolThread #2 14:54:17 WARN  Failed to create counter 'Sitecore.Security\Virtual Users Built / sec'. Sitecore has no necessary permissions for reading/creating counters
7100 14:54:17 INFO  Cache created: 'ProxyProvider' (max size: 500KB, running total: 909MB)
7100 14:54:17 INFO  Loading Dictionary from cache
7100 14:54:17 INFO  MemoryMonitor initialized. Threshold: 2 GB. Interval: 00:00:05
7100 14:54:17 INFO  [Analytics]: Started background service for 'maintenanceService'.
7100 14:54:17 INFO  Cache created: 'taxonomy.campaigngroups' (max size: 20MB, running total: 929MB)
7100 14:54:17 INFO  Cache created: 'taxonomy.channels' (max size: 20MB, running total: 949MB)
7100 14:54:17 INFO  Cache created: 'taxonomy.venues' (max size: 20MB, running total: 969MB)
7100 14:54:17 INFO  Cache created: 'taxonomy.assets' (max size: 20MB, running total: 989MB)
7100 14:54:17 INFO  Cache created: 'taxonomy.outcomeGroups' (max size: 20MB, running total: 1009MB)
7100 14:54:17 INFO  [Analytics]: Started background service for 'aggregation/aggregator'.
7100 14:54:17 INFO  [Analytics]: Started background service for 'aggregation/contactProcessing'.
7100 14:54:17 INFO  [Analytics]: Started background service for 'aggregation/cleanup'.
7100 14:54:17 INFO  [Analytics]: Started background service for 'aggregation/recovery'.
7100 14:54:17 INFO  [Analytics]: Started background service for 'aggregation/rebuildAgent'.
7100 14:54:17 INFO  [Analytics]: Started background service for 'aggregation/historyWorker'.
7100 14:54:17 INFO  [Analytics]: Started background service for 'aggregation/historyCompletionCheck'.
7100 14:54:17 INFO  [Analytics]: Started background service for 'aggregation/automationAggregator'.
7100 14:54:17 INFO  [Analytics]: Started background service for 'aggregation/automationRangeManager'.
7100 14:54:17 INFO  [Analytics]: Started background service for 'aggregation/automationCleanupService'.
7100 14:54:17 INFO  [Analytics]: Automation aggregation SubsystemLoader hook initialized.
7100 14:54:17 INFO  [Analytics]: Started background service for 'processing/taskAgent'.
7100 14:54:17 INFO  Cache created: 'rules' (max size: 800KB, running total: 1009MB)
7100 14:54:17 INFO  Cache created: '[FieldReaderCache]' (max size: 5MB, running total: 1014MB)
7100 14:54:18 INFO  [Analytics]: Started background service for 'pathAnalyzer/newMapAgent'.
7100 14:54:18 INFO  [Analytics]: Started background service for 'pathAnalyzer/smartMergeAgent'.
7100 14:54:18 INFO  [Analytics]: Started background service for 'aggregation/pathAnalyzerLiveAgent'.
7100 14:54:18 INFO  [Analytics]: Started background service for 'aggregation/pathAnalyzerHistoryAgent'.
7100 14:54:18 INFO  [Analytics]: Started background service for 'pathAnalyzer/trailCleanupAgent'.
7100 14:54:18 INFO  [Analytics]: Started background service for 'pathAnalyzer/mapRebuildStatusCheckerAgent'.
7100 14:54:18 INFO  [Path Analyzer](.) Path Analyzer subsystem hook initialized.
7100 14:54:18 INFO  [Analytics]: Started background service for 'experienceAnalytics/reduce/agent'.
7100 14:54:18 INFO  [Experience Analytics]: ExperienceAnalytics reduce subsystem initialized.
7100 14:54:18 INFO  Scheduler - Initializing
7100 14:54:18 INFO  Cache created: 'UserProfileCache' (max size: 5MB, running total: 1019MB)
7100 14:54:18 INFO  Cache created: 'clientData' (max size: 25MB, running total: 1044MB)
7100 14:54:18 INFO  Scheduler - Interval set to: 00:00:05
7100 14:54:18 INFO  Scheduler - Worker thread started
7100 14:54:18 ERROR WebDAV License file 'D:\projects\GatherContent\Sitecore\Website\data\webdav.lic' not found.
ManagedPoolThread #4 14:54:19 WARN  Failed to create counter 'Sitecore.Automation\State Transitions / sec'. Sitecore has no necessary permissions for reading/creating counters
ManagedPoolThread #3 14:54:19 WARN  Failed to create counter 'Sitecore.Automation\State Evaluations - Total / sec'. Sitecore has no necessary permissions for reading/creating counters
ManagedPoolThread #16 14:54:19 WARN  Failed to create counter 'Sitecore.Automation\State Evaluations - Page Events / sec'. Sitecore has no necessary permissions for reading/creating counters
ManagedPoolThread #11 14:54:19 WARN  Failed to create counter 'Sitecore.Automation\State Evaluations - Timeouts / sec'. Sitecore has no necessary permissions for reading/creating counters
ManagedPoolThread #15 14:54:19 WARN  Failed to create counter 'Sitecore.Automation\Emails Sent / sec'. Sitecore has no necessary permissions for reading/creating counters
ManagedPoolThread #5 14:54:19 WARN  Failed to create counter 'Sitecore.Automation\Average Evaluation Time'. Sitecore has no necessary permissions for reading/creating counters
ManagedPoolThread #6 14:54:19 WARN  Failed to create counter 'Sitecore.Automation\Average Evaluation Time Average Base'. Sitecore has no necessary permissions for reading/creating counters
ManagedPoolThread #13 14:54:19 WARN  Failed to create counter 'Sitecore.Automation\Average State Load Time - Contact'. Sitecore has no necessary permissions for reading/creating counters
ManagedPoolThread #1 14:54:19 WARN  Failed to create counter 'Sitecore.Automation\Average State Load Time - Contact Average Base'. Sitecore has no necessary permissions for reading/creating counters
ManagedPoolThread #18 14:54:19 WARN  Failed to create counter 'Sitecore.Automation\Monitor - Average Time to Load Data - ms'. Sitecore has no necessary permissions for reading/creating counters
ManagedPoolThread #8 14:54:19 WARN  Failed to create counter 'Sitecore.Automation\Aggregation | Automation Transitions Aggregated / sec'. Sitecore has no necessary permissions for reading/creating counters
ManagedPoolThread #7 14:54:19 WARN  Failed to create counter 'Sitecore.Automation\Monitor - Average Time to Load Data - ms Average Base'. Sitecore has no necessary permissions for reading/creating counters
ManagedPoolThread #2 14:54:19 WARN  Failed to create counter 'Sitecore.Automation\Aggregation | Transition Aggregation Errors / sec'. Sitecore has no necessary permissions for reading/creating counters
ManagedPoolThread #17 14:54:19 WARN  Failed to create counter 'Sitecore.Automation\Aggregation | Contact States Aggregated / sec'. Sitecore has no necessary permissions for reading/creating counters
ManagedPoolThread #4 14:54:19 WARN  Failed to create counter 'Sitecore.Automation\Aggregation | Contact State Aggregation Errors / sec'. Sitecore has no necessary permissions for reading/creating counters
ManagedPoolThread #16 14:54:19 WARN  Failed to create counter 'Sitecore.Automation\Aggregation | Average Automation Aggregation Pipeline Time / sec Average Base'. Sitecore has no necessary permissions for reading/creating counters
ManagedPoolThread #15 14:54:19 WARN  Failed to create counter 'Sitecore.Automation\Aggregation | Average Transition Store In Reporting / sec Average Base'. Sitecore has no necessary permissions for reading/creating counters
ManagedPoolThread #3 14:54:19 WARN  Failed to create counter 'Sitecore.Automation\Aggregation | Average Automation Aggregation Pipeline Time / sec'. Sitecore has no necessary permissions for reading/creating counters
ManagedPoolThread #6 14:54:19 WARN  Failed to create counter 'Sitecore.Automation\Aggregation | Average Contact States Store In Reporting / sec Average Base'. Sitecore has no necessary permissions for reading/creating counters
ManagedPoolThread #5 14:54:19 WARN  Failed to create counter 'Sitecore.Automation\Aggregation | Average Contact States Store In Reporting / sec'. Sitecore has no necessary permissions for reading/creating counters
ManagedPoolThread #1 14:54:19 WARN  Failed to create counter 'Sitecore.Automation\Data | Average Delete Aggregated Transitions Time / sec Average Base'. Sitecore has no necessary permissions for reading/creating counters
ManagedPoolThread #13 14:54:19 WARN  Failed to create counter 'Sitecore.Automation\Data | Average Delete Aggregated Transitions Time / sec'. Sitecore has no necessary permissions for reading/creating counters
ManagedPoolThread #8 14:54:19 WARN  Failed to create counter 'Sitecore.Automation\Data | Average Merge Transition Time/ sec Average Base'. Sitecore has no necessary permissions for reading/creating counters
ManagedPoolThread #18 14:54:19 WARN  Failed to create counter 'Sitecore.Automation\Data | Average Merge Transition Time/ sec'. Sitecore has no necessary permissions for reading/creating counters
7100 14:54:19 INFO  Sitecore.Analytics.Automation.Diagnostics.PerformanceCounters are initialized
ManagedPoolThread #11 14:54:19 WARN  Failed to create counter 'Sitecore.Automation\Aggregation | Average Transition Store In Reporting / sec'. Sitecore has no necessary permissions for reading/creating counters
ManagedPoolThread #7 14:54:19 WARN  Failed to create counter 'Sitecore.Analytics.Tracking\Collection | Total Requests / sec'. Sitecore has no necessary permissions for reading/creating counters
ManagedPoolThread #2 14:54:19 WARN  Failed to create counter 'Sitecore.Analytics.Tracking\Collection | Requests Tracked / sec'. Sitecore has no necessary permissions for reading/creating counters
ManagedPoolThread #17 14:54:19 WARN  Failed to create counter 'Sitecore.Analytics.Tracking\Collection | Requests Ignored / sec'. Sitecore has no necessary permissions for reading/creating counters
ManagedPoolThread #4 14:54:19 WARN  Failed to create counter 'Sitecore.Analytics.Tracking\Collection | Malicious Robot Requests / sec'. Sitecore has no necessary permissions for reading/creating counters
ManagedPoolThread #16 14:54:19 WARN  Failed to create counter 'Sitecore.Analytics.Tracking\Collection | Robot Requests / sec'. Sitecore has no necessary permissions for reading/creating counters
ManagedPoolThread #15 14:54:19 WARN  Failed to create counter 'Sitecore.Analytics.Tracking\Collection | Human Requests / sec'. Sitecore has no necessary permissions for reading/creating counters
ManagedPoolThread #3 14:54:19 WARN  Failed to create counter 'Sitecore.Analytics.Tracking\Collection | Total Visits / sec'. Sitecore has no necessary permissions for reading/creating counters
ManagedPoolThread #6 14:54:19 WARN  Failed to create counter 'Sitecore.Analytics.Tracking\Collection | Unique Visitors / sec'. Sitecore has no necessary permissions for reading/creating counters
ManagedPoolThread #5 14:54:19 WARN  Failed to create counter 'Sitecore.Analytics.Tracking\Data | Dictionaries - Locations Reads / sec'. Sitecore has no necessary permissions for reading/creating counters
ManagedPoolThread #1 14:54:19 WARN  Failed to create counter 'Sitecore.Analytics.Tracking\Data | Dictionaries - Locations Cache Hits / sec'. Sitecore has no necessary permissions for reading/creating counters
ManagedPoolThread #13 14:54:19 WARN  Failed to create counter 'Sitecore.Analytics.Tracking\Data | Dictionaries - Locations Database Reads / sec'. Sitecore has no necessary permissions for reading/creating counters
ManagedPoolThread #8 14:54:19 WARN  Failed to create counter 'Sitecore.Analytics.Tracking\Data | Dictionaries - Locations Writes / sec'. Sitecore has no necessary permissions for reading/creating counters
ManagedPoolThread #18 14:54:19 WARN  Failed to create counter 'Sitecore.Analytics.Tracking\Data | Dictionaries - ReferringSites Reads / sec'. Sitecore has no necessary permissions for reading/creating counters
ManagedPoolThread #11 14:54:19 WARN  Failed to create counter 'Sitecore.Analytics.Tracking\Data | Dictionaries - ReferringSites Cache Hits / sec'. Sitecore has no necessary permissions for reading/creating counters
ManagedPoolThread #7 14:54:19 WARN  Failed to create counter 'Sitecore.Analytics.Tracking\Data | Dictionaries - ReferringSites Database Reads / sec'. Sitecore has no necessary permissions for reading/creating counters
ManagedPoolThread #2 14:54:19 WARN  Failed to create counter 'Sitecore.Analytics.Tracking\Data | Dictionaries - ReferringSites Writes / sec'. Sitecore has no necessary permissions for reading/creating counters
ManagedPoolThread #17 14:54:19 WARN  Failed to create counter 'Sitecore.Analytics.Tracking\Data | Dictionaries - UserAgents Reads / sec'. Sitecore has no necessary permissions for reading/creating counters
ManagedPoolThread #4 14:54:19 WARN  Failed to create counter 'Sitecore.Analytics.Tracking\Data | Dictionaries - UserAgents Cache Hits / sec'. Sitecore has no necessary permissions for reading/creating counters
ManagedPoolThread #16 14:54:19 WARN  Failed to create counter 'Sitecore.Analytics.Tracking\Data | Dictionaries - UserAgents Database Reads / sec'. Sitecore has no necessary permissions for reading/creating counters
ManagedPoolThread #15 14:54:19 WARN  Failed to create counter 'Sitecore.Analytics.Tracking\Data | Dictionaries - UserAgents Writes / sec'. Sitecore has no necessary permissions for reading/creating counters
ManagedPoolThread #3 14:54:19 WARN  Failed to create counter 'Sitecore.Analytics.Tracking\Data | Dictionaries - GeoIps Reads / sec'. Sitecore has no necessary permissions for reading/creating counters
ManagedPoolThread #6 14:54:19 WARN  Failed to create counter 'Sitecore.Analytics.Tracking\Data | Dictionaries - GeoIps Cache Hits / sec'. Sitecore has no necessary permissions for reading/creating counters
ManagedPoolThread #5 14:54:19 WARN  Failed to create counter 'Sitecore.Analytics.Tracking\Data | Dictionaries - GeoIps Database Reads / sec'. Sitecore has no necessary permissions for reading/creating counters
ManagedPoolThread #1 14:54:19 WARN  Failed to create counter 'Sitecore.Analytics.Tracking\Data | Dictionaries - GeoIps Writes / sec'. Sitecore has no necessary permissions for reading/creating counters
ManagedPoolThread #13 14:54:19 WARN  Failed to create counter 'Sitecore.Analytics.Tracking\GeoIP | Requests - Total / sec'. Sitecore has no necessary permissions for reading/creating counters
ManagedPoolThread #8 14:54:19 WARN  Failed to create counter 'Sitecore.Analytics.Tracking\GeoIP | Requests - Pages / sec'. Sitecore has no necessary permissions for reading/creating counters
ManagedPoolThread #18 14:54:19 WARN  Failed to create counter 'Sitecore.Analytics.Tracking\GeoIP | Requests - Background / sec'. Sitecore has no necessary permissions for reading/creating counters
ManagedPoolThread #11 14:54:19 WARN  Failed to create counter 'Sitecore.Analytics.Tracking\GeoIP | Memory Lookups / sec'. Sitecore has no necessary permissions for reading/creating counters
ManagedPoolThread #7 14:54:19 WARN  Failed to create counter 'Sitecore.Analytics.Tracking\GeoIP | Database Lookups / sec'. Sitecore has no necessary permissions for reading/creating counters
ManagedPoolThread #2 14:54:19 WARN  Failed to create counter 'Sitecore.Analytics.Tracking\GeoIP | Provider Lookups / sec'. Sitecore has no necessary permissions for reading/creating counters
ManagedPoolThread #17 14:54:19 WARN  Failed to create counter 'Sitecore.Analytics.Tracking\GeoIP | Failed Lookups / sec'. Sitecore has no necessary permissions for reading/creating counters
ManagedPoolThread #4 14:54:19 WARN  Failed to create counter 'Sitecore.Analytics.Tracking\GeoIP | Unknown IPs / sec'. Sitecore has no necessary permissions for reading/creating counters
ManagedPoolThread #16 14:54:19 WARN  Failed to create counter 'Sitecore.Analytics.Tracking\GeoIP | Average Resolve Time'. Sitecore has no necessary permissions for reading/creating counters
ManagedPoolThread #15 14:54:19 WARN  Failed to create counter 'Sitecore.Analytics.Tracking\GeoIP | Average Resolve Time Average Base'. Sitecore has no necessary permissions for reading/creating counters
ManagedPoolThread #3 14:54:19 WARN  Failed to create counter 'Sitecore.Analytics.Tracking\GeoIP | Cache Size'. Sitecore has no necessary permissions for reading/creating counters
ManagedPoolThread #6 14:54:19 WARN  Failed to create counter 'Sitecore.Analytics.Tracking\GeoIP | Visits Updated / sec'. Sitecore has no necessary permissions for reading/creating counters
ManagedPoolThread #1 14:54:19 WARN  Failed to create counter 'Sitecore.Analytics.Tracking\GeoIP | Average Calls Before IP Resolved'. Sitecore has no necessary permissions for reading/creating counters
7100 14:54:19 INFO  Sitecore.Analytics.Tracking.Diagnostics.PerformanceCounters are initialized
ManagedPoolThread #5 14:54:19 WARN  Failed to create counter 'Sitecore.Analytics.Tracking\GeoIP | Average Calls Before IP Resolved Average Base'. Sitecore has no necessary permissions for reading/creating counters
ManagedPoolThread #13 14:54:19 WARN  Failed to create counter 'Sitecore.Analytics\Data | Rows Saved - Total / sec'. Sitecore has no necessary permissions for reading/creating counters
ManagedPoolThread #8 14:54:19 WARN  Failed to create counter 'Sitecore.Analytics\Data | Rows Saved - Bulk Copy / sec'. Sitecore has no necessary permissions for reading/creating counters
ManagedPoolThread #13 14:54:19 WARN  Failed to create counter 'Sitecore.Analytics\Data | Rows Saved - Batch / sec'. Sitecore has no necessary permissions for reading/creating counters
ManagedPoolThread #8 14:54:19 WARN  Failed to create counter 'Sitecore.Analytics\Data | Rows Saved - Row By Row / sec'. Sitecore has no necessary permissions for reading/creating counters
ManagedPoolThread #7 14:54:19 WARN  Failed to create counter 'Sitecore.Analytics\Data | Rows Failed to Save / sec'. Sitecore has no necessary permissions for reading/creating counters
ManagedPoolThread #2 14:54:19 WARN  Failed to create counter 'Sitecore.Analytics\Data | Commit Queue Length'. Sitecore has no necessary permissions for reading/creating counters
ManagedPoolThread #17 14:54:19 WARN  Failed to create counter 'Sitecore.Analytics\Data | Commit Queue Flush Length'. Sitecore has no necessary permissions for reading/creating counters
ManagedPoolThread #4 14:54:19 WARN  Failed to create counter 'Sitecore.Analytics\Data | Tracker Flushes - Total / sec'. Sitecore has no necessary permissions for reading/creating counters
ManagedPoolThread #16 14:54:19 WARN  Failed to create counter 'Sitecore.Analytics\Data | Tracker Flushes - Explicit / sec'. Sitecore has no necessary permissions for reading/creating counters
ManagedPoolThread #15 14:54:19 WARN  Failed to create counter 'Sitecore.Analytics\Data | Tracker Flushes - Inline / sec'. Sitecore has no necessary permissions for reading/creating counters
ManagedPoolThread #3 14:54:19 WARN  Failed to create counter 'Sitecore.Analytics\Data | Tracker Flushes - Timeout / sec'. Sitecore has no necessary permissions for reading/creating counters
ManagedPoolThread #6 14:54:19 WARN  Failed to create counter 'Sitecore.Analytics\Data | Tracker Flushes - Capacity Overflow'. Sitecore has no necessary permissions for reading/creating counters
ManagedPoolThread #5 14:54:19 WARN  Failed to create counter 'Sitecore.Analytics\Data | Average Tracker Flush Time Average Base'. Sitecore has no necessary permissions for reading/creating counters
ManagedPoolThread #18 14:54:19 WARN  Failed to create counter 'Sitecore.Analytics\Data | Last Tracker Flush Time'. Sitecore has no necessary permissions for reading/creating counters
ManagedPoolThread #1 14:54:19 WARN  Failed to create counter 'Sitecore.Analytics\Data | Average Tracker Flush Time'. Sitecore has no necessary permissions for reading/creating counters
ManagedPoolThread #11 14:54:19 WARN  Failed to create counter 'Sitecore.Analytics\Data | Aggregation - Visits saved to reporting database / sec'. Sitecore has no necessary permissions for reading/creating counters
ManagedPoolThread #13 14:54:19 WARN  Failed to create counter 'Sitecore.Analytics\Aggregation | Live Interactions Processed / sec'. Sitecore has no necessary permissions for reading/creating counters
ManagedPoolThread #8 14:54:19 WARN  Failed to create counter 'Sitecore.Analytics\Aggregation | History Interactions Processed / sec'. Sitecore has no necessary permissions for reading/creating counters
ManagedPoolThread #7 14:54:19 WARN  Failed to create counter 'Sitecore.Analytics\Aggregation | Total Interactions Processed / sec'. Sitecore has no necessary permissions for reading/creating counters
ManagedPoolThread #2 14:54:19 WARN  Failed to create counter 'Sitecore.Analytics\Aggregation | Live Aggregation Errors / sec'. Sitecore has no necessary permissions for reading/creating counters
ManagedPoolThread #17 14:54:19 WARN  Failed to create counter 'Sitecore.Analytics\Aggregation | History Aggregation Errors / sec'. Sitecore has no necessary permissions for reading/creating counters
ManagedPoolThread #17 14:54:19 WARN  Failed to create counter 'Sitecore.Analytics\Aggregation | Total Aggregation Errors / sec'. Sitecore has no necessary permissions for reading/creating counters
ManagedPoolThread #16 14:54:19 WARN  Failed to create counter 'Sitecore.Analytics\Aggregation | Contacts Processed / sec'. Sitecore has no necessary permissions for reading/creating counters
ManagedPoolThread #15 14:54:19 WARN  Failed to create counter 'Sitecore.Analytics\Aggregation | Contact Processing Errors / sec'. Sitecore has no necessary permissions for reading/creating counters
ManagedPoolThread #3 14:54:19 WARN  Failed to create counter 'Sitecore.Analytics\Aggregation | Average Batch Size - Live'. Sitecore has no necessary permissions for reading/creating counters
ManagedPoolThread #6 14:54:19 WARN  Failed to create counter 'Sitecore.Analytics\Aggregation | Average Batch Size - Live Average Base'. Sitecore has no necessary permissions for reading/creating counters
ManagedPoolThread #5 14:54:19 WARN  Failed to create counter 'Sitecore.Analytics\Aggregation | Average Batch Size - History'. Sitecore has no necessary permissions for reading/creating counters
ManagedPoolThread #18 14:54:19 WARN  Failed to create counter 'Sitecore.Analytics\Aggregation | Average Batch Size - History Average Base'. Sitecore has no necessary permissions for reading/creating counters
ManagedPoolThread #1 14:54:19 WARN  Failed to create counter 'Sitecore.Analytics\Aggregation | Number of Batches Containing Failing Items - Live'. Sitecore has no necessary permissions for reading/creating counters
ManagedPoolThread #11 14:54:19 WARN  Failed to create counter 'Sitecore.Analytics\Aggregation | Number of Batches Containing Failing Items - History'. Sitecore has no necessary permissions for reading/creating counters
ManagedPoolThread #13 14:54:19 WARN  Failed to create counter 'Sitecore.Analytics\Aggregation | Average Aggregation Pipeline Time (ms)'. Sitecore has no necessary permissions for reading/creating counters
ManagedPoolThread #8 14:54:19 WARN  Failed to create counter 'Sitecore.Analytics\Aggregation | Average Aggregation Pipeline Time (ms) Average Base'. Sitecore has no necessary permissions for reading/creating counters
ManagedPoolThread #7 14:54:19 WARN  Failed to create counter 'Sitecore.Analytics\Aggregation | Average Write Time (ms)'. Sitecore has no necessary permissions for reading/creating counters
ManagedPoolThread #2 14:54:19 WARN  Failed to create counter 'Sitecore.Analytics\Aggregation | Average Write Time (ms) Average Base'. Sitecore has no necessary permissions for reading/creating counters
ManagedPoolThread #4 14:54:19 WARN  Failed to create counter 'Sitecore.Analytics\Aggregation | Average Contact Processing Pipeline Time (ms)'. Sitecore has no necessary permissions for reading/creating counters
ManagedPoolThread #17 14:54:19 WARN  Failed to create counter 'Sitecore.Analytics\Aggregation | Average Contact Processing Pipeline Time (ms) Average Base'. Sitecore has no necessary permissions for reading/creating counters
ManagedPoolThread #16 14:54:19 WARN  Failed to create counter 'Sitecore.Analytics\Aggregation | Average Write Time - Primary (ms)'. Sitecore has no necessary permissions for reading/creating counters
ManagedPoolThread #15 14:54:19 WARN  Failed to create counter 'Sitecore.Analytics\Aggregation | Average Write Time - Primary (ms) Average Base'. Sitecore has no necessary permissions for reading/creating counters
ManagedPoolThread #6 14:54:19 WARN  Failed to create counter 'Sitecore.Analytics\Aggregation | Average Write Time - Secondary, Live (ms) Average Base'. Sitecore has no necessary permissions for reading/creating counters
ManagedPoolThread #3 14:54:19 WARN  Failed to create counter 'Sitecore.Analytics\Aggregation | Average Write Time - Secondary, Live (ms)'. Sitecore has no necessary permissions for reading/creating counters
ManagedPoolThread #18 14:54:19 WARN  Failed to create counter 'Sitecore.Analytics\Aggregation | Average Write Time - Secondary, History (ms) Average Base'. Sitecore has no necessary permissions for reading/creating counters
ManagedPoolThread #5 14:54:19 WARN  Failed to create counter 'Sitecore.Analytics\Aggregation | Average Write Time - Secondary, History (ms)'. Sitecore has no necessary permissions for reading/creating counters
ManagedPoolThread #1 14:54:19 WARN  Failed to create counter 'Sitecore.Analytics\Aggregation | Active Interaction Aggregators'. Sitecore has no necessary permissions for reading/creating counters
ManagedPoolThread #13 14:54:19 WARN  Failed to create counter 'Sitecore.Analytics\Aggregation | Average Check Out Time - Live (ms) Average Base'. Sitecore has no necessary permissions for reading/creating counters
ManagedPoolThread #8 14:54:19 WARN  Failed to create counter 'Sitecore.Analytics\Aggregation | Average Check In Time - Live (ms)'. Sitecore has no necessary permissions for reading/creating counters
ManagedPoolThread #7 14:54:19 WARN  Failed to create counter 'Sitecore.Analytics\Aggregation | Average Check In Time - Live (ms) Average Base'. Sitecore has no necessary permissions for reading/creating counters
ManagedPoolThread #4 14:54:19 WARN  Failed to create counter 'Sitecore.Analytics\Aggregation | Average Check Out Time - History (ms) Average Base'. Sitecore has no necessary permissions for reading/creating counters
ManagedPoolThread #2 14:54:19 WARN  Failed to create counter 'Sitecore.Analytics\Aggregation | Average Check Out Time - History (ms)'. Sitecore has no necessary permissions for reading/creating counters
ManagedPoolThread #17 14:54:19 WARN  Failed to create counter 'Sitecore.Analytics\Aggregation | Average Check In Time - History (ms)'. Sitecore has no necessary permissions for reading/creating counters
ManagedPoolThread #16 14:54:19 WARN  Failed to create counter 'Sitecore.Analytics\Aggregation | Average Check In Time - History (ms) Average Base'. Sitecore has no necessary permissions for reading/creating counters
ManagedPoolThread #11 14:54:19 WARN  Failed to create counter 'Sitecore.Analytics\Aggregation | Average Check Out Time - Live (ms)'. Sitecore has no necessary permissions for reading/creating counters
7100 14:54:19 INFO  Sitecore.Analytics.Diagnostics.PerformanceCounters are initialized
7100 14:54:19 INFO  DumpConfigurationFiles: Started
6592 14:54:19 INFO  DumpConfigurationFiles: Dump folder is D:\projects\GatherContent\Sitecore\Website\data\diagnostics\configuration_history\20151112Z.115419Z
7100 14:54:20 INFO  Sitecore.Social: The Social MVC area is registered.
6592 14:54:20 INFO  DumpConfigurationFiles: D:\projects\GatherContent\Sitecore\Website\App_Config has been dumped
6592 14:54:20 INFO  DumpConfigurationFiles: D:\projects\GatherContent\Sitecore\Website\Web.config has been dumped
6592 14:54:20 INFO  DumpConfigurationFiles: D:\projects\GatherContent\Sitecore\Website\Global.asax has been dumped
6592 14:54:20 INFO  DumpConfigurationFiles: D:\projects\GatherContent\Sitecore\Website\sitecore\shell\sitecore.version.xml has been dumped
6592 14:54:20 INFO  DumpConfigurationFiles: Zipping of the dumped configuration files is enabled
ManagedPoolThread #12 14:54:20 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
6592 14:54:20 INFO  DumpConfigurationFiles: D:\projects\GatherContent\Sitecore\Website\data\diagnostics\configuration_history\20151112Z.115419Z.zip has been created
6592 14:54:20 INFO  DumpConfigurationFiles: D:\projects\GatherContent\Sitecore\Website\data\diagnostics\configuration_history\20151112Z.115419Z has been removed
6592 14:54:20 INFO  DumpConfigurationFiles: Completed
ManagedPoolThread #19 14:54:21 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
7100 14:54:21 INFO  [Sitecore Mvc]: Registered area : AppCenter
7100 14:54:21 INFO  Filter (Sitecore.Services.Infrastructure.Web.Http.Filters.AnonymousUserFilter) instance created
7100 14:54:21 INFO  Filter (Sitecore.Services.Infrastructure.Web.Http.Filters.LoggingExceptionFilter) instance created
7100 14:54:21 INFO  Filter (Sitecore.Services.Infrastructure.Web.Http.Filters.SecurityPolicyAuthorisationFilter) instance created
7100 14:54:21 INFO  [Path Analyzer](ApplicationContainer.RegisterType) Sitecore.SequenceAnalyzer.Data.ITreeStorage
7100 14:54:21 INFO  [Path Analyzer](ApplicationContainer.RegisterType) Sitecore.PathAnalyzer.Data.Storage.ITreeDefinitionStorage
7100 14:54:21 INFO  [Path Analyzer](ApplicationContainer.RegisterType) Sitecore.PathAnalyzer.Contracts.ITreeDefinitionService
7100 14:54:21 INFO  [Path Analyzer](ApplicationContainer.RegisterType) Sitecore.PathAnalyzer.Contracts.IMapItemRepository
7100 14:54:21 INFO  [Path Analyzer](ApplicationContainer.RegisterType) Sitecore.PathAnalyzer.Contracts.IMapStatusService
7100 14:54:21 INFO  [Path Analyzer](ApplicationContainer.RegisterType) Sitecore.PathAnalyzer.Contracts.IConfiguration
7100 14:54:21 INFO  [Path Analyzer](ApplicationContainer.RegisterType) Sitecore.SequenceAnalyzer.Configuration.IPruningConfig
7100 14:54:21 INFO  [Path Analyzer](ApplicationContainer.RegisterType) Sitecore.PathAnalyzer.Contracts.IContactReader
7100 14:54:21 INFO  [Path Analyzer](ApplicationContainer.RegisterType) Sitecore.PathAnalyzer.Contracts.IWebRequestFactory
7100 14:54:21 WARN  [Path Analyzer](ApplicationContainer.RegisterType) Failed for Sitecore.PathAnalyzer.Contracts.IWebRequestFactory. Config entry pathAnalyzer/webRequestFactory doesn't exist
7100 14:54:21 INFO  [Path Analyzer](ApplicationContainer.RegisterType) Sitecore.PathAnalyzer.Localization.IResourceManager
7100 14:54:21 INFO  [Path Analyzer](ApplicationContainer.RegisterType) Sitecore.PathAnalyzer.Data.Caching.ITreeCache
7100 14:54:21 INFO  [Path Analyzer](ApplicationContainer.RegisterType) Sitecore.PathAnalyzer.Contracts.ITreeProvider
7100 14:54:21 INFO  [Path Analyzer](ApplicationContainer.RegisterType) Sitecore.PathAnalyzer.Data.SitecoreData.IItemRepository
7100 14:54:21 INFO  [Path Analyzer](ApplicationContainer.RegisterType) Sitecore.PathAnalyzer.Contracts.IMapItemDeploymentManager
7100 14:54:21 INFO  [Path Analyzer](ApplicationContainer.RegisterType) Sitecore.PathAnalyzer.Data.Storage.ITreeStorageManager
7100 14:54:21 INFO  [Path Analyzer](ApplicationContainer.RegisterModelsForSerialization) Setting serialization info
7100 14:54:21 INFO  [Path Analyzer](ApplicationContainer.RegisterModelsForSerialization) Type 'Sitecore.PathAnalyzer.Data.Models.ExperienceNode, Sitecore.PathAnalyzer' was registered succesfully.
7100 14:54:21 INFO  [Path Analyzer](ApplicationContainer.RegisterModelsForSerialization) Type 'Sitecore.PathAnalyzer.Data.Models.ExperienceTree, Sitecore.PathAnalyzer' was registered succesfully.
7100 14:54:21 INFO  [Path Analyzer](ApplicationContainer.RegisterModelsForSerialization) Type 'Sitecore.PathAnalyzer.Data.Models.PageNode, Sitecore.PathAnalyzer' was registered succesfully.
7100 14:54:21 INFO  [Experience Analytics]: ExperienceAnalytics SyncSegmentsProcessor
5392 14:54:21 INFO  [Experience Analytics]: Segment Deploy started.
6652 14:54:21 INFO  Precompiling SPEAK Views: 60
6652 14:54:21 INFO  Precompiling SPEAK View: ~\sitecore\shell\client\Applications\ContentTesting\Components\Behaviours\MultiSelectListExtended.cshtml
7100 14:54:21 INFO  [Experience Analytics]: WebApiInitializer
7100 14:54:22 INFO  [Experience Analytics]: Filter (Sitecore.ExperienceAnalytics.Api.Http.Filters.CacheHeaderFilterAttribute) added
3440 14:54:22 INFO  Precompiling SPEAK Views: 188
3440 14:54:22 INFO  Precompiling SPEAK View: ~\sitecore\shell\client\Business Component Library\Layouts\Renderings\Authentications\AccountInformation\AccountInformation.cshtml
7100 14:54:22 INFO  Sitecore.Social: The Social remote events are initialized.
2976 14:54:22 INFO  HttpModule is being initialized
ManagedPoolThread #0 14:54:22 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
2976 14:54:22 INFO  Cache created: 'SqlDataProvider - Prefetch data(web)' (max size: 50MB, running total: 1094MB)
2976 14:54:22 INFO  Cache created: 'shell[html]' (max size: 0 bytes, running total: 1094MB)
ManagedPoolThread #14 14:54:23 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
5392 14:54:23 INFO  Cache created: 'SqlDataProvider - Prefetch data(master)' (max size: 100MB, running total: 1194MB)
6352 14:54:23 INFO  Scheduler - Adding agents
6352 14:54:23 INFO  Scheduler - Adding agent: Sitecore.Tasks.UrlAgent (interval: 00:15:00)
6352 14:54:23 INFO  Scheduler - Adding agent: Sitecore.Tasks.TaskDatabaseAgent (interval: 00:10:00)
6352 14:54:23 INFO  Scheduler - Adding agent: Sitecore.Tasks.CompactClientDataAgent (interval: 04:00:00)
6352 14:54:23 INFO  Scheduler - Adding agent: Sitecore.Tasks.CleanupHistory (interval: 04:00:00)
6352 14:54:23 INFO  Scheduler - Adding agent: Sitecore.Tasks.CleanupPublishQueue (interval: 04:00:00)
6352 14:54:23 INFO  Scheduler - Adding agent: Sitecore.Tasks.CleanupEventQueue (interval: 04:00:00)
6352 14:54:23 INFO  Scheduler - Skipping inactive agent: Sitecore.Tasks.HtmlCacheClearAgent
6352 14:54:23 INFO  Scheduler - Adding agent: Sitecore.Tasks.CleanupAuthenticationTicketsAgent (interval: 04:00:00)
6352 14:54:23 INFO  Scheduler - Skipping inactive agent: Sitecore.Tasks.PublishAgent
6352 14:54:24 INFO  Scheduler - Adding agent: Sitecore.Tasks.CleanupAgent (interval: 06:00:00)
6352 14:54:24 INFO  Scheduler - Adding agent: Sitecore.Tasks.CounterDumpAgent (interval: 01:00:00)
6352 14:54:24 INFO  Scheduler - Adding agent: Sitecore.Tasks.CloneNotificationsCleanupAgent (interval: 1.00:00:00)
6352 14:54:24 INFO  Scheduler - Adding agent: Sitecore.Analytics.Tasks.EmailReportsTask (interval: 01:00:00)
6352 14:54:24 INFO  Scheduler - Adding agent: Sitecore.ContentSearch.Tasks.Optimize (interval: 12:00:00)
6352 14:54:24 INFO  Scheduler - Adding agent: Core_Database_Agent (interval: 00:10:00)
6352 14:54:24 INFO  Scheduler - Adding agent: Master_Database_Agent (interval: 00:10:00)
6352 14:54:24 INFO  Scheduler - Adding agent: Sitecore.Tasks.CleanupFDAObsoleteMediaData (interval: 1.00:00:00)
6352 14:54:24 INFO  Scheduler - Adding agent: Sitecore.Tasks.WebDAVOptionsCleanupAgent (interval: 1.00:00:00)
6352 14:54:24 INFO  Scheduler - Adding agent: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (interval: 00:00:10)
6352 14:54:24 INFO  Scheduler - Skipping inactive agent: Sitecore.Social.Client.Tasks.ManagePreExpiredAccounts
6352 14:54:24 INFO  Scheduler - Skipping inactive agent: Sitecore.Social.Client.Tasks.SynchronizeSocialMediaInfo
6352 14:54:24 INFO  Scheduler - Adding agent: Sitecore.Social.Client.Tasks.PostFlaggedMessages (interval: 01:00:00)
6352 14:54:24 INFO  Scheduler - Adding agent: Sitecore.Social.Client.Tasks.UpdateMessagesStatistics (interval: 01:00:00)
6352 14:54:24 INFO  Scheduler - Agents added
ManagedPoolThread #9 14:54:24 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
5392 14:54:24 INFO  Cache created: 'IsUserInRoleCache' (max size: 5MB, running total: 1199MB)
5392 14:54:24 INFO  Trying to load XML configuration /App_Config/Security/GlobalRoles.config
5392 14:54:25 INFO  Cache created: 'ReportDataCache' (max size: 50MB, running total: 1249MB)
5392 14:54:25 INFO  Cache created: 'ExperienceAnalytics.Segments' (max size: 20MB, running total: 1269MB)
5392 14:54:25 INFO  [Experience Analytics]: Segment Deploy complete.
ManagedPoolThread #10 14:54:25 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
2976 14:54:25 INFO  Cache created: 'shell[registry]' (max size: 15MB, running total: 1284MB)
2976 14:54:25 INFO  Cache created: 'shell[viewstate]' (max size: 1MB, running total: 1285MB)
2976 14:54:25 INFO  Cache created: 'shell[xsl]' (max size: 25MB, running total: 1310MB)
2976 14:54:25 INFO  Cache created: 'shell[filtered items]' (max size: 10MB, running total: 1320MB)
2976 14:54:25 INFO  Cache created: 'login[html]' (max size: 0 bytes, running total: 1320MB)
2976 14:54:25 INFO  Cache created: 'login[registry]' (max size: 25MB, running total: 1345MB)
2976 14:54:25 INFO  Cache created: 'login[viewstate]' (max size: 25MB, running total: 1370MB)
2976 14:54:25 INFO  Cache created: 'login[xsl]' (max size: 50MB, running total: 1420MB)
2976 14:54:25 INFO  Cache created: 'login[filtered items]' (max size: 10MB, running total: 1430MB)
2976 14:54:25 INFO  Cache created: 'admin[html]' (max size: 0 bytes, running total: 1430MB)
2976 14:54:25 INFO  Cache created: 'admin[registry]' (max size: 25MB, running total: 1455MB)
2976 14:54:25 INFO  Cache created: 'admin[viewstate]' (max size: 25MB, running total: 1480MB)
2976 14:54:25 INFO  Cache created: 'admin[xsl]' (max size: 50MB, running total: 1530MB)
2976 14:54:25 INFO  Cache created: 'admin[filtered items]' (max size: 10MB, running total: 1540MB)
2976 14:54:25 INFO  Cache created: 'service[html]' (max size: 0 bytes, running total: 1540MB)
2976 14:54:25 INFO  Cache created: 'service[registry]' (max size: 25MB, running total: 1565MB)
2976 14:54:25 INFO  Cache created: 'service[viewstate]' (max size: 25MB, running total: 1590MB)
2976 14:54:25 INFO  Cache created: 'service[xsl]' (max size: 50MB, running total: 1640MB)
2976 14:54:25 INFO  Cache created: 'service[filtered items]' (max size: 10MB, running total: 1650MB)
2976 14:54:25 INFO  Cache created: 'modules_shell[html]' (max size: 0 bytes, running total: 1650MB)
2976 14:54:25 INFO  Cache created: 'modules_shell[registry]' (max size: 25MB, running total: 1675MB)
2976 14:54:25 INFO  Cache created: 'modules_shell[viewstate]' (max size: 25MB, running total: 1700MB)
2976 14:54:25 INFO  Cache created: 'modules_shell[xsl]' (max size: 50MB, running total: 1750MB)
2976 14:54:25 INFO  Cache created: 'modules_shell[filtered items]' (max size: 10MB, running total: 1760MB)
2976 14:54:25 INFO  Cache created: 'modules_website[html]' (max size: 25MB, running total: 1785MB)
2976 14:54:25 INFO  Cache created: 'modules_website[registry]' (max size: 25MB, running total: 1810MB)
2976 14:54:25 INFO  Cache created: 'modules_website[viewstate]' (max size: 25MB, running total: 1835MB)
2976 14:54:25 INFO  Cache created: 'modules_website[xsl]' (max size: 50MB, running total: 1885MB)
2976 14:54:25 INFO  Cache created: 'modules_website[filtered items]' (max size: 10MB, running total: 1895MB)
2976 14:54:25 INFO  Cache created: 'website[html]' (max size: 50MB, running total: 1945MB)
2976 14:54:25 INFO  Cache created: 'website[registry]' (max size: 0 bytes, running total: 1945MB)
2976 14:54:25 INFO  Cache created: 'website[viewstate]' (max size: 0 bytes, running total: 1945MB)
2976 14:54:25 INFO  Cache created: 'website[xsl]' (max size: 25MB, running total: 1970MB)
2976 14:54:25 INFO  Cache created: 'website[filtered items]' (max size: 10MB, running total: 1980MB)
2976 14:54:25 INFO  Cache created: 'website[renderingParameters]' (max size: 10MB, running total: 1990MB)
2976 14:54:25 INFO  Cache created: 'scheduler[html]' (max size: 0 bytes, running total: 1990MB)
2976 14:54:25 INFO  Cache created: 'scheduler[registry]' (max size: 25MB, running total: 2015MB)
2976 14:54:25 INFO  Cache created: 'scheduler[viewstate]' (max size: 25MB, running total: 2040MB)
2976 14:54:25 INFO  Cache created: 'scheduler[xsl]' (max size: 50MB, running total: 2090MB)
2976 14:54:25 INFO  Cache created: 'scheduler[filtered items]' (max size: 10MB, running total: 2100MB)
2976 14:54:25 INFO  Cache created: 'system[html]' (max size: 0 bytes, running total: 2100MB)
2976 14:54:25 INFO  Cache created: 'system[registry]' (max size: 25MB, running total: 2125MB)
2976 14:54:25 INFO  Cache created: 'system[viewstate]' (max size: 25MB, running total: 2150MB)
2976 14:54:25 INFO  Cache created: 'system[xsl]' (max size: 50MB, running total: 2200MB)
2976 14:54:25 INFO  Cache created: 'system[filtered items]' (max size: 10MB, running total: 2210MB)
2976 14:54:25 INFO  Cache created: 'publisher[html]' (max size: 0 bytes, running total: 2210MB)
2976 14:54:25 INFO  Cache created: 'publisher[registry]' (max size: 25MB, running total: 2235MB)
2976 14:54:25 INFO  Cache created: 'publisher[viewstate]' (max size: 25MB, running total: 2260MB)
2976 14:54:25 INFO  Cache created: 'publisher[xsl]' (max size: 50MB, running total: 2310MB)
2976 14:54:25 INFO  Cache created: 'publisher[filtered items]' (max size: 10MB, running total: 2320MB)
6652 14:54:25 INFO  Precompiling SPEAK View: ~\sitecore\shell\client\Applications\ContentTesting\Components\Behaviours\StateChangeListBehavior.cshtml
6652 14:54:25 INFO  Precompiling SPEAK View: ~\sitecore\shell\client\Applications\ContentTesting\Components\ButtonGroup\ButtonGroup.cshtml
ManagedPoolThread #13 14:54:27 INFO  Trying to load XML configuration /App_Config/Security/GlobalRoles.config
3440 14:54:28 INFO  Precompiling SPEAK View: ~\sitecore\shell\client\Business Component Library\Layouts\Renderings\Behaviors\Behavior.cshtml
ManagedPoolThread #8 14:54:29 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #7 14:54:29 WARN  Failed to create counter 'Sitecore.Presentation\Context | Site Changed / sec'. Sitecore has no necessary permissions for reading/creating counters
ManagedPoolThread #4 14:54:29 WARN  Failed to create counter 'Sitecore.Presentation\Rendering | Controls Rendered / sec'. Sitecore has no necessary permissions for reading/creating counters
ManagedPoolThread #2 14:54:29 WARN  Failed to create counter 'Sitecore.Presentation\Rendering | Controls Rendered From Cache / sec'. Sitecore has no necessary permissions for reading/creating counters
ManagedPoolThread #17 14:54:29 WARN  Failed to create counter 'Sitecore.Presentation\Rendering | Pages Generated / sec'. Sitecore has no necessary permissions for reading/creating counters
ManagedPoolThread #16 14:54:29 WARN  Failed to create counter 'Sitecore.Presentation\Rendering | Renderings Rendered / sec'. Sitecore has no necessary permissions for reading/creating counters
ManagedPoolThread #11 14:54:29 WARN  Failed to create counter 'Sitecore.Presentation\Rendering | Sublayouts Rendered / sec'. Sitecore has no necessary permissions for reading/creating counters
ManagedPoolThread #18 14:54:29 WARN  Failed to create counter 'Sitecore.Presentation\Rendering | XmlControls Compiled / sec'. Sitecore has no necessary permissions for reading/creating counters
ManagedPoolThread #18 14:54:29 WARN  Failed to create counter 'Sitecore.Presentation\Rendering | Xsl Transforms Rendered / sec'. Sitecore has no necessary permissions for reading/creating counters
ManagedPoolThread #13 14:54:29 WARN  Failed to create counter 'Sitecore.Presentation\Rendering | Xaml Controls Compiled / sec'. Sitecore has no necessary permissions for reading/creating counters
ManagedPoolThread #8 14:54:29 INFO  Cache created: '[IDTable]' (max size: 2MB, running total: 2323MB)
ManagedPoolThread #8 14:54:29 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
6652 14:54:30 INFO  Precompiling SPEAK View: ~\sitecore\shell\client\Applications\ContentTesting\Components\CarouselImage\CarouselImage.cshtml
6928 14:54:32 INFO  Cache created: 'Task Manager - tasks' (max size: 100 bytes, running total: 2323MB)
1932 14:54:32 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Core.BackgroundService.Run()

3288 14:54:32 INFO  Cache created: 'ReportingStorageProviderProperties.Properties' (max size: 100 bytes, running total: 2323MB)
3288 14:54:32 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

5476 14:54:32 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

6832 14:54:32 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

2288 14:54:32 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

5344 14:54:32 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #10 14:54:32 WARN  Failed to create counter 'Sitecore.Analytics.MongoDb\Reads / sec'. Sitecore has no necessary permissions for reading/creating counters
ManagedPoolThread #18 14:54:32 WARN  Failed to create counter 'Sitecore.Analytics.MongoDb\Writes / sec'. Sitecore has no necessary permissions for reading/creating counters
ManagedPoolThread #10 14:54:32 WARN  Failed to create counter 'Sitecore.Analytics.MongoDb\Documents fetched / sec'. Sitecore has no necessary permissions for reading/creating counters
ManagedPoolThread #10 14:54:32 WARN  Failed to create counter 'Sitecore.Analytics.MongoDb\Data | Aggregation - Add (Visits scheduled for aggregation) / sec'. Sitecore has no necessary permissions for reading/creating counters
ManagedPoolThread #7 14:54:32 WARN  Failed to create counter 'Sitecore.Analytics.MongoDb\Data | Aggregation - Check out calls / sec'. Sitecore has no necessary permissions for reading/creating counters
ManagedPoolThread #13 14:54:32 WARN  Failed to create counter 'Sitecore.Analytics.MongoDb\Data | Aggregation - Check out (Visits checked out) / sec'. Sitecore has no necessary permissions for reading/creating counters
ManagedPoolThread #10 14:54:32 WARN  Failed to create counter 'Sitecore.Analytics.MongoDb\Data | Aggregation - Pool cleanup calls / sec'. Sitecore has no necessary permissions for reading/creating counters
ManagedPoolThread #18 14:54:32 WARN  Failed to create counter 'Sitecore.Analytics.MongoDb\Data | Aggregation - Check in (Visits checked in) / sec'. Sitecore has no necessary permissions for reading/creating counters
ManagedPoolThread #7 14:54:32 WARN  Failed to create counter 'Sitecore.Analytics.MongoDb\Data | Aggregation - Visits cleaned up / sec'. Sitecore has no necessary permissions for reading/creating counters
ManagedPoolThread #13 14:54:32 WARN  Failed to create counter 'Sitecore.Analytics.MongoDb\Data | Aggregation - Pool Recovery calls / sec'. Sitecore has no necessary permissions for reading/creating counters
ManagedPoolThread #10 14:54:32 WARN  Failed to create counter 'Sitecore.Analytics.MongoDb\Data | Aggregation - Visits recovered / sec'. Sitecore has no necessary permissions for reading/creating counters
3440 14:54:33 INFO  Precompiling SPEAK View: ~\sitecore\shell\client\Business Component Library\Layouts\Renderings\Charts\FusionChartsAreaChart.cshtml
ManagedPoolThread #2 14:54:33 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #17 14:54:34 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #11 14:54:35 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
2976 14:54:36 INFO  Cache created: 'Log singles' (max size: 100KB, running total: 2323MB)
2976 14:54:36 WARN  No session Id managers were found to manage the session Id for the current request. Default asp.net session manager will be used.
ManagedPoolThread #16 14:54:36 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
2976 14:54:37 INFO  Cache created: 'WebUtil.QueryStringCache' (max size: 19KB, running total: 2323MB)
2896 14:54:37 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
2896 14:54:37 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.HandleDatabaseException(ExceptionBehavior exceptionBehavior, Exception ex)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

Nested Exception

Exception: MongoDB.Driver.MongoConnectionException
Message: Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
Source: MongoDB.Driver
   at MongoDB.Driver.Internal.DirectMongoServerProxy.Connect(TimeSpan timeout, ReadPreference readPreference)
   at MongoDB.Driver.Internal.DirectMongoServerProxy.ChooseServerInstance(ReadPreference readPreference)
   at MongoDB.Driver.MongoServer.AcquireConnection(ReadPreference readPreference)
   at MongoDB.Driver.MongoCollection.RunCommandAs[TCommandResult](IMongoCommand command, ReadPreference readPreference, IBsonSerializer resultSerializer, IBsonSerializationOptions resultSerializationOptions)
   at MongoDB.Driver.MongoCollection.RunCommandAs[TCommandResult](IMongoCommand command, ReadPreference readPreference)
   at MongoDB.Driver.MongoCollection.FindAndModify(FindAndModifyArgs args)
   at MongoDB.Driver.MongoCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.<>c__DisplayClass2c.<FindAndModify>b__2b()
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)

Nested Exception

Exception: System.Net.Sockets.SocketException
Message: No connection could be made because the target machine actively refused it 127.0.0.1:27017
Source: System
   at System.Net.Sockets.Socket.DoConnect(EndPoint endPointSnapshot, SocketAddress socketAddress)
   at System.Net.Sockets.Socket.Connect(EndPoint remoteEP)
   at System.Net.Sockets.TcpClient.Connect(IPEndPoint remoteEP)
   at MongoDB.Driver.Internal.MongoConnection.Open()
   at MongoDB.Driver.Internal.MongoConnection.SendMessage(BsonBuffer buffer, Int32 requestId)
   at MongoDB.Driver.Internal.MongoConnection.SendMessage(MongoRequestMessage message)
   at MongoDB.Driver.Operations.CommandOperation`1.Execute(MongoConnection connection)
   at MongoDB.Driver.MongoServerInstance.Ping(MongoConnection connection)
   at MongoDB.Driver.MongoServerInstance.Connect()
   at MongoDB.Driver.Internal.DirectMongoServerProxy.Connect(TimeSpan timeout, ReadPreference readPreference)



6652 14:54:37 INFO  Precompiling SPEAK View: ~\sitecore\shell\client\Applications\ContentTesting\Components\CompareImage\CompareImage.cshtml
ManagedPoolThread #18 14:54:38 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #7 14:54:39 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #7 14:54:39 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
3440 14:54:39 INFO  Precompiling SPEAK View: ~\sitecore\shell\client\Business Component Library\Layouts\Renderings\Charts\FusionChartsBarChart.cshtml
3440 14:54:39 INFO  Precompiling SPEAK View: ~\sitecore\shell\client\Business Component Library\Layouts\Renderings\Charts\FusionChartsColumnChart.cshtml
3440 14:54:39 INFO  Precompiling SPEAK View: ~\sitecore\shell\client\Business Component Library\Layouts\Renderings\Charts\FusionChartsDoughnutChart.cshtml
3440 14:54:39 INFO  Precompiling SPEAK View: ~\sitecore\shell\client\Business Component Library\Layouts\Renderings\Charts\FusionChartsJourneyChart.cshtml
3440 14:54:39 INFO  Precompiling SPEAK View: ~\sitecore\shell\client\Business Component Library\Layouts\Renderings\Charts\FusionChartsLineChart.cshtml
3440 14:54:39 INFO  Precompiling SPEAK View: ~\sitecore\shell\client\Business Component Library\Layouts\Renderings\Charts\FusionChartsPieChart.cshtml
3440 14:54:39 INFO  Precompiling SPEAK View: ~\sitecore\shell\client\Business Component Library\Layouts\Renderings\Charts\FusionChartsRadarChart.cshtml
3440 14:54:39 INFO  Precompiling SPEAK View: ~\sitecore\shell\client\Business Component Library\Layouts\Renderings\Common\ActionControl\ActionControl.cshtml
6652 14:54:40 INFO  Precompiling SPEAK View: ~\sitecore\shell\client\Applications\ContentTesting\Components\DataRepeater\ContentTestingDataRepeater.cshtml
3440 14:54:41 INFO  Precompiling SPEAK View: ~\sitecore\shell\client\Business Component Library\Layouts\Renderings\Common\Buttons\BackButton.cshtml
6652 14:54:43 INFO  Precompiling SPEAK View: ~\sitecore\shell\client\Applications\ContentTesting\Components\DataSource\ActivityDataSource\ActivityDataSource.cshtml
3440 14:54:44 INFO  Precompiling SPEAK View: ~\sitecore\shell\client\Business Component Library\Layouts\Renderings\Common\Buttons\Button.cshtml
3440 14:54:44 INFO  Precompiling SPEAK View: ~\sitecore\shell\client\Business Component Library\Layouts\Renderings\Common\Buttons\DropDownButton.cshtml
3440 14:54:44 INFO  Precompiling SPEAK View: ~\sitecore\shell\client\Business Component Library\Layouts\Renderings\Common\Buttons\ToggleButton.cshtml
3440 14:54:44 INFO  Precompiling SPEAK View: ~\sitecore\shell\client\Business Component Library\Layouts\Renderings\Common\CheckBoxes\CheckBox.cshtml
6652 14:54:45 INFO  Precompiling SPEAK View: ~\sitecore\shell\client\Applications\ContentTesting\Components\DataSource\BaseDataSource\OptimizationBaseDataSource.cshtml
3440 14:54:47 INFO  Precompiling SPEAK View: ~\sitecore\shell\client\Business Component Library\Layouts\Renderings\Common\ComboBoxes\AdvancedComboBox.cshtml
1932 14:54:47 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Core.BackgroundService.Run()

3288 14:54:47 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

5476 14:54:47 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

6832 14:54:47 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

5344 14:54:47 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

2288 14:54:47 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

6652 14:54:48 INFO  Precompiling SPEAK View: ~\sitecore\shell\client\Applications\ContentTesting\Components\DataSource\BaseDataSource\OptimizationEntriesBaseDataSource.cshtml
6652 14:54:48 INFO  Precompiling SPEAK View: ~\sitecore\shell\client\Applications\ContentTesting\Components\DataSource\BestGuessDataSource\BestGuessingDataSource.cshtml
2436 14:54:48 INFO  [Experience Analytics]: Reduce agent found zero sites to process
ManagedPoolThread #10 14:54:49 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #10 14:54:49 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
3440 14:54:49 INFO  Precompiling SPEAK View: ~\sitecore\shell\client\Business Component Library\Layouts\Renderings\Common\ComboBoxes\ComboBox.cshtml
3440 14:54:49 INFO  Precompiling SPEAK View: ~\sitecore\shell\client\Business Component Library\Layouts\Renderings\Common\ContextSwitcher\ContextSwitcher.cshtml
6652 14:54:51 INFO  Precompiling SPEAK View: ~\sitecore\shell\client\Applications\ContentTesting\Components\DataSource\ConversionRateDataSource\ConversionRateDataSource.cshtml
3440 14:54:52 INFO  Precompiling SPEAK View: ~\sitecore\shell\client\Business Component Library\Layouts\Renderings\Common\ControlRenderers\ControlRenderer.cshtml
2896 14:54:52 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

6652 14:54:53 INFO  Precompiling SPEAK View: ~\sitecore\shell\client\Applications\ContentTesting\Components\DataSource\ExperienceEngagementDataSource\ExperienceEngagementDataSource.cshtml
3440 14:54:54 INFO  Precompiling SPEAK View: ~\sitecore\shell\client\Business Component Library\Layouts\Renderings\Common\DatePickers\DatePicker.cshtml
6652 14:54:56 INFO  Precompiling SPEAK View: ~\sitecore\shell\client\Applications\ContentTesting\Components\DataSource\ExperienceKPIDataSource\ExperienceKPIDataSource.cshtml
3440 14:54:57 INFO  Precompiling SPEAK View: ~\sitecore\shell\client\Business Component Library\Layouts\Renderings\Common\GlobalLogos\GlobalLogo.cshtml
6652 14:54:58 INFO  Precompiling SPEAK View: ~\sitecore\shell\client\Applications\ContentTesting\Components\DataSource\HighestEffectDataSource\HighestEffectDataSource.cshtml
ManagedPoolThread #16 14:54:59 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #16 14:54:59 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
3440 14:55:00 INFO  Precompiling SPEAK View: ~\sitecore\shell\client\Business Component Library\Layouts\Renderings\Common\HyperlinkButtons\HyperlinkButton.cshtml
6652 14:55:01 INFO  Precompiling SPEAK View: ~\sitecore\shell\client\Applications\ContentTesting\Components\DataSource\ItemFromQueryString\ItemFromQueryString.cshtml
1932 14:55:02 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Core.BackgroundService.Run()

3440 14:55:02 INFO  Precompiling SPEAK View: ~\sitecore\shell\client\Business Component Library\Layouts\Renderings\Common\HyperlinkButtons\IconHyperlinkButton.cshtml
3440 14:55:02 INFO  Precompiling SPEAK View: ~\sitecore\shell\client\Business Component Library\Layouts\Renderings\Common\IconButtons\IconButton.cshtml
5476 14:55:02 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

3288 14:55:02 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

6832 14:55:02 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

5344 14:55:02 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

2288 14:55:02 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

6652 14:55:04 INFO  Precompiling SPEAK View: ~\sitecore\shell\client\Applications\ContentTesting\Components\DataSource\ItemInfoDataSource\ItemInfoDataSource.cshtml
3440 14:55:05 INFO  Precompiling SPEAK View: ~\sitecore\shell\client\Business Component Library\Layouts\Renderings\Common\Images\Image.cshtml
6652 14:55:06 INFO  Precompiling SPEAK View: ~\sitecore\shell\client\Applications\ContentTesting\Components\DataSource\KPIDataSource\KPIDataSource.cshtml
2896 14:55:07 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

3440 14:55:08 INFO  Precompiling SPEAK View: ~\sitecore\shell\client\Business Component Library\Layouts\Renderings\Common\Labels\Label.cshtml
ManagedPoolThread #13 14:55:09 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #13 14:55:09 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
6652 14:55:09 INFO  Precompiling SPEAK View: ~\sitecore\shell\client\Applications\ContentTesting\Components\DataSource\MostActiveUserDataSource\MostActiveUserDataSource.cshtml
3440 14:55:10 INFO  Precompiling SPEAK View: ~\sitecore\shell\client\Business Component Library\Layouts\Renderings\Common\ListBoxes\ListBox.cshtml
6652 14:55:11 INFO  Precompiling SPEAK View: ~\sitecore\shell\client\Applications\ContentTesting\Components\DataSource\OverallPerformanceDataSource\OverallPerformanceDataSource.cshtml
3440 14:55:13 INFO  Precompiling SPEAK View: ~\sitecore\shell\client\Business Component Library\Layouts\Renderings\Common\MessageBars\MessageBar.cshtml
6652 14:55:14 INFO  Precompiling SPEAK View: ~\sitecore\shell\client\Applications\ContentTesting\Components\DataSource\PersonalizationRuleDataSource\PersonalizationRuleDataSource.cshtml
3440 14:55:15 INFO  Precompiling SPEAK View: ~\sitecore\shell\client\Business Component Library\Layouts\Renderings\Common\ProgressBars\ProgressBar.cshtml
6652 14:55:17 INFO  Precompiling SPEAK View: ~\sitecore\shell\client\Applications\ContentTesting\Components\DataSource\ReachDataSource\ReachDataSource.cshtml
1932 14:55:17 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Core.BackgroundService.Run()

5476 14:55:17 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

3288 14:55:17 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

6832 14:55:17 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

5344 14:55:17 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

2288 14:55:17 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

3440 14:55:18 INFO  Precompiling SPEAK View: ~\sitecore\shell\client\Business Component Library\Layouts\Renderings\Common\ProgressIndicators\ProgressIndicator.cshtml
2436 14:55:18 INFO  [Experience Analytics]: Reduce agent found zero sites to process
ManagedPoolThread #16 14:55:19 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #16 14:55:19 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
6652 14:55:19 INFO  Precompiling SPEAK View: ~\sitecore\shell\client\Applications\ContentTesting\Components\DataSource\ReportingDatesDataSource\ReportingDatesDataSource.cshtml
3440 14:55:21 INFO  Precompiling SPEAK View: ~\sitecore\shell\client\Business Component Library\Layouts\Renderings\Common\RadioButtons\RadioButton.cshtml
6652 14:55:22 INFO  Precompiling SPEAK View: ~\sitecore\shell\client\Applications\ContentTesting\Components\DataSource\RulePerformanceDataSource\RulePerformanceDataSource.cshtml
2896 14:55:22 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

3440 14:55:23 INFO  Precompiling SPEAK View: ~\sitecore\shell\client\Business Component Library\Layouts\Renderings\Common\Separators\Separator.cshtml
6652 14:55:25 INFO  Precompiling SPEAK View: ~\sitecore\shell\client\Applications\ContentTesting\Components\DataSource\RulesDataSource\RulesDataSource.cshtml
ManagedPoolThread #19 14:55:26 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
3440 14:55:26 INFO  Precompiling SPEAK View: ~\sitecore\shell\client\Business Component Library\Layouts\Renderings\Common\SheerUI\SheerUI.cshtml
ManagedPoolThread #12 14:55:27 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
6652 14:55:27 INFO  Precompiling SPEAK View: ~\sitecore\shell\client\Applications\ContentTesting\Components\DataSource\RuleSetPerformanceDataSource\RuleSetPerformanceDataSource.cshtml
ManagedPoolThread #14 14:55:28 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #10 14:55:29 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #10 14:55:29 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
ManagedPoolThread #0 14:55:29 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
3440 14:55:30 INFO  Precompiling SPEAK View: ~\sitecore\shell\client\Business Component Library\Layouts\Renderings\Common\Slider\Slider.cshtml
ManagedPoolThread #9 14:55:30 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
6652 14:55:31 INFO  Precompiling SPEAK View: ~\sitecore\shell\client\Applications\ContentTesting\Components\DataSource\SitecoreQueryDataSource\SitecoreQueryDataSource.cshtml
ManagedPoolThread #15 14:55:32 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
1932 14:55:32 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Core.BackgroundService.Run()

3440 14:55:32 INFO  Precompiling SPEAK View: ~\sitecore\shell\client\Business Component Library\Layouts\Renderings\Common\SubAppRenderes\SubAppRenderer.cshtml
5476 14:55:32 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

3288 14:55:32 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

5344 14:55:32 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

6832 14:55:32 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

2288 14:55:32 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #1 14:55:33 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
6652 14:55:34 INFO  Precompiling SPEAK View: ~\sitecore\shell\client\Applications\ContentTesting\Components\DataSource\SiteUsageDataSource\SiteUsageDataSource.cshtml
ManagedPoolThread #3 14:55:34 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #5 14:55:35 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
3440 14:55:35 INFO  Precompiling SPEAK View: ~\sitecore\shell\client\Business Component Library\Layouts\Renderings\Common\TextAreas\TextArea.cshtml
ManagedPoolThread #6 14:55:36 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
6652 14:55:36 INFO  Precompiling SPEAK View: ~\sitecore\shell\client\Applications\ContentTesting\Components\DataSource\TestCandidatesDataSource\TestCandidatesDataSource.cshtml
ManagedPoolThread #2 14:55:37 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
2896 14:55:37 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

3440 14:55:38 INFO  Precompiling SPEAK View: ~\sitecore\shell\client\Business Component Library\Layouts\Renderings\Common\TextBoxes\ButtonTextBox.cshtml
ManagedPoolThread #11 14:55:38 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #7 14:55:39 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #7 14:55:39 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
6652 14:55:39 INFO  Precompiling SPEAK View: ~\sitecore\shell\client\Applications\ContentTesting\Components\DataSource\TestDefinitionDataSource\TestDefinitionDataSource.cshtml
ManagedPoolThread #18 14:55:39 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
3440 14:55:40 INFO  Precompiling SPEAK View: ~\sitecore\shell\client\Business Component Library\Layouts\Renderings\Common\TextBoxes\TextBox.cshtml
3440 14:55:40 INFO  Precompiling SPEAK View: ~\sitecore\shell\client\Business Component Library\Layouts\Renderings\Common\Texts\Text.cshtml
6652 14:55:41 INFO  Precompiling SPEAK View: ~\sitecore\shell\client\Applications\ContentTesting\Components\DataSource\TestDurationDataSource\TestDurationDataSource.cshtml
3440 14:55:43 INFO  Precompiling SPEAK View: ~\sitecore\shell\client\Business Component Library\Layouts\Renderings\Common\Timelines\Timeline.cshtml
6652 14:55:44 INFO  Precompiling SPEAK View: ~\sitecore\shell\client\Applications\ContentTesting\Components\DataSource\TestExpectationsDataSource\TestExpectationsDataSource.cshtml
3440 14:55:45 INFO  Precompiling SPEAK View: ~\sitecore\shell\client\Business Component Library\Layouts\Renderings\Common\TimePickers\TimePicker.cshtml
6652 14:55:47 INFO  Precompiling SPEAK View: ~\sitecore\shell\client\Applications\ContentTesting\Components\DataSource\TestObjectivesDataSource\TestObjectivesDataSource.cshtml
1932 14:55:47 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Core.BackgroundService.Run()

5476 14:55:47 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

5344 14:55:47 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

6832 14:55:47 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

2288 14:55:47 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

3288 14:55:47 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

3440 14:55:48 INFO  Precompiling SPEAK View: ~\sitecore\shell\client\Business Component Library\Layouts\Renderings\Common\Tooltips\ToolTip.cshtml
2436 14:55:48 INFO  [Experience Analytics]: Reduce agent found zero sites to process
ManagedPoolThread #13 14:55:49 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #13 14:55:49 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
6652 14:55:49 INFO  Precompiling SPEAK View: ~\sitecore\shell\client\Applications\ContentTesting\Components\DataSource\TestOutcomesDataSource\TestOutcomesDataSource.cshtml
3440 14:55:51 INFO  Precompiling SPEAK View: ~\sitecore\shell\client\Business Component Library\Layouts\Renderings\Configuration\SinglePageAppConfiguration.cshtml
2896 14:55:52 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

6652 14:55:52 INFO  Precompiling SPEAK View: ~\sitecore\shell\client\Applications\ContentTesting\Components\DataSource\TestsDataSource\TestsDataSource.cshtml
3440 14:55:54 INFO  Precompiling SPEAK View: ~\sitecore\shell\client\Business Component Library\Layouts\Renderings\Containers\AdvancedExpanders\AdvancedExpander.cshtml
6652 14:55:55 INFO  Precompiling SPEAK View: ~\sitecore\shell\client\Applications\ContentTesting\Components\DataSource\TestSummary\TestSummary.cshtml
3440 14:55:56 INFO  Precompiling SPEAK View: ~\sitecore\shell\client\Business Component Library\Layouts\Renderings\Containers\Borders\Border.cshtml
6652 14:55:58 INFO  Precompiling SPEAK View: ~\sitecore\shell\client\Applications\ContentTesting\Components\DataSource\TestVariablesDataSource\TestVariablesDataSource.cshtml
ManagedPoolThread #7 14:55:59 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #7 14:55:59 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
3440 14:55:59 INFO  Precompiling SPEAK View: ~\sitecore\shell\client\Business Component Library\Layouts\Renderings\Containers\Borders\ProtectedBorder.cshtml
3440 14:55:59 INFO  Precompiling SPEAK View: ~\sitecore\shell\client\Business Component Library\Layouts\Renderings\Containers\ColumnPanels\ColumnPanel.cshtml
6652 14:56:00 INFO  Precompiling SPEAK View: ~\sitecore\shell\client\Applications\ContentTesting\Components\DataSource\TestVariationsDataSource\TestVariationsDataSource.cshtml
3440 14:56:02 INFO  Precompiling SPEAK View: ~\sitecore\shell\client\Business Component Library\Layouts\Renderings\Containers\Expanders\Expander.cshtml
1932 14:56:02 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Core.BackgroundService.Run()

5476 14:56:02 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

5344 14:56:02 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

6832 14:56:02 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

2288 14:56:02 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

3288 14:56:02 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

6652 14:56:03 INFO  Precompiling SPEAK View: ~\sitecore\shell\client\Applications\ContentTesting\Components\DataSource\ThumbnailImageDataSource\ThumbnailImageDataSource.cshtml
3440 14:56:04 INFO  Precompiling SPEAK View: ~\sitecore\shell\client\Business Component Library\Layouts\Renderings\Containers\Frames\Frame.cshtml
6652 14:56:06 INFO  Precompiling SPEAK View: ~\sitecore\shell\client\Applications\ContentTesting\Components\DataSource\TopClicksToPagesDataSource\TopClicksToPagesDataSource.cshtml
3440 14:56:07 INFO  Precompiling SPEAK View: ~\sitecore\shell\client\Business Component Library\Layouts\Renderings\Containers\LoadOnDemandPanel\LoadOnDemandPanel.cshtml
2896 14:56:07 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

6652 14:56:08 INFO  Precompiling SPEAK View: ~\sitecore\shell\client\Applications\ContentTesting\Components\DataSource\TopGoalsDataSource\TopGoalsDataSource.cshtml
ManagedPoolThread #13 14:56:09 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #13 14:56:09 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
3440 14:56:09 INFO  Precompiling SPEAK View: ~\sitecore\shell\client\Business Component Library\Layouts\Renderings\Containers\Panels\Panel.cshtml
6652 14:56:11 INFO  Precompiling SPEAK View: ~\sitecore\shell\client\Applications\ContentTesting\Components\DataSource\VariablesDataSource\VariablesDataSource.cshtml
3440 14:56:12 INFO  Precompiling SPEAK View: ~\sitecore\shell\client\Business Component Library\Layouts\Renderings\Containers\Popovers\Popover.cshtml
6652 14:56:13 INFO  Precompiling SPEAK View: ~\sitecore\shell\client\Applications\ContentTesting\Components\ExperienceIndicator\ExperienceIndicator.cshtml
3440 14:56:15 INFO  Precompiling SPEAK View: ~\sitecore\shell\client\Business Component Library\Layouts\Renderings\Containers\Repeaters\Repeater.cshtml
6652 14:56:16 INFO  Precompiling SPEAK View: ~\sitecore\shell\client\Applications\ContentTesting\Components\FilteredComboBox\FilteredComboBox.cshtml
3440 14:56:17 INFO  Precompiling SPEAK View: ~\sitecore\shell\client\Business Component Library\Layouts\Renderings\Containers\RowPanels\RowPanel.cshtml
1932 14:56:17 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Core.BackgroundService.Run()

5476 14:56:17 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

5344 14:56:17 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

6832 14:56:17 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

2288 14:56:17 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

3288 14:56:17 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

2436 14:56:18 INFO  [Experience Analytics]: Reduce agent found zero sites to process
6652 14:56:18 INFO  Precompiling SPEAK View: ~\sitecore\shell\client\Applications\ContentTesting\Components\GroupedCheckboxList\GroupedCheckboxList.cshtml
ManagedPoolThread #16 14:56:19 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #16 14:56:19 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
Heartbeat 14:56:19 INFO  Cache created: '[no name]' (max size: 976KB, running total: 2324MB)
Heartbeat 14:56:19 INFO  Cache created: '[no name]' (max size: 976KB, running total: 2325MB)
Heartbeat 14:56:19 INFO  Cache created: '[no name]' (max size: 976KB, running total: 2326MB)
Heartbeat 14:56:19 INFO  Cache created: '[no name]' (max size: 976KB, running total: 2327MB)
Heartbeat 14:56:19 INFO  Cache created: '[no name]' (max size: 976KB, running total: 2328MB)
Heartbeat 14:56:19 ERROR MongoDbDictionary.Store() has failed.
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Save(Object value)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbDictionary.Store(Object value)

3440 14:56:20 INFO  Precompiling SPEAK View: ~\sitecore\shell\client\Business Component Library\Layouts\Renderings\Containers\Sections\Section.cshtml
6652 14:56:21 INFO  Precompiling SPEAK View: ~\sitecore\shell\client\Applications\ContentTesting\Components\ImageSrc\ImageSrc.cshtml
2896 14:56:22 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

3440 14:56:22 INFO  Precompiling SPEAK View: ~\sitecore\shell\client\Business Component Library\Layouts\Renderings\Containers\SmartPanels\SmartPanel.cshtml
6652 14:56:24 INFO  Precompiling SPEAK View: ~\sitecore\shell\client\Applications\ContentTesting\Components\OptionsMapper\OptionsMapper.cshtml
3440 14:56:25 INFO  Precompiling SPEAK View: ~\sitecore\shell\client\Business Component Library\Layouts\Renderings\Containers\TabControls\TabControl.cshtml
6652 14:56:26 INFO  Precompiling SPEAK View: ~\sitecore\shell\client\Applications\ContentTesting\Components\PageThumbnail\PageThumbnail.cshtml
3440 14:56:28 INFO  Precompiling SPEAK View: ~\sitecore\shell\client\Business Component Library\Layouts\Renderings\Dialogs\DialogWindow.cshtml
ManagedPoolThread #13 14:56:29 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #13 14:56:29 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
6652 14:56:29 INFO  Precompiling SPEAK View: ~\sitecore\shell\client\Applications\ContentTesting\Components\ProgressBarCustom\ProgressBarCustom.cshtml
3440 14:56:30 INFO  Precompiling SPEAK View: ~\sitecore\shell\client\Business Component Library\Layouts\Renderings\Forms\Uploader\Uploader.cshtml
6652 14:56:31 INFO  Precompiling SPEAK View: ~\sitecore\shell\client\Applications\ContentTesting\Components\QueryStringParameterResolver\QueryStringParameterResolver.cshtml
1932 14:56:32 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Core.BackgroundService.Run()

5476 14:56:32 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

5344 14:56:32 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

6832 14:56:32 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

2288 14:56:32 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

3288 14:56:32 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

3440 14:56:33 INFO  Precompiling SPEAK View: ~\sitecore\shell\client\Business Component Library\Layouts\Renderings\Forms\UploaderInfo\UploaderInfo.cshtml
6652 14:56:34 INFO  Precompiling SPEAK View: ~\sitecore\shell\client\Applications\ContentTesting\Components\ResizableFrameGrip\ResizableFrameGrip.cshtml
3440 14:56:35 INFO  Precompiling SPEAK View: ~\sitecore\shell\client\Business Component Library\Layouts\Renderings\Indicators\ArrowIndicator.cshtml
6652 14:56:37 INFO  Precompiling SPEAK View: ~\sitecore\shell\client\Applications\ContentTesting\Components\ScoreGainedSpot\ScoreGainedSpot.cshtml
ManagedPoolThread #19 14:56:37 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
2896 14:56:37 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #12 14:56:38 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
6652 14:56:38 INFO  Precompiling SPEAK View: ~\sitecore\shell\client\Applications\ContentTesting\Components\SliderAdvanced\SliderAdvanced.cshtml
ManagedPoolThread #7 14:56:39 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #7 14:56:39 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
ManagedPoolThread #14 14:56:39 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
3440 14:56:39 INFO  Precompiling SPEAK View: ~\sitecore\shell\client\Business Component Library\Layouts\Renderings\Indicators\ValueLabel.cshtml
3440 14:56:39 INFO  Precompiling SPEAK View: ~\sitecore\shell\client\Business Component Library\Layouts\Renderings\ListsAndGrids\Carousels\Carousel.cshtml
ManagedPoolThread #0 14:56:40 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
6652 14:56:41 INFO  Precompiling SPEAK View: ~\sitecore\shell\client\Applications\ContentTesting\Components\StateListControl\StateListControl.cshtml
ManagedPoolThread #9 14:56:41 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
3440 14:56:42 INFO  Precompiling SPEAK View: ~\sitecore\shell\client\Business Component Library\Layouts\Renderings\ListsAndGrids\ListControls\DefaultTile.cshtml
ManagedPoolThread #15 14:56:42 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #1 14:56:43 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
6652 14:56:43 INFO  Precompiling SPEAK View: ~\sitecore\shell\client\Applications\ContentTesting\Components\TestOptions\TestOptions.cshtml
ManagedPoolThread #6 14:56:44 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
3440 14:56:44 INFO  Precompiling SPEAK View: ~\sitecore\shell\client\Business Component Library\Layouts\Renderings\ListsAndGrids\ListControls\ListControl.cshtml
3440 14:56:44 INFO  Precompiling SPEAK View: ~\sitecore\shell\client\Business Component Library\Layouts\Renderings\ListsAndGrids\TreeViews\ItemTreeView.cshtml
ManagedPoolThread #5 14:56:45 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
6652 14:56:46 INFO  Precompiling SPEAK View: ~\sitecore\shell\client\Applications\ContentTesting\Components\TextTemplate\TextTemplate.cshtml
ManagedPoolThread #3 14:56:46 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #2 14:56:47 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
3440 14:56:47 INFO  Precompiling SPEAK View: ~\sitecore\shell\client\Business Component Library\Layouts\Renderings\Navigation\Breadcrumbs\Breadcrumb.cshtml
1932 14:56:47 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Core.BackgroundService.Run()

5476 14:56:47 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

5344 14:56:47 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

6832 14:56:47 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

2288 14:56:47 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

3288 14:56:47 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #11 14:56:48 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
2436 14:56:48 INFO  [Experience Analytics]: Reduce agent found zero sites to process
6652 14:56:48 INFO  Precompiling SPEAK View: ~\sitecore\shell\client\Applications\ContentTesting\Components\UnorderedList\UnorderedList.cshtml
ManagedPoolThread #13 14:56:49 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #13 14:56:49 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
ManagedPoolThread #8 14:56:49 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
3440 14:56:50 INFO  Precompiling SPEAK View: ~\sitecore\shell\client\Business Component Library\Layouts\Renderings\Navigation\HyperlinkButtonsGroups\HyperlinkButtonsGroup.cshtml
ManagedPoolThread #18 14:56:50 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #17 14:56:51 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
6652 14:56:51 INFO  Precompiling SPEAK View: ~\sitecore\shell\client\Applications\ContentTesting\Components\ValueBar\ValueBar.cshtml
3440 14:56:52 INFO  Precompiling SPEAK View: ~\sitecore\shell\client\Business Component Library\Layouts\Renderings\Navigation\Menus\Menu.cshtml
2896 14:56:52 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

6652 14:56:54 INFO  Precompiling SPEAK View: ~\sitecore\shell\client\Applications\ContentTesting\Components\WrappingLink\WrappingLink.cshtml
3440 14:56:55 INFO  Precompiling SPEAK View: ~\sitecore\shell\client\Business Component Library\Layouts\Renderings\Navigation\NavigationPanelToggleButtons\NavigationPanelToggleButton.cshtml
6652 14:56:56 INFO  Precompiling SPEAK View: ~\sitecore\shell\client\Applications\ContentTesting\Components\ZoomFrame\ZoomFrame.cshtml
3440 14:56:57 INFO  Precompiling SPEAK View: ~\sitecore\shell\client\Business Component Library\Layouts\Renderings\SearchingAndFiltering\FilterControls\FilterControl.cshtml
6652 14:56:59 INFO  Precompiling SPEAK View: ~\sitecore\shell\client\Applications\ContentTesting\Components\__OLD\KPISpot\KPISpot.cshtml
ManagedPoolThread #7 14:56:59 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #7 14:56:59 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
3440 14:57:00 INFO  Precompiling SPEAK View: ~\sitecore\shell\client\Business Component Library\Layouts\Renderings\SearchingAndFiltering\Searches\SearchPanel.cshtml
6652 14:57:01 INFO  Precompiling SPEAK Views: Done - time taking: 159886 milliseconds.
1932 14:57:02 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Core.BackgroundService.Run()

5476 14:57:02 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

5344 14:57:02 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

6832 14:57:02 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

2288 14:57:02 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

3288 14:57:02 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

3440 14:57:03 INFO  Precompiling SPEAK View: ~\sitecore\shell\client\Business Component Library\Layouts\Renderings\Silverlight\SilverlightFrame\SilverlightFrame.cshtml
3440 14:57:04 INFO  Precompiling SPEAK View: ~\sitecore\shell\client\Business Component Library\Layouts\Renderings\Structures\Page Structures\Application\Dashboard.cshtml
3440 14:57:05 INFO  Precompiling SPEAK View: ~\sitecore\shell\client\Business Component Library\Layouts\Renderings\Structures\Page Structures\Application\List.cshtml
3440 14:57:05 INFO  Precompiling SPEAK View: ~\sitecore\shell\client\Business Component Library\Layouts\Renderings\Structures\Page Structures\Application\Task.cshtml
3440 14:57:05 INFO  Precompiling SPEAK View: ~\sitecore\shell\client\Business Component Library\Layouts\Renderings\Structures\Page Structures\Dialog\Dialog.cshtml
3440 14:57:07 INFO  Precompiling SPEAK View: ~\sitecore\shell\client\Business Component Library\Layouts\Renderings\Structures\Page Structures\Framework\SearchResults.cshtml
2896 14:57:07 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

3440 14:57:08 INFO  Precompiling SPEAK View: ~\sitecore\shell\client\Business Component Library\Layouts\Renderings\Structures\Page Structures\Framework\Start.cshtml
3440 14:57:08 INFO  Precompiling SPEAK View: ~\sitecore\shell\client\Business Component Library\Layouts\Renderings\Structures\Substructures\ApplicationContentM.cshtml
ManagedPoolThread #13 14:57:09 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #13 14:57:09 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
3440 14:57:09 INFO  Precompiling SPEAK View: ~\sitecore\shell\client\Business Component Library\Layouts\Renderings\Structures\Substructures\ApplicationContentMI.cshtml
3440 14:57:09 INFO  Precompiling SPEAK View: ~\sitecore\shell\client\Business Component Library\Layouts\Renderings\Structures\Substructures\ApplicationContentNM.cshtml
3440 14:57:09 INFO  Precompiling SPEAK View: ~\sitecore\shell\client\Business Component Library\Layouts\Renderings\Structures\Substructures\ApplicationContentNMI.cshtml
3440 14:57:09 INFO  Precompiling SPEAK View: ~\sitecore\shell\client\Business Component Library\Layouts\Renderings\Structures\Substructures\ApplicationHeader.cshtml
3440 14:57:09 INFO  Precompiling SPEAK View: ~\sitecore\shell\client\Business Component Library\Layouts\Renderings\Structures\Substructures\DialogContentM.cshtml
3440 14:57:09 INFO  Precompiling SPEAK View: ~\sitecore\shell\client\Business Component Library\Layouts\Renderings\Structures\Substructures\DialogContentMI.cshtml
3440 14:57:09 INFO  Precompiling SPEAK View: ~\sitecore\shell\client\Business Component Library\Layouts\Renderings\Structures\Substructures\DialogContentNM.cshtml
3440 14:57:09 INFO  Precompiling SPEAK View: ~\sitecore\shell\client\Business Component Library\Layouts\Renderings\Structures\Substructures\DialogFooter.cshtml
3440 14:57:09 INFO  Precompiling SPEAK View: ~\sitecore\shell\client\Business Component Library\Layouts\Renderings\Structures\Substructures\DialogHeader.cshtml
3440 14:57:09 INFO  Precompiling SPEAK View: ~\sitecore\shell\client\Business Component Library\Layouts\Renderings\Structures\Substructures\FrameworkContentM.cshtml
3440 14:57:09 INFO  Precompiling SPEAK View: ~\sitecore\shell\client\Business Component Library\Layouts\Renderings\Structures\Substructures\GlobalFooter.cshtml
3440 14:57:09 INFO  Precompiling SPEAK View: ~\sitecore\shell\client\Business Component Library\Layouts\Renderings\Structures\Substructures\GlobalHeader.cshtml
3440 14:57:09 INFO  Precompiling SPEAK View: ~\sitecore\shell\client\Business Component Library\version 2\Content\Guidance\Common\Layouts\Renderings\AllComponentProperties\AllComponentProperties.cshtml
3440 14:57:11 INFO  Precompiling SPEAK View: ~\sitecore\shell\client\Business Component Library\version 2\Content\Guidance\Common\Layouts\Renderings\AllComponentsList\AllComponentslist.cshtml
3440 14:57:12 INFO  Precompiling SPEAK View: ~\sitecore\shell\client\Business Component Library\version 2\Content\Guidance\Common\Layouts\Renderings\ComponentReferences\ComponentReference.cshtml
3440 14:57:13 INFO  Precompiling SPEAK View: ~\sitecore\shell\client\Business Component Library\version 2\Content\Guidance\Common\Layouts\Renderings\DemoComponentPanels\DemoComponentPanel.cshtml
3440 14:57:15 INFO  Precompiling SPEAK View: ~\sitecore\shell\client\Business Component Library\version 2\Layouts\Layouts\Speak-Extension-Layout.cshtml
3440 14:57:16 INFO  Precompiling SPEAK View: ~\sitecore\shell\client\Business Component Library\version 2\Layouts\Layouts\Speak-Test-Layout.cshtml
3440 14:57:16 INFO  Precompiling SPEAK View: ~\sitecore\shell\client\Business Component Library\version 2\Layouts\Renderings\Authentications\AccountInformations\AccountInformation.cshtml
3440 14:57:17 INFO  Precompiling SPEAK View: ~\sitecore\shell\client\Business Component Library\version 2\Layouts\Renderings\Charts\FusionChartsAreaChart.cshtml
1932 14:57:17 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Core.BackgroundService.Run()

5476 14:57:17 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

5344 14:57:17 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

6832 14:57:17 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

2288 14:57:17 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

3288 14:57:17 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

2436 14:57:18 INFO  [Experience Analytics]: Reduce agent found zero sites to process
3440 14:57:19 INFO  Precompiling SPEAK View: ~\sitecore\shell\client\Business Component Library\version 2\Layouts\Renderings\Charts\FusionChartsBarChart.cshtml
3440 14:57:19 INFO  Precompiling SPEAK View: ~\sitecore\shell\client\Business Component Library\version 2\Layouts\Renderings\Charts\FusionChartsColumnChart.cshtml
3440 14:57:19 INFO  Precompiling SPEAK View: ~\sitecore\shell\client\Business Component Library\version 2\Layouts\Renderings\Charts\FusionChartsDoughnutChart.cshtml
3440 14:57:19 INFO  Precompiling SPEAK View: ~\sitecore\shell\client\Business Component Library\version 2\Layouts\Renderings\Charts\FusionChartsJourneyChart.cshtml
3440 14:57:19 INFO  Precompiling SPEAK View: ~\sitecore\shell\client\Business Component Library\version 2\Layouts\Renderings\Charts\FusionChartsLineChart.cshtml
3440 14:57:19 INFO  Precompiling SPEAK View: ~\sitecore\shell\client\Business Component Library\version 2\Layouts\Renderings\Charts\FusionChartsPieChart.cshtml
3440 14:57:19 INFO  Precompiling SPEAK View: ~\sitecore\shell\client\Business Component Library\version 2\Layouts\Renderings\Charts\FusionChartsRadarChart.cshtml
3440 14:57:19 INFO  Precompiling SPEAK View: ~\sitecore\shell\client\Business Component Library\version 2\Layouts\Renderings\Common\ActionControls\ActionControl.cshtml
ManagedPoolThread #10 14:57:19 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #10 14:57:19 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
3440 14:57:20 INFO  Precompiling SPEAK View: ~\sitecore\shell\client\Business Component Library\version 2\Layouts\Renderings\Common\Buttons\BackButton.cshtml
3440 14:57:21 INFO  Precompiling SPEAK View: ~\sitecore\shell\client\Business Component Library\version 2\Layouts\Renderings\Common\Buttons\Button.cshtml
3440 14:57:21 INFO  Precompiling SPEAK View: ~\sitecore\shell\client\Business Component Library\version 2\Layouts\Renderings\Common\Buttons\DropDownButton.cshtml
3440 14:57:21 INFO  Precompiling SPEAK View: ~\sitecore\shell\client\Business Component Library\version 2\Layouts\Renderings\Common\Buttons\IconButton.cshtml
3440 14:57:21 INFO  Precompiling SPEAK View: ~\sitecore\shell\client\Business Component Library\version 2\Layouts\Renderings\Common\Buttons\ToggleButton.cshtml
3440 14:57:21 INFO  Precompiling SPEAK View: ~\sitecore\shell\client\Business Component Library\version 2\Layouts\Renderings\Common\CheckBoxes\CheckBox.cshtml
2896 14:57:22 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

3440 14:57:22 INFO  Precompiling SPEAK View: ~\sitecore\shell\client\Business Component Library\version 2\Layouts\Renderings\Common\ComboBoxes\DropList.cshtml
3440 14:57:24 INFO  Precompiling SPEAK View: ~\sitecore\shell\client\Business Component Library\version 2\Layouts\Renderings\Common\ComboBoxes\SearchableDropList.cshtml
3440 14:57:24 INFO  Precompiling SPEAK View: ~\sitecore\shell\client\Business Component Library\version 2\Layouts\Renderings\Common\ContextSwitchers\ContextSwitcher.cshtml
3440 14:57:25 INFO  Precompiling SPEAK View: ~\sitecore\shell\client\Business Component Library\version 2\Layouts\Renderings\Common\DatePickers\DatePicker.cshtml
3440 14:57:26 INFO  Precompiling SPEAK View: ~\sitecore\shell\client\Business Component Library\version 2\Layouts\Renderings\Common\GlobalLogos\GlobalLogo.cshtml
3440 14:57:28 INFO  Precompiling SPEAK View: ~\sitecore\shell\client\Business Component Library\version 2\Layouts\Renderings\Common\HyperlinkButtons\HyperlinkButton.cshtml
ManagedPoolThread #16 14:57:29 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #16 14:57:29 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
3440 14:57:29 INFO  Precompiling SPEAK View: ~\sitecore\shell\client\Business Component Library\version 2\Layouts\Renderings\Common\Images\Image.cshtml
3440 14:57:30 INFO  Precompiling SPEAK View: ~\sitecore\shell\client\Business Component Library\version 2\Layouts\Renderings\Common\ListBoxes\ListBox.cshtml
3440 14:57:31 INFO  Precompiling SPEAK View: ~\sitecore\shell\client\Business Component Library\version 2\Layouts\Renderings\Common\MessageBars\MessageBar.cshtml
1932 14:57:32 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Core.BackgroundService.Run()

5476 14:57:32 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

5344 14:57:32 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

6832 14:57:32 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

2288 14:57:32 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

3288 14:57:32 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

3440 14:57:33 INFO  Precompiling SPEAK View: ~\sitecore\shell\client\Business Component Library\version 2\Layouts\Renderings\Common\ProgressBars\ProgressBar.cshtml
3440 14:57:34 INFO  Precompiling SPEAK View: ~\sitecore\shell\client\Business Component Library\version 2\Layouts\Renderings\Common\RadioButtons\RadioButton.cshtml
3440 14:57:36 INFO  Precompiling SPEAK View: ~\sitecore\shell\client\Business Component Library\version 2\Layouts\Renderings\Common\Separators\Separator.cshtml
3440 14:57:37 INFO  Precompiling SPEAK View: ~\sitecore\shell\client\Business Component Library\version 2\Layouts\Renderings\Common\TextAreas\TextArea.cshtml
2896 14:57:37 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

3440 14:57:38 INFO  Precompiling SPEAK View: ~\sitecore\shell\client\Business Component Library\version 2\Layouts\Renderings\Common\TextBoxes\ButtonTextBox.cshtml
ManagedPoolThread #13 14:57:39 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #13 14:57:39 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
3440 14:57:40 INFO  Precompiling SPEAK View: ~\sitecore\shell\client\Business Component Library\version 2\Layouts\Renderings\Common\TextBoxes\TextBox.cshtml
3440 14:57:40 INFO  Precompiling SPEAK View: ~\sitecore\shell\client\Business Component Library\version 2\Layouts\Renderings\Common\Texts\Text.cshtml
3440 14:57:41 INFO  Precompiling SPEAK View: ~\sitecore\shell\client\Business Component Library\version 2\Layouts\Renderings\Common\Tooltips\Tooltip.cshtml
3440 14:57:42 INFO  Precompiling SPEAK View: ~\sitecore\shell\client\Business Component Library\version 2\Layouts\Renderings\Containers\Borders\Border.cshtml
3440 14:57:43 INFO  Precompiling SPEAK View: ~\sitecore\shell\client\Business Component Library\version 2\Layouts\Renderings\Containers\Borders\ScrollablePanel.cshtml
3440 14:57:43 INFO  Precompiling SPEAK View: ~\sitecore\shell\client\Business Component Library\version 2\Layouts\Renderings\Containers\ColumnPanels\ColumnPanel.cshtml
3440 14:57:45 INFO  Precompiling SPEAK View: ~\sitecore\shell\client\Business Component Library\version 2\Layouts\Renderings\Containers\Expanders\Expander.cshtml
3440 14:57:46 INFO  Precompiling SPEAK View: ~\sitecore\shell\client\Business Component Library\version 2\Layouts\Renderings\Containers\Frames\Frame.cshtml
ManagedPoolThread #19 14:57:47 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
1932 14:57:47 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Core.BackgroundService.Run()

3440 14:57:47 INFO  Precompiling SPEAK View: ~\sitecore\shell\client\Business Component Library\version 2\Layouts\Renderings\Containers\Popovers\Popover.cshtml
5476 14:57:47 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

5344 14:57:47 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

6832 14:57:47 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

2288 14:57:47 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

3288 14:57:47 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #12 14:57:48 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
2436 14:57:48 INFO  [Experience Analytics]: Reduce agent found zero sites to process
3440 14:57:49 INFO  Precompiling SPEAK View: ~\sitecore\shell\client\Business Component Library\version 2\Layouts\Renderings\Containers\RowPanels\RowPanel.cshtml
ManagedPoolThread #7 14:57:49 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #7 14:57:49 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
ManagedPoolThread #14 14:57:49 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #3 14:57:50 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
3440 14:57:50 INFO  Precompiling SPEAK View: ~\sitecore\shell\client\Business Component Library\version 2\Layouts\Renderings\Containers\Sections\Section.cshtml
ManagedPoolThread #15 14:57:51 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
3440 14:57:51 INFO  Precompiling SPEAK View: ~\sitecore\shell\client\Business Component Library\version 2\Layouts\Renderings\Containers\SmartPanels\SmartPanel.cshtml
ManagedPoolThread #5 14:57:52 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
3440 14:57:53 INFO  Precompiling SPEAK View: ~\sitecore\shell\client\Business Component Library\version 2\Layouts\Renderings\Containers\SubAppRenderers\SubAppRenderer.cshtml
ManagedPoolThread #0 14:57:53 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
3440 14:57:54 INFO  Precompiling SPEAK View: ~\sitecore\shell\client\Business Component Library\version 2\Layouts\Renderings\Containers\TabControl\TabControl.cshtml
ManagedPoolThread #9 14:57:54 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #6 14:57:55 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
3440 14:57:55 INFO  Precompiling SPEAK View: ~\sitecore\shell\client\Business Component Library\version 2\Layouts\Renderings\Data\ChartDataSources\ChartDataSource.cshtml
ManagedPoolThread #1 14:57:56 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
3440 14:57:56 INFO  Precompiling SPEAK View: ~\sitecore\shell\client\Business Component Library\version 2\Layouts\Renderings\Data\EntityDataSources\EntityDataSource.cshtml
ManagedPoolThread #2 14:57:57 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
3440 14:57:58 INFO  Precompiling SPEAK View: ~\sitecore\shell\client\Business Component Library\version 2\Layouts\Renderings\Data\GenericDataSources\GenericDataSource.cshtml
ManagedPoolThread #8 14:57:58 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #10 14:57:59 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #10 14:57:59 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
ManagedPoolThread #17 14:57:59 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
3440 14:57:59 INFO  Precompiling SPEAK View: ~\sitecore\shell\client\Business Component Library\version 2\Layouts\Renderings\Data\QueryDataSources\QueryDataSource.cshtml
2896 14:58:00 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
2896 14:58:00 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.HandleDatabaseException(ExceptionBehavior exceptionBehavior, Exception ex)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

Nested Exception

Exception: MongoDB.Driver.MongoConnectionException
Message: Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
Source: MongoDB.Driver
   at MongoDB.Driver.Internal.DirectMongoServerProxy.Connect(TimeSpan timeout, ReadPreference readPreference)
   at MongoDB.Driver.Internal.DirectMongoServerProxy.ChooseServerInstance(ReadPreference readPreference)
   at MongoDB.Driver.MongoServer.AcquireConnection(ReadPreference readPreference)
   at MongoDB.Driver.MongoCollection.RunCommandAs[TCommandResult](IMongoCommand command, ReadPreference readPreference, IBsonSerializer resultSerializer, IBsonSerializationOptions resultSerializationOptions)
   at MongoDB.Driver.MongoCollection.RunCommandAs[TCommandResult](IMongoCommand command, ReadPreference readPreference)
   at MongoDB.Driver.MongoCollection.FindAndModify(FindAndModifyArgs args)
   at MongoDB.Driver.MongoCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.<>c__DisplayClass2c.<FindAndModify>b__2b()
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)

Nested Exception

Exception: System.Net.Sockets.SocketException
Message: No connection could be made because the target machine actively refused it 127.0.0.1:27017
Source: System
   at System.Net.Sockets.Socket.DoConnect(EndPoint endPointSnapshot, SocketAddress socketAddress)
   at System.Net.Sockets.Socket.Connect(EndPoint remoteEP)
   at System.Net.Sockets.TcpClient.Connect(IPEndPoint remoteEP)
   at MongoDB.Driver.Internal.MongoConnection.Open()
   at MongoDB.Driver.Internal.MongoConnection.SendMessage(BsonBuffer buffer, Int32 requestId)
   at MongoDB.Driver.Internal.MongoConnection.SendMessage(MongoRequestMessage message)
   at MongoDB.Driver.Operations.CommandOperation`1.Execute(MongoConnection connection)
   at MongoDB.Driver.MongoServerInstance.Ping(MongoConnection connection)
   at MongoDB.Driver.MongoServerInstance.Connect()
   at MongoDB.Driver.Internal.DirectMongoServerProxy.Connect(TimeSpan timeout, ReadPreference readPreference)



3440 14:58:00 INFO  Precompiling SPEAK View: ~\sitecore\shell\client\Business Component Library\version 2\Layouts\Renderings\Data\SearchDataSources\SearchDataSource.cshtml
ManagedPoolThread #11 14:58:01 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
3440 14:58:02 INFO  Precompiling SPEAK View: ~\sitecore\shell\client\Business Component Library\version 2\Layouts\Renderings\Dialogs\DialogWindows\ConfirmationDialog.cshtml
1932 14:58:02 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Core.BackgroundService.Run()

5476 14:58:02 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

5344 14:58:02 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

6832 14:58:02 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

2288 14:58:02 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

3288 14:58:02 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

3440 14:58:03 INFO  Precompiling SPEAK View: ~\sitecore\shell\client\Business Component Library\version 2\Layouts\Renderings\Dialogs\DialogWindows\DialogWindow.cshtml
3440 14:58:03 INFO  Precompiling SPEAK View: ~\sitecore\shell\client\Business Component Library\version 2\Layouts\Renderings\Forms\FormPanels\Form.cshtml
3440 14:58:04 INFO  Precompiling SPEAK View: ~\sitecore\shell\client\Business Component Library\version 2\Layouts\Renderings\Forms\Uploader\Uploader.cshtml
3440 14:58:06 INFO  Precompiling SPEAK View: ~\sitecore\shell\client\Business Component Library\version 2\Layouts\Renderings\Forms\UploaderInfo\UploaderInfo.cshtml
3440 14:58:07 INFO  Precompiling SPEAK View: ~\sitecore\shell\client\Business Component Library\version 2\Layouts\Renderings\Indicators\ArrowIndicators\ArrowIndicator.cshtml
3440 14:58:08 INFO  Precompiling SPEAK View: ~\sitecore\shell\client\Business Component Library\version 2\Layouts\Renderings\Indicators\ValueLabels\ValueLabel.cshtml
ManagedPoolThread #7 14:58:09 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #7 14:58:09 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
3440 14:58:09 INFO  Precompiling SPEAK View: ~\sitecore\shell\client\Business Component Library\version 2\Layouts\Renderings\ListsAndGrids\Grids\Grid.cshtml
3440 14:58:11 INFO  Precompiling SPEAK View: ~\sitecore\shell\client\Business Component Library\version 2\Layouts\Renderings\ListsAndGrids\ItemTreeViews\ItemTreeView.cshtml
3440 14:58:12 INFO  Precompiling SPEAK View: ~\sitecore\shell\client\Business Component Library\version 2\Layouts\Renderings\ListsAndGrids\ListControls\ListControl.cshtml
3440 14:58:13 INFO  Precompiling SPEAK View: ~\sitecore\shell\client\Business Component Library\version 2\Layouts\Renderings\Navigation\Breadcrumbs\Breadcrumb.cshtml
3440 14:58:15 INFO  Precompiling SPEAK View: ~\sitecore\shell\client\Business Component Library\version 2\Layouts\Renderings\Navigation\HyperlinkButtonsGroups\HyperlinkButtonsGroup.cshtml
2896 14:58:15 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

3440 14:58:16 INFO  Precompiling SPEAK View: ~\sitecore\shell\client\Business Component Library\version 2\Layouts\Renderings\Navigation\Menus\Menu.cshtml
3440 14:58:17 INFO  Precompiling SPEAK View: ~\sitecore\shell\client\Business Component Library\version 2\Layouts\Renderings\Navigation\NavigationToggles\NavigationToggle.cshtml
1932 14:58:17 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Core.BackgroundService.Run()

5476 14:58:17 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

5344 14:58:17 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

6832 14:58:17 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

2288 14:58:17 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

3288 14:58:17 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

2436 14:58:18 INFO  [Experience Analytics]: Reduce agent found zero sites to process
3440 14:58:19 INFO  Precompiling SPEAK View: ~\sitecore\shell\client\Business Component Library\version 2\Layouts\Renderings\Resources\Pipelines\Pipeline.cshtml
ManagedPoolThread #10 14:58:19 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #10 14:58:19 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
Heartbeat 14:58:19 ERROR MongoDbDictionary.Store() has failed.
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Save(Object value)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbDictionary.Store(Object value)

3440 14:58:20 INFO  Precompiling SPEAK View: ~\sitecore\shell\client\Business Component Library\version 2\Layouts\Renderings\Resources\Rules\Rule.cshtml
3440 14:58:21 INFO  Precompiling SPEAK View: ~\sitecore\shell\client\Business Component Library\version 2\Layouts\Renderings\SearchingandFiltering\FilterControls\FilterControl.cshtml
3440 14:58:22 INFO  Precompiling SPEAK View: ~\sitecore\shell\client\Business Component Library\version 2\Layouts\Renderings\SearchingandFiltering\SearchPanels\SearchPanel.cshtml
3440 14:58:24 INFO  Precompiling SPEAK View: ~\sitecore\shell\client\Business Component Library\version 2\Layouts\Renderings\Silverlights\SilverlightFrames\SilverlightFrame.cshtml
3440 14:58:25 INFO  Precompiling SPEAK View: ~\sitecore\shell\client\Business Component Library\version 2\Layouts\Renderings\Structures\Page Structures\Application\Dashboards\DashboardPageStructure.cshtml
3440 14:58:26 INFO  Precompiling SPEAK View: ~\sitecore\shell\client\Business Component Library\version 2\Layouts\Renderings\Structures\Page Structures\Application\Lists\ListPageStructure.cshtml
3440 14:58:28 INFO  Precompiling SPEAK View: ~\sitecore\shell\client\Business Component Library\version 2\Layouts\Renderings\Structures\Page Structures\Application\Tasks\TaskPageStructure.cshtml
ManagedPoolThread #16 14:58:29 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #16 14:58:29 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
3440 14:58:29 INFO  Precompiling SPEAK View: ~\sitecore\shell\client\Business Component Library\version 2\Layouts\Renderings\Structures\Page Structures\Dialogs\DialogPageStructure.cshtml
2896 14:58:30 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

3440 14:58:30 INFO  Precompiling SPEAK View: ~\sitecore\shell\client\Business Component Library\version 2\Layouts\Renderings\Structures\Page Structures\Framework\SearchResults.cshtml
3440 14:58:32 INFO  Precompiling SPEAK View: ~\sitecore\shell\client\Business Component Library\version 2\Layouts\Renderings\Structures\Page Structures\Framework\Start.cshtml
3440 14:58:32 INFO  Precompiling SPEAK View: ~\sitecore\shell\client\Business Component Library\version 2\Layouts\Renderings\Structures\Substructures\ApplicationContentM.cshtml
1932 14:58:32 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Core.BackgroundService.Run()

5476 14:58:32 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

6832 14:58:32 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

5344 14:58:32 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

2288 14:58:32 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

3288 14:58:32 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

3440 14:58:33 INFO  Precompiling SPEAK View: ~\sitecore\shell\client\Business Component Library\version 2\Layouts\Renderings\Structures\Substructures\ApplicationContentMI.cshtml
3440 14:58:33 INFO  Precompiling SPEAK View: ~\sitecore\shell\client\Business Component Library\version 2\Layouts\Renderings\Structures\Substructures\ApplicationContentNM.cshtml
3440 14:58:33 INFO  Precompiling SPEAK View: ~\sitecore\shell\client\Business Component Library\version 2\Layouts\Renderings\Structures\Substructures\ApplicationContentNMI.cshtml
3440 14:58:33 INFO  Precompiling SPEAK View: ~\sitecore\shell\client\Business Component Library\version 2\Layouts\Renderings\Structures\Substructures\ApplicationHeader.cshtml
3440 14:58:33 INFO  Precompiling SPEAK View: ~\sitecore\shell\client\Business Component Library\version 2\Layouts\Renderings\Structures\Substructures\DialogFooter.cshtml
3440 14:58:33 INFO  Precompiling SPEAK View: ~\sitecore\shell\client\Business Component Library\version 2\Layouts\Renderings\Structures\Substructures\DialogHeader.cshtml
3440 14:58:33 INFO  Precompiling SPEAK View: ~\sitecore\shell\client\Business Component Library\version 2\Layouts\Renderings\Structures\Substructures\FrameworkContentM.cshtml
3440 14:58:33 INFO  Precompiling SPEAK View: ~\sitecore\shell\client\Business Component Library\version 2\Layouts\Renderings\Structures\Substructures\GlobalFooter.cshtml
3440 14:58:33 INFO  Precompiling SPEAK View: ~\sitecore\shell\client\Business Component Library\version 2\Layouts\Renderings\Structures\Substructures\GlobalHeader.cshtml
3440 14:58:33 INFO  Precompiling SPEAK View: ~\sitecore\shell\client\Business Component Library\version 2\Layouts\Renderings\Structures\Substructures\ApplicationHeaders\ApplicationHeader.cshtml
3440 14:58:34 INFO  Precompiling SPEAK View: ~\sitecore\shell\client\Business Component Library\version 2\Layouts\Renderings\Structures\Substructures\DialogContentMIs\DialogContentMI.cshtml
3440 14:58:36 INFO  Precompiling SPEAK View: ~\sitecore\shell\client\Business Component Library\version 2\Layouts\Renderings\Structures\Substructures\DialogContentMs\DialogContentM.cshtml
3440 14:58:37 INFO  Precompiling SPEAK View: ~\sitecore\shell\client\Business Component Library\version 2\Layouts\Renderings\Structures\Substructures\DialogContentNMs\DialogContentNM.cshtml
3440 14:58:38 INFO  Precompiling SPEAK View: ~\sitecore\shell\client\Business Component Library\version 2\Layouts\Renderings\Test\PageTestCode.cshtml
ManagedPoolThread #13 14:58:39 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #13 14:58:39 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
3440 14:58:39 INFO  Precompiling SPEAK Views: Done - time taking: 257930 milliseconds.
2896 14:58:45 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

1932 14:58:47 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Core.BackgroundService.Run()

5476 14:58:47 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

6832 14:58:47 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

5344 14:58:47 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

2288 14:58:47 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

3288 14:58:47 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

2436 14:58:48 INFO  [Experience Analytics]: Reduce agent found zero sites to process
ManagedPoolThread #16 14:58:49 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #16 14:58:49 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
ManagedPoolThread #19 14:58:57 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #14 14:58:58 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #13 14:58:59 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #13 14:58:59 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
ManagedPoolThread #12 14:58:59 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #3 14:59:00 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #15 14:59:01 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #5 14:59:02 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
1932 14:59:02 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Core.BackgroundService.Run()

5476 14:59:02 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

6832 14:59:02 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

5344 14:59:02 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

2288 14:59:02 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

3288 14:59:02 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #0 14:59:03 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #9 14:59:04 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #6 14:59:05 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #1 14:59:06 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #2 14:59:07 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
2896 14:59:08 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
2896 14:59:08 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.HandleDatabaseException(ExceptionBehavior exceptionBehavior, Exception ex)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

Nested Exception

Exception: MongoDB.Driver.MongoConnectionException
Message: Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
Source: MongoDB.Driver
   at MongoDB.Driver.Internal.DirectMongoServerProxy.Connect(TimeSpan timeout, ReadPreference readPreference)
   at MongoDB.Driver.Internal.DirectMongoServerProxy.ChooseServerInstance(ReadPreference readPreference)
   at MongoDB.Driver.MongoServer.AcquireConnection(ReadPreference readPreference)
   at MongoDB.Driver.MongoCollection.RunCommandAs[TCommandResult](IMongoCommand command, ReadPreference readPreference, IBsonSerializer resultSerializer, IBsonSerializationOptions resultSerializationOptions)
   at MongoDB.Driver.MongoCollection.RunCommandAs[TCommandResult](IMongoCommand command, ReadPreference readPreference)
   at MongoDB.Driver.MongoCollection.FindAndModify(FindAndModifyArgs args)
   at MongoDB.Driver.MongoCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.<>c__DisplayClass2c.<FindAndModify>b__2b()
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)

Nested Exception

Exception: System.Net.Sockets.SocketException
Message: No connection could be made because the target machine actively refused it 127.0.0.1:27017
Source: System
   at System.Net.Sockets.Socket.DoConnect(EndPoint endPointSnapshot, SocketAddress socketAddress)
   at System.Net.Sockets.Socket.Connect(EndPoint remoteEP)
   at System.Net.Sockets.TcpClient.Connect(IPEndPoint remoteEP)
   at MongoDB.Driver.Internal.MongoConnection.Open()
   at MongoDB.Driver.Internal.MongoConnection.SendMessage(BsonBuffer buffer, Int32 requestId)
   at MongoDB.Driver.Internal.MongoConnection.SendMessage(MongoRequestMessage message)
   at MongoDB.Driver.Operations.CommandOperation`1.Execute(MongoConnection connection)
   at MongoDB.Driver.MongoServerInstance.Ping(MongoConnection connection)
   at MongoDB.Driver.MongoServerInstance.Connect()
   at MongoDB.Driver.Internal.DirectMongoServerProxy.Connect(TimeSpan timeout, ReadPreference readPreference)



ManagedPoolThread #16 14:59:09 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #16 14:59:09 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
ManagedPoolThread #11 14:59:09 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #8 14:59:10 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
1932 14:59:17 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Core.BackgroundService.Run()

5476 14:59:17 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

6832 14:59:17 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

5344 14:59:17 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

2288 14:59:17 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

3288 14:59:17 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

 388 14:59:18 INFO  [Path Analyzer](.) Running trail cleanup agent
 388 14:59:18 INFO  [Path Analyzer](.) Running trail cleanup on database
 388 14:59:18 WARN  [Path Analyzer](.) SqlStorage ConnectionString 'reporting.secondary' cannot be found
2436 14:59:18 INFO  [Experience Analytics]: Reduce agent found zero sites to process
ManagedPoolThread #13 14:59:19 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #13 14:59:19 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
ManagedPoolThread #16 14:59:21 INFO  Starting update of index for the database 'master' (3 pending).
ManagedPoolThread #16 14:59:22 INFO  Update of index for the database 'master' done.
2896 14:59:23 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #13 14:59:29 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #13 14:59:29 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
1932 14:59:32 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Core.BackgroundService.Run()

5476 14:59:32 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

6832 14:59:32 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

5344 14:59:32 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

2288 14:59:32 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

3288 14:59:32 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

2896 14:59:38 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #16 14:59:39 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #16 14:59:39 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
1932 14:59:47 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Core.BackgroundService.Run()

5476 14:59:47 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

6832 14:59:47 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

5344 14:59:47 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

2288 14:59:47 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

3288 14:59:47 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

2436 14:59:48 INFO  [Experience Analytics]: Reduce agent found zero sites to process
ManagedPoolThread #13 14:59:49 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #13 14:59:49 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
2896 14:59:53 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #7 14:59:59 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #7 14:59:59 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
1932 15:00:02 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Core.BackgroundService.Run()

5476 15:00:02 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

6832 15:00:02 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

5344 15:00:02 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

2288 15:00:02 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

3288 15:00:02 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #19 15:00:07 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #14 15:00:08 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #10 15:00:09 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #10 15:00:09 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
ManagedPoolThread #12 15:00:09 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #15 15:00:10 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #3 15:00:11 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #5 15:00:12 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #0 15:00:13 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #6 15:00:14 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #9 15:00:15 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #1 15:00:16 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #2 15:00:17 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
1932 15:00:17 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Core.BackgroundService.Run()

5476 15:00:17 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

6832 15:00:17 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

5344 15:00:17 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

2288 15:00:17 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

3288 15:00:17 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

2896 15:00:18 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
2896 15:00:18 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.HandleDatabaseException(ExceptionBehavior exceptionBehavior, Exception ex)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

Nested Exception

Exception: MongoDB.Driver.MongoConnectionException
Message: Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
Source: MongoDB.Driver
   at MongoDB.Driver.Internal.DirectMongoServerProxy.Connect(TimeSpan timeout, ReadPreference readPreference)
   at MongoDB.Driver.Internal.DirectMongoServerProxy.ChooseServerInstance(ReadPreference readPreference)
   at MongoDB.Driver.MongoServer.AcquireConnection(ReadPreference readPreference)
   at MongoDB.Driver.MongoCollection.RunCommandAs[TCommandResult](IMongoCommand command, ReadPreference readPreference, IBsonSerializer resultSerializer, IBsonSerializationOptions resultSerializationOptions)
   at MongoDB.Driver.MongoCollection.RunCommandAs[TCommandResult](IMongoCommand command, ReadPreference readPreference)
   at MongoDB.Driver.MongoCollection.FindAndModify(FindAndModifyArgs args)
   at MongoDB.Driver.MongoCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.<>c__DisplayClass2c.<FindAndModify>b__2b()
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)

Nested Exception

Exception: System.Net.Sockets.SocketException
Message: No connection could be made because the target machine actively refused it 127.0.0.1:27017
Source: System
   at System.Net.Sockets.Socket.DoConnect(EndPoint endPointSnapshot, SocketAddress socketAddress)
   at System.Net.Sockets.Socket.Connect(EndPoint remoteEP)
   at System.Net.Sockets.TcpClient.Connect(IPEndPoint remoteEP)
   at MongoDB.Driver.Internal.MongoConnection.Open()
   at MongoDB.Driver.Internal.MongoConnection.SendMessage(BsonBuffer buffer, Int32 requestId)
   at MongoDB.Driver.Internal.MongoConnection.SendMessage(MongoRequestMessage message)
   at MongoDB.Driver.Operations.CommandOperation`1.Execute(MongoConnection connection)
   at MongoDB.Driver.MongoServerInstance.Ping(MongoConnection connection)
   at MongoDB.Driver.MongoServerInstance.Connect()
   at MongoDB.Driver.Internal.DirectMongoServerProxy.Connect(TimeSpan timeout, ReadPreference readPreference)



2436 15:00:18 INFO  [Experience Analytics]: Reduce agent found zero sites to process
ManagedPoolThread #16 15:00:19 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #16 15:00:19 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
Heartbeat 15:00:19 ERROR MongoDbDictionary.Store() has failed.
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Save(Object value)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbDictionary.Store(Object value)

ManagedPoolThread #17 15:00:19 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #18 15:00:20 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #8 15:00:21 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #11 15:00:22 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #7 15:00:29 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #7 15:00:29 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
1932 15:00:32 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Core.BackgroundService.Run()

5476 15:00:32 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

6832 15:00:32 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

5344 15:00:32 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

2288 15:00:32 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

3288 15:00:32 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

2896 15:00:33 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #10 15:00:39 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #10 15:00:39 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
1932 15:00:47 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Core.BackgroundService.Run()

5476 15:00:47 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

6832 15:00:47 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

5344 15:00:47 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

2288 15:00:47 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

3288 15:00:47 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

2896 15:00:48 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

2436 15:00:48 INFO  [Experience Analytics]: Reduce agent found zero sites to process
ManagedPoolThread #7 15:00:49 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #7 15:00:49 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
ManagedPoolThread #10 15:00:59 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #10 15:00:59 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
1932 15:01:02 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Core.BackgroundService.Run()

5476 15:01:02 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

6832 15:01:02 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

5344 15:01:02 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

2288 15:01:02 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

3288 15:01:02 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

2896 15:01:03 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #7 15:01:09 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #7 15:01:09 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
ManagedPoolThread #19 15:01:17 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
1932 15:01:17 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Core.BackgroundService.Run()

5476 15:01:17 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

6832 15:01:17 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

5344 15:01:17 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

2288 15:01:17 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

3288 15:01:17 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

2896 15:01:18 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #15 15:01:18 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
2436 15:01:18 INFO  [Experience Analytics]: Reduce agent found zero sites to process
ManagedPoolThread #16 15:01:19 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #16 15:01:19 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
ManagedPoolThread #14 15:01:19 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #12 15:01:20 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #3 15:01:21 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #6 15:01:22 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #5 15:01:23 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #9 15:01:24 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #0 15:01:25 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #1 15:01:26 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #2 15:01:27 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #18 15:01:28 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #7 15:01:29 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #7 15:01:29 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
ManagedPoolThread #11 15:01:29 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
1932 15:01:32 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Core.BackgroundService.Run()

5476 15:01:32 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

6832 15:01:32 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

5344 15:01:32 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

2288 15:01:32 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

3288 15:01:32 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

2896 15:01:33 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #10 15:01:39 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #10 15:01:39 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
1932 15:01:47 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Core.BackgroundService.Run()

5476 15:01:47 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

6832 15:01:47 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

5344 15:01:47 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

2288 15:01:47 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

3288 15:01:47 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

2896 15:01:48 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

2436 15:01:48 INFO  [Experience Analytics]: Reduce agent found zero sites to process
ManagedPoolThread #7 15:01:49 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #7 15:01:49 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
ManagedPoolThread #10 15:01:59 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #10 15:01:59 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
ManagedPoolThread #7 15:02:01 WARN  Failed to create counter 'Sitecore.Jobs\Pipelines.PipelinesAborted'. Sitecore has no necessary permissions for reading/creating counters
ManagedPoolThread #16 15:02:01 WARN  Failed to create counter 'Sitecore.Jobs\Pipelines.ProcessorsExecuted'. Sitecore has no necessary permissions for reading/creating counters
ManagedPoolThread #13 15:02:01 WARN  Failed to create counter 'Sitecore.Jobs\Pipelines.PipelinesExecuted'. Sitecore has no necessary permissions for reading/creating counters
1932 15:02:02 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Core.BackgroundService.Run()

5476 15:02:02 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

6832 15:02:02 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

5344 15:02:02 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

2288 15:02:02 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

3288 15:02:02 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

2896 15:02:03 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #7 15:02:09 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #7 15:02:09 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
1932 15:02:17 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Core.BackgroundService.Run()

5476 15:02:17 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

6832 15:02:17 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

5344 15:02:17 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

2288 15:02:17 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

3288 15:02:17 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

2896 15:02:18 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

2436 15:02:18 INFO  [Experience Analytics]: Reduce agent found zero sites to process
ManagedPoolThread #13 15:02:19 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #13 15:02:19 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
Heartbeat 15:02:21 ERROR MongoDbDictionary.Store() has failed.
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Save(Object value)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbDictionary.Store(Object value)

5088 15:02:26 INFO  HttpModule is being initialized
ManagedPoolThread #14 15:02:27 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
6308 15:02:27 INFO  HttpModule is being initialized
ManagedPoolThread #12 15:02:28 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #16 15:02:29 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #16 15:02:29 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
ManagedPoolThread #19 15:02:29 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #6 15:02:30 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #5 15:02:31 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #9 15:02:32 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
1932 15:02:32 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Core.BackgroundService.Run()

5476 15:02:32 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

6832 15:02:32 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

5344 15:02:32 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

2288 15:02:32 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

3288 15:02:32 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #15 15:02:33 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #3 15:02:34 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #1 15:02:35 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #0 15:02:36 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
6308 15:02:38 INFO  AUDIT (sitecore\admin): Recycle item: master:/sitecore/system/Modules/Gather Content/Gather Content Account/Projects/Energy Company redesign, language: en, version: 1, id: {5CFACD23-8A2C-4497-92B7-CFE472A07772}
ManagedPoolThread #2 15:02:38 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #7 15:02:39 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #7 15:02:39 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
ManagedPoolThread #18 15:02:39 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #17 15:02:40 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #10 15:02:41 INFO  Starting update of index for the database 'master' (4 pending).
ManagedPoolThread #10 15:02:41 INFO  Update of index for the database 'master' done.
ManagedPoolThread #11 15:02:41 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #8 15:02:42 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
3112 15:02:42 INFO  AUDIT (sitecore\admin): Recycle item: master:/sitecore/system/Modules/Gather Content/Projects, language: en, version: 1, id: {DCC03EA1-15EB-4730-B1B2-2B8BD23C4FD4}
2896 15:02:43 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
2896 15:02:43 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.HandleDatabaseException(ExceptionBehavior exceptionBehavior, Exception ex)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

Nested Exception

Exception: MongoDB.Driver.MongoConnectionException
Message: Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
Source: MongoDB.Driver
   at MongoDB.Driver.Internal.DirectMongoServerProxy.Connect(TimeSpan timeout, ReadPreference readPreference)
   at MongoDB.Driver.Internal.DirectMongoServerProxy.ChooseServerInstance(ReadPreference readPreference)
   at MongoDB.Driver.MongoServer.AcquireConnection(ReadPreference readPreference)
   at MongoDB.Driver.MongoCollection.RunCommandAs[TCommandResult](IMongoCommand command, ReadPreference readPreference, IBsonSerializer resultSerializer, IBsonSerializationOptions resultSerializationOptions)
   at MongoDB.Driver.MongoCollection.RunCommandAs[TCommandResult](IMongoCommand command, ReadPreference readPreference)
   at MongoDB.Driver.MongoCollection.FindAndModify(FindAndModifyArgs args)
   at MongoDB.Driver.MongoCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.<>c__DisplayClass2c.<FindAndModify>b__2b()
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)

Nested Exception

Exception: System.Net.Sockets.SocketException
Message: No connection could be made because the target machine actively refused it 127.0.0.1:27017
Source: System
   at System.Net.Sockets.Socket.DoConnect(EndPoint endPointSnapshot, SocketAddress socketAddress)
   at System.Net.Sockets.Socket.Connect(EndPoint remoteEP)
   at System.Net.Sockets.TcpClient.Connect(IPEndPoint remoteEP)
   at MongoDB.Driver.Internal.MongoConnection.Open()
   at MongoDB.Driver.Internal.MongoConnection.SendMessage(BsonBuffer buffer, Int32 requestId)
   at MongoDB.Driver.Internal.MongoConnection.SendMessage(MongoRequestMessage message)
   at MongoDB.Driver.Operations.CommandOperation`1.Execute(MongoConnection connection)
   at MongoDB.Driver.MongoServerInstance.Ping(MongoConnection connection)
   at MongoDB.Driver.MongoServerInstance.Connect()
   at MongoDB.Driver.Internal.DirectMongoServerProxy.Connect(TimeSpan timeout, ReadPreference readPreference)



ManagedPoolThread #16 15:02:45 INFO  Starting update of index for the database 'master' (1 pending).
ManagedPoolThread #16 15:02:45 INFO  Update of index for the database 'master' done.
1932 15:02:47 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Core.BackgroundService.Run()

5476 15:02:47 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

6832 15:02:47 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

5344 15:02:47 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

2288 15:02:47 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

3288 15:02:47 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

2436 15:02:48 INFO  [Experience Analytics]: Reduce agent found zero sites to process
ManagedPoolThread #13 15:02:49 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #13 15:02:49 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
 464 15:02:52 INFO  AUDIT (sitecore\admin): Recycle item: master:/sitecore/system/Modules/Gather Content/Gather Content Account/Projects/hello world, language: en, version: 1, id: {C3E28483-C152-4616-AEEC-78B57FFBFB6B}
ManagedPoolThread #7 15:02:55 INFO  Starting update of index for the database 'master' (4 pending).
ManagedPoolThread #7 15:02:55 INFO  Update of index for the database 'master' done.
3112 15:02:55 INFO  AUDIT (sitecore\admin): Recycle item: master:/sitecore/system/Modules/Gather Content/Gather Content Account/Projects/test, language: en, version: 1, id: {0307D4E2-9AAF-4B33-AB56-62439B8D8E97}
ManagedPoolThread #10 15:02:57 INFO  Starting update of index for the database 'master' (4 pending).
ManagedPoolThread #10 15:02:57 INFO  Update of index for the database 'master' done.
2896 15:02:58 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #13 15:02:59 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #13 15:02:59 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
ManagedPoolThread #13 15:03:01 INFO  Starting update of index for the database 'master' (26 pending).
ManagedPoolThread #13 15:03:02 INFO  Update of index for the database 'master' done.
ManagedPoolThread #7 15:03:02 INFO  Starting update of index for the database 'master' (32 pending).
ManagedPoolThread #7 15:03:02 INFO  Update of index for the database 'master' done.
1932 15:03:02 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Core.BackgroundService.Run()

5476 15:03:02 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

5344 15:03:02 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

6832 15:03:02 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

2288 15:03:02 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

3288 15:03:02 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #16 15:03:09 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #16 15:03:09 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
2896 15:03:13 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

3588 15:03:13 INFO  AUDIT (sitecore\admin): Recycle item: master:/sitecore/system/Modules/Gather Content/Gather Content Account/Projects/test, language: en, version: 1, id: {CDEE22D1-431F-4761-96E5-DAE6EBC477BA}
ManagedPoolThread #16 15:03:15 INFO  Starting update of index for the database 'master' (4 pending).
ManagedPoolThread #16 15:03:15 INFO  Update of index for the database 'master' done.
1932 15:03:17 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Core.BackgroundService.Run()

5476 15:03:17 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

5344 15:03:17 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

6832 15:03:17 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

2288 15:03:17 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

3288 15:03:17 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

2436 15:03:18 INFO  [Experience Analytics]: Reduce agent found zero sites to process
ManagedPoolThread #7 15:03:19 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #7 15:03:19 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
ManagedPoolThread #16 15:03:21 INFO  Starting update of index for the database 'master' (12 pending).
ManagedPoolThread #16 15:03:21 INFO  Update of index for the database 'master' done.
2896 15:03:28 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #10 15:03:29 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #10 15:03:29 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
1932 15:03:32 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Core.BackgroundService.Run()

5476 15:03:32 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

5344 15:03:32 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

6832 15:03:32 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

2288 15:03:32 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

3288 15:03:32 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #14 15:03:37 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #12 15:03:38 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #16 15:03:39 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #16 15:03:39 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
ManagedPoolThread #19 15:03:39 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #6 15:03:40 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #0 15:03:41 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #5 15:03:42 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #3 15:03:43 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #1 15:03:44 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #15 15:03:45 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #9 15:03:46 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #2 15:03:47 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
1932 15:03:47 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Core.BackgroundService.Run()

5476 15:03:47 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

5344 15:03:47 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

6832 15:03:47 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

2288 15:03:47 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

3288 15:03:47 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #8 15:03:48 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
2436 15:03:48 INFO  [Experience Analytics]: Reduce agent found zero sites to process
ManagedPoolThread #10 15:03:49 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #10 15:03:49 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
2896 15:03:49 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
2896 15:03:49 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.HandleDatabaseException(ExceptionBehavior exceptionBehavior, Exception ex)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

Nested Exception

Exception: MongoDB.Driver.MongoConnectionException
Message: Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
Source: MongoDB.Driver
   at MongoDB.Driver.Internal.DirectMongoServerProxy.Connect(TimeSpan timeout, ReadPreference readPreference)
   at MongoDB.Driver.Internal.DirectMongoServerProxy.ChooseServerInstance(ReadPreference readPreference)
   at MongoDB.Driver.MongoServer.AcquireConnection(ReadPreference readPreference)
   at MongoDB.Driver.MongoCollection.RunCommandAs[TCommandResult](IMongoCommand command, ReadPreference readPreference, IBsonSerializer resultSerializer, IBsonSerializationOptions resultSerializationOptions)
   at MongoDB.Driver.MongoCollection.RunCommandAs[TCommandResult](IMongoCommand command, ReadPreference readPreference)
   at MongoDB.Driver.MongoCollection.FindAndModify(FindAndModifyArgs args)
   at MongoDB.Driver.MongoCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.<>c__DisplayClass2c.<FindAndModify>b__2b()
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)

Nested Exception

Exception: System.Net.Sockets.SocketException
Message: No connection could be made because the target machine actively refused it 127.0.0.1:27017
Source: System
   at System.Net.Sockets.Socket.DoConnect(EndPoint endPointSnapshot, SocketAddress socketAddress)
   at System.Net.Sockets.Socket.Connect(EndPoint remoteEP)
   at System.Net.Sockets.TcpClient.Connect(IPEndPoint remoteEP)
   at MongoDB.Driver.Internal.MongoConnection.Open()
   at MongoDB.Driver.Internal.MongoConnection.SendMessage(BsonBuffer buffer, Int32 requestId)
   at MongoDB.Driver.Internal.MongoConnection.SendMessage(MongoRequestMessage message)
   at MongoDB.Driver.Operations.CommandOperation`1.Execute(MongoConnection connection)
   at MongoDB.Driver.MongoServerInstance.Ping(MongoConnection connection)
   at MongoDB.Driver.MongoServerInstance.Connect()
   at MongoDB.Driver.Internal.DirectMongoServerProxy.Connect(TimeSpan timeout, ReadPreference readPreference)



ManagedPoolThread #18 15:03:50 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #16 15:03:59 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #16 15:03:59 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
1932 15:04:02 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Core.BackgroundService.Run()

5476 15:04:02 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

5344 15:04:02 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

2288 15:04:02 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

6832 15:04:02 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

3288 15:04:02 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

2896 15:04:04 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #10 15:04:09 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #10 15:04:09 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
Heartbeat 15:04:15 INFO  Health.PrivateBytes: 795,656,192
Heartbeat 15:04:15 INFO  Health.CacheInstances: 116
Heartbeat 15:04:15 INFO  Health.CacheTotalCount: 21,126
Heartbeat 15:04:15 INFO  Health.CacheTotalSize: 84,439,176
Heartbeat 15:04:15 WARN  Could not register counter in HealthMonitor. Category: Process, Name: Private Bytes, Instance: , InstanceType: Windows
		Message: Access to the registry key 'Global' is denied.
Heartbeat 15:04:15 WARN  Could not register counter in HealthMonitor. Category: Process, Name: Virtual Bytes, Instance: , InstanceType: Windows
		Message: Access to the registry key 'Global' is denied.
Heartbeat 15:04:15 WARN  Could not register counter in HealthMonitor. Category: Process, Name: Page File Bytes, Instance: , InstanceType: Windows
		Message: Access to the registry key 'Global' is denied.
Heartbeat 15:04:15 WARN  Could not register counter in HealthMonitor. Category: .NET CLR Memory, Name: # Bytes in all Heaps, Instance: , InstanceType: CLR
		Message: Access to the registry key 'Global' is denied.
Heartbeat 15:04:15 WARN  Could not register counter in HealthMonitor. Category: .NET CLR Memory, Name: % Time in GC, Instance: , InstanceType: CLR
		Message: Access to the registry key 'Global' is denied.
Heartbeat 15:04:15 WARN  Could not register counter in HealthMonitor. Category: .NET CLR Memory, Name: Large Object Heap size, Instance: , InstanceType: CLR
		Message: Access to the registry key 'Global' is denied.
Heartbeat 15:04:15 WARN  Could not register counter in HealthMonitor. Category: .NET CLR Loading, Name: Bytes in Loader Heap, Instance: , InstanceType: CLR
		Message: Access to the registry key 'Global' is denied.
Heartbeat 15:04:15 WARN  Could not register counter in HealthMonitor. Category: .NET CLR Loading, Name: Current Assemblies, Instance: , InstanceType: CLR
		Message: Access to the registry key 'Global' is denied.
1932 15:04:17 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Core.BackgroundService.Run()

5476 15:04:17 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

5344 15:04:17 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

2288 15:04:17 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

6832 15:04:17 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

3288 15:04:17 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

 388 15:04:18 INFO  [Path Analyzer](.) Running trail cleanup agent
 388 15:04:18 INFO  [Path Analyzer](.) Running trail cleanup on database
2436 15:04:18 INFO  [Experience Analytics]: Reduce agent found zero sites to process
ManagedPoolThread #16 15:04:19 INFO  Job started: Sitecore.Tasks.TaskDatabaseAgent
ManagedPoolThread #16 15:04:19 INFO  Processing tasks (count: 0)
ManagedPoolThread #16 15:04:19 INFO  Job ended: Sitecore.Tasks.TaskDatabaseAgent (units processed: )
ManagedPoolThread #7 15:04:19 INFO  Job started: Core_Database_Agent
ManagedPoolThread #7 15:04:19 INFO  Scheduling.DatabaseAgent started. Database: core
ManagedPoolThread #7 15:04:19 INFO  Examining schedules (count: 0)
ManagedPoolThread #7 15:04:19 INFO  Job ended: Core_Database_Agent (units processed: )
ManagedPoolThread #10 15:04:19 INFO  Job started: Master_Database_Agent
ManagedPoolThread #10 15:04:19 INFO  Scheduling.DatabaseAgent started. Database: master
ManagedPoolThread #10 15:04:19 INFO  Examining schedules (count: 5)
ManagedPoolThread #10 15:04:19 INFO  Starting: __Task Schedule
ManagedPoolThread #10 15:04:19 INFO  Ended: __Task Schedule
ManagedPoolThread #10 15:04:19 INFO  Not due: Calculate Statistical Relevancy
ManagedPoolThread #10 15:04:19 INFO  Not due: Rebuild Suggested Tests Index
ManagedPoolThread #10 15:04:19 INFO  Not due: Suspend Corrupted Tests
ManagedPoolThread #10 15:04:19 INFO  Not due: Try Finish Test
ManagedPoolThread #10 15:04:19 INFO  Job ended: Master_Database_Agent (units processed: 5)
ManagedPoolThread #13 15:04:19 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #13 15:04:19 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
2896 15:04:19 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

Heartbeat 15:04:21 ERROR MongoDbDictionary.Store() has failed.
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Save(Object value)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbDictionary.Store(Object value)

ManagedPoolThread #16 15:04:29 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #16 15:04:29 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
1932 15:04:32 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Core.BackgroundService.Run()

5476 15:04:32 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

5344 15:04:32 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

2288 15:04:32 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

6832 15:04:32 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

3288 15:04:32 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

2896 15:04:34 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #13 15:04:39 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #13 15:04:39 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
ManagedPoolThread #14 15:04:47 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
1932 15:04:47 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Core.BackgroundService.Run()

5476 15:04:47 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

5344 15:04:47 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

6832 15:04:47 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

2288 15:04:47 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

3288 15:04:47 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #19 15:04:48 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
2436 15:04:48 INFO  [Experience Analytics]: Reduce agent found zero sites to process
ManagedPoolThread #16 15:04:49 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #16 15:04:49 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
2896 15:04:49 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #6 15:04:49 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #12 15:04:50 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #5 15:04:51 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #0 15:04:52 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #1 15:04:53 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #3 15:04:54 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #15 15:04:55 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #9 15:04:56 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #2 15:04:57 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #8 15:04:58 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #10 15:04:59 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #10 15:04:59 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
ManagedPoolThread #18 15:04:59 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #11 15:05:00 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
1932 15:05:02 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Core.BackgroundService.Run()

5476 15:05:02 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

5344 15:05:02 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

6832 15:05:02 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

2288 15:05:02 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

3288 15:05:02 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

2896 15:05:04 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #7 15:05:09 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #7 15:05:09 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
1932 15:05:17 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Core.BackgroundService.Run()

5476 15:05:17 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

5344 15:05:17 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

6832 15:05:17 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

2288 15:05:17 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

3288 15:05:17 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

2436 15:05:18 INFO  [Experience Analytics]: Reduce agent found zero sites to process
ManagedPoolThread #10 15:05:19 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #10 15:05:19 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
2896 15:05:19 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #16 15:05:29 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #16 15:05:29 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
1932 15:05:32 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Core.BackgroundService.Run()

5476 15:05:32 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

5344 15:05:32 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

6832 15:05:32 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

2288 15:05:32 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

3288 15:05:33 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

2896 15:05:34 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #13 15:05:39 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #13 15:05:39 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
1932 15:05:47 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Core.BackgroundService.Run()

5476 15:05:47 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

5344 15:05:47 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

6832 15:05:47 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

2288 15:05:47 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

3288 15:05:48 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

2436 15:05:48 INFO  [Experience Analytics]: Reduce agent found zero sites to process
ManagedPoolThread #16 15:05:49 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #16 15:05:49 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
2896 15:05:49 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #14 15:05:57 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #6 15:05:58 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #13 15:05:59 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #13 15:05:59 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
ManagedPoolThread #19 15:05:59 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #15 15:06:00 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #12 15:06:01 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #9 15:06:02 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
1932 15:06:02 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Core.BackgroundService.Run()

5476 15:06:02 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

5344 15:06:02 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

6832 15:06:02 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

2288 15:06:02 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

3288 15:06:03 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #5 15:06:03 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #1 15:06:04 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #0 15:06:05 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #3 15:06:06 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #2 15:06:08 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #7 15:06:09 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #7 15:06:09 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
ManagedPoolThread #18 15:06:09 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #17 15:06:10 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #11 15:06:11 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
2896 15:06:12 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
2896 15:06:12 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.HandleDatabaseException(ExceptionBehavior exceptionBehavior, Exception ex)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

Nested Exception

Exception: MongoDB.Driver.MongoConnectionException
Message: Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
Source: MongoDB.Driver
   at MongoDB.Driver.Internal.DirectMongoServerProxy.Connect(TimeSpan timeout, ReadPreference readPreference)
   at MongoDB.Driver.Internal.DirectMongoServerProxy.ChooseServerInstance(ReadPreference readPreference)
   at MongoDB.Driver.MongoServer.AcquireConnection(ReadPreference readPreference)
   at MongoDB.Driver.MongoCollection.RunCommandAs[TCommandResult](IMongoCommand command, ReadPreference readPreference, IBsonSerializer resultSerializer, IBsonSerializationOptions resultSerializationOptions)
   at MongoDB.Driver.MongoCollection.RunCommandAs[TCommandResult](IMongoCommand command, ReadPreference readPreference)
   at MongoDB.Driver.MongoCollection.FindAndModify(FindAndModifyArgs args)
   at MongoDB.Driver.MongoCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.<>c__DisplayClass2c.<FindAndModify>b__2b()
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)

Nested Exception

Exception: System.Net.Sockets.SocketException
Message: No connection could be made because the target machine actively refused it 127.0.0.1:27017
Source: System
   at System.Net.Sockets.Socket.DoConnect(EndPoint endPointSnapshot, SocketAddress socketAddress)
   at System.Net.Sockets.Socket.Connect(EndPoint remoteEP)
   at System.Net.Sockets.TcpClient.Connect(IPEndPoint remoteEP)
   at MongoDB.Driver.Internal.MongoConnection.Open()
   at MongoDB.Driver.Internal.MongoConnection.SendMessage(BsonBuffer buffer, Int32 requestId)
   at MongoDB.Driver.Internal.MongoConnection.SendMessage(MongoRequestMessage message)
   at MongoDB.Driver.Operations.CommandOperation`1.Execute(MongoConnection connection)
   at MongoDB.Driver.MongoServerInstance.Ping(MongoConnection connection)
   at MongoDB.Driver.MongoServerInstance.Connect()
   at MongoDB.Driver.Internal.DirectMongoServerProxy.Connect(TimeSpan timeout, ReadPreference readPreference)



ManagedPoolThread #8 15:06:13 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
1932 15:06:17 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Core.BackgroundService.Run()

5476 15:06:17 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

5344 15:06:17 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

6832 15:06:17 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

2288 15:06:17 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

3288 15:06:18 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

2436 15:06:18 INFO  [Experience Analytics]: Reduce agent found zero sites to process
ManagedPoolThread #10 15:06:19 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #10 15:06:19 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
Heartbeat 15:06:21 ERROR MongoDbDictionary.Store() has failed.
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Save(Object value)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbDictionary.Store(Object value)

2896 15:06:27 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #16 15:06:29 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #16 15:06:29 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
1932 15:06:32 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Core.BackgroundService.Run()

5476 15:06:32 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

5344 15:06:32 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

6832 15:06:32 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

2288 15:06:32 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

3288 15:06:33 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #10 15:06:39 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #10 15:06:39 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
2896 15:06:42 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

1932 15:06:47 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Core.BackgroundService.Run()

5476 15:06:47 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

5344 15:06:47 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

6832 15:06:47 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

2288 15:06:47 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

3288 15:06:48 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

2436 15:06:48 INFO  [Experience Analytics]: Reduce agent found zero sites to process
ManagedPoolThread #16 15:06:49 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #16 15:06:49 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
2896 15:06:57 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #10 15:06:59 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #10 15:06:59 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
1932 15:07:02 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Core.BackgroundService.Run()

5476 15:07:02 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

5344 15:07:02 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

6832 15:07:02 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

2288 15:07:02 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

3288 15:07:03 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #19 15:07:07 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #14 15:07:08 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #16 15:07:09 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #16 15:07:09 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
ManagedPoolThread #12 15:07:09 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #0 15:07:10 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #5 15:07:11 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #1 15:07:12 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #15 15:07:13 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #6 15:07:14 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #9 15:07:15 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #3 15:07:16 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #2 15:07:17 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
1932 15:07:17 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Core.BackgroundService.Run()

5476 15:07:17 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

5344 15:07:17 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

6832 15:07:17 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

2288 15:07:17 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

3288 15:07:18 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

2896 15:07:18 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
2896 15:07:18 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.HandleDatabaseException(ExceptionBehavior exceptionBehavior, Exception ex)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

Nested Exception

Exception: MongoDB.Driver.MongoConnectionException
Message: Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
Source: MongoDB.Driver
   at MongoDB.Driver.Internal.DirectMongoServerProxy.Connect(TimeSpan timeout, ReadPreference readPreference)
   at MongoDB.Driver.Internal.DirectMongoServerProxy.ChooseServerInstance(ReadPreference readPreference)
   at MongoDB.Driver.MongoServer.AcquireConnection(ReadPreference readPreference)
   at MongoDB.Driver.MongoCollection.RunCommandAs[TCommandResult](IMongoCommand command, ReadPreference readPreference, IBsonSerializer resultSerializer, IBsonSerializationOptions resultSerializationOptions)
   at MongoDB.Driver.MongoCollection.RunCommandAs[TCommandResult](IMongoCommand command, ReadPreference readPreference)
   at MongoDB.Driver.MongoCollection.FindAndModify(FindAndModifyArgs args)
   at MongoDB.Driver.MongoCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.<>c__DisplayClass2c.<FindAndModify>b__2b()
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)

Nested Exception

Exception: System.Net.Sockets.SocketException
Message: No connection could be made because the target machine actively refused it 127.0.0.1:27017
Source: System
   at System.Net.Sockets.Socket.DoConnect(EndPoint endPointSnapshot, SocketAddress socketAddress)
   at System.Net.Sockets.Socket.Connect(EndPoint remoteEP)
   at System.Net.Sockets.TcpClient.Connect(IPEndPoint remoteEP)
   at MongoDB.Driver.Internal.MongoConnection.Open()
   at MongoDB.Driver.Internal.MongoConnection.SendMessage(BsonBuffer buffer, Int32 requestId)
   at MongoDB.Driver.Internal.MongoConnection.SendMessage(MongoRequestMessage message)
   at MongoDB.Driver.Operations.CommandOperation`1.Execute(MongoConnection connection)
   at MongoDB.Driver.MongoServerInstance.Ping(MongoConnection connection)
   at MongoDB.Driver.MongoServerInstance.Connect()
   at MongoDB.Driver.Internal.DirectMongoServerProxy.Connect(TimeSpan timeout, ReadPreference readPreference)



2436 15:07:18 INFO  [Experience Analytics]: Reduce agent found zero sites to process
ManagedPoolThread #10 15:07:19 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #10 15:07:19 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
ManagedPoolThread #8 15:07:19 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #13 15:07:29 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #13 15:07:29 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
1932 15:07:32 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Core.BackgroundService.Run()

5476 15:07:32 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

5344 15:07:32 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

6832 15:07:32 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

2288 15:07:32 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

3288 15:07:33 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

2896 15:07:33 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #7 15:07:39 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #7 15:07:39 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
1932 15:07:47 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Core.BackgroundService.Run()

5476 15:07:47 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

5344 15:07:47 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

6832 15:07:47 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

2288 15:07:47 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

3288 15:07:48 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

2896 15:07:48 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

2436 15:07:48 INFO  [Experience Analytics]: Reduce agent found zero sites to process
ManagedPoolThread #13 15:07:49 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #13 15:07:49 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
ManagedPoolThread #10 15:07:59 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #10 15:07:59 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
1932 15:08:02 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Core.BackgroundService.Run()

5476 15:08:02 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

5344 15:08:02 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

6832 15:08:02 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

2288 15:08:02 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

3288 15:08:03 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

2896 15:08:03 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #16 15:08:09 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #16 15:08:09 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
ManagedPoolThread #12 15:08:17 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
1932 15:08:17 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Core.BackgroundService.Run()

5476 15:08:17 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

5344 15:08:17 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

6832 15:08:17 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

2288 15:08:17 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

3288 15:08:18 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #14 15:08:18 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
2436 15:08:18 INFO  [Experience Analytics]: Reduce agent found zero sites to process
ManagedPoolThread #10 15:08:19 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #10 15:08:19 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
ManagedPoolThread #19 15:08:19 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #0 15:08:20 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
Heartbeat 15:08:21 ERROR MongoDbDictionary.Store() has failed.
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Save(Object value)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbDictionary.Store(Object value)

ManagedPoolThread #5 15:08:21 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #1 15:08:22 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #9 15:08:23 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #15 15:08:24 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #3 15:08:25 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #6 15:08:26 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #2 15:08:27 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
2896 15:08:28 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
2896 15:08:28 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.HandleDatabaseException(ExceptionBehavior exceptionBehavior, Exception ex)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

Nested Exception

Exception: MongoDB.Driver.MongoConnectionException
Message: Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
Source: MongoDB.Driver
   at MongoDB.Driver.Internal.DirectMongoServerProxy.Connect(TimeSpan timeout, ReadPreference readPreference)
   at MongoDB.Driver.Internal.DirectMongoServerProxy.ChooseServerInstance(ReadPreference readPreference)
   at MongoDB.Driver.MongoServer.AcquireConnection(ReadPreference readPreference)
   at MongoDB.Driver.MongoCollection.RunCommandAs[TCommandResult](IMongoCommand command, ReadPreference readPreference, IBsonSerializer resultSerializer, IBsonSerializationOptions resultSerializationOptions)
   at MongoDB.Driver.MongoCollection.RunCommandAs[TCommandResult](IMongoCommand command, ReadPreference readPreference)
   at MongoDB.Driver.MongoCollection.FindAndModify(FindAndModifyArgs args)
   at MongoDB.Driver.MongoCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.<>c__DisplayClass2c.<FindAndModify>b__2b()
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)

Nested Exception

Exception: System.Net.Sockets.SocketException
Message: No connection could be made because the target machine actively refused it 127.0.0.1:27017
Source: System
   at System.Net.Sockets.Socket.DoConnect(EndPoint endPointSnapshot, SocketAddress socketAddress)
   at System.Net.Sockets.Socket.Connect(EndPoint remoteEP)
   at System.Net.Sockets.TcpClient.Connect(IPEndPoint remoteEP)
   at MongoDB.Driver.Internal.MongoConnection.Open()
   at MongoDB.Driver.Internal.MongoConnection.SendMessage(BsonBuffer buffer, Int32 requestId)
   at MongoDB.Driver.Internal.MongoConnection.SendMessage(MongoRequestMessage message)
   at MongoDB.Driver.Operations.CommandOperation`1.Execute(MongoConnection connection)
   at MongoDB.Driver.MongoServerInstance.Ping(MongoConnection connection)
   at MongoDB.Driver.MongoServerInstance.Connect()
   at MongoDB.Driver.Internal.DirectMongoServerProxy.Connect(TimeSpan timeout, ReadPreference readPreference)



ManagedPoolThread #13 15:08:29 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #13 15:08:29 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
ManagedPoolThread #18 15:08:29 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #8 15:08:30 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #17 15:08:31 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #11 15:08:32 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
1932 15:08:32 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Core.BackgroundService.Run()

5476 15:08:32 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

5344 15:08:32 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

6832 15:08:32 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

2288 15:08:33 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

3288 15:08:33 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #7 15:08:39 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #7 15:08:39 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
2896 15:08:43 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

1932 15:08:47 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Core.BackgroundService.Run()

5476 15:08:47 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

5344 15:08:47 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

6832 15:08:47 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

2288 15:08:48 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

3288 15:08:48 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

2436 15:08:48 INFO  [Experience Analytics]: Reduce agent found zero sites to process
ManagedPoolThread #13 15:08:49 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #13 15:08:49 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
2896 15:08:58 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #7 15:08:59 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #7 15:08:59 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
1932 15:09:02 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Core.BackgroundService.Run()

5476 15:09:02 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

5344 15:09:02 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

6832 15:09:02 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

2288 15:09:03 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

3288 15:09:03 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #13 15:09:09 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #13 15:09:09 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
2896 15:09:13 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

1932 15:09:17 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Core.BackgroundService.Run()

5476 15:09:17 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

5344 15:09:17 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

6832 15:09:18 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

2288 15:09:18 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

3288 15:09:18 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

 388 15:09:18 INFO  [Path Analyzer](.) Running trail cleanup agent
 388 15:09:18 INFO  [Path Analyzer](.) Running trail cleanup on database
6508 15:09:18 WARN  [Path Analyzer](.) SmartMergeAgent.Execute() returns. No missing date ranges to merge.
2436 15:09:18 INFO  [Experience Analytics]: Reduce agent found zero sites to process
ManagedPoolThread #16 15:09:19 INFO  Job started: Sitecore.Tasks.UrlAgent
ManagedPoolThread #16 15:09:19 INFO  Scheduling.UrlAgent started. Url: http://gathercontent.dev/sitecore/service/keepalive.aspx
ManagedPoolThread #16 15:09:21 INFO  Scheduling.UrlAgent done (received: 561 bytes)
ManagedPoolThread #16 15:09:21 INFO  Job ended: Sitecore.Tasks.UrlAgent (units processed: )
ManagedPoolThread #10 15:09:21 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #10 15:09:21 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
ManagedPoolThread #14 15:09:27 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
2896 15:09:28 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #12 15:09:28 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #15 15:09:29 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #19 15:09:30 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #7 15:09:31 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #7 15:09:31 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
ManagedPoolThread #3 15:09:31 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
1932 15:09:32 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #1 15:09:32 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
5476 15:09:32 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

5344 15:09:32 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

6832 15:09:33 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

2288 15:09:33 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

3288 15:09:33 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #5 15:09:33 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #0 15:09:34 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #9 15:09:35 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #6 15:09:36 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #2 15:09:37 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #17 15:09:38 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #11 15:09:39 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #10 15:09:41 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #10 15:09:41 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
2896 15:09:43 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

1932 15:09:47 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Core.BackgroundService.Run()

5476 15:09:47 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

5344 15:09:48 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

6832 15:09:48 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

2288 15:09:48 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

3288 15:09:48 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

2436 15:09:48 INFO  [Experience Analytics]: Reduce agent found zero sites to process
ManagedPoolThread #7 15:09:51 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #7 15:09:51 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
2896 15:09:58 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #10 15:10:01 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #10 15:10:01 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
1932 15:10:02 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Core.BackgroundService.Run()

5476 15:10:02 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

5344 15:10:03 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

6832 15:10:03 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

2288 15:10:03 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

3288 15:10:03 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #7 15:10:11 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #7 15:10:11 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
2896 15:10:13 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

1932 15:10:17 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Core.BackgroundService.Run()

5476 15:10:17 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

5344 15:10:18 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

6832 15:10:18 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

2288 15:10:18 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

3288 15:10:18 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

2436 15:10:18 INFO  [Experience Analytics]: Reduce agent found zero sites to process
ManagedPoolThread #10 15:10:21 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #10 15:10:21 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
Heartbeat 15:10:21 ERROR MongoDbDictionary.Store() has failed.
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Save(Object value)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbDictionary.Store(Object value)

2896 15:10:28 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #7 15:10:31 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #7 15:10:31 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
1932 15:10:32 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Core.BackgroundService.Run()

5476 15:10:32 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

5344 15:10:33 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

6832 15:10:33 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

2288 15:10:33 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

3288 15:10:33 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #1 15:10:37 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #3 15:10:38 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #5 15:10:39 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #15 15:10:40 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #10 15:10:41 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #10 15:10:41 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
ManagedPoolThread #0 15:10:41 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #19 15:10:42 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #12 15:10:43 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #14 15:10:44 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #9 15:10:45 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #6 15:10:46 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
1932 15:10:47 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Core.BackgroundService.Run()

5476 15:10:47 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #2 15:10:47 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
5344 15:10:48 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

6832 15:10:48 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

2288 15:10:48 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

3288 15:10:48 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

2436 15:10:48 INFO  [Experience Analytics]: Reduce agent found zero sites to process
ManagedPoolThread #17 15:10:48 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #18 15:10:49 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #11 15:10:50 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #7 15:10:51 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #7 15:10:51 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
ManagedPoolThread #8 15:10:51 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
2896 15:10:52 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
2896 15:10:52 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.HandleDatabaseException(ExceptionBehavior exceptionBehavior, Exception ex)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

Nested Exception

Exception: MongoDB.Driver.MongoConnectionException
Message: Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
Source: MongoDB.Driver
   at MongoDB.Driver.Internal.DirectMongoServerProxy.Connect(TimeSpan timeout, ReadPreference readPreference)
   at MongoDB.Driver.Internal.DirectMongoServerProxy.ChooseServerInstance(ReadPreference readPreference)
   at MongoDB.Driver.MongoServer.AcquireConnection(ReadPreference readPreference)
   at MongoDB.Driver.MongoCollection.RunCommandAs[TCommandResult](IMongoCommand command, ReadPreference readPreference, IBsonSerializer resultSerializer, IBsonSerializationOptions resultSerializationOptions)
   at MongoDB.Driver.MongoCollection.RunCommandAs[TCommandResult](IMongoCommand command, ReadPreference readPreference)
   at MongoDB.Driver.MongoCollection.FindAndModify(FindAndModifyArgs args)
   at MongoDB.Driver.MongoCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.<>c__DisplayClass2c.<FindAndModify>b__2b()
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)

Nested Exception

Exception: System.Net.Sockets.SocketException
Message: No connection could be made because the target machine actively refused it 127.0.0.1:27017
Source: System
   at System.Net.Sockets.Socket.DoConnect(EndPoint endPointSnapshot, SocketAddress socketAddress)
   at System.Net.Sockets.Socket.Connect(EndPoint remoteEP)
   at System.Net.Sockets.TcpClient.Connect(IPEndPoint remoteEP)
   at MongoDB.Driver.Internal.MongoConnection.Open()
   at MongoDB.Driver.Internal.MongoConnection.SendMessage(BsonBuffer buffer, Int32 requestId)
   at MongoDB.Driver.Internal.MongoConnection.SendMessage(MongoRequestMessage message)
   at MongoDB.Driver.Operations.CommandOperation`1.Execute(MongoConnection connection)
   at MongoDB.Driver.MongoServerInstance.Ping(MongoConnection connection)
   at MongoDB.Driver.MongoServerInstance.Connect()
   at MongoDB.Driver.Internal.DirectMongoServerProxy.Connect(TimeSpan timeout, ReadPreference readPreference)



ManagedPoolThread #10 15:11:01 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #10 15:11:01 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
1932 15:11:02 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Core.BackgroundService.Run()

5476 15:11:02 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

5344 15:11:03 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

6832 15:11:03 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

2288 15:11:03 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

3288 15:11:03 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

2896 15:11:07 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #7 15:11:11 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #7 15:11:11 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
1932 15:11:17 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Core.BackgroundService.Run()

5476 15:11:17 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

5344 15:11:18 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

6832 15:11:18 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

2288 15:11:18 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

3288 15:11:18 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

2436 15:11:18 INFO  [Experience Analytics]: Reduce agent found zero sites to process
ManagedPoolThread #10 15:11:21 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #10 15:11:21 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
2896 15:11:22 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #7 15:11:31 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #7 15:11:31 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
1932 15:11:32 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Core.BackgroundService.Run()

5476 15:11:32 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

5344 15:11:33 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

6832 15:11:33 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

2288 15:11:33 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

3288 15:11:33 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

2896 15:11:37 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #10 15:11:41 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #10 15:11:41 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
ManagedPoolThread #9 15:11:47 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
5344 15:11:48 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

6832 15:11:48 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

2288 15:11:48 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

3288 15:11:48 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

2436 15:11:48 INFO  [Experience Analytics]: Reduce agent found zero sites to process
ManagedPoolThread #6 15:11:48 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #12 15:11:49 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #14 15:11:51 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #7 15:11:51 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #7 15:11:51 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
ManagedPoolThread #19 15:11:52 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #0 15:11:53 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #5 15:11:54 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #15 15:11:55 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #1 15:11:56 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #3 15:11:57 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
6928 15:11:58 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
1932 15:11:59 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: MongoDB.Driver.MongoConnectionException
Message: Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
Source: MongoDB.Driver
   at MongoDB.Driver.Internal.DirectMongoServerProxy.Connect(TimeSpan timeout, ReadPreference readPreference)
   at MongoDB.Driver.Internal.DirectMongoServerProxy.ChooseServerInstance(ReadPreference readPreference)
   at MongoDB.Driver.MongoServer.AcquireConnection(ReadPreference readPreference)
   at MongoDB.Driver.MongoCursor`1.MongoCursorConnectionProvider.AcquireConnection()
   at MongoDB.Driver.Operations.QueryOperation`1.GetFirstBatch(IConnectionProvider connectionProvider)
   at MongoDB.Driver.Operations.QueryOperation`1.Execute(IConnectionProvider connectionProvider)
   at System.Linq.Enumerable.FirstOrDefault[TSource](IEnumerable`1 source)
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Core.BackgroundService.Run()

Nested Exception

Exception: System.Net.Sockets.SocketException
Message: No connection could be made because the target machine actively refused it 127.0.0.1:27017
Source: System
   at System.Net.Sockets.Socket.DoConnect(EndPoint endPointSnapshot, SocketAddress socketAddress)
   at System.Net.Sockets.Socket.Connect(EndPoint remoteEP)
   at System.Net.Sockets.TcpClient.Connect(IPEndPoint remoteEP)
   at MongoDB.Driver.Internal.MongoConnection.Open()
   at MongoDB.Driver.Internal.MongoConnection.SendMessage(BsonBuffer buffer, Int32 requestId)
   at MongoDB.Driver.Internal.MongoConnection.SendMessage(MongoRequestMessage message)
   at MongoDB.Driver.Operations.CommandOperation`1.Execute(MongoConnection connection)
   at MongoDB.Driver.MongoServerInstance.Ping(MongoConnection connection)
   at MongoDB.Driver.MongoServerInstance.Connect()
   at MongoDB.Driver.Internal.DirectMongoServerProxy.Connect(TimeSpan timeout, ReadPreference readPreference)


5476 15:12:00 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: MongoDB.Driver.MongoConnectionException
Message: Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
Source: MongoDB.Driver
   at MongoDB.Driver.Internal.DirectMongoServerProxy.Connect(TimeSpan timeout, ReadPreference readPreference)
   at MongoDB.Driver.Internal.DirectMongoServerProxy.ChooseServerInstance(ReadPreference readPreference)
   at MongoDB.Driver.MongoServer.AcquireConnection(ReadPreference readPreference)
   at MongoDB.Driver.MongoCursor`1.MongoCursorConnectionProvider.AcquireConnection()
   at MongoDB.Driver.Operations.QueryOperation`1.GetFirstBatch(IConnectionProvider connectionProvider)
   at MongoDB.Driver.Operations.QueryOperation`1.Execute(IConnectionProvider connectionProvider)
   at System.Linq.Enumerable.FirstOrDefault[TSource](IEnumerable`1 source)
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

Nested Exception

Exception: System.Net.Sockets.SocketException
Message: No connection could be made because the target machine actively refused it 127.0.0.1:27017
Source: System
   at System.Net.Sockets.Socket.DoConnect(EndPoint endPointSnapshot, SocketAddress socketAddress)
   at System.Net.Sockets.Socket.Connect(EndPoint remoteEP)
   at System.Net.Sockets.TcpClient.Connect(IPEndPoint remoteEP)
   at MongoDB.Driver.Internal.MongoConnection.Open()
   at MongoDB.Driver.Internal.MongoConnection.SendMessage(BsonBuffer buffer, Int32 requestId)
   at MongoDB.Driver.Internal.MongoConnection.SendMessage(MongoRequestMessage message)
   at MongoDB.Driver.Operations.CommandOperation`1.Execute(MongoConnection connection)
   at MongoDB.Driver.MongoServerInstance.Ping(MongoConnection connection)
   at MongoDB.Driver.MongoServerInstance.Connect()
   at MongoDB.Driver.Internal.DirectMongoServerProxy.Connect(TimeSpan timeout, ReadPreference readPreference)


ManagedPoolThread #2 15:12:01 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #10 15:12:01 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #10 15:12:01 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
5140 15:12:02 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
5344 15:12:03 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

6832 15:12:03 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #8 15:12:03 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
2288 15:12:03 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

3288 15:12:03 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

2896 15:12:04 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
2896 15:12:04 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.HandleDatabaseException(ExceptionBehavior exceptionBehavior, Exception ex)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

Nested Exception

Exception: MongoDB.Driver.MongoConnectionException
Message: Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
Source: MongoDB.Driver
   at MongoDB.Driver.Internal.DirectMongoServerProxy.Connect(TimeSpan timeout, ReadPreference readPreference)
   at MongoDB.Driver.Internal.DirectMongoServerProxy.ChooseServerInstance(ReadPreference readPreference)
   at MongoDB.Driver.MongoServer.AcquireConnection(ReadPreference readPreference)
   at MongoDB.Driver.MongoCollection.RunCommandAs[TCommandResult](IMongoCommand command, ReadPreference readPreference, IBsonSerializer resultSerializer, IBsonSerializationOptions resultSerializationOptions)
   at MongoDB.Driver.MongoCollection.RunCommandAs[TCommandResult](IMongoCommand command, ReadPreference readPreference)
   at MongoDB.Driver.MongoCollection.FindAndModify(FindAndModifyArgs args)
   at MongoDB.Driver.MongoCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.<>c__DisplayClass2c.<FindAndModify>b__2b()
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)

Nested Exception

Exception: System.Net.Sockets.SocketException
Message: No connection could be made because the target machine actively refused it 127.0.0.1:27017
Source: System
   at System.Net.Sockets.Socket.DoConnect(EndPoint endPointSnapshot, SocketAddress socketAddress)
   at System.Net.Sockets.Socket.Connect(EndPoint remoteEP)
   at System.Net.Sockets.TcpClient.Connect(IPEndPoint remoteEP)
   at MongoDB.Driver.Internal.MongoConnection.Open()
   at MongoDB.Driver.Internal.MongoConnection.SendMessage(BsonBuffer buffer, Int32 requestId)
   at MongoDB.Driver.Internal.MongoConnection.SendMessage(MongoRequestMessage message)
   at MongoDB.Driver.Operations.CommandOperation`1.Execute(MongoConnection connection)
   at MongoDB.Driver.MongoServerInstance.Ping(MongoConnection connection)
   at MongoDB.Driver.MongoServerInstance.Connect()
   at MongoDB.Driver.Internal.DirectMongoServerProxy.Connect(TimeSpan timeout, ReadPreference readPreference)



ManagedPoolThread #17 15:12:05 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #18 15:12:06 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #11 15:12:07 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #7 15:12:11 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #7 15:12:11 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
1932 15:12:14 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Core.BackgroundService.Run()

5476 15:12:15 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

5344 15:12:18 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

6832 15:12:18 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

2288 15:12:18 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

3288 15:12:18 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

2436 15:12:18 INFO  [Experience Analytics]: Reduce agent found zero sites to process
2896 15:12:19 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #13 15:12:21 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #13 15:12:21 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
Heartbeat 15:12:25 ERROR MongoDbDictionary.Store() has failed.
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Save(Object value)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbDictionary.Store(Object value)

1932 15:12:29 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Core.BackgroundService.Run()

5476 15:12:30 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #10 15:12:31 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #10 15:12:31 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
5344 15:12:33 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

6832 15:12:33 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

2288 15:12:33 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

3288 15:12:33 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

2896 15:12:34 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #7 15:12:41 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #7 15:12:41 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
1932 15:12:44 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Core.BackgroundService.Run()

5476 15:12:45 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

5344 15:12:48 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

6832 15:12:48 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

2288 15:12:48 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

3288 15:12:48 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

2436 15:12:48 INFO  [Experience Analytics]: Reduce agent found zero sites to process
2896 15:12:49 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #10 15:12:51 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #10 15:12:51 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
1932 15:12:59 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Core.BackgroundService.Run()

5476 15:13:00 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #7 15:13:01 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #7 15:13:01 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
ManagedPoolThread #2 15:13:02 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #6 15:13:03 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
2288 15:13:03 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

3288 15:13:03 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

2896 15:13:04 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

5140 15:13:04 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #9 15:13:05 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #12 15:13:06 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #14 15:13:07 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #19 15:13:08 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #0 15:13:09 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #15 15:13:10 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #5 15:13:11 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #10 15:13:11 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #10 15:13:11 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
ManagedPoolThread #1 15:13:12 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #3 15:13:13 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
1932 15:13:14 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Core.BackgroundService.Run()

5344 15:13:14 ERROR Exception when executing agent aggregation/automationAggregator
Exception: MongoDB.Driver.MongoConnectionException
Message: Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
Source: MongoDB.Driver
   at MongoDB.Driver.Internal.DirectMongoServerProxy.Connect(TimeSpan timeout, ReadPreference readPreference)
   at MongoDB.Driver.Internal.DirectMongoServerProxy.ChooseServerInstance(ReadPreference readPreference)
   at MongoDB.Driver.MongoServer.AcquireConnection(ReadPreference readPreference)
   at MongoDB.Driver.MongoCursor`1.MongoCursorConnectionProvider.AcquireConnection()
   at MongoDB.Driver.Operations.QueryOperation`1.GetFirstBatch(IConnectionProvider connectionProvider)
   at MongoDB.Driver.Operations.QueryOperation`1.Execute(IConnectionProvider connectionProvider)
   at System.Linq.Buffer`1..ctor(IEnumerable`1 source)
   at System.Linq.Enumerable.ToArray[TSource](IEnumerable`1 source)
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

Nested Exception

Exception: System.Net.Sockets.SocketException
Message: No connection could be made because the target machine actively refused it 127.0.0.1:27017
Source: System
   at System.Net.Sockets.Socket.DoConnect(EndPoint endPointSnapshot, SocketAddress socketAddress)
   at System.Net.Sockets.Socket.Connect(EndPoint remoteEP)
   at System.Net.Sockets.TcpClient.Connect(IPEndPoint remoteEP)
   at MongoDB.Driver.Internal.MongoConnection.Open()
   at MongoDB.Driver.Internal.MongoConnection.SendMessage(BsonBuffer buffer, Int32 requestId)
   at MongoDB.Driver.Internal.MongoConnection.SendMessage(MongoRequestMessage message)
   at MongoDB.Driver.Operations.CommandOperation`1.Execute(MongoConnection connection)
   at MongoDB.Driver.MongoServerInstance.Ping(MongoConnection connection)
   at MongoDB.Driver.MongoServerInstance.Connect()
   at MongoDB.Driver.Internal.DirectMongoServerProxy.Connect(TimeSpan timeout, ReadPreference readPreference)


5476 15:13:15 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

6832 15:13:15 ERROR Exception when executing agent aggregation/automationAggregator
Exception: MongoDB.Driver.MongoConnectionException
Message: Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
Source: MongoDB.Driver
   at MongoDB.Driver.Internal.DirectMongoServerProxy.Connect(TimeSpan timeout, ReadPreference readPreference)
   at MongoDB.Driver.Internal.DirectMongoServerProxy.ChooseServerInstance(ReadPreference readPreference)
   at MongoDB.Driver.MongoServer.AcquireConnection(ReadPreference readPreference)
   at MongoDB.Driver.MongoCursor`1.MongoCursorConnectionProvider.AcquireConnection()
   at MongoDB.Driver.Operations.QueryOperation`1.GetFirstBatch(IConnectionProvider connectionProvider)
   at MongoDB.Driver.Operations.QueryOperation`1.Execute(IConnectionProvider connectionProvider)
   at System.Linq.Buffer`1..ctor(IEnumerable`1 source)
   at System.Linq.Enumerable.ToArray[TSource](IEnumerable`1 source)
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

Nested Exception

Exception: System.Net.Sockets.SocketException
Message: No connection could be made because the target machine actively refused it 127.0.0.1:27017
Source: System
   at System.Net.Sockets.Socket.DoConnect(EndPoint endPointSnapshot, SocketAddress socketAddress)
   at System.Net.Sockets.Socket.Connect(EndPoint remoteEP)
   at System.Net.Sockets.TcpClient.Connect(IPEndPoint remoteEP)
   at MongoDB.Driver.Internal.MongoConnection.Open()
   at MongoDB.Driver.Internal.MongoConnection.SendMessage(BsonBuffer buffer, Int32 requestId)
   at MongoDB.Driver.Internal.MongoConnection.SendMessage(MongoRequestMessage message)
   at MongoDB.Driver.Operations.CommandOperation`1.Execute(MongoConnection connection)
   at MongoDB.Driver.MongoServerInstance.Ping(MongoConnection connection)
   at MongoDB.Driver.MongoServerInstance.Connect()
   at MongoDB.Driver.Internal.DirectMongoServerProxy.Connect(TimeSpan timeout, ReadPreference readPreference)


ManagedPoolThread #18 15:13:16 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #11 15:13:17 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
2288 15:13:18 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #8 15:13:18 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
3288 15:13:18 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

2436 15:13:18 INFO  [Experience Analytics]: Reduce agent found zero sites to process
2896 15:13:19 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #17 15:13:19 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #7 15:13:21 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #7 15:13:21 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
1932 15:13:29 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Core.BackgroundService.Run()

5344 15:13:29 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

5476 15:13:30 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

6832 15:13:30 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #10 15:13:31 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #10 15:13:31 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
2288 15:13:33 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

3288 15:13:33 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

2896 15:13:34 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #7 15:13:41 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #7 15:13:41 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
1932 15:13:44 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Core.BackgroundService.Run()

5344 15:13:44 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

5476 15:13:45 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

6832 15:13:45 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

2288 15:13:48 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

3288 15:13:48 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

2436 15:13:48 INFO  [Experience Analytics]: Reduce agent found zero sites to process
2896 15:13:49 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #10 15:13:51 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #10 15:13:51 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
1932 15:13:59 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Core.BackgroundService.Run()

5344 15:13:59 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

5476 15:14:00 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

6832 15:14:00 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #7 15:14:01 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #7 15:14:01 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
ManagedPoolThread #2 15:14:03 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
2288 15:14:03 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

3288 15:14:03 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

2896 15:14:04 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #10 15:14:11 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #10 15:14:11 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
ManagedPoolThread #6 15:14:14 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
5476 15:14:15 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

6832 15:14:15 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #19 15:14:15 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
Heartbeat 15:14:15 INFO  Health.PrivateBytes: 668,528,640
Heartbeat 15:14:15 INFO  Health.CacheInstances: 116
Heartbeat 15:14:15 INFO  Health.CacheTotalCount: 21,146
Heartbeat 15:14:15 INFO  Health.CacheTotalSize: 84,485,258
ManagedPoolThread #14 15:14:16 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #9 15:14:17 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
2288 15:14:18 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

3288 15:14:18 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #12 15:14:18 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
 388 15:14:18 INFO  [Path Analyzer](.) Running trail cleanup agent
 388 15:14:18 INFO  [Path Analyzer](.) Running trail cleanup on database
2436 15:14:18 INFO  [Experience Analytics]: Reduce agent found zero sites to process
2896 15:14:19 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #0 15:14:19 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #5 15:14:20 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #15 15:14:21 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #7 15:14:21 INFO  Job started: Sitecore.Tasks.TaskDatabaseAgent
ManagedPoolThread #7 15:14:21 INFO  Processing tasks (count: 0)
ManagedPoolThread #7 15:14:21 INFO  Job ended: Sitecore.Tasks.TaskDatabaseAgent (units processed: )
ManagedPoolThread #7 15:14:21 INFO  Job started: Core_Database_Agent
ManagedPoolThread #7 15:14:21 INFO  Scheduling.DatabaseAgent started. Database: core
ManagedPoolThread #7 15:14:21 INFO  Examining schedules (count: 0)
ManagedPoolThread #7 15:14:21 INFO  Job ended: Core_Database_Agent (units processed: )
ManagedPoolThread #10 15:14:21 INFO  Job started: Master_Database_Agent
ManagedPoolThread #10 15:14:21 INFO  Scheduling.DatabaseAgent started. Database: master
ManagedPoolThread #10 15:14:21 INFO  Examining schedules (count: 5)
ManagedPoolThread #10 15:14:21 INFO  Starting: __Task Schedule
ManagedPoolThread #10 15:14:21 INFO  Ended: __Task Schedule
ManagedPoolThread #10 15:14:21 INFO  Not due: Calculate Statistical Relevancy
ManagedPoolThread #10 15:14:21 INFO  Not due: Rebuild Suggested Tests Index
ManagedPoolThread #10 15:14:21 INFO  Not due: Suspend Corrupted Tests
ManagedPoolThread #10 15:14:21 INFO  Not due: Try Finish Test
ManagedPoolThread #10 15:14:21 INFO  Job ended: Master_Database_Agent (units processed: 5)
ManagedPoolThread #7 15:14:21 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #7 15:14:21 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
ManagedPoolThread #3 15:14:22 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #1 15:14:23 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
1932 15:14:25 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: MongoDB.Driver.MongoConnectionException
Message: Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
Source: MongoDB.Driver
   at MongoDB.Driver.Internal.DirectMongoServerProxy.Connect(TimeSpan timeout, ReadPreference readPreference)
   at MongoDB.Driver.Internal.DirectMongoServerProxy.ChooseServerInstance(ReadPreference readPreference)
   at MongoDB.Driver.MongoServer.AcquireConnection(ReadPreference readPreference)
   at MongoDB.Driver.MongoCursor`1.MongoCursorConnectionProvider.AcquireConnection()
   at MongoDB.Driver.Operations.QueryOperation`1.GetFirstBatch(IConnectionProvider connectionProvider)
   at MongoDB.Driver.Operations.QueryOperation`1.Execute(IConnectionProvider connectionProvider)
   at System.Linq.Enumerable.FirstOrDefault[TSource](IEnumerable`1 source)
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Core.BackgroundService.Run()

Nested Exception

Exception: System.Net.Sockets.SocketException
Message: No connection could be made because the target machine actively refused it 127.0.0.1:27017
Source: System
   at System.Net.Sockets.Socket.DoConnect(EndPoint endPointSnapshot, SocketAddress socketAddress)
   at System.Net.Sockets.Socket.Connect(EndPoint remoteEP)
   at System.Net.Sockets.TcpClient.Connect(IPEndPoint remoteEP)
   at MongoDB.Driver.Internal.MongoConnection.Open()
   at MongoDB.Driver.Internal.MongoConnection.SendMessage(BsonBuffer buffer, Int32 requestId)
   at MongoDB.Driver.Internal.MongoConnection.SendMessage(MongoRequestMessage message)
   at MongoDB.Driver.Operations.CommandOperation`1.Execute(MongoConnection connection)
   at MongoDB.Driver.MongoServerInstance.Ping(MongoConnection connection)
   at MongoDB.Driver.MongoServerInstance.Connect()
   at MongoDB.Driver.Internal.DirectMongoServerProxy.Connect(TimeSpan timeout, ReadPreference readPreference)


Heartbeat 15:14:25 ERROR MongoDbDictionary.Store() has failed.
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Save(Object value)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbDictionary.Store(Object value)

5344 15:14:26 ERROR Exception when executing agent aggregation/automationAggregator
Exception: MongoDB.Driver.MongoConnectionException
Message: Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
Source: MongoDB.Driver
   at MongoDB.Driver.Internal.DirectMongoServerProxy.Connect(TimeSpan timeout, ReadPreference readPreference)
   at MongoDB.Driver.Internal.DirectMongoServerProxy.ChooseServerInstance(ReadPreference readPreference)
   at MongoDB.Driver.MongoServer.AcquireConnection(ReadPreference readPreference)
   at MongoDB.Driver.MongoCursor`1.MongoCursorConnectionProvider.AcquireConnection()
   at MongoDB.Driver.Operations.QueryOperation`1.GetFirstBatch(IConnectionProvider connectionProvider)
   at MongoDB.Driver.Operations.QueryOperation`1.Execute(IConnectionProvider connectionProvider)
   at System.Linq.Buffer`1..ctor(IEnumerable`1 source)
   at System.Linq.Enumerable.ToArray[TSource](IEnumerable`1 source)
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

Nested Exception

Exception: System.Net.Sockets.SocketException
Message: No connection could be made because the target machine actively refused it 127.0.0.1:27017
Source: System
   at System.Net.Sockets.Socket.DoConnect(EndPoint endPointSnapshot, SocketAddress socketAddress)
   at System.Net.Sockets.Socket.Connect(EndPoint remoteEP)
   at System.Net.Sockets.TcpClient.Connect(IPEndPoint remoteEP)
   at MongoDB.Driver.Internal.MongoConnection.Open()
   at MongoDB.Driver.Internal.MongoConnection.SendMessage(BsonBuffer buffer, Int32 requestId)
   at MongoDB.Driver.Internal.MongoConnection.SendMessage(MongoRequestMessage message)
   at MongoDB.Driver.Operations.CommandOperation`1.Execute(MongoConnection connection)
   at MongoDB.Driver.MongoServerInstance.Ping(MongoConnection connection)
   at MongoDB.Driver.MongoServerInstance.Connect()
   at MongoDB.Driver.Internal.DirectMongoServerProxy.Connect(TimeSpan timeout, ReadPreference readPreference)


ManagedPoolThread #8 15:14:27 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #17 15:14:28 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #18 15:14:29 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
5476 15:14:30 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

6832 15:14:30 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #11 15:14:30 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #7 15:14:31 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #7 15:14:31 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
2288 15:14:33 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

3288 15:14:33 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

2896 15:14:34 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

1932 15:14:40 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Core.BackgroundService.Run()

5344 15:14:41 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #16 15:14:41 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #16 15:14:41 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
5476 15:14:45 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

6832 15:14:45 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

2288 15:14:48 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

3288 15:14:48 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

2436 15:14:48 INFO  [Experience Analytics]: Reduce agent found zero sites to process
2896 15:14:49 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #7 15:14:51 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #7 15:14:51 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
1932 15:14:55 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Core.BackgroundService.Run()

5344 15:14:56 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

5476 15:15:00 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

6832 15:15:00 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #13 15:15:01 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #13 15:15:01 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
2288 15:15:03 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

3288 15:15:03 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #2 15:15:04 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
2896 15:15:04 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

1932 15:15:10 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Core.BackgroundService.Run()

5344 15:15:11 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #10 15:15:11 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #10 15:15:11 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
5476 15:15:15 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

6832 15:15:15 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

2288 15:15:18 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

3288 15:15:18 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

2436 15:15:19 INFO  [Experience Analytics]: Reduce agent found zero sites to process
2896 15:15:19 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #16 15:15:21 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #16 15:15:21 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
ManagedPoolThread #6 15:15:24 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
1932 15:15:25 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #19 15:15:25 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
5344 15:15:26 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #14 15:15:26 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #9 15:15:27 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #12 15:15:28 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #5 15:15:29 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
5476 15:15:30 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

6832 15:15:30 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #0 15:15:30 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #15 15:15:31 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #13 15:15:31 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #13 15:15:31 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
ManagedPoolThread #3 15:15:32 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
2288 15:15:33 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

3288 15:15:33 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #1 15:15:33 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #18 15:15:34 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #11 15:15:35 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
2896 15:15:36 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
2896 15:15:36 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.HandleDatabaseException(ExceptionBehavior exceptionBehavior, Exception ex)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

Nested Exception

Exception: MongoDB.Driver.MongoConnectionException
Message: Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
Source: MongoDB.Driver
   at MongoDB.Driver.Internal.DirectMongoServerProxy.Connect(TimeSpan timeout, ReadPreference readPreference)
   at MongoDB.Driver.Internal.DirectMongoServerProxy.ChooseServerInstance(ReadPreference readPreference)
   at MongoDB.Driver.MongoServer.AcquireConnection(ReadPreference readPreference)
   at MongoDB.Driver.MongoCollection.RunCommandAs[TCommandResult](IMongoCommand command, ReadPreference readPreference, IBsonSerializer resultSerializer, IBsonSerializationOptions resultSerializationOptions)
   at MongoDB.Driver.MongoCollection.RunCommandAs[TCommandResult](IMongoCommand command, ReadPreference readPreference)
   at MongoDB.Driver.MongoCollection.FindAndModify(FindAndModifyArgs args)
   at MongoDB.Driver.MongoCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.<>c__DisplayClass2c.<FindAndModify>b__2b()
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)

Nested Exception

Exception: System.Net.Sockets.SocketException
Message: No connection could be made because the target machine actively refused it 127.0.0.1:27017
Source: System
   at System.Net.Sockets.Socket.DoConnect(EndPoint endPointSnapshot, SocketAddress socketAddress)
   at System.Net.Sockets.Socket.Connect(EndPoint remoteEP)
   at System.Net.Sockets.TcpClient.Connect(IPEndPoint remoteEP)
   at MongoDB.Driver.Internal.MongoConnection.Open()
   at MongoDB.Driver.Internal.MongoConnection.SendMessage(BsonBuffer buffer, Int32 requestId)
   at MongoDB.Driver.Internal.MongoConnection.SendMessage(MongoRequestMessage message)
   at MongoDB.Driver.Operations.CommandOperation`1.Execute(MongoConnection connection)
   at MongoDB.Driver.MongoServerInstance.Ping(MongoConnection connection)
   at MongoDB.Driver.MongoServerInstance.Connect()
   at MongoDB.Driver.Internal.DirectMongoServerProxy.Connect(TimeSpan timeout, ReadPreference readPreference)



1932 15:15:40 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Core.BackgroundService.Run()

5344 15:15:41 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #10 15:15:41 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #10 15:15:41 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
5476 15:15:45 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

6832 15:15:45 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

2288 15:15:48 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

3288 15:15:48 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

2436 15:15:49 INFO  [Experience Analytics]: Reduce agent found zero sites to process
2896 15:15:51 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #13 15:15:51 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #13 15:15:51 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
1932 15:15:55 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Core.BackgroundService.Run()

5344 15:15:56 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

5476 15:16:00 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

6832 15:16:00 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #16 15:16:01 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #16 15:16:01 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
2288 15:16:03 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

3288 15:16:03 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #2 15:16:05 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
2896 15:16:06 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

1932 15:16:10 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Core.BackgroundService.Run()

5344 15:16:11 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #7 15:16:11 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #7 15:16:11 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
5476 15:16:15 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

6832 15:16:15 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

2288 15:16:18 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

3288 15:16:18 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

2436 15:16:19 INFO  [Experience Analytics]: Reduce agent found zero sites to process
2896 15:16:21 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #16 15:16:21 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #16 15:16:21 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
1932 15:16:25 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Core.BackgroundService.Run()

Heartbeat 15:16:25 ERROR MongoDbDictionary.Store() has failed.
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Save(Object value)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbDictionary.Store(Object value)

5344 15:16:26 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

5476 15:16:30 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

6832 15:16:30 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #7 15:16:31 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #7 15:16:31 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
2288 15:16:33 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

3288 15:16:33 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #6 15:16:34 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #19 15:16:35 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #14 15:16:36 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #9 15:16:37 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #12 15:16:38 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #0 15:16:39 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
1932 15:16:40 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #5 15:16:40 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
5344 15:16:41 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #15 15:16:41 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #10 15:16:41 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #10 15:16:41 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
ManagedPoolThread #3 15:16:42 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #1 15:16:43 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
5140 15:16:44 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
5476 15:16:45 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

6832 15:16:45 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #11 15:16:45 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
2896 15:16:46 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
2896 15:16:46 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.HandleDatabaseException(ExceptionBehavior exceptionBehavior, Exception ex)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

Nested Exception

Exception: MongoDB.Driver.MongoConnectionException
Message: Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
Source: MongoDB.Driver
   at MongoDB.Driver.Internal.DirectMongoServerProxy.Connect(TimeSpan timeout, ReadPreference readPreference)
   at MongoDB.Driver.Internal.DirectMongoServerProxy.ChooseServerInstance(ReadPreference readPreference)
   at MongoDB.Driver.MongoServer.AcquireConnection(ReadPreference readPreference)
   at MongoDB.Driver.MongoCollection.RunCommandAs[TCommandResult](IMongoCommand command, ReadPreference readPreference, IBsonSerializer resultSerializer, IBsonSerializationOptions resultSerializationOptions)
   at MongoDB.Driver.MongoCollection.RunCommandAs[TCommandResult](IMongoCommand command, ReadPreference readPreference)
   at MongoDB.Driver.MongoCollection.FindAndModify(FindAndModifyArgs args)
   at MongoDB.Driver.MongoCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.<>c__DisplayClass2c.<FindAndModify>b__2b()
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)

Nested Exception

Exception: System.Net.Sockets.SocketException
Message: No connection could be made because the target machine actively refused it 127.0.0.1:27017
Source: System
   at System.Net.Sockets.Socket.DoConnect(EndPoint endPointSnapshot, SocketAddress socketAddress)
   at System.Net.Sockets.Socket.Connect(EndPoint remoteEP)
   at System.Net.Sockets.TcpClient.Connect(IPEndPoint remoteEP)
   at MongoDB.Driver.Internal.MongoConnection.Open()
   at MongoDB.Driver.Internal.MongoConnection.SendMessage(BsonBuffer buffer, Int32 requestId)
   at MongoDB.Driver.Internal.MongoConnection.SendMessage(MongoRequestMessage message)
   at MongoDB.Driver.Operations.CommandOperation`1.Execute(MongoConnection connection)
   at MongoDB.Driver.MongoServerInstance.Ping(MongoConnection connection)
   at MongoDB.Driver.MongoServerInstance.Connect()
   at MongoDB.Driver.Internal.DirectMongoServerProxy.Connect(TimeSpan timeout, ReadPreference readPreference)



ManagedPoolThread #8 15:16:47 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
2288 15:16:48 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

3288 15:16:48 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #17 15:16:48 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
2436 15:16:49 INFO  [Experience Analytics]: Reduce agent found zero sites to process
ManagedPoolThread #18 15:16:49 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #13 15:16:51 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #13 15:16:51 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
1932 15:16:55 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Core.BackgroundService.Run()

5344 15:16:56 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

5476 15:17:00 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

6832 15:17:00 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

2896 15:17:01 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #10 15:17:01 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #10 15:17:01 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
2288 15:17:03 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

3288 15:17:03 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #2 15:17:06 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
1932 15:17:10 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Core.BackgroundService.Run()

5344 15:17:11 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #13 15:17:11 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #13 15:17:11 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
5476 15:17:15 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

6832 15:17:15 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

2896 15:17:16 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

2288 15:17:18 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

3288 15:17:18 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

2436 15:17:19 INFO  [Experience Analytics]: Reduce agent found zero sites to process
ManagedPoolThread #10 15:17:21 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #10 15:17:21 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
1932 15:17:25 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Core.BackgroundService.Run()

5344 15:17:26 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

5476 15:17:30 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

6832 15:17:30 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

2896 15:17:31 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #13 15:17:31 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #13 15:17:31 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
2288 15:17:33 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

3288 15:17:33 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

1932 15:17:40 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Core.BackgroundService.Run()

5344 15:17:41 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #7 15:17:41 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #7 15:17:41 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
ManagedPoolThread #6 15:17:45 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #19 15:17:46 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
2896 15:17:46 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #14 15:17:47 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
2288 15:17:48 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

3288 15:17:48 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

5140 15:17:48 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
2436 15:17:49 INFO  [Experience Analytics]: Reduce agent found zero sites to process
ManagedPoolThread #9 15:17:49 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #12 15:17:50 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #0 15:17:51 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #16 15:17:51 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #16 15:17:51 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
ManagedPoolThread #5 15:17:52 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #1 15:17:53 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #15 15:17:54 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
1932 15:17:55 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #3 15:17:55 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
5344 15:17:56 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

5476 15:17:56 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: MongoDB.Driver.MongoConnectionException
Message: Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
Source: MongoDB.Driver
   at MongoDB.Driver.Internal.DirectMongoServerProxy.Connect(TimeSpan timeout, ReadPreference readPreference)
   at MongoDB.Driver.Internal.DirectMongoServerProxy.ChooseServerInstance(ReadPreference readPreference)
   at MongoDB.Driver.MongoServer.AcquireConnection(ReadPreference readPreference)
   at MongoDB.Driver.MongoCursor`1.MongoCursorConnectionProvider.AcquireConnection()
   at MongoDB.Driver.Operations.QueryOperation`1.GetFirstBatch(IConnectionProvider connectionProvider)
   at MongoDB.Driver.Operations.QueryOperation`1.Execute(IConnectionProvider connectionProvider)
   at System.Linq.Enumerable.FirstOrDefault[TSource](IEnumerable`1 source)
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

Nested Exception

Exception: System.Net.Sockets.SocketException
Message: No connection could be made because the target machine actively refused it 127.0.0.1:27017
Source: System
   at System.Net.Sockets.Socket.DoConnect(EndPoint endPointSnapshot, SocketAddress socketAddress)
   at System.Net.Sockets.Socket.Connect(EndPoint remoteEP)
   at System.Net.Sockets.TcpClient.Connect(IPEndPoint remoteEP)
   at MongoDB.Driver.Internal.MongoConnection.Open()
   at MongoDB.Driver.Internal.MongoConnection.SendMessage(BsonBuffer buffer, Int32 requestId)
   at MongoDB.Driver.Internal.MongoConnection.SendMessage(MongoRequestMessage message)
   at MongoDB.Driver.Operations.CommandOperation`1.Execute(MongoConnection connection)
   at MongoDB.Driver.MongoServerInstance.Ping(MongoConnection connection)
   at MongoDB.Driver.MongoServerInstance.Connect()
   at MongoDB.Driver.Internal.DirectMongoServerProxy.Connect(TimeSpan timeout, ReadPreference readPreference)


6832 15:17:57 ERROR Exception when executing agent aggregation/automationAggregator
Exception: MongoDB.Driver.MongoConnectionException
Message: Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
Source: MongoDB.Driver
   at MongoDB.Driver.Internal.DirectMongoServerProxy.Connect(TimeSpan timeout, ReadPreference readPreference)
   at MongoDB.Driver.Internal.DirectMongoServerProxy.ChooseServerInstance(ReadPreference readPreference)
   at MongoDB.Driver.MongoServer.AcquireConnection(ReadPreference readPreference)
   at MongoDB.Driver.MongoCursor`1.MongoCursorConnectionProvider.AcquireConnection()
   at MongoDB.Driver.Operations.QueryOperation`1.GetFirstBatch(IConnectionProvider connectionProvider)
   at MongoDB.Driver.Operations.QueryOperation`1.Execute(IConnectionProvider connectionProvider)
   at System.Linq.Buffer`1..ctor(IEnumerable`1 source)
   at System.Linq.Enumerable.ToArray[TSource](IEnumerable`1 source)
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

Nested Exception

Exception: System.Net.Sockets.SocketException
Message: No connection could be made because the target machine actively refused it 127.0.0.1:27017
Source: System
   at System.Net.Sockets.Socket.DoConnect(EndPoint endPointSnapshot, SocketAddress socketAddress)
   at System.Net.Sockets.Socket.Connect(EndPoint remoteEP)
   at System.Net.Sockets.TcpClient.Connect(IPEndPoint remoteEP)
   at MongoDB.Driver.Internal.MongoConnection.Open()
   at MongoDB.Driver.Internal.MongoConnection.SendMessage(BsonBuffer buffer, Int32 requestId)
   at MongoDB.Driver.Internal.MongoConnection.SendMessage(MongoRequestMessage message)
   at MongoDB.Driver.Operations.CommandOperation`1.Execute(MongoConnection connection)
   at MongoDB.Driver.MongoServerInstance.Ping(MongoConnection connection)
   at MongoDB.Driver.MongoServerInstance.Connect()
   at MongoDB.Driver.Internal.DirectMongoServerProxy.Connect(TimeSpan timeout, ReadPreference readPreference)


ManagedPoolThread #8 15:17:58 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #18 15:17:59 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #11 15:18:00 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
2896 15:18:01 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #17 15:18:01 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #10 15:18:01 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #10 15:18:01 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
2288 15:18:03 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

3288 15:18:03 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #2 15:18:07 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
1932 15:18:10 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Core.BackgroundService.Run()

5344 15:18:11 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

5476 15:18:11 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #13 15:18:11 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #13 15:18:11 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
6832 15:18:12 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

2896 15:18:16 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

2288 15:18:18 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

3288 15:18:18 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

2436 15:18:19 INFO  [Experience Analytics]: Reduce agent found zero sites to process
ManagedPoolThread #7 15:18:21 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #7 15:18:21 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
1932 15:18:25 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Core.BackgroundService.Run()

5344 15:18:26 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

5476 15:18:26 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

6832 15:18:27 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

Heartbeat 15:18:27 ERROR MongoDbDictionary.Store() has failed.
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Save(Object value)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbDictionary.Store(Object value)

2896 15:18:31 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #16 15:18:31 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #16 15:18:31 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
2288 15:18:33 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

3288 15:18:33 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

1932 15:18:40 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Core.BackgroundService.Run()

5344 15:18:41 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

5476 15:18:41 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #13 15:18:41 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #13 15:18:41 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
6832 15:18:42 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

2896 15:18:46 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

2288 15:18:48 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

3288 15:18:48 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

2436 15:18:49 INFO  [Experience Analytics]: Reduce agent found zero sites to process
ManagedPoolThread #10 15:18:51 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #10 15:18:51 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
1932 15:18:55 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #9 15:18:56 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
6832 15:18:57 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #14 15:18:57 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #19 15:18:58 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #6 15:18:59 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #12 15:19:00 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
2896 15:19:01 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #5 15:19:01 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #7 15:19:01 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #7 15:19:01 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
ManagedPoolThread #0 15:19:02 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
2288 15:19:03 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

3288 15:19:03 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #1 15:19:03 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #3 15:19:04 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #15 15:19:05 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
5344 15:19:06 ERROR Exception when executing agent aggregation/automationAggregator
Exception: MongoDB.Driver.MongoConnectionException
Message: Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
Source: MongoDB.Driver
   at MongoDB.Driver.Internal.DirectMongoServerProxy.Connect(TimeSpan timeout, ReadPreference readPreference)
   at MongoDB.Driver.Internal.DirectMongoServerProxy.ChooseServerInstance(ReadPreference readPreference)
   at MongoDB.Driver.MongoServer.AcquireConnection(ReadPreference readPreference)
   at MongoDB.Driver.MongoCursor`1.MongoCursorConnectionProvider.AcquireConnection()
   at MongoDB.Driver.Operations.QueryOperation`1.GetFirstBatch(IConnectionProvider connectionProvider)
   at MongoDB.Driver.Operations.QueryOperation`1.Execute(IConnectionProvider connectionProvider)
   at System.Linq.Buffer`1..ctor(IEnumerable`1 source)
   at System.Linq.Enumerable.ToArray[TSource](IEnumerable`1 source)
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

Nested Exception

Exception: System.Net.Sockets.SocketException
Message: No connection could be made because the target machine actively refused it 127.0.0.1:27017
Source: System
   at System.Net.Sockets.Socket.DoConnect(EndPoint endPointSnapshot, SocketAddress socketAddress)
   at System.Net.Sockets.Socket.Connect(EndPoint remoteEP)
   at System.Net.Sockets.TcpClient.Connect(IPEndPoint remoteEP)
   at MongoDB.Driver.Internal.MongoConnection.Open()
   at MongoDB.Driver.Internal.MongoConnection.SendMessage(BsonBuffer buffer, Int32 requestId)
   at MongoDB.Driver.Internal.MongoConnection.SendMessage(MongoRequestMessage message)
   at MongoDB.Driver.Operations.CommandOperation`1.Execute(MongoConnection connection)
   at MongoDB.Driver.MongoServerInstance.Ping(MongoConnection connection)
   at MongoDB.Driver.MongoServerInstance.Connect()
   at MongoDB.Driver.Internal.DirectMongoServerProxy.Connect(TimeSpan timeout, ReadPreference readPreference)


5476 15:19:07 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: MongoDB.Driver.MongoConnectionException
Message: Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
Source: MongoDB.Driver
   at MongoDB.Driver.Internal.DirectMongoServerProxy.Connect(TimeSpan timeout, ReadPreference readPreference)
   at MongoDB.Driver.Internal.DirectMongoServerProxy.ChooseServerInstance(ReadPreference readPreference)
   at MongoDB.Driver.MongoServer.AcquireConnection(ReadPreference readPreference)
   at MongoDB.Driver.MongoCursor`1.MongoCursorConnectionProvider.AcquireConnection()
   at MongoDB.Driver.Operations.QueryOperation`1.GetFirstBatch(IConnectionProvider connectionProvider)
   at MongoDB.Driver.Operations.QueryOperation`1.Execute(IConnectionProvider connectionProvider)
   at System.Linq.Enumerable.FirstOrDefault[TSource](IEnumerable`1 source)
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

Nested Exception

Exception: System.Net.Sockets.SocketException
Message: No connection could be made because the target machine actively refused it 127.0.0.1:27017
Source: System
   at System.Net.Sockets.Socket.DoConnect(EndPoint endPointSnapshot, SocketAddress socketAddress)
   at System.Net.Sockets.Socket.Connect(EndPoint remoteEP)
   at System.Net.Sockets.TcpClient.Connect(IPEndPoint remoteEP)
   at MongoDB.Driver.Internal.MongoConnection.Open()
   at MongoDB.Driver.Internal.MongoConnection.SendMessage(BsonBuffer buffer, Int32 requestId)
   at MongoDB.Driver.Internal.MongoConnection.SendMessage(MongoRequestMessage message)
   at MongoDB.Driver.Operations.CommandOperation`1.Execute(MongoConnection connection)
   at MongoDB.Driver.MongoServerInstance.Ping(MongoConnection connection)
   at MongoDB.Driver.MongoServerInstance.Connect()
   at MongoDB.Driver.Internal.DirectMongoServerProxy.Connect(TimeSpan timeout, ReadPreference readPreference)


ManagedPoolThread #11 15:19:08 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #17 15:19:09 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
1932 15:19:10 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #2 15:19:10 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #8 15:19:11 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #16 15:19:11 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #16 15:19:11 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
6832 15:19:12 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #18 15:19:12 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
2896 15:19:16 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

2288 15:19:18 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

3288 15:19:18 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

 388 15:19:18 INFO  [Path Analyzer](.) Running trail cleanup agent
 388 15:19:18 INFO  [Path Analyzer](.) Running trail cleanup on database
2436 15:19:19 INFO  [Experience Analytics]: Reduce agent found zero sites to process
5344 15:19:21 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #13 15:19:21 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #13 15:19:21 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
5476 15:19:22 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

1932 15:19:25 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Core.BackgroundService.Run()

6832 15:19:27 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

2896 15:19:31 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #10 15:19:31 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #10 15:19:31 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
2288 15:19:33 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

3288 15:19:33 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

5344 15:19:36 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

5476 15:19:37 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

1932 15:19:40 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #13 15:19:41 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #13 15:19:41 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
6832 15:19:42 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

2896 15:19:46 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

2288 15:19:48 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

3288 15:19:48 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

2436 15:19:49 INFO  [Experience Analytics]: Reduce agent found zero sites to process
5344 15:19:51 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #7 15:19:51 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #7 15:19:51 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
5476 15:19:52 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

1932 15:19:55 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Core.BackgroundService.Run()

6832 15:19:57 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

2896 15:20:01 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #13 15:20:01 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #13 15:20:01 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
2288 15:20:03 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

3288 15:20:03 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #14 15:20:06 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
5476 15:20:07 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #19 15:20:07 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #9 15:20:08 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #6 15:20:09 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
1932 15:20:10 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #12 15:20:10 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #15 15:20:11 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #7 15:20:11 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #7 15:20:11 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
6832 15:20:12 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #1 15:20:12 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #0 15:20:13 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #5 15:20:14 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #3 15:20:15 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
5344 15:20:16 ERROR Exception when executing agent aggregation/automationAggregator
Exception: MongoDB.Driver.MongoConnectionException
Message: Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
Source: MongoDB.Driver
   at MongoDB.Driver.Internal.DirectMongoServerProxy.Connect(TimeSpan timeout, ReadPreference readPreference)
   at MongoDB.Driver.Internal.DirectMongoServerProxy.ChooseServerInstance(ReadPreference readPreference)
   at MongoDB.Driver.MongoServer.AcquireConnection(ReadPreference readPreference)
   at MongoDB.Driver.MongoCursor`1.MongoCursorConnectionProvider.AcquireConnection()
   at MongoDB.Driver.Operations.QueryOperation`1.GetFirstBatch(IConnectionProvider connectionProvider)
   at MongoDB.Driver.Operations.QueryOperation`1.Execute(IConnectionProvider connectionProvider)
   at System.Linq.Buffer`1..ctor(IEnumerable`1 source)
   at System.Linq.Enumerable.ToArray[TSource](IEnumerable`1 source)
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

Nested Exception

Exception: System.Net.Sockets.SocketException
Message: No connection could be made because the target machine actively refused it 127.0.0.1:27017
Source: System
   at System.Net.Sockets.Socket.DoConnect(EndPoint endPointSnapshot, SocketAddress socketAddress)
   at System.Net.Sockets.Socket.Connect(EndPoint remoteEP)
   at System.Net.Sockets.TcpClient.Connect(IPEndPoint remoteEP)
   at MongoDB.Driver.Internal.MongoConnection.Open()
   at MongoDB.Driver.Internal.MongoConnection.SendMessage(BsonBuffer buffer, Int32 requestId)
   at MongoDB.Driver.Internal.MongoConnection.SendMessage(MongoRequestMessage message)
   at MongoDB.Driver.Operations.CommandOperation`1.Execute(MongoConnection connection)
   at MongoDB.Driver.MongoServerInstance.Ping(MongoConnection connection)
   at MongoDB.Driver.MongoServerInstance.Connect()
   at MongoDB.Driver.Internal.DirectMongoServerProxy.Connect(TimeSpan timeout, ReadPreference readPreference)


ManagedPoolThread #2 15:20:17 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
2288 15:20:18 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

3288 15:20:18 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #8 15:20:18 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
2436 15:20:19 INFO  [Experience Analytics]: Reduce agent found zero sites to process
ManagedPoolThread #18 15:20:19 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
2896 15:20:20 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
2896 15:20:20 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.HandleDatabaseException(ExceptionBehavior exceptionBehavior, Exception ex)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

Nested Exception

Exception: MongoDB.Driver.MongoConnectionException
Message: Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
Source: MongoDB.Driver
   at MongoDB.Driver.Internal.DirectMongoServerProxy.Connect(TimeSpan timeout, ReadPreference readPreference)
   at MongoDB.Driver.Internal.DirectMongoServerProxy.ChooseServerInstance(ReadPreference readPreference)
   at MongoDB.Driver.MongoServer.AcquireConnection(ReadPreference readPreference)
   at MongoDB.Driver.MongoCollection.RunCommandAs[TCommandResult](IMongoCommand command, ReadPreference readPreference, IBsonSerializer resultSerializer, IBsonSerializationOptions resultSerializationOptions)
   at MongoDB.Driver.MongoCollection.RunCommandAs[TCommandResult](IMongoCommand command, ReadPreference readPreference)
   at MongoDB.Driver.MongoCollection.FindAndModify(FindAndModifyArgs args)
   at MongoDB.Driver.MongoCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.<>c__DisplayClass2c.<FindAndModify>b__2b()
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)

Nested Exception

Exception: System.Net.Sockets.SocketException
Message: No connection could be made because the target machine actively refused it 127.0.0.1:27017
Source: System
   at System.Net.Sockets.Socket.DoConnect(EndPoint endPointSnapshot, SocketAddress socketAddress)
   at System.Net.Sockets.Socket.Connect(EndPoint remoteEP)
   at System.Net.Sockets.TcpClient.Connect(IPEndPoint remoteEP)
   at MongoDB.Driver.Internal.MongoConnection.Open()
   at MongoDB.Driver.Internal.MongoConnection.SendMessage(BsonBuffer buffer, Int32 requestId)
   at MongoDB.Driver.Internal.MongoConnection.SendMessage(MongoRequestMessage message)
   at MongoDB.Driver.Operations.CommandOperation`1.Execute(MongoConnection connection)
   at MongoDB.Driver.MongoServerInstance.Ping(MongoConnection connection)
   at MongoDB.Driver.MongoServerInstance.Connect()
   at MongoDB.Driver.Internal.DirectMongoServerProxy.Connect(TimeSpan timeout, ReadPreference readPreference)



ManagedPoolThread #13 15:20:21 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #11 15:20:21 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #13 15:20:21 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
5476 15:20:22 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #17 15:20:22 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
1932 15:20:25 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Core.BackgroundService.Run()

6832 15:20:27 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

Heartbeat 15:20:27 ERROR MongoDbDictionary.Store() has failed.
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Save(Object value)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbDictionary.Store(Object value)

5344 15:20:31 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #10 15:20:31 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #10 15:20:31 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
2288 15:20:33 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

3288 15:20:33 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

2896 15:20:35 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

5476 15:20:37 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

1932 15:20:40 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #13 15:20:41 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #13 15:20:41 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
6832 15:20:42 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

5344 15:20:46 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

2288 15:20:48 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

3288 15:20:48 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

2436 15:20:49 INFO  [Experience Analytics]: Reduce agent found zero sites to process
2896 15:20:50 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #7 15:20:51 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #7 15:20:51 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
5476 15:20:52 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

1932 15:20:55 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Core.BackgroundService.Run()

6832 15:20:57 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

5344 15:21:01 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #13 15:21:01 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #13 15:21:01 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
2288 15:21:03 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

3288 15:21:03 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

2896 15:21:05 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

5476 15:21:07 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

1932 15:21:10 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #7 15:21:11 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #7 15:21:11 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
6832 15:21:12 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #14 15:21:16 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #19 15:21:17 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
2288 15:21:18 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

3288 15:21:18 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #6 15:21:18 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
2436 15:21:19 INFO  [Experience Analytics]: Reduce agent found zero sites to process
ManagedPoolThread #9 15:21:19 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
2896 15:21:20 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #15 15:21:20 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #10 15:21:21 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #10 15:21:21 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
ManagedPoolThread #1 15:21:21 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
5476 15:21:22 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #12 15:21:22 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #5 15:21:23 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #0 15:21:24 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
1932 15:21:25 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #3 15:21:25 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
5344 15:21:26 ERROR Exception when executing agent aggregation/automationAggregator
Exception: MongoDB.Driver.MongoConnectionException
Message: Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
Source: MongoDB.Driver
   at MongoDB.Driver.Internal.DirectMongoServerProxy.Connect(TimeSpan timeout, ReadPreference readPreference)
   at MongoDB.Driver.Internal.DirectMongoServerProxy.ChooseServerInstance(ReadPreference readPreference)
   at MongoDB.Driver.MongoServer.AcquireConnection(ReadPreference readPreference)
   at MongoDB.Driver.MongoCursor`1.MongoCursorConnectionProvider.AcquireConnection()
   at MongoDB.Driver.Operations.QueryOperation`1.GetFirstBatch(IConnectionProvider connectionProvider)
   at MongoDB.Driver.Operations.QueryOperation`1.Execute(IConnectionProvider connectionProvider)
   at System.Linq.Buffer`1..ctor(IEnumerable`1 source)
   at System.Linq.Enumerable.ToArray[TSource](IEnumerable`1 source)
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

Nested Exception

Exception: System.Net.Sockets.SocketException
Message: No connection could be made because the target machine actively refused it 127.0.0.1:27017
Source: System
   at System.Net.Sockets.Socket.DoConnect(EndPoint endPointSnapshot, SocketAddress socketAddress)
   at System.Net.Sockets.Socket.Connect(EndPoint remoteEP)
   at System.Net.Sockets.TcpClient.Connect(IPEndPoint remoteEP)
   at MongoDB.Driver.Internal.MongoConnection.Open()
   at MongoDB.Driver.Internal.MongoConnection.SendMessage(BsonBuffer buffer, Int32 requestId)
   at MongoDB.Driver.Internal.MongoConnection.SendMessage(MongoRequestMessage message)
   at MongoDB.Driver.Operations.CommandOperation`1.Execute(MongoConnection connection)
   at MongoDB.Driver.MongoServerInstance.Ping(MongoConnection connection)
   at MongoDB.Driver.MongoServerInstance.Connect()
   at MongoDB.Driver.Internal.DirectMongoServerProxy.Connect(TimeSpan timeout, ReadPreference readPreference)


6832 15:21:27 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #2 15:21:27 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #11 15:21:28 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #17 15:21:29 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #8 15:21:30 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #16 15:21:31 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #16 15:21:31 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
ManagedPoolThread #18 15:21:31 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
2288 15:21:33 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

3288 15:21:33 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

2896 15:21:35 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

5476 15:21:37 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

1932 15:21:40 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #7 15:21:41 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #7 15:21:41 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
5344 15:21:41 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

6832 15:21:42 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

2288 15:21:48 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

3288 15:21:48 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

2436 15:21:49 INFO  [Experience Analytics]: Reduce agent found zero sites to process
2896 15:21:50 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #13 15:21:51 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #13 15:21:51 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
5476 15:21:52 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

1932 15:21:55 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Core.BackgroundService.Run()

5344 15:21:56 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

6832 15:21:57 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #7 15:22:01 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #7 15:22:01 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
2288 15:22:03 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

3288 15:22:03 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

2896 15:22:05 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

5476 15:22:07 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

1932 15:22:10 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #13 15:22:11 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #13 15:22:11 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
5344 15:22:11 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

6832 15:22:12 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

2288 15:22:18 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

3288 15:22:18 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

2436 15:22:19 INFO  [Experience Analytics]: Reduce agent found zero sites to process
2896 15:22:20 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #7 15:22:21 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #7 15:22:21 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
5476 15:22:22 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

1932 15:22:25 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #19 15:22:26 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
6832 15:22:27 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #14 15:22:27 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
Heartbeat 15:22:27 ERROR MongoDbDictionary.Store() has failed.
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Save(Object value)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbDictionary.Store(Object value)

ManagedPoolThread #9 15:22:28 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #15 15:22:29 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #6 15:22:30 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #13 15:22:31 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #13 15:22:31 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
ManagedPoolThread #1 15:22:31 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #12 15:22:32 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
2288 15:22:33 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

3288 15:22:33 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #5 15:22:33 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #0 15:22:34 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #3 15:22:35 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
5344 15:22:36 ERROR Exception when executing agent aggregation/automationAggregator
Exception: MongoDB.Driver.MongoConnectionException
Message: Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
Source: MongoDB.Driver
   at MongoDB.Driver.Internal.DirectMongoServerProxy.Connect(TimeSpan timeout, ReadPreference readPreference)
   at MongoDB.Driver.Internal.DirectMongoServerProxy.ChooseServerInstance(ReadPreference readPreference)
   at MongoDB.Driver.MongoServer.AcquireConnection(ReadPreference readPreference)
   at MongoDB.Driver.MongoCursor`1.MongoCursorConnectionProvider.AcquireConnection()
   at MongoDB.Driver.Operations.QueryOperation`1.GetFirstBatch(IConnectionProvider connectionProvider)
   at MongoDB.Driver.Operations.QueryOperation`1.Execute(IConnectionProvider connectionProvider)
   at System.Linq.Buffer`1..ctor(IEnumerable`1 source)
   at System.Linq.Enumerable.ToArray[TSource](IEnumerable`1 source)
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

Nested Exception

Exception: System.Net.Sockets.SocketException
Message: No connection could be made because the target machine actively refused it 127.0.0.1:27017
Source: System
   at System.Net.Sockets.Socket.DoConnect(EndPoint endPointSnapshot, SocketAddress socketAddress)
   at System.Net.Sockets.Socket.Connect(EndPoint remoteEP)
   at System.Net.Sockets.TcpClient.Connect(IPEndPoint remoteEP)
   at MongoDB.Driver.Internal.MongoConnection.Open()
   at MongoDB.Driver.Internal.MongoConnection.SendMessage(BsonBuffer buffer, Int32 requestId)
   at MongoDB.Driver.Internal.MongoConnection.SendMessage(MongoRequestMessage message)
   at MongoDB.Driver.Operations.CommandOperation`1.Execute(MongoConnection connection)
   at MongoDB.Driver.MongoServerInstance.Ping(MongoConnection connection)
   at MongoDB.Driver.MongoServerInstance.Connect()
   at MongoDB.Driver.Internal.DirectMongoServerProxy.Connect(TimeSpan timeout, ReadPreference readPreference)


5476 15:22:37 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #2 15:22:37 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #8 15:22:38 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #18 15:22:39 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
1932 15:22:40 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Core.BackgroundService.Run()

2896 15:22:40 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
2896 15:22:40 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.HandleDatabaseException(ExceptionBehavior exceptionBehavior, Exception ex)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

Nested Exception

Exception: MongoDB.Driver.MongoConnectionException
Message: Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
Source: MongoDB.Driver
   at MongoDB.Driver.Internal.DirectMongoServerProxy.Connect(TimeSpan timeout, ReadPreference readPreference)
   at MongoDB.Driver.Internal.DirectMongoServerProxy.ChooseServerInstance(ReadPreference readPreference)
   at MongoDB.Driver.MongoServer.AcquireConnection(ReadPreference readPreference)
   at MongoDB.Driver.MongoCollection.RunCommandAs[TCommandResult](IMongoCommand command, ReadPreference readPreference, IBsonSerializer resultSerializer, IBsonSerializationOptions resultSerializationOptions)
   at MongoDB.Driver.MongoCollection.RunCommandAs[TCommandResult](IMongoCommand command, ReadPreference readPreference)
   at MongoDB.Driver.MongoCollection.FindAndModify(FindAndModifyArgs args)
   at MongoDB.Driver.MongoCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.<>c__DisplayClass2c.<FindAndModify>b__2b()
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)

Nested Exception

Exception: System.Net.Sockets.SocketException
Message: No connection could be made because the target machine actively refused it 127.0.0.1:27017
Source: System
   at System.Net.Sockets.Socket.DoConnect(EndPoint endPointSnapshot, SocketAddress socketAddress)
   at System.Net.Sockets.Socket.Connect(EndPoint remoteEP)
   at System.Net.Sockets.TcpClient.Connect(IPEndPoint remoteEP)
   at MongoDB.Driver.Internal.MongoConnection.Open()
   at MongoDB.Driver.Internal.MongoConnection.SendMessage(BsonBuffer buffer, Int32 requestId)
   at MongoDB.Driver.Internal.MongoConnection.SendMessage(MongoRequestMessage message)
   at MongoDB.Driver.Operations.CommandOperation`1.Execute(MongoConnection connection)
   at MongoDB.Driver.MongoServerInstance.Ping(MongoConnection connection)
   at MongoDB.Driver.MongoServerInstance.Connect()
   at MongoDB.Driver.Internal.DirectMongoServerProxy.Connect(TimeSpan timeout, ReadPreference readPreference)



ManagedPoolThread #16 15:22:41 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #16 15:22:41 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
ManagedPoolThread #11 15:22:41 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
6832 15:22:42 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #17 15:22:42 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
2288 15:22:48 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

3288 15:22:48 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

2436 15:22:49 INFO  [Experience Analytics]: Reduce agent found zero sites to process
ManagedPoolThread #10 15:22:51 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #10 15:22:51 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
5344 15:22:51 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

5476 15:22:52 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

1932 15:22:55 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Core.BackgroundService.Run()

2896 15:22:55 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

6832 15:22:57 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #7 15:23:01 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #7 15:23:01 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
2288 15:23:03 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

3288 15:23:03 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

5344 15:23:06 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

5476 15:23:07 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

1932 15:23:10 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Core.BackgroundService.Run()

2896 15:23:10 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #13 15:23:11 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #13 15:23:11 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
6832 15:23:12 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

2288 15:23:18 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

3288 15:23:18 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

2436 15:23:19 INFO  [Experience Analytics]: Reduce agent found zero sites to process
ManagedPoolThread #7 15:23:21 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #7 15:23:21 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
5344 15:23:21 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

5476 15:23:22 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

1932 15:23:25 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Core.BackgroundService.Run()

2896 15:23:25 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

6832 15:23:27 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #13 15:23:31 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #13 15:23:31 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
2288 15:23:33 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

3288 15:23:33 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #15 15:23:36 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
5476 15:23:37 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #12 15:23:37 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #19 15:23:38 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #6 15:23:39 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
1932 15:23:40 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Core.BackgroundService.Run()

2896 15:23:40 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #1 15:23:40 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #16 15:23:41 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #16 15:23:41 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
ManagedPoolThread #5 15:23:41 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
6832 15:23:42 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #9 15:23:42 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #14 15:23:43 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #3 15:23:44 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #0 15:23:45 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
5344 15:23:47 ERROR Exception when executing agent aggregation/automationAggregator
Exception: MongoDB.Driver.MongoConnectionException
Message: Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
Source: MongoDB.Driver
   at MongoDB.Driver.Internal.DirectMongoServerProxy.Connect(TimeSpan timeout, ReadPreference readPreference)
   at MongoDB.Driver.Internal.DirectMongoServerProxy.ChooseServerInstance(ReadPreference readPreference)
   at MongoDB.Driver.MongoServer.AcquireConnection(ReadPreference readPreference)
   at MongoDB.Driver.MongoCursor`1.MongoCursorConnectionProvider.AcquireConnection()
   at MongoDB.Driver.Operations.QueryOperation`1.GetFirstBatch(IConnectionProvider connectionProvider)
   at MongoDB.Driver.Operations.QueryOperation`1.Execute(IConnectionProvider connectionProvider)
   at System.Linq.Buffer`1..ctor(IEnumerable`1 source)
   at System.Linq.Enumerable.ToArray[TSource](IEnumerable`1 source)
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

Nested Exception

Exception: System.Net.Sockets.SocketException
Message: No connection could be made because the target machine actively refused it 127.0.0.1:27017
Source: System
   at System.Net.Sockets.Socket.DoConnect(EndPoint endPointSnapshot, SocketAddress socketAddress)
   at System.Net.Sockets.Socket.Connect(EndPoint remoteEP)
   at System.Net.Sockets.TcpClient.Connect(IPEndPoint remoteEP)
   at MongoDB.Driver.Internal.MongoConnection.Open()
   at MongoDB.Driver.Internal.MongoConnection.SendMessage(BsonBuffer buffer, Int32 requestId)
   at MongoDB.Driver.Internal.MongoConnection.SendMessage(MongoRequestMessage message)
   at MongoDB.Driver.Operations.CommandOperation`1.Execute(MongoConnection connection)
   at MongoDB.Driver.MongoServerInstance.Ping(MongoConnection connection)
   at MongoDB.Driver.MongoServerInstance.Connect()
   at MongoDB.Driver.Internal.DirectMongoServerProxy.Connect(TimeSpan timeout, ReadPreference readPreference)


2288 15:23:48 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

3288 15:23:48 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #2 15:23:48 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
2436 15:23:49 INFO  [Experience Analytics]: Reduce agent found zero sites to process
ManagedPoolThread #11 15:23:49 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #17 15:23:50 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #7 15:23:51 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #7 15:23:51 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
ManagedPoolThread #8 15:23:51 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
5476 15:23:52 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #18 15:23:52 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
1932 15:23:55 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Core.BackgroundService.Run()

2896 15:23:55 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

6832 15:23:57 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #10 15:24:01 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #10 15:24:01 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
5344 15:24:02 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

2288 15:24:03 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

3288 15:24:03 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

5476 15:24:07 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

1932 15:24:10 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Core.BackgroundService.Run()

2896 15:24:10 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #7 15:24:11 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #7 15:24:11 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
6832 15:24:12 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

Heartbeat 15:24:15 INFO  Health.PrivateBytes: 643,653,632
Heartbeat 15:24:15 INFO  Health.CacheInstances: 116
Heartbeat 15:24:15 INFO  Health.CacheTotalCount: 21,146
Heartbeat 15:24:15 INFO  Health.CacheTotalSize: 84,485,258
5344 15:24:17 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

2288 15:24:18 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

3288 15:24:18 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

 388 15:24:18 INFO  [Path Analyzer](.) Running trail cleanup agent
 388 15:24:18 INFO  [Path Analyzer](.) Running trail cleanup on database
6508 15:24:18 WARN  [Path Analyzer](.) SmartMergeAgent.Execute() returns. No missing date ranges to merge.
2436 15:24:19 INFO  [Experience Analytics]: Reduce agent found zero sites to process
ManagedPoolThread #10 15:24:21 INFO  Job started: Sitecore.Tasks.UrlAgent
ManagedPoolThread #10 15:24:21 INFO  Scheduling.UrlAgent started. Url: http://gathercontent.dev/sitecore/service/keepalive.aspx
ManagedPoolThread #10 15:24:21 INFO  Scheduling.UrlAgent done (received: 561 bytes)
ManagedPoolThread #10 15:24:21 INFO  Job ended: Sitecore.Tasks.UrlAgent (units processed: )
ManagedPoolThread #16 15:24:21 INFO  Job started: Sitecore.Tasks.TaskDatabaseAgent
ManagedPoolThread #16 15:24:21 INFO  Processing tasks (count: 0)
ManagedPoolThread #16 15:24:21 INFO  Job ended: Sitecore.Tasks.TaskDatabaseAgent (units processed: )
ManagedPoolThread #13 15:24:21 INFO  Job started: Core_Database_Agent
ManagedPoolThread #13 15:24:21 INFO  Scheduling.DatabaseAgent started. Database: core
ManagedPoolThread #13 15:24:21 INFO  Examining schedules (count: 0)
ManagedPoolThread #13 15:24:21 INFO  Job ended: Core_Database_Agent (units processed: )
ManagedPoolThread #10 15:24:21 INFO  Job started: Master_Database_Agent
ManagedPoolThread #10 15:24:21 INFO  Scheduling.DatabaseAgent started. Database: master
ManagedPoolThread #10 15:24:21 INFO  Examining schedules (count: 5)
ManagedPoolThread #10 15:24:21 INFO  Starting: __Task Schedule
ManagedPoolThread #10 15:24:21 INFO  Ended: __Task Schedule
ManagedPoolThread #10 15:24:21 INFO  Not due: Calculate Statistical Relevancy
ManagedPoolThread #10 15:24:21 INFO  Not due: Rebuild Suggested Tests Index
ManagedPoolThread #10 15:24:21 INFO  Not due: Suspend Corrupted Tests
ManagedPoolThread #10 15:24:21 INFO  Not due: Try Finish Test
ManagedPoolThread #10 15:24:21 INFO  Job ended: Master_Database_Agent (units processed: 5)
ManagedPoolThread #7 15:24:21 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #7 15:24:21 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
5476 15:24:22 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

1932 15:24:25 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Core.BackgroundService.Run()

2896 15:24:25 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

6832 15:24:27 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

Heartbeat 15:24:27 ERROR MongoDbDictionary.Store() has failed.
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Save(Object value)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbDictionary.Store(Object value)

ManagedPoolThread #16 15:24:31 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #16 15:24:31 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
5344 15:24:32 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

2288 15:24:33 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

3288 15:24:33 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

5476 15:24:37 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

1932 15:24:40 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Core.BackgroundService.Run()

2896 15:24:40 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #7 15:24:41 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #7 15:24:41 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
6832 15:24:42 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #19 15:24:46 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
5344 15:24:47 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #1 15:24:47 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
2288 15:24:48 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

3288 15:24:48 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #9 15:24:48 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
2436 15:24:49 INFO  [Experience Analytics]: Reduce agent found zero sites to process
ManagedPoolThread #14 15:24:49 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #12 15:24:50 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #13 15:24:51 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #13 15:24:51 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
ManagedPoolThread #0 15:24:51 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
5476 15:24:52 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #6 15:24:52 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #15 15:24:53 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #5 15:24:54 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
1932 15:24:55 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #3 15:24:55 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #2 15:24:56 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
6832 15:24:57 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #8 15:24:57 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #18 15:24:58 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
2896 15:24:59 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
2896 15:24:59 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.HandleDatabaseException(ExceptionBehavior exceptionBehavior, Exception ex)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

Nested Exception

Exception: MongoDB.Driver.MongoConnectionException
Message: Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
Source: MongoDB.Driver
   at MongoDB.Driver.Internal.DirectMongoServerProxy.Connect(TimeSpan timeout, ReadPreference readPreference)
   at MongoDB.Driver.Internal.DirectMongoServerProxy.ChooseServerInstance(ReadPreference readPreference)
   at MongoDB.Driver.MongoServer.AcquireConnection(ReadPreference readPreference)
   at MongoDB.Driver.MongoCollection.RunCommandAs[TCommandResult](IMongoCommand command, ReadPreference readPreference, IBsonSerializer resultSerializer, IBsonSerializationOptions resultSerializationOptions)
   at MongoDB.Driver.MongoCollection.RunCommandAs[TCommandResult](IMongoCommand command, ReadPreference readPreference)
   at MongoDB.Driver.MongoCollection.FindAndModify(FindAndModifyArgs args)
   at MongoDB.Driver.MongoCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.<>c__DisplayClass2c.<FindAndModify>b__2b()
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)

Nested Exception

Exception: System.Net.Sockets.SocketException
Message: No connection could be made because the target machine actively refused it 127.0.0.1:27017
Source: System
   at System.Net.Sockets.Socket.DoConnect(EndPoint endPointSnapshot, SocketAddress socketAddress)
   at System.Net.Sockets.Socket.Connect(EndPoint remoteEP)
   at System.Net.Sockets.TcpClient.Connect(IPEndPoint remoteEP)
   at MongoDB.Driver.Internal.MongoConnection.Open()
   at MongoDB.Driver.Internal.MongoConnection.SendMessage(BsonBuffer buffer, Int32 requestId)
   at MongoDB.Driver.Internal.MongoConnection.SendMessage(MongoRequestMessage message)
   at MongoDB.Driver.Operations.CommandOperation`1.Execute(MongoConnection connection)
   at MongoDB.Driver.MongoServerInstance.Ping(MongoConnection connection)
   at MongoDB.Driver.MongoServerInstance.Connect()
   at MongoDB.Driver.Internal.DirectMongoServerProxy.Connect(TimeSpan timeout, ReadPreference readPreference)



ManagedPoolThread #7 15:25:01 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #7 15:25:01 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
5344 15:25:02 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

2288 15:25:03 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

3288 15:25:03 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

5476 15:25:07 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

1932 15:25:10 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #13 15:25:11 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #13 15:25:11 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
6832 15:25:12 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

2896 15:25:14 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

5344 15:25:17 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

2288 15:25:18 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

3288 15:25:18 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

2436 15:25:19 INFO  [Experience Analytics]: Reduce agent found zero sites to process
ManagedPoolThread #7 15:25:21 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #7 15:25:21 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
5476 15:25:22 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

1932 15:25:25 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Core.BackgroundService.Run()

6832 15:25:27 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

2896 15:25:29 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #13 15:25:31 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #13 15:25:31 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
5344 15:25:32 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

2288 15:25:33 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

3288 15:25:33 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

5476 15:25:37 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

1932 15:25:40 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #16 15:25:41 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #16 15:25:41 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
6832 15:25:42 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

2896 15:25:44 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

5344 15:25:47 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

2288 15:25:48 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

3288 15:25:48 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

2436 15:25:49 INFO  [Experience Analytics]: Reduce agent found zero sites to process
ManagedPoolThread #10 15:25:51 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #10 15:25:51 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
5476 15:25:52 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

1932 15:25:55 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #1 15:25:56 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
6832 15:25:57 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #19 15:25:57 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #9 15:25:58 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #14 15:25:59 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #0 15:26:00 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #16 15:26:01 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #16 15:26:01 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
ManagedPoolThread #12 15:26:01 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
5344 15:26:02 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #6 15:26:02 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
2288 15:26:03 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

3288 15:26:03 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #15 15:26:03 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #5 15:26:04 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #3 15:26:05 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #2 15:26:06 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
5476 15:26:07 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #8 15:26:07 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #11 15:26:08 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
2896 15:26:09 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
2896 15:26:09 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.HandleDatabaseException(ExceptionBehavior exceptionBehavior, Exception ex)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

Nested Exception

Exception: MongoDB.Driver.MongoConnectionException
Message: Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
Source: MongoDB.Driver
   at MongoDB.Driver.Internal.DirectMongoServerProxy.Connect(TimeSpan timeout, ReadPreference readPreference)
   at MongoDB.Driver.Internal.DirectMongoServerProxy.ChooseServerInstance(ReadPreference readPreference)
   at MongoDB.Driver.MongoServer.AcquireConnection(ReadPreference readPreference)
   at MongoDB.Driver.MongoCollection.RunCommandAs[TCommandResult](IMongoCommand command, ReadPreference readPreference, IBsonSerializer resultSerializer, IBsonSerializationOptions resultSerializationOptions)
   at MongoDB.Driver.MongoCollection.RunCommandAs[TCommandResult](IMongoCommand command, ReadPreference readPreference)
   at MongoDB.Driver.MongoCollection.FindAndModify(FindAndModifyArgs args)
   at MongoDB.Driver.MongoCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.<>c__DisplayClass2c.<FindAndModify>b__2b()
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)

Nested Exception

Exception: System.Net.Sockets.SocketException
Message: No connection could be made because the target machine actively refused it 127.0.0.1:27017
Source: System
   at System.Net.Sockets.Socket.DoConnect(EndPoint endPointSnapshot, SocketAddress socketAddress)
   at System.Net.Sockets.Socket.Connect(EndPoint remoteEP)
   at System.Net.Sockets.TcpClient.Connect(IPEndPoint remoteEP)
   at MongoDB.Driver.Internal.MongoConnection.Open()
   at MongoDB.Driver.Internal.MongoConnection.SendMessage(BsonBuffer buffer, Int32 requestId)
   at MongoDB.Driver.Internal.MongoConnection.SendMessage(MongoRequestMessage message)
   at MongoDB.Driver.Operations.CommandOperation`1.Execute(MongoConnection connection)
   at MongoDB.Driver.MongoServerInstance.Ping(MongoConnection connection)
   at MongoDB.Driver.MongoServerInstance.Connect()
   at MongoDB.Driver.Internal.DirectMongoServerProxy.Connect(TimeSpan timeout, ReadPreference readPreference)



1932 15:26:10 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #17 15:26:10 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #10 15:26:11 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #10 15:26:11 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
ManagedPoolThread #18 15:26:11 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
6832 15:26:12 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

5344 15:26:17 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

2288 15:26:18 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

3288 15:26:18 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

2436 15:26:19 INFO  [Experience Analytics]: Reduce agent found zero sites to process
ManagedPoolThread #7 15:26:21 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #7 15:26:21 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
5476 15:26:22 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

2896 15:26:24 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

1932 15:26:25 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Core.BackgroundService.Run()

6832 15:26:27 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

Heartbeat 15:26:27 ERROR MongoDbDictionary.Store() has failed.
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Save(Object value)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbDictionary.Store(Object value)

ManagedPoolThread #13 15:26:31 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #13 15:26:31 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
5344 15:26:32 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

2288 15:26:33 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

3288 15:26:33 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

5476 15:26:37 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

2896 15:26:39 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

1932 15:26:40 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #16 15:26:41 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #16 15:26:41 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
6832 15:26:42 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

5344 15:26:47 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

2288 15:26:48 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

3288 15:26:48 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

2436 15:26:49 INFO  [Experience Analytics]: Reduce agent found zero sites to process
ManagedPoolThread #10 15:26:51 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #10 15:26:51 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
5476 15:26:52 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

2896 15:26:54 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

1932 15:26:55 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Core.BackgroundService.Run()

6832 15:26:57 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #16 15:27:01 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #16 15:27:01 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
5344 15:27:02 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

2288 15:27:03 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

3288 15:27:03 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #1 15:27:06 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
5476 15:27:07 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #19 15:27:07 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #9 15:27:08 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #14 15:27:09 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
2896 15:27:09 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

1932 15:27:10 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #6 15:27:10 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #10 15:27:11 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #10 15:27:11 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
ManagedPoolThread #12 15:27:11 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
6832 15:27:12 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #0 15:27:12 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #5 15:27:13 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #15 15:27:14 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #3 15:27:15 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #2 15:27:16 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
5344 15:27:17 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #11 15:27:17 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
2288 15:27:18 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

3288 15:27:18 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #18 15:27:18 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
2436 15:27:19 INFO  [Experience Analytics]: Reduce agent found zero sites to process
ManagedPoolThread #8 15:27:19 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #13 15:27:21 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #13 15:27:21 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
5476 15:27:22 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

2896 15:27:24 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

1932 15:27:25 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Core.BackgroundService.Run()

6832 15:27:27 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #16 15:27:31 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #16 15:27:31 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
5344 15:27:32 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

2288 15:27:33 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

3288 15:27:33 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

5476 15:27:37 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

2896 15:27:39 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

1932 15:27:40 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #10 15:27:41 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #10 15:27:41 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
6832 15:27:42 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

5344 15:27:47 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

2288 15:27:48 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

3288 15:27:48 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

2436 15:27:49 INFO  [Experience Analytics]: Reduce agent found zero sites to process
ManagedPoolThread #7 15:27:51 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #7 15:27:51 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
5476 15:27:52 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

2896 15:27:54 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

1932 15:27:55 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Core.BackgroundService.Run()

6832 15:27:57 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #10 15:28:01 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #10 15:28:01 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
5344 15:28:02 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

2288 15:28:03 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

3288 15:28:03 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

5476 15:28:07 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

2896 15:28:09 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

1932 15:28:10 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #7 15:28:11 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #7 15:28:11 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
6832 15:28:12 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #0 15:28:16 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
5344 15:28:17 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #12 15:28:17 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
2288 15:28:18 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

3288 15:28:18 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #6 15:28:18 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
2436 15:28:19 INFO  [Experience Analytics]: Reduce agent found zero sites to process
ManagedPoolThread #1 15:28:19 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #5 15:28:20 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #10 15:28:21 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #10 15:28:21 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
ManagedPoolThread #14 15:28:21 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
5476 15:28:22 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #19 15:28:22 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #3 15:28:23 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #9 15:28:24 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
1932 15:28:25 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #15 15:28:25 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #2 15:28:26 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
6832 15:28:27 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

Heartbeat 15:28:27 ERROR MongoDbDictionary.Store() has failed.
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Save(Object value)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbDictionary.Store(Object value)

ManagedPoolThread #18 15:28:27 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #8 15:28:28 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #17 15:28:29 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
2896 15:28:30 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
2896 15:28:30 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.HandleDatabaseException(ExceptionBehavior exceptionBehavior, Exception ex)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

Nested Exception

Exception: MongoDB.Driver.MongoConnectionException
Message: Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
Source: MongoDB.Driver
   at MongoDB.Driver.Internal.DirectMongoServerProxy.Connect(TimeSpan timeout, ReadPreference readPreference)
   at MongoDB.Driver.Internal.DirectMongoServerProxy.ChooseServerInstance(ReadPreference readPreference)
   at MongoDB.Driver.MongoServer.AcquireConnection(ReadPreference readPreference)
   at MongoDB.Driver.MongoCollection.RunCommandAs[TCommandResult](IMongoCommand command, ReadPreference readPreference, IBsonSerializer resultSerializer, IBsonSerializationOptions resultSerializationOptions)
   at MongoDB.Driver.MongoCollection.RunCommandAs[TCommandResult](IMongoCommand command, ReadPreference readPreference)
   at MongoDB.Driver.MongoCollection.FindAndModify(FindAndModifyArgs args)
   at MongoDB.Driver.MongoCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.<>c__DisplayClass2c.<FindAndModify>b__2b()
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)

Nested Exception

Exception: System.Net.Sockets.SocketException
Message: No connection could be made because the target machine actively refused it 127.0.0.1:27017
Source: System
   at System.Net.Sockets.Socket.DoConnect(EndPoint endPointSnapshot, SocketAddress socketAddress)
   at System.Net.Sockets.Socket.Connect(EndPoint remoteEP)
   at System.Net.Sockets.TcpClient.Connect(IPEndPoint remoteEP)
   at MongoDB.Driver.Internal.MongoConnection.Open()
   at MongoDB.Driver.Internal.MongoConnection.SendMessage(BsonBuffer buffer, Int32 requestId)
   at MongoDB.Driver.Internal.MongoConnection.SendMessage(MongoRequestMessage message)
   at MongoDB.Driver.Operations.CommandOperation`1.Execute(MongoConnection connection)
   at MongoDB.Driver.MongoServerInstance.Ping(MongoConnection connection)
   at MongoDB.Driver.MongoServerInstance.Connect()
   at MongoDB.Driver.Internal.DirectMongoServerProxy.Connect(TimeSpan timeout, ReadPreference readPreference)



ManagedPoolThread #7 15:28:31 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #7 15:28:31 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
ManagedPoolThread #11 15:28:31 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
5344 15:28:32 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

2288 15:28:33 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

3288 15:28:33 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

5476 15:28:37 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

1932 15:28:40 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #10 15:28:41 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #10 15:28:41 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
6832 15:28:42 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

2896 15:28:45 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

5344 15:28:47 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

2288 15:28:48 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

3288 15:28:48 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

2436 15:28:49 INFO  [Experience Analytics]: Reduce agent found zero sites to process
ManagedPoolThread #7 15:28:51 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #7 15:28:51 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
5476 15:28:52 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

1932 15:28:55 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Core.BackgroundService.Run()

6832 15:28:57 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

2896 15:29:00 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #10 15:29:01 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #10 15:29:01 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
5344 15:29:02 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

2288 15:29:03 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

3288 15:29:03 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

5476 15:29:07 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

1932 15:29:10 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #7 15:29:11 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #7 15:29:11 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
6832 15:29:12 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

2896 15:29:15 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

5344 15:29:17 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

2288 15:29:18 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

3288 15:29:18 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

 388 15:29:18 INFO  [Path Analyzer](.) Running trail cleanup agent
 388 15:29:18 INFO  [Path Analyzer](.) Running trail cleanup on database
2436 15:29:19 INFO  [Experience Analytics]: Reduce agent found zero sites to process
ManagedPoolThread #16 15:29:21 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #16 15:29:21 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
5476 15:29:22 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

1932 15:29:25 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #9 15:29:26 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
6832 15:29:27 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #15 15:29:27 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #14 15:29:28 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #1 15:29:29 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #3 15:29:30 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #7 15:29:31 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #7 15:29:31 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
ManagedPoolThread #5 15:29:31 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
5344 15:29:32 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #19 15:29:32 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
2288 15:29:33 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

3288 15:29:33 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #0 15:29:33 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #6 15:29:34 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #12 15:29:35 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #2 15:29:36 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
5476 15:29:37 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

2896 15:29:37 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
2896 15:29:37 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.HandleDatabaseException(ExceptionBehavior exceptionBehavior, Exception ex)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

Nested Exception

Exception: MongoDB.Driver.MongoConnectionException
Message: Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
Source: MongoDB.Driver
   at MongoDB.Driver.Internal.DirectMongoServerProxy.Connect(TimeSpan timeout, ReadPreference readPreference)
   at MongoDB.Driver.Internal.DirectMongoServerProxy.ChooseServerInstance(ReadPreference readPreference)
   at MongoDB.Driver.MongoServer.AcquireConnection(ReadPreference readPreference)
   at MongoDB.Driver.MongoCollection.RunCommandAs[TCommandResult](IMongoCommand command, ReadPreference readPreference, IBsonSerializer resultSerializer, IBsonSerializationOptions resultSerializationOptions)
   at MongoDB.Driver.MongoCollection.RunCommandAs[TCommandResult](IMongoCommand command, ReadPreference readPreference)
   at MongoDB.Driver.MongoCollection.FindAndModify(FindAndModifyArgs args)
   at MongoDB.Driver.MongoCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.<>c__DisplayClass2c.<FindAndModify>b__2b()
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)

Nested Exception

Exception: System.Net.Sockets.SocketException
Message: No connection could be made because the target machine actively refused it 127.0.0.1:27017
Source: System
   at System.Net.Sockets.Socket.DoConnect(EndPoint endPointSnapshot, SocketAddress socketAddress)
   at System.Net.Sockets.Socket.Connect(EndPoint remoteEP)
   at System.Net.Sockets.TcpClient.Connect(IPEndPoint remoteEP)
   at MongoDB.Driver.Internal.MongoConnection.Open()
   at MongoDB.Driver.Internal.MongoConnection.SendMessage(BsonBuffer buffer, Int32 requestId)
   at MongoDB.Driver.Internal.MongoConnection.SendMessage(MongoRequestMessage message)
   at MongoDB.Driver.Operations.CommandOperation`1.Execute(MongoConnection connection)
   at MongoDB.Driver.MongoServerInstance.Ping(MongoConnection connection)
   at MongoDB.Driver.MongoServerInstance.Connect()
   at MongoDB.Driver.Internal.DirectMongoServerProxy.Connect(TimeSpan timeout, ReadPreference readPreference)



ManagedPoolThread #11 15:29:38 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #18 15:29:39 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
1932 15:29:40 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #8 15:29:40 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #16 15:29:41 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #16 15:29:41 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
6832 15:29:42 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

5344 15:29:47 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

2288 15:29:48 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

3288 15:29:48 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

2436 15:29:49 INFO  [Experience Analytics]: Reduce agent found zero sites to process
ManagedPoolThread #10 15:29:51 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #10 15:29:51 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
5476 15:29:52 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

2896 15:29:52 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

1932 15:29:55 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Core.BackgroundService.Run()

6832 15:29:57 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #13 15:30:01 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #13 15:30:01 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
5344 15:30:02 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

2288 15:30:03 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

3288 15:30:03 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

5476 15:30:07 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

2896 15:30:07 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

1932 15:30:10 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #7 15:30:11 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #7 15:30:11 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
6832 15:30:12 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

5344 15:30:17 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

2288 15:30:18 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

3288 15:30:18 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

2436 15:30:19 INFO  [Experience Analytics]: Reduce agent found zero sites to process
ManagedPoolThread #16 15:30:21 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #16 15:30:21 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
5476 15:30:22 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

2896 15:30:22 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

1932 15:30:25 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Core.BackgroundService.Run()

6832 15:30:27 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

Heartbeat 15:30:29 ERROR MongoDbDictionary.Store() has failed.
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Save(Object value)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbDictionary.Store(Object value)

ManagedPoolThread #10 15:30:31 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #10 15:30:31 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
5344 15:30:32 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

2288 15:30:33 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

3288 15:30:33 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #9 15:30:36 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
5476 15:30:37 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

2896 15:30:37 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #15 15:30:37 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #14 15:30:38 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #1 15:30:39 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
1932 15:30:40 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #3 15:30:40 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #7 15:30:41 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #7 15:30:41 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
ManagedPoolThread #5 15:30:41 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
6832 15:30:42 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #19 15:30:42 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #12 15:30:43 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #6 15:30:44 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #0 15:30:45 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #2 15:30:46 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
5344 15:30:47 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #18 15:30:47 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
2288 15:30:48 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

3288 15:30:48 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #8 15:30:48 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
2436 15:30:49 INFO  [Experience Analytics]: Reduce agent found zero sites to process
ManagedPoolThread #11 15:30:49 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #13 15:30:51 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #13 15:30:51 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
5476 15:30:52 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

2896 15:30:52 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

1932 15:30:55 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Core.BackgroundService.Run()

6832 15:30:57 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #7 15:31:01 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #7 15:31:01 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
5344 15:31:02 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

2288 15:31:03 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

3288 15:31:03 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

5476 15:31:07 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

2896 15:31:07 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

1932 15:31:10 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #13 15:31:11 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #13 15:31:11 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
6832 15:31:12 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

5344 15:31:17 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

2288 15:31:18 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

3288 15:31:18 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

2436 15:31:19 INFO  [Experience Analytics]: Reduce agent found zero sites to process
ManagedPoolThread #7 15:31:21 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #7 15:31:21 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
5476 15:31:22 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

2896 15:31:22 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

1932 15:31:25 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Core.BackgroundService.Run()

6832 15:31:27 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #13 15:31:31 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #13 15:31:31 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
5344 15:31:32 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

2288 15:31:33 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

3288 15:31:33 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

5476 15:31:37 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

2896 15:31:37 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

1932 15:31:40 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #10 15:31:41 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #10 15:31:41 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
6832 15:31:42 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #19 15:31:46 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
5344 15:31:47 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #9 15:31:48 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
2288 15:31:48 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

3288 15:31:48 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #12 15:31:49 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
2436 15:31:49 INFO  [Experience Analytics]: Reduce agent found zero sites to process
ManagedPoolThread #3 15:31:50 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #6 15:31:51 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #16 15:31:51 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #16 15:31:51 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
ManagedPoolThread #5 15:31:52 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
5476 15:31:52 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #14 15:31:53 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #1 15:31:54 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #0 15:31:55 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
1932 15:31:55 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #15 15:31:56 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #2 15:31:57 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
6832 15:31:57 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #18 15:31:58 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #17 15:31:59 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #11 15:32:00 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
2896 15:32:01 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
2896 15:32:01 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.HandleDatabaseException(ExceptionBehavior exceptionBehavior, Exception ex)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

Nested Exception

Exception: MongoDB.Driver.MongoConnectionException
Message: Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
Source: MongoDB.Driver
   at MongoDB.Driver.Internal.DirectMongoServerProxy.Connect(TimeSpan timeout, ReadPreference readPreference)
   at MongoDB.Driver.Internal.DirectMongoServerProxy.ChooseServerInstance(ReadPreference readPreference)
   at MongoDB.Driver.MongoServer.AcquireConnection(ReadPreference readPreference)
   at MongoDB.Driver.MongoCollection.RunCommandAs[TCommandResult](IMongoCommand command, ReadPreference readPreference, IBsonSerializer resultSerializer, IBsonSerializationOptions resultSerializationOptions)
   at MongoDB.Driver.MongoCollection.RunCommandAs[TCommandResult](IMongoCommand command, ReadPreference readPreference)
   at MongoDB.Driver.MongoCollection.FindAndModify(FindAndModifyArgs args)
   at MongoDB.Driver.MongoCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.<>c__DisplayClass2c.<FindAndModify>b__2b()
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)

Nested Exception

Exception: System.Net.Sockets.SocketException
Message: No connection could be made because the target machine actively refused it 127.0.0.1:27017
Source: System
   at System.Net.Sockets.Socket.DoConnect(EndPoint endPointSnapshot, SocketAddress socketAddress)
   at System.Net.Sockets.Socket.Connect(EndPoint remoteEP)
   at System.Net.Sockets.TcpClient.Connect(IPEndPoint remoteEP)
   at MongoDB.Driver.Internal.MongoConnection.Open()
   at MongoDB.Driver.Internal.MongoConnection.SendMessage(BsonBuffer buffer, Int32 requestId)
   at MongoDB.Driver.Internal.MongoConnection.SendMessage(MongoRequestMessage message)
   at MongoDB.Driver.Operations.CommandOperation`1.Execute(MongoConnection connection)
   at MongoDB.Driver.MongoServerInstance.Ping(MongoConnection connection)
   at MongoDB.Driver.MongoServerInstance.Connect()
   at MongoDB.Driver.Internal.DirectMongoServerProxy.Connect(TimeSpan timeout, ReadPreference readPreference)



ManagedPoolThread #10 15:32:01 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #10 15:32:01 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
ManagedPoolThread #8 15:32:02 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
5344 15:32:02 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

2288 15:32:03 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

3288 15:32:03 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

5476 15:32:07 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

1932 15:32:10 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #16 15:32:11 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #16 15:32:11 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
6832 15:32:12 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

2896 15:32:16 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

5344 15:32:17 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

2288 15:32:18 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

3288 15:32:18 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

2436 15:32:19 INFO  [Experience Analytics]: Reduce agent found zero sites to process
ManagedPoolThread #10 15:32:21 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #10 15:32:21 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
5476 15:32:22 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

1932 15:32:25 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Core.BackgroundService.Run()

6832 15:32:27 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

Heartbeat 15:32:29 ERROR MongoDbDictionary.Store() has failed.
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Save(Object value)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbDictionary.Store(Object value)

2896 15:32:31 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #16 15:32:31 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #16 15:32:31 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
5344 15:32:32 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

2288 15:32:33 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

3288 15:32:33 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

5476 15:32:37 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

1932 15:32:40 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #10 15:32:41 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #10 15:32:41 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
6832 15:32:42 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

2896 15:32:46 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

5344 15:32:47 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

2288 15:32:48 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

3288 15:32:48 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

2436 15:32:49 INFO  [Experience Analytics]: Reduce agent found zero sites to process
ManagedPoolThread #16 15:32:51 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #16 15:32:51 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
5476 15:32:52 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

1932 15:32:55 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #3 15:32:57 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
6832 15:32:57 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #12 15:32:58 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #19 15:32:59 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #6 15:33:00 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #15 15:33:01 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #10 15:33:01 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #10 15:33:01 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
ManagedPoolThread #9 15:33:02 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
5344 15:33:02 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #5 15:33:03 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
2288 15:33:03 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

3288 15:33:03 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #14 15:33:04 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #0 15:33:05 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #1 15:33:06 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #2 15:33:07 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
5476 15:33:07 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

2896 15:33:08 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
2896 15:33:08 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.HandleDatabaseException(ExceptionBehavior exceptionBehavior, Exception ex)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

Nested Exception

Exception: MongoDB.Driver.MongoConnectionException
Message: Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
Source: MongoDB.Driver
   at MongoDB.Driver.Internal.DirectMongoServerProxy.Connect(TimeSpan timeout, ReadPreference readPreference)
   at MongoDB.Driver.Internal.DirectMongoServerProxy.ChooseServerInstance(ReadPreference readPreference)
   at MongoDB.Driver.MongoServer.AcquireConnection(ReadPreference readPreference)
   at MongoDB.Driver.MongoCollection.RunCommandAs[TCommandResult](IMongoCommand command, ReadPreference readPreference, IBsonSerializer resultSerializer, IBsonSerializationOptions resultSerializationOptions)
   at MongoDB.Driver.MongoCollection.RunCommandAs[TCommandResult](IMongoCommand command, ReadPreference readPreference)
   at MongoDB.Driver.MongoCollection.FindAndModify(FindAndModifyArgs args)
   at MongoDB.Driver.MongoCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.<>c__DisplayClass2c.<FindAndModify>b__2b()
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)

Nested Exception

Exception: System.Net.Sockets.SocketException
Message: No connection could be made because the target machine actively refused it 127.0.0.1:27017
Source: System
   at System.Net.Sockets.Socket.DoConnect(EndPoint endPointSnapshot, SocketAddress socketAddress)
   at System.Net.Sockets.Socket.Connect(EndPoint remoteEP)
   at System.Net.Sockets.TcpClient.Connect(IPEndPoint remoteEP)
   at MongoDB.Driver.Internal.MongoConnection.Open()
   at MongoDB.Driver.Internal.MongoConnection.SendMessage(BsonBuffer buffer, Int32 requestId)
   at MongoDB.Driver.Internal.MongoConnection.SendMessage(MongoRequestMessage message)
   at MongoDB.Driver.Operations.CommandOperation`1.Execute(MongoConnection connection)
   at MongoDB.Driver.MongoServerInstance.Ping(MongoConnection connection)
   at MongoDB.Driver.MongoServerInstance.Connect()
   at MongoDB.Driver.Internal.DirectMongoServerProxy.Connect(TimeSpan timeout, ReadPreference readPreference)



ManagedPoolThread #8 15:33:09 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #18 15:33:10 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
1932 15:33:10 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #16 15:33:11 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #16 15:33:11 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
6832 15:33:12 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

5344 15:33:17 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

2288 15:33:18 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

3288 15:33:18 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

2436 15:33:19 INFO  [Experience Analytics]: Reduce agent found zero sites to process
ManagedPoolThread #13 15:33:21 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #13 15:33:21 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
5476 15:33:22 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

2896 15:33:23 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

1932 15:33:25 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Core.BackgroundService.Run()

6832 15:33:27 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #10 15:33:31 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #10 15:33:31 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
5344 15:33:32 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

2288 15:33:33 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

3288 15:33:33 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

5476 15:33:37 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

2896 15:33:38 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

1932 15:33:40 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #16 15:33:41 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #16 15:33:41 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
6832 15:33:42 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

5344 15:33:47 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

2288 15:33:48 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

3288 15:33:48 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

2436 15:33:49 INFO  [Experience Analytics]: Reduce agent found zero sites to process
ManagedPoolThread #7 15:33:51 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #7 15:33:51 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
5476 15:33:52 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

2896 15:33:53 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

1932 15:33:55 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Core.BackgroundService.Run()

6832 15:33:57 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #16 15:34:01 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #16 15:34:01 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
5344 15:34:02 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

2288 15:34:03 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

3288 15:34:03 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #3 15:34:07 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
5476 15:34:07 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #12 15:34:08 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
2896 15:34:08 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #19 15:34:09 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #15 15:34:10 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
1932 15:34:10 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #5 15:34:11 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #7 15:34:11 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #7 15:34:11 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
ManagedPoolThread #9 15:34:12 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
6832 15:34:12 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #6 15:34:13 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #14 15:34:14 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #0 15:34:15 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
Heartbeat 15:34:15 INFO  Health.PrivateBytes: 749,342,720
Heartbeat 15:34:15 INFO  Health.CacheInstances: 116
Heartbeat 15:34:15 INFO  Health.CacheTotalCount: 21,146
Heartbeat 15:34:15 INFO  Health.CacheTotalSize: 84,485,258
ManagedPoolThread #1 15:34:16 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #2 15:34:17 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
5344 15:34:17 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #8 15:34:18 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
2288 15:34:18 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

3288 15:34:18 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

 388 15:34:18 INFO  [Path Analyzer](.) Running trail cleanup agent
 388 15:34:18 INFO  [Path Analyzer](.) Running trail cleanup on database
ManagedPoolThread #11 15:34:19 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
2436 15:34:19 INFO  [Experience Analytics]: Reduce agent found zero sites to process
ManagedPoolThread #18 15:34:20 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #17 15:34:21 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #13 15:34:21 INFO  Job started: Sitecore.Tasks.TaskDatabaseAgent
ManagedPoolThread #13 15:34:21 INFO  Processing tasks (count: 0)
ManagedPoolThread #13 15:34:21 INFO  Job ended: Sitecore.Tasks.TaskDatabaseAgent (units processed: )
ManagedPoolThread #13 15:34:21 INFO  Job started: Core_Database_Agent
ManagedPoolThread #13 15:34:21 INFO  Scheduling.DatabaseAgent started. Database: core
ManagedPoolThread #13 15:34:21 INFO  Examining schedules (count: 0)
ManagedPoolThread #13 15:34:21 INFO  Job ended: Core_Database_Agent (units processed: )
ManagedPoolThread #13 15:34:21 INFO  Job started: Master_Database_Agent
ManagedPoolThread #13 15:34:21 INFO  Scheduling.DatabaseAgent started. Database: master
ManagedPoolThread #13 15:34:21 INFO  Examining schedules (count: 5)
ManagedPoolThread #13 15:34:21 INFO  Starting: __Task Schedule
ManagedPoolThread #13 15:34:21 INFO  Ended: __Task Schedule
ManagedPoolThread #13 15:34:21 INFO  Not due: Calculate Statistical Relevancy
ManagedPoolThread #13 15:34:21 INFO  Not due: Rebuild Suggested Tests Index
ManagedPoolThread #13 15:34:21 INFO  Not due: Suspend Corrupted Tests
ManagedPoolThread #13 15:34:21 INFO  Not due: Try Finish Test
ManagedPoolThread #13 15:34:21 INFO  Job ended: Master_Database_Agent (units processed: 5)
ManagedPoolThread #10 15:34:21 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #10 15:34:21 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
5476 15:34:22 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

2896 15:34:23 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

1932 15:34:25 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Core.BackgroundService.Run()

6832 15:34:27 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

Heartbeat 15:34:29 ERROR MongoDbDictionary.Store() has failed.
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Save(Object value)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbDictionary.Store(Object value)

ManagedPoolThread #13 15:34:31 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #13 15:34:31 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
5344 15:34:32 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

2288 15:34:33 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

3288 15:34:33 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

5476 15:34:37 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

2896 15:34:38 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

1932 15:34:40 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #7 15:34:41 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #7 15:34:41 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
6832 15:34:42 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

5344 15:34:47 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

2288 15:34:48 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

3288 15:34:48 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

2436 15:34:49 INFO  [Experience Analytics]: Reduce agent found zero sites to process
ManagedPoolThread #13 15:34:51 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #13 15:34:51 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
5476 15:34:52 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

2896 15:34:53 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

1932 15:34:55 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Core.BackgroundService.Run()

6832 15:34:57 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #7 15:35:01 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #7 15:35:01 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
5344 15:35:02 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

2288 15:35:03 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

3288 15:35:03 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

5476 15:35:07 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

2896 15:35:08 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

1932 15:35:10 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #13 15:35:11 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #13 15:35:11 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
6832 15:35:12 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #12 15:35:17 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
5344 15:35:17 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #3 15:35:18 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
2288 15:35:18 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

3288 15:35:18 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #19 15:35:19 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
2436 15:35:19 INFO  [Experience Analytics]: Reduce agent found zero sites to process
ManagedPoolThread #15 15:35:20 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #5 15:35:21 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #7 15:35:21 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #7 15:35:21 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
ManagedPoolThread #9 15:35:22 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
5476 15:35:22 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #6 15:35:23 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #0 15:35:24 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #14 15:35:25 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
1932 15:35:25 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #1 15:35:26 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #2 15:35:27 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
6832 15:35:27 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #11 15:35:28 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #17 15:35:29 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
2896 15:35:30 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
2896 15:35:30 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.HandleDatabaseException(ExceptionBehavior exceptionBehavior, Exception ex)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

Nested Exception

Exception: MongoDB.Driver.MongoConnectionException
Message: Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
Source: MongoDB.Driver
   at MongoDB.Driver.Internal.DirectMongoServerProxy.Connect(TimeSpan timeout, ReadPreference readPreference)
   at MongoDB.Driver.Internal.DirectMongoServerProxy.ChooseServerInstance(ReadPreference readPreference)
   at MongoDB.Driver.MongoServer.AcquireConnection(ReadPreference readPreference)
   at MongoDB.Driver.MongoCollection.RunCommandAs[TCommandResult](IMongoCommand command, ReadPreference readPreference, IBsonSerializer resultSerializer, IBsonSerializationOptions resultSerializationOptions)
   at MongoDB.Driver.MongoCollection.RunCommandAs[TCommandResult](IMongoCommand command, ReadPreference readPreference)
   at MongoDB.Driver.MongoCollection.FindAndModify(FindAndModifyArgs args)
   at MongoDB.Driver.MongoCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.<>c__DisplayClass2c.<FindAndModify>b__2b()
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)

Nested Exception

Exception: System.Net.Sockets.SocketException
Message: No connection could be made because the target machine actively refused it 127.0.0.1:27017
Source: System
   at System.Net.Sockets.Socket.DoConnect(EndPoint endPointSnapshot, SocketAddress socketAddress)
   at System.Net.Sockets.Socket.Connect(EndPoint remoteEP)
   at System.Net.Sockets.TcpClient.Connect(IPEndPoint remoteEP)
   at MongoDB.Driver.Internal.MongoConnection.Open()
   at MongoDB.Driver.Internal.MongoConnection.SendMessage(BsonBuffer buffer, Int32 requestId)
   at MongoDB.Driver.Internal.MongoConnection.SendMessage(MongoRequestMessage message)
   at MongoDB.Driver.Operations.CommandOperation`1.Execute(MongoConnection connection)
   at MongoDB.Driver.MongoServerInstance.Ping(MongoConnection connection)
   at MongoDB.Driver.MongoServerInstance.Connect()
   at MongoDB.Driver.Internal.DirectMongoServerProxy.Connect(TimeSpan timeout, ReadPreference readPreference)



ManagedPoolThread #8 15:35:31 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #13 15:35:31 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #13 15:35:31 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
5344 15:35:32 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

2288 15:35:33 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

3288 15:35:33 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

5476 15:35:37 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

1932 15:35:40 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #16 15:35:41 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #16 15:35:41 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
6832 15:35:42 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

2896 15:35:45 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

5344 15:35:47 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

2288 15:35:48 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

3288 15:35:48 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

2436 15:35:49 INFO  [Experience Analytics]: Reduce agent found zero sites to process
ManagedPoolThread #10 15:35:51 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #10 15:35:51 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
5476 15:35:52 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

1932 15:35:55 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Core.BackgroundService.Run()

6832 15:35:57 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

2896 15:36:00 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #7 15:36:01 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #7 15:36:01 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
5344 15:36:02 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

2288 15:36:03 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

3288 15:36:03 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

5476 15:36:07 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

1932 15:36:10 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #13 15:36:11 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #13 15:36:11 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
6832 15:36:12 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

2896 15:36:15 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

5344 15:36:17 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

2288 15:36:18 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

3288 15:36:18 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

2436 15:36:19 INFO  [Experience Analytics]: Reduce agent found zero sites to process
ManagedPoolThread #16 15:36:21 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #16 15:36:21 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
5476 15:36:22 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

1932 15:36:25 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #15 15:36:27 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
6832 15:36:27 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #3 15:36:28 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #19 15:36:29 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
Heartbeat 15:36:29 ERROR MongoDbDictionary.Store() has failed.
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Save(Object value)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbDictionary.Store(Object value)

ManagedPoolThread #5 15:36:30 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #0 15:36:31 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #10 15:36:31 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #10 15:36:31 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
ManagedPoolThread #9 15:36:32 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
5344 15:36:32 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #12 15:36:33 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
2288 15:36:33 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

3288 15:36:33 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #6 15:36:34 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #14 15:36:35 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #1 15:36:36 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #2 15:36:37 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
5476 15:36:37 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

2896 15:36:38 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
2896 15:36:38 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.HandleDatabaseException(ExceptionBehavior exceptionBehavior, Exception ex)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

Nested Exception

Exception: MongoDB.Driver.MongoConnectionException
Message: Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
Source: MongoDB.Driver
   at MongoDB.Driver.Internal.DirectMongoServerProxy.Connect(TimeSpan timeout, ReadPreference readPreference)
   at MongoDB.Driver.Internal.DirectMongoServerProxy.ChooseServerInstance(ReadPreference readPreference)
   at MongoDB.Driver.MongoServer.AcquireConnection(ReadPreference readPreference)
   at MongoDB.Driver.MongoCollection.RunCommandAs[TCommandResult](IMongoCommand command, ReadPreference readPreference, IBsonSerializer resultSerializer, IBsonSerializationOptions resultSerializationOptions)
   at MongoDB.Driver.MongoCollection.RunCommandAs[TCommandResult](IMongoCommand command, ReadPreference readPreference)
   at MongoDB.Driver.MongoCollection.FindAndModify(FindAndModifyArgs args)
   at MongoDB.Driver.MongoCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.<>c__DisplayClass2c.<FindAndModify>b__2b()
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)

Nested Exception

Exception: System.Net.Sockets.SocketException
Message: No connection could be made because the target machine actively refused it 127.0.0.1:27017
Source: System
   at System.Net.Sockets.Socket.DoConnect(EndPoint endPointSnapshot, SocketAddress socketAddress)
   at System.Net.Sockets.Socket.Connect(EndPoint remoteEP)
   at System.Net.Sockets.TcpClient.Connect(IPEndPoint remoteEP)
   at MongoDB.Driver.Internal.MongoConnection.Open()
   at MongoDB.Driver.Internal.MongoConnection.SendMessage(BsonBuffer buffer, Int32 requestId)
   at MongoDB.Driver.Internal.MongoConnection.SendMessage(MongoRequestMessage message)
   at MongoDB.Driver.Operations.CommandOperation`1.Execute(MongoConnection connection)
   at MongoDB.Driver.MongoServerInstance.Ping(MongoConnection connection)
   at MongoDB.Driver.MongoServerInstance.Connect()
   at MongoDB.Driver.Internal.DirectMongoServerProxy.Connect(TimeSpan timeout, ReadPreference readPreference)



ManagedPoolThread #8 15:36:39 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
1932 15:36:40 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #11 15:36:40 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #13 15:36:41 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #13 15:36:41 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
6832 15:36:42 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

5344 15:36:47 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

2288 15:36:48 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

3288 15:36:48 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

2436 15:36:49 INFO  [Experience Analytics]: Reduce agent found zero sites to process
ManagedPoolThread #7 15:36:51 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #7 15:36:51 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
5476 15:36:52 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

2896 15:36:53 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

1932 15:36:55 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Core.BackgroundService.Run()

6832 15:36:57 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #13 15:37:01 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #13 15:37:01 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
5344 15:37:02 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

2288 15:37:03 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

3288 15:37:03 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

5476 15:37:07 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

2896 15:37:08 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

1932 15:37:10 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #10 15:37:11 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #10 15:37:11 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
6832 15:37:12 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

5344 15:37:17 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

2288 15:37:18 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

3288 15:37:18 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

2436 15:37:19 INFO  [Experience Analytics]: Reduce agent found zero sites to process
ManagedPoolThread #16 15:37:21 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #16 15:37:21 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
5476 15:37:22 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

2896 15:37:23 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

1932 15:37:25 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Core.BackgroundService.Run()

6832 15:37:27 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #10 15:37:31 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #10 15:37:31 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
5344 15:37:32 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

2288 15:37:33 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

3288 15:37:33 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #3 15:37:37 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
5476 15:37:37 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #19 15:37:38 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #15 15:37:39 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
1932 15:37:40 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #5 15:37:40 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #6 15:37:41 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #13 15:37:41 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #13 15:37:41 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
ManagedPoolThread #14 15:37:42 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
6832 15:37:42 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #1 15:37:43 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #0 15:37:44 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #12 15:37:45 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #9 15:37:46 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #2 15:37:47 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
5344 15:37:47 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

2896 15:37:48 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
2896 15:37:48 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.HandleDatabaseException(ExceptionBehavior exceptionBehavior, Exception ex)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

Nested Exception

Exception: MongoDB.Driver.MongoConnectionException
Message: Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
Source: MongoDB.Driver
   at MongoDB.Driver.Internal.DirectMongoServerProxy.Connect(TimeSpan timeout, ReadPreference readPreference)
   at MongoDB.Driver.Internal.DirectMongoServerProxy.ChooseServerInstance(ReadPreference readPreference)
   at MongoDB.Driver.MongoServer.AcquireConnection(ReadPreference readPreference)
   at MongoDB.Driver.MongoCollection.RunCommandAs[TCommandResult](IMongoCommand command, ReadPreference readPreference, IBsonSerializer resultSerializer, IBsonSerializationOptions resultSerializationOptions)
   at MongoDB.Driver.MongoCollection.RunCommandAs[TCommandResult](IMongoCommand command, ReadPreference readPreference)
   at MongoDB.Driver.MongoCollection.FindAndModify(FindAndModifyArgs args)
   at MongoDB.Driver.MongoCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.<>c__DisplayClass2c.<FindAndModify>b__2b()
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)

Nested Exception

Exception: System.Net.Sockets.SocketException
Message: No connection could be made because the target machine actively refused it 127.0.0.1:27017
Source: System
   at System.Net.Sockets.Socket.DoConnect(EndPoint endPointSnapshot, SocketAddress socketAddress)
   at System.Net.Sockets.Socket.Connect(EndPoint remoteEP)
   at System.Net.Sockets.TcpClient.Connect(IPEndPoint remoteEP)
   at MongoDB.Driver.Internal.MongoConnection.Open()
   at MongoDB.Driver.Internal.MongoConnection.SendMessage(BsonBuffer buffer, Int32 requestId)
   at MongoDB.Driver.Internal.MongoConnection.SendMessage(MongoRequestMessage message)
   at MongoDB.Driver.Operations.CommandOperation`1.Execute(MongoConnection connection)
   at MongoDB.Driver.MongoServerInstance.Ping(MongoConnection connection)
   at MongoDB.Driver.MongoServerInstance.Connect()
   at MongoDB.Driver.Internal.DirectMongoServerProxy.Connect(TimeSpan timeout, ReadPreference readPreference)



2288 15:37:48 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

3288 15:37:48 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

2436 15:37:49 INFO  [Experience Analytics]: Reduce agent found zero sites to process
ManagedPoolThread #17 15:37:49 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #18 15:37:50 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #11 15:37:51 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #7 15:37:51 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #7 15:37:51 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
ManagedPoolThread #8 15:37:52 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
5476 15:37:52 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

1932 15:37:55 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Core.BackgroundService.Run()

6832 15:37:57 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #13 15:38:01 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #13 15:38:01 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
5344 15:38:02 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

2896 15:38:03 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

2288 15:38:03 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

3288 15:38:03 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

5476 15:38:07 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

1932 15:38:10 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #7 15:38:11 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #7 15:38:11 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
6832 15:38:12 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

5344 15:38:17 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

2896 15:38:18 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

2288 15:38:18 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

3288 15:38:18 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

2436 15:38:19 INFO  [Experience Analytics]: Reduce agent found zero sites to process
ManagedPoolThread #13 15:38:21 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #13 15:38:21 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
5476 15:38:22 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

1932 15:38:25 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Core.BackgroundService.Run()

6832 15:38:27 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

Heartbeat 15:38:29 ERROR MongoDbDictionary.Store() has failed.
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Save(Object value)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbDictionary.Store(Object value)

ManagedPoolThread #7 15:38:31 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #7 15:38:31 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
5344 15:38:32 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

2896 15:38:33 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

2288 15:38:33 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

3288 15:38:33 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

5476 15:38:37 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

1932 15:38:40 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #10 15:38:41 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #10 15:38:41 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
6832 15:38:42 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #3 15:38:47 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
5344 15:38:47 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

2896 15:38:48 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #19 15:38:48 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
2288 15:38:48 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

3288 15:38:48 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

2436 15:38:49 INFO  [Experience Analytics]: Reduce agent found zero sites to process
ManagedPoolThread #5 15:38:49 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #6 15:38:50 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #14 15:38:51 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #16 15:38:51 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #16 15:38:51 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
ManagedPoolThread #15 15:38:52 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
5476 15:38:52 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #0 15:38:53 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #1 15:38:54 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
1932 15:38:55 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #9 15:38:55 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #12 15:38:56 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #2 15:38:57 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
6832 15:38:57 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #18 15:38:58 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #8 15:38:59 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #10 15:39:01 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #10 15:39:01 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
5344 15:39:02 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

2896 15:39:03 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

2288 15:39:03 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

3288 15:39:03 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

5476 15:39:07 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

1932 15:39:10 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #16 15:39:11 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #16 15:39:11 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
6832 15:39:12 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

5344 15:39:17 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

2896 15:39:18 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

2288 15:39:18 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

3288 15:39:18 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

 388 15:39:18 INFO  [Path Analyzer](.) Running trail cleanup agent
 388 15:39:18 INFO  [Path Analyzer](.) Running trail cleanup on database
6508 15:39:18 WARN  [Path Analyzer](.) SmartMergeAgent.Execute() returns. No missing date ranges to merge.
2436 15:39:19 INFO  [Experience Analytics]: Reduce agent found zero sites to process
ManagedPoolThread #16 15:39:21 INFO  Job started: Sitecore.Tasks.UrlAgent
ManagedPoolThread #16 15:39:21 INFO  Scheduling.UrlAgent started. Url: http://gathercontent.dev/sitecore/service/keepalive.aspx
ManagedPoolThread #16 15:39:21 INFO  Scheduling.UrlAgent done (received: 561 bytes)
ManagedPoolThread #16 15:39:21 INFO  Job ended: Sitecore.Tasks.UrlAgent (units processed: )
ManagedPoolThread #13 15:39:21 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #13 15:39:21 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
5476 15:39:22 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

1932 15:39:25 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Core.BackgroundService.Run()

6832 15:39:27 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #7 15:39:31 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #7 15:39:31 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
5344 15:39:32 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

2896 15:39:33 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

2288 15:39:33 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

3288 15:39:33 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

5476 15:39:37 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

1932 15:39:40 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #10 15:39:41 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #10 15:39:41 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
6832 15:39:42 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

5344 15:39:47 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

2896 15:39:48 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

2288 15:39:48 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

3288 15:39:48 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

2436 15:39:49 INFO  [Experience Analytics]: Reduce agent found zero sites to process
ManagedPoolThread #16 15:39:51 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #16 15:39:51 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
5476 15:39:52 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

1932 15:39:55 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #6 15:39:57 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
6832 15:39:57 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #19 15:39:58 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #5 15:39:59 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #15 15:40:00 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #3 15:40:01 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #10 15:40:01 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #10 15:40:01 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
ManagedPoolThread #14 15:40:02 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
5344 15:40:02 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

2288 15:40:03 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #1 15:40:03 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
3288 15:40:03 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #0 15:40:04 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #9 15:40:05 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #12 15:40:06 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #2 15:40:07 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
5476 15:40:07 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #18 15:40:08 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #17 15:40:09 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
1932 15:40:10 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #8 15:40:10 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #11 15:40:11 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #16 15:40:11 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #16 15:40:11 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
2896 15:40:12 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
2896 15:40:12 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.HandleDatabaseException(ExceptionBehavior exceptionBehavior, Exception ex)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

Nested Exception

Exception: MongoDB.Driver.MongoConnectionException
Message: Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
Source: MongoDB.Driver
   at MongoDB.Driver.Internal.DirectMongoServerProxy.Connect(TimeSpan timeout, ReadPreference readPreference)
   at MongoDB.Driver.Internal.DirectMongoServerProxy.ChooseServerInstance(ReadPreference readPreference)
   at MongoDB.Driver.MongoServer.AcquireConnection(ReadPreference readPreference)
   at MongoDB.Driver.MongoCollection.RunCommandAs[TCommandResult](IMongoCommand command, ReadPreference readPreference, IBsonSerializer resultSerializer, IBsonSerializationOptions resultSerializationOptions)
   at MongoDB.Driver.MongoCollection.RunCommandAs[TCommandResult](IMongoCommand command, ReadPreference readPreference)
   at MongoDB.Driver.MongoCollection.FindAndModify(FindAndModifyArgs args)
   at MongoDB.Driver.MongoCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.<>c__DisplayClass2c.<FindAndModify>b__2b()
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)

Nested Exception

Exception: System.Net.Sockets.SocketException
Message: No connection could be made because the target machine actively refused it 127.0.0.1:27017
Source: System
   at System.Net.Sockets.Socket.DoConnect(EndPoint endPointSnapshot, SocketAddress socketAddress)
   at System.Net.Sockets.Socket.Connect(EndPoint remoteEP)
   at System.Net.Sockets.TcpClient.Connect(IPEndPoint remoteEP)
   at MongoDB.Driver.Internal.MongoConnection.Open()
   at MongoDB.Driver.Internal.MongoConnection.SendMessage(BsonBuffer buffer, Int32 requestId)
   at MongoDB.Driver.Internal.MongoConnection.SendMessage(MongoRequestMessage message)
   at MongoDB.Driver.Operations.CommandOperation`1.Execute(MongoConnection connection)
   at MongoDB.Driver.MongoServerInstance.Ping(MongoConnection connection)
   at MongoDB.Driver.MongoServerInstance.Connect()
   at MongoDB.Driver.Internal.DirectMongoServerProxy.Connect(TimeSpan timeout, ReadPreference readPreference)



6832 15:40:12 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

5344 15:40:17 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

2288 15:40:18 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

3288 15:40:18 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

2436 15:40:19 INFO  [Experience Analytics]: Reduce agent found zero sites to process
ManagedPoolThread #10 15:40:21 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #10 15:40:21 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
5476 15:40:22 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

1932 15:40:25 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Core.BackgroundService.Run()

2896 15:40:27 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

6832 15:40:27 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

Heartbeat 15:40:29 ERROR MongoDbDictionary.Store() has failed.
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Save(Object value)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbDictionary.Store(Object value)

ManagedPoolThread #16 15:40:31 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #16 15:40:31 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
5344 15:40:32 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

2288 15:40:33 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

3288 15:40:33 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

5476 15:40:37 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

1932 15:40:40 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #7 15:40:41 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #7 15:40:41 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
2896 15:40:42 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

6832 15:40:42 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

5344 15:40:47 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

2288 15:40:48 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

3288 15:40:48 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

2436 15:40:49 INFO  [Experience Analytics]: Reduce agent found zero sites to process
ManagedPoolThread #13 15:40:51 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #13 15:40:51 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
5476 15:40:52 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

1932 15:40:55 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Core.BackgroundService.Run()

2896 15:40:57 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

6832 15:40:57 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #7 15:41:01 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #7 15:41:02 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
5344 15:41:02 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

2288 15:41:03 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

3288 15:41:03 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #5 15:41:07 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
5476 15:41:07 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #1 15:41:08 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #3 15:41:09 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
1932 15:41:10 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #15 15:41:10 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #19 15:41:11 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #13 15:41:12 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #13 15:41:12 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
ManagedPoolThread #14 15:41:12 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
6832 15:41:12 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #6 15:41:13 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #12 15:41:14 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #0 15:41:15 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #9 15:41:16 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #2 15:41:17 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
5344 15:41:17 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

2288 15:41:18 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #11 15:41:18 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
3288 15:41:18 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

2436 15:41:19 INFO  [Experience Analytics]: Reduce agent found zero sites to process
2896 15:41:19 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
2896 15:41:19 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.HandleDatabaseException(ExceptionBehavior exceptionBehavior, Exception ex)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

Nested Exception

Exception: MongoDB.Driver.MongoConnectionException
Message: Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
Source: MongoDB.Driver
   at MongoDB.Driver.Internal.DirectMongoServerProxy.Connect(TimeSpan timeout, ReadPreference readPreference)
   at MongoDB.Driver.Internal.DirectMongoServerProxy.ChooseServerInstance(ReadPreference readPreference)
   at MongoDB.Driver.MongoServer.AcquireConnection(ReadPreference readPreference)
   at MongoDB.Driver.MongoCollection.RunCommandAs[TCommandResult](IMongoCommand command, ReadPreference readPreference, IBsonSerializer resultSerializer, IBsonSerializationOptions resultSerializationOptions)
   at MongoDB.Driver.MongoCollection.RunCommandAs[TCommandResult](IMongoCommand command, ReadPreference readPreference)
   at MongoDB.Driver.MongoCollection.FindAndModify(FindAndModifyArgs args)
   at MongoDB.Driver.MongoCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.<>c__DisplayClass2c.<FindAndModify>b__2b()
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)

Nested Exception

Exception: System.Net.Sockets.SocketException
Message: No connection could be made because the target machine actively refused it 127.0.0.1:27017
Source: System
   at System.Net.Sockets.Socket.DoConnect(EndPoint endPointSnapshot, SocketAddress socketAddress)
   at System.Net.Sockets.Socket.Connect(EndPoint remoteEP)
   at System.Net.Sockets.TcpClient.Connect(IPEndPoint remoteEP)
   at MongoDB.Driver.Internal.MongoConnection.Open()
   at MongoDB.Driver.Internal.MongoConnection.SendMessage(BsonBuffer buffer, Int32 requestId)
   at MongoDB.Driver.Internal.MongoConnection.SendMessage(MongoRequestMessage message)
   at MongoDB.Driver.Operations.CommandOperation`1.Execute(MongoConnection connection)
   at MongoDB.Driver.MongoServerInstance.Ping(MongoConnection connection)
   at MongoDB.Driver.MongoServerInstance.Connect()
   at MongoDB.Driver.Internal.DirectMongoServerProxy.Connect(TimeSpan timeout, ReadPreference readPreference)



ManagedPoolThread #18 15:41:20 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #17 15:41:21 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #7 15:41:22 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #7 15:41:22 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
5476 15:41:22 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

1932 15:41:25 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Core.BackgroundService.Run()

6832 15:41:27 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #13 15:41:32 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #13 15:41:32 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
5344 15:41:32 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

2288 15:41:33 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

3288 15:41:33 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

2896 15:41:34 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

5476 15:41:37 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

1932 15:41:40 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #7 15:41:42 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #7 15:41:42 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
6832 15:41:42 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

5344 15:41:47 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

2288 15:41:48 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

3288 15:41:48 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

2436 15:41:49 INFO  [Experience Analytics]: Reduce agent found zero sites to process
2896 15:41:49 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #13 15:41:52 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #13 15:41:52 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
5476 15:41:52 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

1932 15:41:55 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Core.BackgroundService.Run()

6832 15:41:57 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #7 15:42:02 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #7 15:42:02 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
5344 15:42:02 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

2288 15:42:03 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

3288 15:42:03 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

2896 15:42:04 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

5476 15:42:07 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

1932 15:42:10 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #13 15:42:12 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #13 15:42:12 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
6832 15:42:12 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #15 15:42:17 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
5344 15:42:17 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

2288 15:42:18 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #3 15:42:18 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
3288 15:42:18 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

2436 15:42:19 INFO  [Experience Analytics]: Reduce agent found zero sites to process
2896 15:42:19 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #12 15:42:19 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #1 15:42:20 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #6 15:42:21 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #16 15:42:22 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #16 15:42:22 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
5476 15:42:22 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #5 15:42:22 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #19 15:42:23 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #14 15:42:24 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
1932 15:42:25 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #0 15:42:25 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #9 15:42:26 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #2 15:42:27 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
6832 15:42:27 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #11 15:42:28 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #8 15:42:29 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
Heartbeat 15:42:29 ERROR MongoDbDictionary.Store() has failed.
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Save(Object value)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbDictionary.Store(Object value)

ManagedPoolThread #17 15:42:30 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #18 15:42:31 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #10 15:42:32 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #10 15:42:32 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
5344 15:42:32 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

2288 15:42:33 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

3288 15:42:33 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

2896 15:42:34 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

5476 15:42:37 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

1932 15:42:40 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #13 15:42:42 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #13 15:42:42 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
6832 15:42:42 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

5344 15:42:47 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

2288 15:42:48 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

3288 15:42:48 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

2436 15:42:49 INFO  [Experience Analytics]: Reduce agent found zero sites to process
2896 15:42:49 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #7 15:42:52 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #7 15:42:52 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
5476 15:42:52 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

1932 15:42:55 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Core.BackgroundService.Run()

6832 15:42:57 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #13 15:43:02 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #13 15:43:02 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
5344 15:43:02 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

2288 15:43:03 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

3288 15:43:03 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

2896 15:43:04 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

5476 15:43:07 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

1932 15:43:10 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #10 15:43:12 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #10 15:43:12 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
6832 15:43:12 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

5344 15:43:17 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

2288 15:43:18 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

3288 15:43:18 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

2436 15:43:19 INFO  [Experience Analytics]: Reduce agent found zero sites to process
2896 15:43:19 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #16 15:43:22 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #16 15:43:22 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
5476 15:43:22 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

1932 15:43:25 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #12 15:43:27 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #3 15:43:28 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #9 15:43:29 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #14 15:43:30 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #5 15:43:31 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #10 15:43:32 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #10 15:43:32 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
ManagedPoolThread #15 15:43:32 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
5344 15:43:32 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

2288 15:43:33 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

3288 15:43:33 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #6 15:43:33 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #19 15:43:34 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #0 15:43:35 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #1 15:43:36 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
5476 15:43:37 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #2 15:43:37 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
6832 15:43:38 ERROR Exception when executing agent aggregation/automationAggregator
Exception: MongoDB.Driver.MongoConnectionException
Message: Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
Source: MongoDB.Driver
   at MongoDB.Driver.Internal.DirectMongoServerProxy.Connect(TimeSpan timeout, ReadPreference readPreference)
   at MongoDB.Driver.Internal.DirectMongoServerProxy.ChooseServerInstance(ReadPreference readPreference)
   at MongoDB.Driver.MongoServer.AcquireConnection(ReadPreference readPreference)
   at MongoDB.Driver.MongoCursor`1.MongoCursorConnectionProvider.AcquireConnection()
   at MongoDB.Driver.Operations.QueryOperation`1.GetFirstBatch(IConnectionProvider connectionProvider)
   at MongoDB.Driver.Operations.QueryOperation`1.Execute(IConnectionProvider connectionProvider)
   at System.Linq.Buffer`1..ctor(IEnumerable`1 source)
   at System.Linq.Enumerable.ToArray[TSource](IEnumerable`1 source)
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

Nested Exception

Exception: System.Net.Sockets.SocketException
Message: No connection could be made because the target machine actively refused it 127.0.0.1:27017
Source: System
   at System.Net.Sockets.Socket.DoConnect(EndPoint endPointSnapshot, SocketAddress socketAddress)
   at System.Net.Sockets.Socket.Connect(EndPoint remoteEP)
   at System.Net.Sockets.TcpClient.Connect(IPEndPoint remoteEP)
   at MongoDB.Driver.Internal.MongoConnection.Open()
   at MongoDB.Driver.Internal.MongoConnection.SendMessage(BsonBuffer buffer, Int32 requestId)
   at MongoDB.Driver.Internal.MongoConnection.SendMessage(MongoRequestMessage message)
   at MongoDB.Driver.Operations.CommandOperation`1.Execute(MongoConnection connection)
   at MongoDB.Driver.MongoServerInstance.Ping(MongoConnection connection)
   at MongoDB.Driver.MongoServerInstance.Connect()
   at MongoDB.Driver.Internal.DirectMongoServerProxy.Connect(TimeSpan timeout, ReadPreference readPreference)


ManagedPoolThread #8 15:43:39 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
1932 15:43:40 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #18 15:43:40 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
2896 15:43:41 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
2896 15:43:41 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.HandleDatabaseException(ExceptionBehavior exceptionBehavior, Exception ex)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

Nested Exception

Exception: MongoDB.Driver.MongoConnectionException
Message: Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
Source: MongoDB.Driver
   at MongoDB.Driver.Internal.DirectMongoServerProxy.Connect(TimeSpan timeout, ReadPreference readPreference)
   at MongoDB.Driver.Internal.DirectMongoServerProxy.ChooseServerInstance(ReadPreference readPreference)
   at MongoDB.Driver.MongoServer.AcquireConnection(ReadPreference readPreference)
   at MongoDB.Driver.MongoCollection.RunCommandAs[TCommandResult](IMongoCommand command, ReadPreference readPreference, IBsonSerializer resultSerializer, IBsonSerializationOptions resultSerializationOptions)
   at MongoDB.Driver.MongoCollection.RunCommandAs[TCommandResult](IMongoCommand command, ReadPreference readPreference)
   at MongoDB.Driver.MongoCollection.FindAndModify(FindAndModifyArgs args)
   at MongoDB.Driver.MongoCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.<>c__DisplayClass2c.<FindAndModify>b__2b()
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)

Nested Exception

Exception: System.Net.Sockets.SocketException
Message: No connection could be made because the target machine actively refused it 127.0.0.1:27017
Source: System
   at System.Net.Sockets.Socket.DoConnect(EndPoint endPointSnapshot, SocketAddress socketAddress)
   at System.Net.Sockets.Socket.Connect(EndPoint remoteEP)
   at System.Net.Sockets.TcpClient.Connect(IPEndPoint remoteEP)
   at MongoDB.Driver.Internal.MongoConnection.Open()
   at MongoDB.Driver.Internal.MongoConnection.SendMessage(BsonBuffer buffer, Int32 requestId)
   at MongoDB.Driver.Internal.MongoConnection.SendMessage(MongoRequestMessage message)
   at MongoDB.Driver.Operations.CommandOperation`1.Execute(MongoConnection connection)
   at MongoDB.Driver.MongoServerInstance.Ping(MongoConnection connection)
   at MongoDB.Driver.MongoServerInstance.Connect()
   at MongoDB.Driver.Internal.DirectMongoServerProxy.Connect(TimeSpan timeout, ReadPreference readPreference)



ManagedPoolThread #13 15:43:42 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #13 15:43:42 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
ManagedPoolThread #11 15:43:42 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #17 15:43:43 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
5344 15:43:47 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

2288 15:43:48 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

3288 15:43:48 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

2436 15:43:49 INFO  [Experience Analytics]: Reduce agent found zero sites to process
ManagedPoolThread #7 15:43:52 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #7 15:43:52 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
5476 15:43:52 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

6832 15:43:53 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

1932 15:43:55 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Core.BackgroundService.Run()

2896 15:43:56 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #13 15:44:02 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #13 15:44:02 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
5344 15:44:02 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

2288 15:44:03 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

3288 15:44:03 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

5476 15:44:07 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

6832 15:44:08 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

1932 15:44:10 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Core.BackgroundService.Run()

2896 15:44:11 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #7 15:44:12 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #7 15:44:12 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
Heartbeat 15:44:16 INFO  Health.PrivateBytes: 767,283,200
Heartbeat 15:44:16 INFO  Health.CacheInstances: 116
Heartbeat 15:44:16 INFO  Health.CacheTotalCount: 21,146
Heartbeat 15:44:16 INFO  Health.CacheTotalSize: 84,485,258
5344 15:44:17 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

2288 15:44:18 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

3288 15:44:18 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

 388 15:44:18 INFO  [Path Analyzer](.) Running trail cleanup agent
 388 15:44:18 INFO  [Path Analyzer](.) Running trail cleanup on database
2436 15:44:19 INFO  [Experience Analytics]: Reduce agent found zero sites to process
ManagedPoolThread #16 15:44:22 INFO  Job started: Sitecore.Tasks.TaskDatabaseAgent
ManagedPoolThread #16 15:44:22 INFO  Processing tasks (count: 0)
ManagedPoolThread #16 15:44:22 INFO  Job ended: Sitecore.Tasks.TaskDatabaseAgent (units processed: )
ManagedPoolThread #16 15:44:22 INFO  Job started: Core_Database_Agent
ManagedPoolThread #16 15:44:22 INFO  Scheduling.DatabaseAgent started. Database: core
ManagedPoolThread #16 15:44:22 INFO  Examining schedules (count: 0)
ManagedPoolThread #16 15:44:22 INFO  Job ended: Core_Database_Agent (units processed: )
ManagedPoolThread #16 15:44:22 INFO  Job started: Master_Database_Agent
ManagedPoolThread #16 15:44:22 INFO  Scheduling.DatabaseAgent started. Database: master
ManagedPoolThread #16 15:44:22 INFO  Examining schedules (count: 5)
ManagedPoolThread #16 15:44:22 INFO  Starting: __Task Schedule
ManagedPoolThread #16 15:44:22 INFO  Ended: __Task Schedule
ManagedPoolThread #16 15:44:22 INFO  Not due: Calculate Statistical Relevancy
ManagedPoolThread #16 15:44:22 INFO  Not due: Rebuild Suggested Tests Index
ManagedPoolThread #16 15:44:22 INFO  Not due: Suspend Corrupted Tests
ManagedPoolThread #16 15:44:22 INFO  Not due: Try Finish Test
ManagedPoolThread #16 15:44:22 INFO  Job ended: Master_Database_Agent (units processed: 5)
ManagedPoolThread #7 15:44:22 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #7 15:44:22 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
5476 15:44:22 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

6832 15:44:23 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

1932 15:44:25 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Core.BackgroundService.Run()

2896 15:44:26 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

Heartbeat 15:44:30 ERROR MongoDbDictionary.Store() has failed.
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Save(Object value)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbDictionary.Store(Object value)

ManagedPoolThread #13 15:44:32 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #13 15:44:32 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
5344 15:44:32 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

2288 15:44:33 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

3288 15:44:33 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #14 15:44:37 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
6832 15:44:38 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #19 15:44:38 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #5 15:44:39 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
1932 15:44:40 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #12 15:44:40 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
2896 15:44:41 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #0 15:44:41 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #16 15:44:42 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #16 15:44:42 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
ManagedPoolThread #15 15:44:42 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #1 15:44:43 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #6 15:44:44 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #3 15:44:45 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #9 15:44:46 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
5476 15:44:47 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: MongoDB.Driver.MongoConnectionException
Message: Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
Source: MongoDB.Driver
   at MongoDB.Driver.Internal.DirectMongoServerProxy.Connect(TimeSpan timeout, ReadPreference readPreference)
   at MongoDB.Driver.Internal.DirectMongoServerProxy.ChooseServerInstance(ReadPreference readPreference)
   at MongoDB.Driver.MongoServer.AcquireConnection(ReadPreference readPreference)
   at MongoDB.Driver.MongoCursor`1.MongoCursorConnectionProvider.AcquireConnection()
   at MongoDB.Driver.Operations.QueryOperation`1.GetFirstBatch(IConnectionProvider connectionProvider)
   at MongoDB.Driver.Operations.QueryOperation`1.Execute(IConnectionProvider connectionProvider)
   at System.Linq.Enumerable.FirstOrDefault[TSource](IEnumerable`1 source)
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

Nested Exception

Exception: System.Net.Sockets.SocketException
Message: No connection could be made because the target machine actively refused it 127.0.0.1:27017
Source: System
   at System.Net.Sockets.Socket.DoConnect(EndPoint endPointSnapshot, SocketAddress socketAddress)
   at System.Net.Sockets.Socket.Connect(EndPoint remoteEP)
   at System.Net.Sockets.TcpClient.Connect(IPEndPoint remoteEP)
   at MongoDB.Driver.Internal.MongoConnection.Open()
   at MongoDB.Driver.Internal.MongoConnection.SendMessage(BsonBuffer buffer, Int32 requestId)
   at MongoDB.Driver.Internal.MongoConnection.SendMessage(MongoRequestMessage message)
   at MongoDB.Driver.Operations.CommandOperation`1.Execute(MongoConnection connection)
   at MongoDB.Driver.MongoServerInstance.Ping(MongoConnection connection)
   at MongoDB.Driver.MongoServerInstance.Connect()
   at MongoDB.Driver.Internal.DirectMongoServerProxy.Connect(TimeSpan timeout, ReadPreference readPreference)


5344 15:44:47 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

2288 15:44:48 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

3288 15:44:48 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #2 15:44:48 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
2436 15:44:49 INFO  [Experience Analytics]: Reduce agent found zero sites to process
ManagedPoolThread #11 15:44:49 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #17 15:44:50 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #8 15:44:51 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #13 15:44:52 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #13 15:44:52 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
ManagedPoolThread #18 15:44:52 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
6832 15:44:53 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

1932 15:44:55 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Core.BackgroundService.Run()

2896 15:44:56 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #10 15:45:02 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #10 15:45:02 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
5476 15:45:02 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

5344 15:45:02 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

2288 15:45:03 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

3288 15:45:03 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

6832 15:45:08 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

1932 15:45:10 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Core.BackgroundService.Run()

2896 15:45:11 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #13 15:45:12 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #13 15:45:12 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
5476 15:45:17 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

5344 15:45:17 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

2288 15:45:18 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

3288 15:45:18 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

2436 15:45:19 INFO  [Experience Analytics]: Reduce agent found zero sites to process
ManagedPoolThread #16 15:45:22 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #16 15:45:22 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
6832 15:45:23 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

1932 15:45:25 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Core.BackgroundService.Run()

2896 15:45:26 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #7 15:45:32 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #7 15:45:32 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
5476 15:45:32 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

5344 15:45:32 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

2288 15:45:33 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

3288 15:45:33 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

6832 15:45:38 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

1932 15:45:40 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Core.BackgroundService.Run()

2896 15:45:41 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #13 15:45:42 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #13 15:45:42 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
ManagedPoolThread #15 15:45:47 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
5344 15:45:47 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

2288 15:45:48 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

3288 15:45:48 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #14 15:45:48 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
2436 15:45:49 INFO  [Experience Analytics]: Reduce agent found zero sites to process
ManagedPoolThread #1 15:45:49 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #3 15:45:50 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #6 15:45:51 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #10 15:45:52 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #10 15:45:52 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
ManagedPoolThread #0 15:45:52 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
6832 15:45:53 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #9 15:45:53 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #12 15:45:54 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
1932 15:45:55 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #19 15:45:55 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #5 15:45:56 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
5476 15:45:57 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: MongoDB.Driver.MongoConnectionException
Message: Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
Source: MongoDB.Driver
   at MongoDB.Driver.Internal.DirectMongoServerProxy.Connect(TimeSpan timeout, ReadPreference readPreference)
   at MongoDB.Driver.Internal.DirectMongoServerProxy.ChooseServerInstance(ReadPreference readPreference)
   at MongoDB.Driver.MongoServer.AcquireConnection(ReadPreference readPreference)
   at MongoDB.Driver.MongoCursor`1.MongoCursorConnectionProvider.AcquireConnection()
   at MongoDB.Driver.Operations.QueryOperation`1.GetFirstBatch(IConnectionProvider connectionProvider)
   at MongoDB.Driver.Operations.QueryOperation`1.Execute(IConnectionProvider connectionProvider)
   at System.Linq.Enumerable.FirstOrDefault[TSource](IEnumerable`1 source)
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

Nested Exception

Exception: System.Net.Sockets.SocketException
Message: No connection could be made because the target machine actively refused it 127.0.0.1:27017
Source: System
   at System.Net.Sockets.Socket.DoConnect(EndPoint endPointSnapshot, SocketAddress socketAddress)
   at System.Net.Sockets.Socket.Connect(EndPoint remoteEP)
   at System.Net.Sockets.TcpClient.Connect(IPEndPoint remoteEP)
   at MongoDB.Driver.Internal.MongoConnection.Open()
   at MongoDB.Driver.Internal.MongoConnection.SendMessage(BsonBuffer buffer, Int32 requestId)
   at MongoDB.Driver.Internal.MongoConnection.SendMessage(MongoRequestMessage message)
   at MongoDB.Driver.Operations.CommandOperation`1.Execute(MongoConnection connection)
   at MongoDB.Driver.MongoServerInstance.Ping(MongoConnection connection)
   at MongoDB.Driver.MongoServerInstance.Connect()
   at MongoDB.Driver.Internal.DirectMongoServerProxy.Connect(TimeSpan timeout, ReadPreference readPreference)


ManagedPoolThread #2 15:45:58 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #8 15:45:59 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #18 15:46:00 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
2896 15:46:01 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
2896 15:46:01 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.HandleDatabaseException(ExceptionBehavior exceptionBehavior, Exception ex)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

Nested Exception

Exception: MongoDB.Driver.MongoConnectionException
Message: Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
Source: MongoDB.Driver
   at MongoDB.Driver.Internal.DirectMongoServerProxy.Connect(TimeSpan timeout, ReadPreference readPreference)
   at MongoDB.Driver.Internal.DirectMongoServerProxy.ChooseServerInstance(ReadPreference readPreference)
   at MongoDB.Driver.MongoServer.AcquireConnection(ReadPreference readPreference)
   at MongoDB.Driver.MongoCollection.RunCommandAs[TCommandResult](IMongoCommand command, ReadPreference readPreference, IBsonSerializer resultSerializer, IBsonSerializationOptions resultSerializationOptions)
   at MongoDB.Driver.MongoCollection.RunCommandAs[TCommandResult](IMongoCommand command, ReadPreference readPreference)
   at MongoDB.Driver.MongoCollection.FindAndModify(FindAndModifyArgs args)
   at MongoDB.Driver.MongoCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.<>c__DisplayClass2c.<FindAndModify>b__2b()
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)

Nested Exception

Exception: System.Net.Sockets.SocketException
Message: No connection could be made because the target machine actively refused it 127.0.0.1:27017
Source: System
   at System.Net.Sockets.Socket.DoConnect(EndPoint endPointSnapshot, SocketAddress socketAddress)
   at System.Net.Sockets.Socket.Connect(EndPoint remoteEP)
   at System.Net.Sockets.TcpClient.Connect(IPEndPoint remoteEP)
   at MongoDB.Driver.Internal.MongoConnection.Open()
   at MongoDB.Driver.Internal.MongoConnection.SendMessage(BsonBuffer buffer, Int32 requestId)
   at MongoDB.Driver.Internal.MongoConnection.SendMessage(MongoRequestMessage message)
   at MongoDB.Driver.Operations.CommandOperation`1.Execute(MongoConnection connection)
   at MongoDB.Driver.MongoServerInstance.Ping(MongoConnection connection)
   at MongoDB.Driver.MongoServerInstance.Connect()
   at MongoDB.Driver.Internal.DirectMongoServerProxy.Connect(TimeSpan timeout, ReadPreference readPreference)



ManagedPoolThread #13 15:46:02 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #13 15:46:02 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
ManagedPoolThread #11 15:46:02 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
5344 15:46:02 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

2288 15:46:03 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

3288 15:46:03 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #17 15:46:03 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
6832 15:46:08 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

1932 15:46:10 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #10 15:46:12 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #10 15:46:12 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
5476 15:46:12 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

2896 15:46:16 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

5344 15:46:17 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

2288 15:46:18 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

3288 15:46:18 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

2436 15:46:19 INFO  [Experience Analytics]: Reduce agent found zero sites to process
ManagedPoolThread #16 15:46:22 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #16 15:46:22 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
6832 15:46:23 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

1932 15:46:25 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Core.BackgroundService.Run()

5476 15:46:27 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

Heartbeat 15:46:30 ERROR MongoDbDictionary.Store() has failed.
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Save(Object value)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbDictionary.Store(Object value)

2896 15:46:31 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #7 15:46:32 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #7 15:46:32 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
5344 15:46:32 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

2288 15:46:33 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

3288 15:46:33 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

6832 15:46:38 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

1932 15:46:40 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #13 15:46:42 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #13 15:46:42 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
5476 15:46:42 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

2896 15:46:46 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

5344 15:46:47 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

2288 15:46:48 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

3288 15:46:48 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

2436 15:46:49 INFO  [Experience Analytics]: Reduce agent found zero sites to process
ManagedPoolThread #10 15:46:52 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #10 15:46:52 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
6832 15:46:53 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

1932 15:46:55 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #14 15:46:57 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #15 15:46:58 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #1 15:46:59 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #3 15:47:00 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
2896 15:47:01 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #6 15:47:01 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #13 15:47:02 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #13 15:47:02 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
ManagedPoolThread #0 15:47:02 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
5344 15:47:02 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

2288 15:47:03 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

3288 15:47:03 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #12 15:47:03 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #9 15:47:04 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #19 15:47:05 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #5 15:47:06 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
5476 15:47:07 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: MongoDB.Driver.MongoConnectionException
Message: Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
Source: MongoDB.Driver
   at MongoDB.Driver.Internal.DirectMongoServerProxy.Connect(TimeSpan timeout, ReadPreference readPreference)
   at MongoDB.Driver.Internal.DirectMongoServerProxy.ChooseServerInstance(ReadPreference readPreference)
   at MongoDB.Driver.MongoServer.AcquireConnection(ReadPreference readPreference)
   at MongoDB.Driver.MongoCursor`1.MongoCursorConnectionProvider.AcquireConnection()
   at MongoDB.Driver.Operations.QueryOperation`1.GetFirstBatch(IConnectionProvider connectionProvider)
   at MongoDB.Driver.Operations.QueryOperation`1.Execute(IConnectionProvider connectionProvider)
   at System.Linq.Enumerable.FirstOrDefault[TSource](IEnumerable`1 source)
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

Nested Exception

Exception: System.Net.Sockets.SocketException
Message: No connection could be made because the target machine actively refused it 127.0.0.1:27017
Source: System
   at System.Net.Sockets.Socket.DoConnect(EndPoint endPointSnapshot, SocketAddress socketAddress)
   at System.Net.Sockets.Socket.Connect(EndPoint remoteEP)
   at System.Net.Sockets.TcpClient.Connect(IPEndPoint remoteEP)
   at MongoDB.Driver.Internal.MongoConnection.Open()
   at MongoDB.Driver.Internal.MongoConnection.SendMessage(BsonBuffer buffer, Int32 requestId)
   at MongoDB.Driver.Internal.MongoConnection.SendMessage(MongoRequestMessage message)
   at MongoDB.Driver.Operations.CommandOperation`1.Execute(MongoConnection connection)
   at MongoDB.Driver.MongoServerInstance.Ping(MongoConnection connection)
   at MongoDB.Driver.MongoServerInstance.Connect()
   at MongoDB.Driver.Internal.DirectMongoServerProxy.Connect(TimeSpan timeout, ReadPreference readPreference)


6832 15:47:08 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #2 15:47:08 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #11 15:47:09 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
1932 15:47:10 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #17 15:47:10 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #8 15:47:11 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #10 15:47:12 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #10 15:47:12 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
ManagedPoolThread #18 15:47:12 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
2896 15:47:16 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

5344 15:47:17 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

2288 15:47:18 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

3288 15:47:18 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

2436 15:47:19 INFO  [Experience Analytics]: Reduce agent found zero sites to process
ManagedPoolThread #13 15:47:22 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #13 15:47:22 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
5476 15:47:22 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

6832 15:47:23 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

1932 15:47:25 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Core.BackgroundService.Run()

2896 15:47:31 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #10 15:47:32 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #10 15:47:32 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
5344 15:47:32 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

2288 15:47:33 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

3288 15:47:33 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

5476 15:47:37 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

6832 15:47:38 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

1932 15:47:40 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #7 15:47:42 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #7 15:47:42 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
2896 15:47:46 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

5344 15:47:47 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

2288 15:47:48 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

3288 15:47:48 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

2436 15:47:49 INFO  [Experience Analytics]: Reduce agent found zero sites to process
ManagedPoolThread #10 15:47:52 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #10 15:47:52 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
5476 15:47:52 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

6832 15:47:53 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

1932 15:47:55 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Core.BackgroundService.Run()

2896 15:48:01 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #13 15:48:02 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #13 15:48:02 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
5344 15:48:02 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

2288 15:48:03 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

3288 15:48:03 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #15 15:48:07 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
6832 15:48:08 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #14 15:48:08 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #1 15:48:09 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
1932 15:48:10 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #3 15:48:10 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #6 15:48:11 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #10 15:48:12 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #10 15:48:12 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
ManagedPoolThread #12 15:48:12 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #0 15:48:13 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #9 15:48:14 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #19 15:48:15 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #5 15:48:16 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
5476 15:48:17 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: MongoDB.Driver.MongoConnectionException
Message: Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
Source: MongoDB.Driver
   at MongoDB.Driver.Internal.DirectMongoServerProxy.Connect(TimeSpan timeout, ReadPreference readPreference)
   at MongoDB.Driver.Internal.DirectMongoServerProxy.ChooseServerInstance(ReadPreference readPreference)
   at MongoDB.Driver.MongoServer.AcquireConnection(ReadPreference readPreference)
   at MongoDB.Driver.MongoCursor`1.MongoCursorConnectionProvider.AcquireConnection()
   at MongoDB.Driver.Operations.QueryOperation`1.GetFirstBatch(IConnectionProvider connectionProvider)
   at MongoDB.Driver.Operations.QueryOperation`1.Execute(IConnectionProvider connectionProvider)
   at System.Linq.Enumerable.FirstOrDefault[TSource](IEnumerable`1 source)
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

Nested Exception

Exception: System.Net.Sockets.SocketException
Message: No connection could be made because the target machine actively refused it 127.0.0.1:27017
Source: System
   at System.Net.Sockets.Socket.DoConnect(EndPoint endPointSnapshot, SocketAddress socketAddress)
   at System.Net.Sockets.Socket.Connect(EndPoint remoteEP)
   at System.Net.Sockets.TcpClient.Connect(IPEndPoint remoteEP)
   at MongoDB.Driver.Internal.MongoConnection.Open()
   at MongoDB.Driver.Internal.MongoConnection.SendMessage(BsonBuffer buffer, Int32 requestId)
   at MongoDB.Driver.Internal.MongoConnection.SendMessage(MongoRequestMessage message)
   at MongoDB.Driver.Operations.CommandOperation`1.Execute(MongoConnection connection)
   at MongoDB.Driver.MongoServerInstance.Ping(MongoConnection connection)
   at MongoDB.Driver.MongoServerInstance.Connect()
   at MongoDB.Driver.Internal.DirectMongoServerProxy.Connect(TimeSpan timeout, ReadPreference readPreference)


5344 15:48:17 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

2288 15:48:18 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

3288 15:48:18 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #2 15:48:18 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
2436 15:48:19 INFO  [Experience Analytics]: Reduce agent found zero sites to process
ManagedPoolThread #8 15:48:19 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #18 15:48:20 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
2896 15:48:21 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
2896 15:48:21 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.HandleDatabaseException(ExceptionBehavior exceptionBehavior, Exception ex)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

Nested Exception

Exception: MongoDB.Driver.MongoConnectionException
Message: Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
Source: MongoDB.Driver
   at MongoDB.Driver.Internal.DirectMongoServerProxy.Connect(TimeSpan timeout, ReadPreference readPreference)
   at MongoDB.Driver.Internal.DirectMongoServerProxy.ChooseServerInstance(ReadPreference readPreference)
   at MongoDB.Driver.MongoServer.AcquireConnection(ReadPreference readPreference)
   at MongoDB.Driver.MongoCollection.RunCommandAs[TCommandResult](IMongoCommand command, ReadPreference readPreference, IBsonSerializer resultSerializer, IBsonSerializationOptions resultSerializationOptions)
   at MongoDB.Driver.MongoCollection.RunCommandAs[TCommandResult](IMongoCommand command, ReadPreference readPreference)
   at MongoDB.Driver.MongoCollection.FindAndModify(FindAndModifyArgs args)
   at MongoDB.Driver.MongoCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.<>c__DisplayClass2c.<FindAndModify>b__2b()
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)

Nested Exception

Exception: System.Net.Sockets.SocketException
Message: No connection could be made because the target machine actively refused it 127.0.0.1:27017
Source: System
   at System.Net.Sockets.Socket.DoConnect(EndPoint endPointSnapshot, SocketAddress socketAddress)
   at System.Net.Sockets.Socket.Connect(EndPoint remoteEP)
   at System.Net.Sockets.TcpClient.Connect(IPEndPoint remoteEP)
   at MongoDB.Driver.Internal.MongoConnection.Open()
   at MongoDB.Driver.Internal.MongoConnection.SendMessage(BsonBuffer buffer, Int32 requestId)
   at MongoDB.Driver.Internal.MongoConnection.SendMessage(MongoRequestMessage message)
   at MongoDB.Driver.Operations.CommandOperation`1.Execute(MongoConnection connection)
   at MongoDB.Driver.MongoServerInstance.Ping(MongoConnection connection)
   at MongoDB.Driver.MongoServerInstance.Connect()
   at MongoDB.Driver.Internal.DirectMongoServerProxy.Connect(TimeSpan timeout, ReadPreference readPreference)



ManagedPoolThread #7 15:48:22 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #7 15:48:22 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
ManagedPoolThread #11 15:48:22 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
6832 15:48:23 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #17 15:48:23 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
1932 15:48:25 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Core.BackgroundService.Run()

Heartbeat 15:48:30 ERROR MongoDbDictionary.Store() has failed.
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Save(Object value)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbDictionary.Store(Object value)

ManagedPoolThread #16 15:48:32 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #16 15:48:32 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
5476 15:48:32 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

5344 15:48:32 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

2288 15:48:33 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

3288 15:48:33 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

2896 15:48:36 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

6832 15:48:38 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

1932 15:48:40 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #10 15:48:42 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #10 15:48:42 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
5476 15:48:47 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

5344 15:48:47 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

2288 15:48:48 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

3288 15:48:48 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

2436 15:48:49 INFO  [Experience Analytics]: Reduce agent found zero sites to process
2896 15:48:51 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #13 15:48:52 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #13 15:48:52 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
6832 15:48:53 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

1932 15:48:55 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #10 15:49:02 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #10 15:49:02 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
5476 15:49:02 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

5344 15:49:02 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

2288 15:49:03 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

3288 15:49:03 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

2896 15:49:06 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

6832 15:49:08 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

1932 15:49:10 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #13 15:49:12 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #13 15:49:12 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
ManagedPoolThread #14 15:49:17 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
5344 15:49:17 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

2288 15:49:18 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

3288 15:49:18 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

 388 15:49:18 INFO  [Path Analyzer](.) Running trail cleanup agent
 388 15:49:18 INFO  [Path Analyzer](.) Running trail cleanup on database
ManagedPoolThread #9 15:49:18 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
2436 15:49:19 INFO  [Experience Analytics]: Reduce agent found zero sites to process
ManagedPoolThread #1 15:49:19 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #15 15:49:20 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
2896 15:49:21 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #5 15:49:21 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #10 15:49:22 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #10 15:49:22 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
ManagedPoolThread #6 15:49:22 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
6832 15:49:23 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #3 15:49:23 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #12 15:49:24 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
1932 15:49:25 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #0 15:49:25 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #19 15:49:26 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
5476 15:49:27 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: MongoDB.Driver.MongoConnectionException
Message: Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
Source: MongoDB.Driver
   at MongoDB.Driver.Internal.DirectMongoServerProxy.Connect(TimeSpan timeout, ReadPreference readPreference)
   at MongoDB.Driver.Internal.DirectMongoServerProxy.ChooseServerInstance(ReadPreference readPreference)
   at MongoDB.Driver.MongoServer.AcquireConnection(ReadPreference readPreference)
   at MongoDB.Driver.MongoCursor`1.MongoCursorConnectionProvider.AcquireConnection()
   at MongoDB.Driver.Operations.QueryOperation`1.GetFirstBatch(IConnectionProvider connectionProvider)
   at MongoDB.Driver.Operations.QueryOperation`1.Execute(IConnectionProvider connectionProvider)
   at System.Linq.Enumerable.FirstOrDefault[TSource](IEnumerable`1 source)
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

Nested Exception

Exception: System.Net.Sockets.SocketException
Message: No connection could be made because the target machine actively refused it 127.0.0.1:27017
Source: System
   at System.Net.Sockets.Socket.DoConnect(EndPoint endPointSnapshot, SocketAddress socketAddress)
   at System.Net.Sockets.Socket.Connect(EndPoint remoteEP)
   at System.Net.Sockets.TcpClient.Connect(IPEndPoint remoteEP)
   at MongoDB.Driver.Internal.MongoConnection.Open()
   at MongoDB.Driver.Internal.MongoConnection.SendMessage(BsonBuffer buffer, Int32 requestId)
   at MongoDB.Driver.Internal.MongoConnection.SendMessage(MongoRequestMessage message)
   at MongoDB.Driver.Operations.CommandOperation`1.Execute(MongoConnection connection)
   at MongoDB.Driver.MongoServerInstance.Ping(MongoConnection connection)
   at MongoDB.Driver.MongoServerInstance.Connect()
   at MongoDB.Driver.Internal.DirectMongoServerProxy.Connect(TimeSpan timeout, ReadPreference readPreference)


ManagedPoolThread #2 15:49:28 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #11 15:49:29 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #17 15:49:30 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #8 15:49:31 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #13 15:49:32 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #13 15:49:32 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
5344 15:49:32 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #18 15:49:32 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
2288 15:49:33 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

3288 15:49:33 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

2896 15:49:36 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

6832 15:49:38 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

1932 15:49:40 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #10 15:49:42 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #10 15:49:42 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
5476 15:49:42 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

5344 15:49:47 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

2288 15:49:48 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

3288 15:49:48 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

2436 15:49:49 INFO  [Experience Analytics]: Reduce agent found zero sites to process
2896 15:49:51 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #16 15:49:52 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #16 15:49:52 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
6832 15:49:53 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

1932 15:49:55 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Core.BackgroundService.Run()

5476 15:49:57 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #10 15:50:02 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #10 15:50:02 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
5344 15:50:02 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

2288 15:50:03 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

3288 15:50:03 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

2896 15:50:06 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

6832 15:50:08 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

1932 15:50:10 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #16 15:50:12 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #16 15:50:12 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
5476 15:50:12 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

5344 15:50:17 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

2288 15:50:18 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

3288 15:50:18 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

2436 15:50:19 INFO  [Experience Analytics]: Reduce agent found zero sites to process
2896 15:50:21 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #10 15:50:22 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #10 15:50:22 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
6832 15:50:23 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

1932 15:50:25 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #9 15:50:27 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #1 15:50:28 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #15 15:50:29 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
Heartbeat 15:50:30 ERROR MongoDbDictionary.Store() has failed.
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Save(Object value)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbDictionary.Store(Object value)

ManagedPoolThread #5 15:50:30 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #14 15:50:31 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #16 15:50:32 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #16 15:50:32 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
5344 15:50:32 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #6 15:50:32 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
2288 15:50:33 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

3288 15:50:33 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #19 15:50:33 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #0 15:50:34 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #3 15:50:35 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #12 15:50:36 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
5476 15:50:37 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: MongoDB.Driver.MongoConnectionException
Message: Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
Source: MongoDB.Driver
   at MongoDB.Driver.Internal.DirectMongoServerProxy.Connect(TimeSpan timeout, ReadPreference readPreference)
   at MongoDB.Driver.Internal.DirectMongoServerProxy.ChooseServerInstance(ReadPreference readPreference)
   at MongoDB.Driver.MongoServer.AcquireConnection(ReadPreference readPreference)
   at MongoDB.Driver.MongoCursor`1.MongoCursorConnectionProvider.AcquireConnection()
   at MongoDB.Driver.Operations.QueryOperation`1.GetFirstBatch(IConnectionProvider connectionProvider)
   at MongoDB.Driver.Operations.QueryOperation`1.Execute(IConnectionProvider connectionProvider)
   at System.Linq.Enumerable.FirstOrDefault[TSource](IEnumerable`1 source)
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

Nested Exception

Exception: System.Net.Sockets.SocketException
Message: No connection could be made because the target machine actively refused it 127.0.0.1:27017
Source: System
   at System.Net.Sockets.Socket.DoConnect(EndPoint endPointSnapshot, SocketAddress socketAddress)
   at System.Net.Sockets.Socket.Connect(EndPoint remoteEP)
   at System.Net.Sockets.TcpClient.Connect(IPEndPoint remoteEP)
   at MongoDB.Driver.Internal.MongoConnection.Open()
   at MongoDB.Driver.Internal.MongoConnection.SendMessage(BsonBuffer buffer, Int32 requestId)
   at MongoDB.Driver.Internal.MongoConnection.SendMessage(MongoRequestMessage message)
   at MongoDB.Driver.Operations.CommandOperation`1.Execute(MongoConnection connection)
   at MongoDB.Driver.MongoServerInstance.Ping(MongoConnection connection)
   at MongoDB.Driver.MongoServerInstance.Connect()
   at MongoDB.Driver.Internal.DirectMongoServerProxy.Connect(TimeSpan timeout, ReadPreference readPreference)


6832 15:50:38 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #2 15:50:38 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #8 15:50:39 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
1932 15:50:40 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #18 15:50:40 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
2896 15:50:41 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
2896 15:50:41 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.HandleDatabaseException(ExceptionBehavior exceptionBehavior, Exception ex)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

Nested Exception

Exception: MongoDB.Driver.MongoConnectionException
Message: Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
Source: MongoDB.Driver
   at MongoDB.Driver.Internal.DirectMongoServerProxy.Connect(TimeSpan timeout, ReadPreference readPreference)
   at MongoDB.Driver.Internal.DirectMongoServerProxy.ChooseServerInstance(ReadPreference readPreference)
   at MongoDB.Driver.MongoServer.AcquireConnection(ReadPreference readPreference)
   at MongoDB.Driver.MongoCollection.RunCommandAs[TCommandResult](IMongoCommand command, ReadPreference readPreference, IBsonSerializer resultSerializer, IBsonSerializationOptions resultSerializationOptions)
   at MongoDB.Driver.MongoCollection.RunCommandAs[TCommandResult](IMongoCommand command, ReadPreference readPreference)
   at MongoDB.Driver.MongoCollection.FindAndModify(FindAndModifyArgs args)
   at MongoDB.Driver.MongoCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.<>c__DisplayClass2c.<FindAndModify>b__2b()
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)

Nested Exception

Exception: System.Net.Sockets.SocketException
Message: No connection could be made because the target machine actively refused it 127.0.0.1:27017
Source: System
   at System.Net.Sockets.Socket.DoConnect(EndPoint endPointSnapshot, SocketAddress socketAddress)
   at System.Net.Sockets.Socket.Connect(EndPoint remoteEP)
   at System.Net.Sockets.TcpClient.Connect(IPEndPoint remoteEP)
   at MongoDB.Driver.Internal.MongoConnection.Open()
   at MongoDB.Driver.Internal.MongoConnection.SendMessage(BsonBuffer buffer, Int32 requestId)
   at MongoDB.Driver.Internal.MongoConnection.SendMessage(MongoRequestMessage message)
   at MongoDB.Driver.Operations.CommandOperation`1.Execute(MongoConnection connection)
   at MongoDB.Driver.MongoServerInstance.Ping(MongoConnection connection)
   at MongoDB.Driver.MongoServerInstance.Connect()
   at MongoDB.Driver.Internal.DirectMongoServerProxy.Connect(TimeSpan timeout, ReadPreference readPreference)



ManagedPoolThread #13 15:50:42 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #13 15:50:42 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
ManagedPoolThread #11 15:50:42 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #17 15:50:43 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
5344 15:50:47 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

2288 15:50:48 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

3288 15:50:48 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

2436 15:50:49 INFO  [Experience Analytics]: Reduce agent found zero sites to process
ManagedPoolThread #7 15:50:52 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #7 15:50:52 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
5476 15:50:52 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

6832 15:50:53 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

1932 15:50:55 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Core.BackgroundService.Run()

2896 15:50:56 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #13 15:51:02 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #13 15:51:02 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
5344 15:51:02 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

2288 15:51:03 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

3288 15:51:03 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

5476 15:51:07 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

6832 15:51:08 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

1932 15:51:10 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Core.BackgroundService.Run()

2896 15:51:11 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #7 15:51:12 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #7 15:51:12 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
5344 15:51:17 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

2288 15:51:18 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

3288 15:51:18 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

2436 15:51:19 INFO  [Experience Analytics]: Reduce agent found zero sites to process
ManagedPoolThread #16 15:51:22 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #16 15:51:22 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
5476 15:51:22 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

6832 15:51:23 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

1932 15:51:25 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Core.BackgroundService.Run()

2896 15:51:26 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #10 15:51:32 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #10 15:51:32 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
5344 15:51:32 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

2288 15:51:33 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

3288 15:51:33 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #9 15:51:37 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
6832 15:51:38 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #15 15:51:38 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #1 15:51:39 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
1932 15:51:40 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #14 15:51:40 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
2896 15:51:41 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #19 15:51:41 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #7 15:51:42 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #7 15:51:42 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
ManagedPoolThread #5 15:51:42 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #0 15:51:43 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #3 15:51:44 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #6 15:51:46 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #12 15:51:47 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
5344 15:51:47 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

5476 15:51:48 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: MongoDB.Driver.MongoConnectionException
Message: Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
Source: MongoDB.Driver
   at MongoDB.Driver.Internal.DirectMongoServerProxy.Connect(TimeSpan timeout, ReadPreference readPreference)
   at MongoDB.Driver.Internal.DirectMongoServerProxy.ChooseServerInstance(ReadPreference readPreference)
   at MongoDB.Driver.MongoServer.AcquireConnection(ReadPreference readPreference)
   at MongoDB.Driver.MongoCursor`1.MongoCursorConnectionProvider.AcquireConnection()
   at MongoDB.Driver.Operations.QueryOperation`1.GetFirstBatch(IConnectionProvider connectionProvider)
   at MongoDB.Driver.Operations.QueryOperation`1.Execute(IConnectionProvider connectionProvider)
   at System.Linq.Enumerable.FirstOrDefault[TSource](IEnumerable`1 source)
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

Nested Exception

Exception: System.Net.Sockets.SocketException
Message: No connection could be made because the target machine actively refused it 127.0.0.1:27017
Source: System
   at System.Net.Sockets.Socket.DoConnect(EndPoint endPointSnapshot, SocketAddress socketAddress)
   at System.Net.Sockets.Socket.Connect(EndPoint remoteEP)
   at System.Net.Sockets.TcpClient.Connect(IPEndPoint remoteEP)
   at MongoDB.Driver.Internal.MongoConnection.Open()
   at MongoDB.Driver.Internal.MongoConnection.SendMessage(BsonBuffer buffer, Int32 requestId)
   at MongoDB.Driver.Internal.MongoConnection.SendMessage(MongoRequestMessage message)
   at MongoDB.Driver.Operations.CommandOperation`1.Execute(MongoConnection connection)
   at MongoDB.Driver.MongoServerInstance.Ping(MongoConnection connection)
   at MongoDB.Driver.MongoServerInstance.Connect()
   at MongoDB.Driver.Internal.DirectMongoServerProxy.Connect(TimeSpan timeout, ReadPreference readPreference)


2288 15:51:48 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

3288 15:51:48 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #2 15:51:49 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
2436 15:51:49 INFO  [Experience Analytics]: Reduce agent found zero sites to process
ManagedPoolThread #11 15:51:50 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #17 15:51:51 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #8 15:51:52 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #13 15:51:52 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #13 15:51:52 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
ManagedPoolThread #18 15:51:53 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
6832 15:51:53 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

1932 15:51:55 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Core.BackgroundService.Run()

2896 15:51:56 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #7 15:52:02 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #7 15:52:02 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
5344 15:52:02 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

5476 15:52:03 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

2288 15:52:03 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

3288 15:52:03 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

6832 15:52:08 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

1932 15:52:10 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Core.BackgroundService.Run()

2896 15:52:11 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #10 15:52:12 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #10 15:52:12 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
5344 15:52:17 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

5476 15:52:18 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

2288 15:52:18 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

3288 15:52:18 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

2436 15:52:19 INFO  [Experience Analytics]: Reduce agent found zero sites to process
ManagedPoolThread #16 15:52:22 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #16 15:52:22 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
6832 15:52:23 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

1932 15:52:25 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Core.BackgroundService.Run()

2896 15:52:26 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

Heartbeat 15:52:30 ERROR MongoDbDictionary.Store() has failed.
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Save(Object value)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbDictionary.Store(Object value)

ManagedPoolThread #10 15:52:32 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #10 15:52:32 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
5344 15:52:32 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

5476 15:52:33 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

2288 15:52:33 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

3288 15:52:33 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

6832 15:52:38 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

1932 15:52:40 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Core.BackgroundService.Run()

2896 15:52:41 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #7 15:52:42 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #7 15:52:42 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
ManagedPoolThread #15 15:52:48 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
5476 15:52:48 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

2288 15:52:48 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

3288 15:52:48 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #9 15:52:49 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
2436 15:52:49 INFO  [Experience Analytics]: Reduce agent found zero sites to process
ManagedPoolThread #1 15:52:50 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #14 15:52:51 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #5 15:52:52 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #13 15:52:52 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #13 15:52:52 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
ManagedPoolThread #0 15:52:53 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
6832 15:52:53 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #19 15:52:54 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #3 15:52:55 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
1932 15:52:55 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #6 15:52:56 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #12 15:52:57 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
5344 15:52:58 ERROR Exception when executing agent aggregation/automationAggregator
Exception: MongoDB.Driver.MongoConnectionException
Message: Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
Source: MongoDB.Driver
   at MongoDB.Driver.Internal.DirectMongoServerProxy.Connect(TimeSpan timeout, ReadPreference readPreference)
   at MongoDB.Driver.Internal.DirectMongoServerProxy.ChooseServerInstance(ReadPreference readPreference)
   at MongoDB.Driver.MongoServer.AcquireConnection(ReadPreference readPreference)
   at MongoDB.Driver.MongoCursor`1.MongoCursorConnectionProvider.AcquireConnection()
   at MongoDB.Driver.Operations.QueryOperation`1.GetFirstBatch(IConnectionProvider connectionProvider)
   at MongoDB.Driver.Operations.QueryOperation`1.Execute(IConnectionProvider connectionProvider)
   at System.Linq.Buffer`1..ctor(IEnumerable`1 source)
   at System.Linq.Enumerable.ToArray[TSource](IEnumerable`1 source)
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

Nested Exception

Exception: System.Net.Sockets.SocketException
Message: No connection could be made because the target machine actively refused it 127.0.0.1:27017
Source: System
   at System.Net.Sockets.Socket.DoConnect(EndPoint endPointSnapshot, SocketAddress socketAddress)
   at System.Net.Sockets.Socket.Connect(EndPoint remoteEP)
   at System.Net.Sockets.TcpClient.Connect(IPEndPoint remoteEP)
   at MongoDB.Driver.Internal.MongoConnection.Open()
   at MongoDB.Driver.Internal.MongoConnection.SendMessage(BsonBuffer buffer, Int32 requestId)
   at MongoDB.Driver.Internal.MongoConnection.SendMessage(MongoRequestMessage message)
   at MongoDB.Driver.Operations.CommandOperation`1.Execute(MongoConnection connection)
   at MongoDB.Driver.MongoServerInstance.Ping(MongoConnection connection)
   at MongoDB.Driver.MongoServerInstance.Connect()
   at MongoDB.Driver.Internal.DirectMongoServerProxy.Connect(TimeSpan timeout, ReadPreference readPreference)


ManagedPoolThread #2 15:52:59 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #8 15:53:00 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #18 15:53:01 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
2896 15:53:02 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
2896 15:53:02 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.HandleDatabaseException(ExceptionBehavior exceptionBehavior, Exception ex)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

Nested Exception

Exception: MongoDB.Driver.MongoConnectionException
Message: Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
Source: MongoDB.Driver
   at MongoDB.Driver.Internal.DirectMongoServerProxy.Connect(TimeSpan timeout, ReadPreference readPreference)
   at MongoDB.Driver.Internal.DirectMongoServerProxy.ChooseServerInstance(ReadPreference readPreference)
   at MongoDB.Driver.MongoServer.AcquireConnection(ReadPreference readPreference)
   at MongoDB.Driver.MongoCollection.RunCommandAs[TCommandResult](IMongoCommand command, ReadPreference readPreference, IBsonSerializer resultSerializer, IBsonSerializationOptions resultSerializationOptions)
   at MongoDB.Driver.MongoCollection.RunCommandAs[TCommandResult](IMongoCommand command, ReadPreference readPreference)
   at MongoDB.Driver.MongoCollection.FindAndModify(FindAndModifyArgs args)
   at MongoDB.Driver.MongoCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.<>c__DisplayClass2c.<FindAndModify>b__2b()
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)

Nested Exception

Exception: System.Net.Sockets.SocketException
Message: No connection could be made because the target machine actively refused it 127.0.0.1:27017
Source: System
   at System.Net.Sockets.Socket.DoConnect(EndPoint endPointSnapshot, SocketAddress socketAddress)
   at System.Net.Sockets.Socket.Connect(EndPoint remoteEP)
   at System.Net.Sockets.TcpClient.Connect(IPEndPoint remoteEP)
   at MongoDB.Driver.Internal.MongoConnection.Open()
   at MongoDB.Driver.Internal.MongoConnection.SendMessage(BsonBuffer buffer, Int32 requestId)
   at MongoDB.Driver.Internal.MongoConnection.SendMessage(MongoRequestMessage message)
   at MongoDB.Driver.Operations.CommandOperation`1.Execute(MongoConnection connection)
   at MongoDB.Driver.MongoServerInstance.Ping(MongoConnection connection)
   at MongoDB.Driver.MongoServerInstance.Connect()
   at MongoDB.Driver.Internal.DirectMongoServerProxy.Connect(TimeSpan timeout, ReadPreference readPreference)



ManagedPoolThread #7 15:53:02 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #7 15:53:02 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
5476 15:53:03 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

2288 15:53:03 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

3288 15:53:03 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

6832 15:53:08 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

1932 15:53:10 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #13 15:53:12 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #13 15:53:12 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
5344 15:53:13 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

2896 15:53:17 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

5476 15:53:18 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

2288 15:53:18 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

3288 15:53:18 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

2436 15:53:19 INFO  [Experience Analytics]: Reduce agent found zero sites to process
ManagedPoolThread #7 15:53:22 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #7 15:53:22 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
6832 15:53:23 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

1932 15:53:25 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Core.BackgroundService.Run()

5344 15:53:28 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

2896 15:53:32 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #13 15:53:32 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #13 15:53:32 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
5476 15:53:33 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

2288 15:53:33 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

3288 15:53:33 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

6832 15:53:38 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

1932 15:53:40 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #10 15:53:42 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #10 15:53:42 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
5344 15:53:43 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

2896 15:53:47 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

5476 15:53:48 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

2288 15:53:48 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

3288 15:53:48 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

2436 15:53:49 INFO  [Experience Analytics]: Reduce agent found zero sites to process
ManagedPoolThread #16 15:53:52 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #16 15:53:52 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
6832 15:53:53 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

1932 15:53:55 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #0 15:53:58 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #6 15:53:59 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #1 15:54:00 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #19 15:54:01 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #10 15:54:02 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #10 15:54:02 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
ManagedPoolThread #14 15:54:02 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
5476 15:54:03 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #5 15:54:03 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
2288 15:54:03 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

3288 15:54:03 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #15 15:54:04 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #12 15:54:05 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #3 15:54:06 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #9 15:54:07 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
5344 15:54:08 ERROR Exception when executing agent aggregation/automationAggregator
Exception: MongoDB.Driver.MongoConnectionException
Message: Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
Source: MongoDB.Driver
   at MongoDB.Driver.Internal.DirectMongoServerProxy.Connect(TimeSpan timeout, ReadPreference readPreference)
   at MongoDB.Driver.Internal.DirectMongoServerProxy.ChooseServerInstance(ReadPreference readPreference)
   at MongoDB.Driver.MongoServer.AcquireConnection(ReadPreference readPreference)
   at MongoDB.Driver.MongoCursor`1.MongoCursorConnectionProvider.AcquireConnection()
   at MongoDB.Driver.Operations.QueryOperation`1.GetFirstBatch(IConnectionProvider connectionProvider)
   at MongoDB.Driver.Operations.QueryOperation`1.Execute(IConnectionProvider connectionProvider)
   at System.Linq.Buffer`1..ctor(IEnumerable`1 source)
   at System.Linq.Enumerable.ToArray[TSource](IEnumerable`1 source)
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

Nested Exception

Exception: System.Net.Sockets.SocketException
Message: No connection could be made because the target machine actively refused it 127.0.0.1:27017
Source: System
   at System.Net.Sockets.Socket.DoConnect(EndPoint endPointSnapshot, SocketAddress socketAddress)
   at System.Net.Sockets.Socket.Connect(EndPoint remoteEP)
   at System.Net.Sockets.TcpClient.Connect(IPEndPoint remoteEP)
   at MongoDB.Driver.Internal.MongoConnection.Open()
   at MongoDB.Driver.Internal.MongoConnection.SendMessage(BsonBuffer buffer, Int32 requestId)
   at MongoDB.Driver.Internal.MongoConnection.SendMessage(MongoRequestMessage message)
   at MongoDB.Driver.Operations.CommandOperation`1.Execute(MongoConnection connection)
   at MongoDB.Driver.MongoServerInstance.Ping(MongoConnection connection)
   at MongoDB.Driver.MongoServerInstance.Connect()
   at MongoDB.Driver.Internal.DirectMongoServerProxy.Connect(TimeSpan timeout, ReadPreference readPreference)


6832 15:54:08 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

6928 15:54:09 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
1932 15:54:10 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #2 15:54:10 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #11 15:54:11 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #16 15:54:12 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #16 15:54:12 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
2896 15:54:12 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
2896 15:54:12 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.HandleDatabaseException(ExceptionBehavior exceptionBehavior, Exception ex)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

Nested Exception

Exception: MongoDB.Driver.MongoConnectionException
Message: Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
Source: MongoDB.Driver
   at MongoDB.Driver.Internal.DirectMongoServerProxy.Connect(TimeSpan timeout, ReadPreference readPreference)
   at MongoDB.Driver.Internal.DirectMongoServerProxy.ChooseServerInstance(ReadPreference readPreference)
   at MongoDB.Driver.MongoServer.AcquireConnection(ReadPreference readPreference)
   at MongoDB.Driver.MongoCollection.RunCommandAs[TCommandResult](IMongoCommand command, ReadPreference readPreference, IBsonSerializer resultSerializer, IBsonSerializationOptions resultSerializationOptions)
   at MongoDB.Driver.MongoCollection.RunCommandAs[TCommandResult](IMongoCommand command, ReadPreference readPreference)
   at MongoDB.Driver.MongoCollection.FindAndModify(FindAndModifyArgs args)
   at MongoDB.Driver.MongoCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.<>c__DisplayClass2c.<FindAndModify>b__2b()
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)

Nested Exception

Exception: System.Net.Sockets.SocketException
Message: No connection could be made because the target machine actively refused it 127.0.0.1:27017
Source: System
   at System.Net.Sockets.Socket.DoConnect(EndPoint endPointSnapshot, SocketAddress socketAddress)
   at System.Net.Sockets.Socket.Connect(EndPoint remoteEP)
   at System.Net.Sockets.TcpClient.Connect(IPEndPoint remoteEP)
   at MongoDB.Driver.Internal.MongoConnection.Open()
   at MongoDB.Driver.Internal.MongoConnection.SendMessage(BsonBuffer buffer, Int32 requestId)
   at MongoDB.Driver.Internal.MongoConnection.SendMessage(MongoRequestMessage message)
   at MongoDB.Driver.Operations.CommandOperation`1.Execute(MongoConnection connection)
   at MongoDB.Driver.MongoServerInstance.Ping(MongoConnection connection)
   at MongoDB.Driver.MongoServerInstance.Connect()
   at MongoDB.Driver.Internal.DirectMongoServerProxy.Connect(TimeSpan timeout, ReadPreference readPreference)



ManagedPoolThread #8 15:54:13 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #18 15:54:14 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #17 15:54:15 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
Heartbeat 15:54:16 INFO  Health.PrivateBytes: 794,144,768
Heartbeat 15:54:16 INFO  Health.CacheInstances: 116
Heartbeat 15:54:16 INFO  Health.CacheTotalCount: 21,146
Heartbeat 15:54:16 INFO  Health.CacheTotalSize: 84,485,258
5476 15:54:18 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

2288 15:54:18 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

3288 15:54:18 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

 388 15:54:18 INFO  [Path Analyzer](.) Running trail cleanup agent
 388 15:54:18 INFO  [Path Analyzer](.) Running trail cleanup on database
6508 15:54:18 WARN  [Path Analyzer](.) SmartMergeAgent.Execute() returns. No missing date ranges to merge.
2436 15:54:19 INFO  [Experience Analytics]: Reduce agent found zero sites to process
ManagedPoolThread #13 15:54:22 INFO  Job started: Sitecore.Tasks.UrlAgent
ManagedPoolThread #13 15:54:22 INFO  Scheduling.UrlAgent started. Url: http://gathercontent.dev/sitecore/service/keepalive.aspx
ManagedPoolThread #13 15:54:22 INFO  Scheduling.UrlAgent done (received: 561 bytes)
ManagedPoolThread #13 15:54:22 INFO  Job ended: Sitecore.Tasks.UrlAgent (units processed: )
ManagedPoolThread #7 15:54:22 INFO  Job started: Sitecore.Tasks.TaskDatabaseAgent
ManagedPoolThread #7 15:54:22 INFO  Processing tasks (count: 0)
ManagedPoolThread #7 15:54:22 INFO  Job ended: Sitecore.Tasks.TaskDatabaseAgent (units processed: )
ManagedPoolThread #10 15:54:22 INFO  Job started: Sitecore.Tasks.CounterDumpAgent
ManagedPoolThread #16 15:54:22 WARN  Failed to create counter 'Sitecore.Caching\CacheClearings'. Sitecore has no necessary permissions for reading/creating counters
ManagedPoolThread #13 15:54:22 WARN  Failed to create counter 'Sitecore.Caching\CacheHits'. Sitecore has no necessary permissions for reading/creating counters
ManagedPoolThread #16 15:54:22 WARN  Failed to create counter 'Sitecore.Caching\CacheMisses'. Sitecore has no necessary permissions for reading/creating counters
ManagedPoolThread #13 15:54:22 WARN  Failed to create counter 'Sitecore.Caching\DataCacheClearings'. Sitecore has no necessary permissions for reading/creating counters
ManagedPoolThread #16 15:54:22 WARN  Failed to create counter 'Sitecore.Caching\DataCacheHits'. Sitecore has no necessary permissions for reading/creating counters
ManagedPoolThread #16 15:54:22 WARN  Failed to create counter 'Sitecore.Caching\HtmlCacheClearings'. Sitecore has no necessary permissions for reading/creating counters
ManagedPoolThread #7 15:54:22 WARN  Failed to create counter 'Sitecore.Caching\HtmlCacheHits'. Sitecore has no necessary permissions for reading/creating counters
ManagedPoolThread #7 15:54:22 WARN  Failed to create counter 'Sitecore.Caching\PathCacheClearings'. Sitecore has no necessary permissions for reading/creating counters
ManagedPoolThread #7 15:54:22 WARN  Failed to create counter 'Sitecore.Caching\PathCacheHits'. Sitecore has no necessary permissions for reading/creating counters
ManagedPoolThread #7 15:54:22 WARN  Failed to create counter 'Sitecore.Caching\PathCacheMisses'. Sitecore has no necessary permissions for reading/creating counters
ManagedPoolThread #7 15:54:22 WARN  Failed to create counter 'Sitecore.Caching\RegistryCacheClearings'. Sitecore has no necessary permissions for reading/creating counters
ManagedPoolThread #7 15:54:22 WARN  Failed to create counter 'Sitecore.Caching\RegistryCacheHits'. Sitecore has no necessary permissions for reading/creating counters
ManagedPoolThread #7 15:54:22 WARN  Failed to create counter 'Sitecore.Caching\RegistryCacheMisses'. Sitecore has no necessary permissions for reading/creating counters
ManagedPoolThread #7 15:54:22 WARN  Failed to create counter 'Sitecore.Caching\ViewStateCacheClearings'. Sitecore has no necessary permissions for reading/creating counters
ManagedPoolThread #7 15:54:22 WARN  Failed to create counter 'Sitecore.Caching\ViewStateCacheHits'. Sitecore has no necessary permissions for reading/creating counters
ManagedPoolThread #7 15:54:22 WARN  Failed to create counter 'Sitecore.Caching\ViewStateCacheMisses'. Sitecore has no necessary permissions for reading/creating counters
ManagedPoolThread #7 15:54:22 WARN  Failed to create counter 'Sitecore.Caching\XslCacheClearings'. Sitecore has no necessary permissions for reading/creating counters
ManagedPoolThread #7 15:54:22 WARN  Failed to create counter 'Sitecore.Caching\XslCacheHits'. Sitecore has no necessary permissions for reading/creating counters
ManagedPoolThread #7 15:54:22 WARN  Failed to create counter 'Sitecore.Caching\XslCacheMisses'. Sitecore has no necessary permissions for reading/creating counters
ManagedPoolThread #7 15:54:22 WARN  Failed to create counter 'Sitecore.Presentation\Context.SiteChanged'. Sitecore has no necessary permissions for reading/creating counters
ManagedPoolThread #16 15:54:22 WARN  Failed to create counter 'Sitecore.Caching\HtmlCacheMisses'. Sitecore has no necessary permissions for reading/creating counters
ManagedPoolThread #7 15:54:22 WARN  Failed to create counter 'Sitecore.System\Events.EventsRaised'. Sitecore has no necessary permissions for reading/creating counters
ManagedPoolThread #16 15:54:22 WARN  Failed to create counter 'Sitecore.System\Exceptions.ExceptionsThrown'. Sitecore has no necessary permissions for reading/creating counters
ManagedPoolThread #7 15:54:22 WARN  Failed to create counter 'Sitecore.Data\Globalization.TextsTranslated'. Sitecore has no necessary permissions for reading/creating counters
ManagedPoolThread #16 15:54:22 WARN  Failed to create counter 'Sitecore.Data\Globalization.TranslateFailed'. Sitecore has no necessary permissions for reading/creating counters
ManagedPoolThread #7 15:54:22 WARN  Failed to create counter 'Sitecore.System\IO.FileWatcherEvents'. Sitecore has no necessary permissions for reading/creating counters
ManagedPoolThread #16 15:54:22 WARN  Failed to create counter 'Sitecore.Jobs\Jobs.JobsExecuted'. Sitecore has no necessary permissions for reading/creating counters
ManagedPoolThread #16 15:54:22 WARN  Failed to create counter 'Sitecore.Data\Links.DataRead'. Sitecore has no necessary permissions for reading/creating counters
ManagedPoolThread #7 15:54:22 WARN  Failed to create counter 'Sitecore.Data\Links.FieldsExamined'. Sitecore has no necessary permissions for reading/creating counters
ManagedPoolThread #7 15:54:22 WARN  Failed to create counter 'Sitecore.System\Logging.AuditsLogged'. Sitecore has no necessary permissions for reading/creating counters
ManagedPoolThread #7 15:54:22 WARN  Failed to create counter 'Sitecore.System\Logging.ErrorsLogged'. Sitecore has no necessary permissions for reading/creating counters
ManagedPoolThread #16 15:54:22 WARN  Failed to create counter 'Sitecore.Data\Links.DataUpdated'. Sitecore has no necessary permissions for reading/creating counters
ManagedPoolThread #7 15:54:22 WARN  Failed to create counter 'Sitecore.System\Logging.FatalsLogged'. Sitecore has no necessary permissions for reading/creating counters
ManagedPoolThread #16 15:54:22 WARN  Failed to create counter 'Sitecore.System\Logging.InformationsLogged'. Sitecore has no necessary permissions for reading/creating counters
ManagedPoolThread #16 15:54:22 WARN  Failed to create counter 'Sitecore.Jobs\Publishing.FullPublishings'. Sitecore has no necessary permissions for reading/creating counters
ManagedPoolThread #16 15:54:22 WARN  Failed to create counter 'Sitecore.Jobs\Publishing.IncrementalPublishings'. Sitecore has no necessary permissions for reading/creating counters
ManagedPoolThread #7 15:54:22 WARN  Failed to create counter 'Sitecore.System\Logging.WarningsLogged'. Sitecore has no necessary permissions for reading/creating counters
ManagedPoolThread #7 15:54:22 WARN  Failed to create counter 'Sitecore.Jobs\Publishing.ItemsExamined'. Sitecore has no necessary permissions for reading/creating counters
ManagedPoolThread #7 15:54:22 WARN  Failed to create counter 'Sitecore.Jobs\Publishing.ItemsPublished'. Sitecore has no necessary permissions for reading/creating counters
ManagedPoolThread #13 15:54:22 WARN  Failed to create counter 'Sitecore.Caching\DataCacheMisses'. Sitecore has no necessary permissions for reading/creating counters
ManagedPoolThread #7 15:54:22 WARN  Failed to create counter 'Sitecore.Jobs\Publishing.ItemsQueued'. Sitecore has no necessary permissions for reading/creating counters
ManagedPoolThread #13 15:54:22 WARN  Failed to create counter 'Sitecore.Jobs\Publishing.Replacements'. Sitecore has no necessary permissions for reading/creating counters
ManagedPoolThread #13 15:54:22 WARN  Failed to create counter 'Sitecore.Jobs\Publishing.TotalPublishings'. Sitecore has no necessary permissions for reading/creating counters
ManagedPoolThread #16 15:54:22 WARN  Failed to create counter 'Sitecore.Jobs\Publishing.ItemPublishings'. Sitecore has no necessary permissions for reading/creating counters
ManagedPoolThread #13 15:54:22 WARN  Failed to create counter 'Sitecore.System\Reflection.MethodsInvoked'. Sitecore has no necessary permissions for reading/creating counters
ManagedPoolThread #13 15:54:22 WARN  Failed to create counter 'Sitecore.System\Reflection.ObjectsNotCreated'. Sitecore has no necessary permissions for reading/creating counters
ManagedPoolThread #13 15:54:22 WARN  Failed to create counter 'Sitecore.System\Reflection.TypesResolved'. Sitecore has no necessary permissions for reading/creating counters
ManagedPoolThread #13 15:54:22 WARN  Failed to create counter 'Sitecore.System\Reflection.TypesNotResolved'. Sitecore has no necessary permissions for reading/creating counters
ManagedPoolThread #7 15:54:22 WARN  Failed to create counter 'Sitecore.Jobs\Publishing.SmartPublishings'. Sitecore has no necessary permissions for reading/creating counters
ManagedPoolThread #16 15:54:22 WARN  Failed to create counter 'Sitecore.System\Reflection.ObjectsCreated'. Sitecore has no necessary permissions for reading/creating counters
ManagedPoolThread #7 15:54:22 WARN  Failed to create counter 'Sitecore.Presentation\Rendering.ControlsRenderedFromCache'. Sitecore has no necessary permissions for reading/creating counters
ManagedPoolThread #16 15:54:22 WARN  Failed to create counter 'Sitecore.Presentation\Rendering.PagesGenerated'. Sitecore has no necessary permissions for reading/creating counters
ManagedPoolThread #16 15:54:22 WARN  Failed to create counter 'Sitecore.Presentation\Rendering.SublayoutsRendered'. Sitecore has no necessary permissions for reading/creating counters
ManagedPoolThread #7 15:54:22 WARN  Failed to create counter 'Sitecore.Presentation\Rendering.RenderingsRendered'. Sitecore has no necessary permissions for reading/creating counters
ManagedPoolThread #16 15:54:22 WARN  Failed to create counter 'Sitecore.Presentation\Rendering.XmlControlsCompiled'. Sitecore has no necessary permissions for reading/creating counters
ManagedPoolThread #7 15:54:22 WARN  Failed to create counter 'Sitecore.Presentation\Rendering.XamlControlsCompiled'. Sitecore has no necessary permissions for reading/creating counters
ManagedPoolThread #13 15:54:22 WARN  Failed to create counter 'Sitecore.Presentation\Rendering.ControlsRendered'. Sitecore has no necessary permissions for reading/creating counters
ManagedPoolThread #16 15:54:22 WARN  Failed to create counter 'Sitecore.Presentation\Rendering.XslTransformsRendered'. Sitecore has no necessary permissions for reading/creating counters
ManagedPoolThread #13 15:54:22 WARN  Failed to create counter 'Sitecore.Security\AccessGranted'. Sitecore has no necessary permissions for reading/creating counters
ManagedPoolThread #13 15:54:22 WARN  Failed to create counter 'Sitecore.Security\ModifyRequests'. Sitecore has no necessary permissions for reading/creating counters
ManagedPoolThread #16 15:54:22 WARN  Failed to create counter 'Sitecore.Security\AccessResolved'. Sitecore has no necessary permissions for reading/creating counters
ManagedPoolThread #16 15:54:22 WARN  Failed to create counter 'Sitecore.Security\ProgrammaticEnabling'. Sitecore has no necessary permissions for reading/creating counters
ManagedPoolThread #13 15:54:22 WARN  Failed to create counter 'Sitecore.Security\ProgrammaticDisabling'. Sitecore has no necessary permissions for reading/creating counters
ManagedPoolThread #16 15:54:22 WARN  Failed to create counter 'Sitecore.Security\ProgrammaticUserSwitch'. Sitecore has no necessary permissions for reading/creating counters
ManagedPoolThread #13 15:54:22 WARN  Failed to create counter 'Sitecore.Security\ReadRequests'. Sitecore has no necessary permissions for reading/creating counters
ManagedPoolThread #7 15:54:22 WARN  Failed to create counter 'Sitecore.Security\AccessDenied'. Sitecore has no necessary permissions for reading/creating counters
ManagedPoolThread #16 15:54:22 WARN  Failed to create counter 'Sitecore.Security\VirtualUsersBuilt'. Sitecore has no necessary permissions for reading/creating counters
ManagedPoolThread #13 15:54:22 WARN  Failed to create counter 'Sitecore.Data\Shadows.DataRead'. Sitecore has no necessary permissions for reading/creating counters
ManagedPoolThread #7 15:54:22 WARN  Failed to create counter 'Sitecore.Data\Shadows.DataUpdated'. Sitecore has no necessary permissions for reading/creating counters
ManagedPoolThread #13 15:54:22 WARN  Failed to create counter 'Sitecore.Jobs\Tasks.HtmlCacheClearings'. Sitecore has no necessary permissions for reading/creating counters
ManagedPoolThread #13 15:54:22 WARN  Failed to create counter 'Sitecore.Jobs\Tasks.Publishings'. Sitecore has no necessary permissions for reading/creating counters
ManagedPoolThread #13 15:54:22 WARN  Failed to create counter 'Sitecore.Jobs\Tasks.RemindersSent'. Sitecore has no necessary permissions for reading/creating counters
ManagedPoolThread #13 15:54:22 WARN  Failed to create counter 'Sitecore.Jobs\Tasks.TasksExecuted'. Sitecore has no necessary permissions for reading/creating counters
ManagedPoolThread #16 15:54:22 WARN  Failed to create counter 'Sitecore.Jobs\Tasks.FileCleanups'. Sitecore has no necessary permissions for reading/creating counters
ManagedPoolThread #13 15:54:22 WARN  Failed to create counter 'Sitecore.System\Threading.BackgroundThreadsStarted'. Sitecore has no necessary permissions for reading/creating counters
ManagedPoolThread #16 15:54:22 WARN  Failed to create counter 'Sitecore.System\Threading.ThreadDataModified'. Sitecore has no necessary permissions for reading/creating counters
ManagedPoolThread #16 15:54:22 WARN  Failed to create counter 'Sitecore.Data\Workflow.ActionsExecuted'. Sitecore has no necessary permissions for reading/creating counters
ManagedPoolThread #13 15:54:22 WARN  Failed to create counter 'Sitecore.System\Threading.ThreadDataRead'. Sitecore has no necessary permissions for reading/creating counters
ManagedPoolThread #13 15:54:22 WARN  Failed to create counter 'Sitecore.Data\Workflow.StateChanges'. Sitecore has no necessary permissions for reading/creating counters
ManagedPoolThread #13 15:54:22 WARN  Failed to create counter 'Sitecore.System\Xml.ItemNavigatorsCreated'. Sitecore has no necessary permissions for reading/creating counters
ManagedPoolThread #16 15:54:22 WARN  Failed to create counter 'Sitecore.Data\Workflow.SecurityResolved'. Sitecore has no necessary permissions for reading/creating counters
ManagedPoolThread #7 15:54:22 WARN  Failed to create counter 'Sitecore.Jobs\Tasks.ItemsArchived'. Sitecore has no necessary permissions for reading/creating counters
ManagedPoolThread #13 15:54:22 WARN  Failed to create counter 'Sitecore.System\Xml.PacketsCreated'. Sitecore has no necessary permissions for reading/creating counters
ManagedPoolThread #10 15:54:22 INFO  Job ended: Sitecore.Tasks.CounterDumpAgent (units processed: )
ManagedPoolThread #16 15:54:22 INFO  Job started: Sitecore.Analytics.Tasks.EmailReportsTask
ManagedPoolThread #16 15:54:22 INFO  EmailReportsTask started. Database: master
ManagedPoolThread #16 15:54:22 INFO  Job ended: Sitecore.Analytics.Tasks.EmailReportsTask (units processed: )
ManagedPoolThread #7 15:54:22 INFO  Job started: Core_Database_Agent
ManagedPoolThread #7 15:54:22 INFO  Scheduling.DatabaseAgent started. Database: core
ManagedPoolThread #7 15:54:22 INFO  Examining schedules (count: 0)
ManagedPoolThread #7 15:54:22 INFO  Job ended: Core_Database_Agent (units processed: )
ManagedPoolThread #13 15:54:22 INFO  Job started: Master_Database_Agent
ManagedPoolThread #13 15:54:22 INFO  Scheduling.DatabaseAgent started. Database: master
ManagedPoolThread #13 15:54:22 INFO  Examining schedules (count: 5)
ManagedPoolThread #13 15:54:22 INFO  Starting: __Task Schedule
ManagedPoolThread #13 15:54:22 INFO  Ended: __Task Schedule
ManagedPoolThread #13 15:54:22 INFO  Not due: Calculate Statistical Relevancy
ManagedPoolThread #13 15:54:22 INFO  Not due: Rebuild Suggested Tests Index
ManagedPoolThread #13 15:54:22 INFO  Not due: Suspend Corrupted Tests
ManagedPoolThread #13 15:54:22 INFO  Not due: Try Finish Test
ManagedPoolThread #13 15:54:22 INFO  Job ended: Master_Database_Agent (units processed: 5)
ManagedPoolThread #10 15:54:22 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #10 15:54:22 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
ManagedPoolThread #16 15:54:22 INFO  Job started: Sitecore.Social.Client.Tasks.PostFlaggedMessages
ManagedPoolThread #16 15:54:22 INFO  Sitecore.Social: Processing messages posting...
ManagedPoolThread #16 15:54:23 INFO  Sitecore.Social: Done.
ManagedPoolThread #16 15:54:23 INFO  Job ended: Sitecore.Social.Client.Tasks.PostFlaggedMessages (units processed: )
ManagedPoolThread #7 15:54:23 INFO  Job started: Sitecore.Social.Client.Tasks.UpdateMessagesStatistics
ManagedPoolThread #7 15:54:23 INFO  Sitecore.Social: Update messages statistics...
ManagedPoolThread #7 15:54:23 INFO  Sitecore.Social: The context database is: master
ManagedPoolThread #7 15:54:23 INFO  Sitecore.Social: No posted messages are found.
ManagedPoolThread #7 15:54:23 INFO  Sitecore.Social: Done.
ManagedPoolThread #7 15:54:23 INFO  Job ended: Sitecore.Social.Client.Tasks.UpdateMessagesStatistics (units processed: )
5344 15:54:23 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

6832 15:54:23 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

1932 15:54:25 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Core.BackgroundService.Run()

2896 15:54:27 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

Heartbeat 15:54:30 ERROR MongoDbDictionary.Store() has failed.
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Save(Object value)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbDictionary.Store(Object value)

5476 15:54:33 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #13 15:54:33 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #13 15:54:33 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
2288 15:54:33 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

3288 15:54:33 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

5344 15:54:38 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

6832 15:54:38 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

1932 15:54:40 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Core.BackgroundService.Run()

2896 15:54:42 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #7 15:54:43 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #7 15:54:43 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
5476 15:54:48 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

2288 15:54:48 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

3288 15:54:48 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

2436 15:54:49 INFO  [Experience Analytics]: Reduce agent found zero sites to process
ManagedPoolThread #10 15:54:53 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #10 15:54:53 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
5344 15:54:53 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

6832 15:54:53 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

1932 15:54:55 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Core.BackgroundService.Run()

2896 15:54:57 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

5476 15:55:03 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #7 15:55:03 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #7 15:55:03 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
2288 15:55:03 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

3288 15:55:03 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

5344 15:55:08 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

6832 15:55:08 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

6928 15:55:10 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #19 15:55:11 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #14 15:55:12 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
2896 15:55:12 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #10 15:55:13 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #10 15:55:13 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
ManagedPoolThread #5 15:55:13 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #15 15:55:14 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #12 15:55:15 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #9 15:55:16 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #3 15:55:17 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
5476 15:55:18 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

2288 15:55:18 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #4 15:55:18 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
3288 15:55:18 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

1932 15:55:19 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: MongoDB.Driver.MongoConnectionException
Message: Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
Source: MongoDB.Driver
   at MongoDB.Driver.Internal.DirectMongoServerProxy.Connect(TimeSpan timeout, ReadPreference readPreference)
   at MongoDB.Driver.Internal.DirectMongoServerProxy.ChooseServerInstance(ReadPreference readPreference)
   at MongoDB.Driver.MongoServer.AcquireConnection(ReadPreference readPreference)
   at MongoDB.Driver.MongoCursor`1.MongoCursorConnectionProvider.AcquireConnection()
   at MongoDB.Driver.Operations.QueryOperation`1.GetFirstBatch(IConnectionProvider connectionProvider)
   at MongoDB.Driver.Operations.QueryOperation`1.Execute(IConnectionProvider connectionProvider)
   at System.Linq.Enumerable.FirstOrDefault[TSource](IEnumerable`1 source)
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Core.BackgroundService.Run()

Nested Exception

Exception: System.Net.Sockets.SocketException
Message: No connection could be made because the target machine actively refused it 127.0.0.1:27017
Source: System
   at System.Net.Sockets.Socket.DoConnect(EndPoint endPointSnapshot, SocketAddress socketAddress)
   at System.Net.Sockets.Socket.Connect(EndPoint remoteEP)
   at System.Net.Sockets.TcpClient.Connect(IPEndPoint remoteEP)
   at MongoDB.Driver.Internal.MongoConnection.Open()
   at MongoDB.Driver.Internal.MongoConnection.SendMessage(BsonBuffer buffer, Int32 requestId)
   at MongoDB.Driver.Internal.MongoConnection.SendMessage(MongoRequestMessage message)
   at MongoDB.Driver.Operations.CommandOperation`1.Execute(MongoConnection connection)
   at MongoDB.Driver.MongoServerInstance.Ping(MongoConnection connection)
   at MongoDB.Driver.MongoServerInstance.Connect()
   at MongoDB.Driver.Internal.DirectMongoServerProxy.Connect(TimeSpan timeout, ReadPreference readPreference)


2436 15:55:19 INFO  [Experience Analytics]: Reduce agent found zero sites to process
ManagedPoolThread #6 15:55:20 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #0 15:55:21 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #1 15:55:22 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #7 15:55:23 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #7 15:55:23 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
5344 15:55:23 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #2 15:55:23 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
6832 15:55:23 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #8 15:55:24 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #17 15:55:25 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #11 15:55:26 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
2896 15:55:27 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #18 15:55:27 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
5476 15:55:33 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #10 15:55:33 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #10 15:55:33 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
2288 15:55:33 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

3288 15:55:33 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

1932 15:55:34 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Core.BackgroundService.Run()

5344 15:55:38 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

6832 15:55:38 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

2896 15:55:42 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #13 15:55:43 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #13 15:55:43 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
5476 15:55:48 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

2288 15:55:48 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

3288 15:55:48 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

1932 15:55:49 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Core.BackgroundService.Run()

2436 15:55:49 INFO  [Experience Analytics]: Reduce agent found zero sites to process
ManagedPoolThread #16 15:55:53 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #16 15:55:53 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
5344 15:55:53 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

6832 15:55:53 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

2896 15:55:57 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

5476 15:56:03 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #13 15:56:03 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #13 15:56:03 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
2288 15:56:03 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

3288 15:56:03 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

1932 15:56:04 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Core.BackgroundService.Run()

5344 15:56:08 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

6832 15:56:08 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

2896 15:56:12 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #16 15:56:13 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #16 15:56:13 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
5476 15:56:18 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

2288 15:56:18 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

3288 15:56:18 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

1932 15:56:19 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Core.BackgroundService.Run()

2436 15:56:19 INFO  [Experience Analytics]: Reduce agent found zero sites to process
ManagedPoolThread #13 15:56:23 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #13 15:56:23 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
ManagedPoolThread #19 15:56:23 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
6832 15:56:23 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #12 15:56:24 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #14 15:56:25 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #15 15:56:26 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
2896 15:56:27 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #9 15:56:27 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #5 15:56:28 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #3 15:56:29 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
Heartbeat 15:56:30 ERROR MongoDbDictionary.Store() has failed.
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Save(Object value)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbDictionary.Store(Object value)

3288 15:56:34 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

5476 15:56:34 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

2288 15:56:34 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #10 15:56:34 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #10 15:56:34 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
1932 15:56:34 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #0 15:56:34 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #1 15:56:35 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #2 15:56:36 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #6 15:56:38 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
6832 15:56:38 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #8 15:56:39 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #11 15:56:40 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #17 15:56:41 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #18 15:56:42 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
2896 15:56:42 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

5344 15:56:43 ERROR Exception when executing agent aggregation/automationAggregator
Exception: MongoDB.Driver.MongoConnectionException
Message: Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
Source: MongoDB.Driver
   at MongoDB.Driver.Internal.DirectMongoServerProxy.Connect(TimeSpan timeout, ReadPreference readPreference)
   at MongoDB.Driver.Internal.DirectMongoServerProxy.ChooseServerInstance(ReadPreference readPreference)
   at MongoDB.Driver.MongoServer.AcquireConnection(ReadPreference readPreference)
   at MongoDB.Driver.MongoCursor`1.MongoCursorConnectionProvider.AcquireConnection()
   at MongoDB.Driver.Operations.QueryOperation`1.GetFirstBatch(IConnectionProvider connectionProvider)
   at MongoDB.Driver.Operations.QueryOperation`1.Execute(IConnectionProvider connectionProvider)
   at System.Linq.Buffer`1..ctor(IEnumerable`1 source)
   at System.Linq.Enumerable.ToArray[TSource](IEnumerable`1 source)
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

Nested Exception

Exception: System.Net.Sockets.SocketException
Message: No connection could be made because the target machine actively refused it 127.0.0.1:27017
Source: System
   at System.Net.Sockets.Socket.DoConnect(EndPoint endPointSnapshot, SocketAddress socketAddress)
   at System.Net.Sockets.Socket.Connect(EndPoint remoteEP)
   at System.Net.Sockets.TcpClient.Connect(IPEndPoint remoteEP)
   at MongoDB.Driver.Internal.MongoConnection.Open()
   at MongoDB.Driver.Internal.MongoConnection.SendMessage(BsonBuffer buffer, Int32 requestId)
   at MongoDB.Driver.Internal.MongoConnection.SendMessage(MongoRequestMessage message)
   at MongoDB.Driver.Operations.CommandOperation`1.Execute(MongoConnection connection)
   at MongoDB.Driver.MongoServerInstance.Ping(MongoConnection connection)
   at MongoDB.Driver.MongoServerInstance.Connect()
   at MongoDB.Driver.Internal.DirectMongoServerProxy.Connect(TimeSpan timeout, ReadPreference readPreference)


ManagedPoolThread #13 15:56:44 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #13 15:56:44 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
3288 15:56:49 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

5476 15:56:49 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

2288 15:56:49 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

2436 15:56:49 INFO  [Experience Analytics]: Reduce agent found zero sites to process
1932 15:56:49 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Core.BackgroundService.Run()

6832 15:56:53 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #16 15:56:54 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #16 15:56:54 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
2896 15:56:57 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

5344 15:56:58 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

3288 15:57:04 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

5476 15:57:04 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

2288 15:57:04 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #13 15:57:04 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #13 15:57:04 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
1932 15:57:04 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Core.BackgroundService.Run()

6832 15:57:08 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

2896 15:57:12 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

5344 15:57:13 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #16 15:57:14 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #16 15:57:14 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
2436 15:57:19 INFO  [Experience Analytics]: Reduce agent found zero sites to process
3288 15:57:19 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

5476 15:57:19 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

2288 15:57:19 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

1932 15:57:19 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Core.BackgroundService.Run()

6832 15:57:23 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #10 15:57:24 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #10 15:57:24 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
2896 15:57:27 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

5344 15:57:28 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #7 15:57:34 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
3288 15:57:34 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #7 15:57:34 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
5476 15:57:34 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

2288 15:57:34 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

1932 15:57:34 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #2 15:57:38 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #3 15:57:39 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #0 15:57:40 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #1 15:57:41 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #4 15:57:42 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
5344 15:57:43 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #5 15:57:44 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #10 15:57:44 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #10 15:57:44 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
ManagedPoolThread #6 15:57:45 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #9 15:57:46 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #11 15:57:47 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #12 15:57:48 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #14 15:57:49 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
2436 15:57:49 INFO  [Experience Analytics]: Reduce agent found zero sites to process
3288 15:57:49 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

5476 15:57:49 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

2288 15:57:49 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

1932 15:57:49 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #15 15:57:50 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #18 15:57:51 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #17 15:57:52 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #19 15:57:53 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #7 15:57:54 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #7 15:57:54 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
6832 15:57:55 ERROR Exception when executing agent aggregation/automationAggregator
Exception: MongoDB.Driver.MongoConnectionException
Message: Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
Source: MongoDB.Driver
   at MongoDB.Driver.Internal.DirectMongoServerProxy.Connect(TimeSpan timeout, ReadPreference readPreference)
   at MongoDB.Driver.Internal.DirectMongoServerProxy.ChooseServerInstance(ReadPreference readPreference)
   at MongoDB.Driver.MongoServer.AcquireConnection(ReadPreference readPreference)
   at MongoDB.Driver.MongoCursor`1.MongoCursorConnectionProvider.AcquireConnection()
   at MongoDB.Driver.Operations.QueryOperation`1.GetFirstBatch(IConnectionProvider connectionProvider)
   at MongoDB.Driver.Operations.QueryOperation`1.Execute(IConnectionProvider connectionProvider)
   at System.Linq.Buffer`1..ctor(IEnumerable`1 source)
   at System.Linq.Enumerable.ToArray[TSource](IEnumerable`1 source)
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

Nested Exception

Exception: System.Net.Sockets.SocketException
Message: No connection could be made because the target machine actively refused it 127.0.0.1:27017
Source: System
   at System.Net.Sockets.Socket.DoConnect(EndPoint endPointSnapshot, SocketAddress socketAddress)
   at System.Net.Sockets.Socket.Connect(EndPoint remoteEP)
   at System.Net.Sockets.TcpClient.Connect(IPEndPoint remoteEP)
   at MongoDB.Driver.Internal.MongoConnection.Open()
   at MongoDB.Driver.Internal.MongoConnection.SendMessage(BsonBuffer buffer, Int32 requestId)
   at MongoDB.Driver.Internal.MongoConnection.SendMessage(MongoRequestMessage message)
   at MongoDB.Driver.Operations.CommandOperation`1.Execute(MongoConnection connection)
   at MongoDB.Driver.MongoServerInstance.Ping(MongoConnection connection)
   at MongoDB.Driver.MongoServerInstance.Connect()
   at MongoDB.Driver.Internal.DirectMongoServerProxy.Connect(TimeSpan timeout, ReadPreference readPreference)


2896 15:57:56 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
2896 15:57:56 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.HandleDatabaseException(ExceptionBehavior exceptionBehavior, Exception ex)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

Nested Exception

Exception: MongoDB.Driver.MongoConnectionException
Message: Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
Source: MongoDB.Driver
   at MongoDB.Driver.Internal.DirectMongoServerProxy.Connect(TimeSpan timeout, ReadPreference readPreference)
   at MongoDB.Driver.Internal.DirectMongoServerProxy.ChooseServerInstance(ReadPreference readPreference)
   at MongoDB.Driver.MongoServer.AcquireConnection(ReadPreference readPreference)
   at MongoDB.Driver.MongoCollection.RunCommandAs[TCommandResult](IMongoCommand command, ReadPreference readPreference, IBsonSerializer resultSerializer, IBsonSerializationOptions resultSerializationOptions)
   at MongoDB.Driver.MongoCollection.RunCommandAs[TCommandResult](IMongoCommand command, ReadPreference readPreference)
   at MongoDB.Driver.MongoCollection.FindAndModify(FindAndModifyArgs args)
   at MongoDB.Driver.MongoCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.<>c__DisplayClass2c.<FindAndModify>b__2b()
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)

Nested Exception

Exception: System.Net.Sockets.SocketException
Message: No connection could be made because the target machine actively refused it 127.0.0.1:27017
Source: System
   at System.Net.Sockets.Socket.DoConnect(EndPoint endPointSnapshot, SocketAddress socketAddress)
   at System.Net.Sockets.Socket.Connect(EndPoint remoteEP)
   at System.Net.Sockets.TcpClient.Connect(IPEndPoint remoteEP)
   at MongoDB.Driver.Internal.MongoConnection.Open()
   at MongoDB.Driver.Internal.MongoConnection.SendMessage(BsonBuffer buffer, Int32 requestId)
   at MongoDB.Driver.Internal.MongoConnection.SendMessage(MongoRequestMessage message)
   at MongoDB.Driver.Operations.CommandOperation`1.Execute(MongoConnection connection)
   at MongoDB.Driver.MongoServerInstance.Ping(MongoConnection connection)
   at MongoDB.Driver.MongoServerInstance.Connect()
   at MongoDB.Driver.Internal.DirectMongoServerProxy.Connect(TimeSpan timeout, ReadPreference readPreference)



5344 15:57:58 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #10 15:58:04 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #10 15:58:04 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
5476 15:58:04 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

3288 15:58:04 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

2288 15:58:04 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

1932 15:58:04 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Core.BackgroundService.Run()

6832 15:58:10 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

2896 15:58:11 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

5344 15:58:13 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #7 15:58:14 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #7 15:58:14 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
2436 15:58:19 INFO  [Experience Analytics]: Reduce agent found zero sites to process
5476 15:58:19 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

3288 15:58:19 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

2288 15:58:19 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

1932 15:58:19 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #10 15:58:24 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #10 15:58:24 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
6832 15:58:25 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

2896 15:58:26 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

5344 15:58:28 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

Heartbeat 15:58:30 ERROR MongoDbDictionary.Store() has failed.
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Save(Object value)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbDictionary.Store(Object value)

ManagedPoolThread #7 15:58:34 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #7 15:58:34 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
5476 15:58:34 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

3288 15:58:34 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

2288 15:58:34 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

1932 15:58:34 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #2 15:58:39 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
6832 15:58:40 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

2896 15:58:41 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

5344 15:58:43 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #10 15:58:44 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #10 15:58:44 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
ManagedPoolThread #11 15:58:48 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
2436 15:58:49 INFO  [Experience Analytics]: Reduce agent found zero sites to process
5476 15:58:49 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

2288 15:58:49 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

1932 15:58:49 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Core.BackgroundService.Run()

3288 15:58:49 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #7 15:58:54 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #7 15:58:54 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
ManagedPoolThread #3 15:58:55 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
6832 15:58:55 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #0 15:58:56 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #1 15:58:57 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #5 15:58:58 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
5344 15:58:58 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #6 15:58:59 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #9 15:59:00 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #12 15:59:01 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #14 15:59:02 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #15 15:59:04 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #10 15:59:04 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #10 15:59:04 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
2288 15:59:05 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

5476 15:59:05 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

3288 15:59:05 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

1932 15:59:05 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #17 15:59:05 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #18 15:59:06 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #19 15:59:07 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
2896 15:59:08 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
2896 15:59:09 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.HandleDatabaseException(ExceptionBehavior exceptionBehavior, Exception ex)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

Nested Exception

Exception: MongoDB.Driver.MongoConnectionException
Message: Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
Source: MongoDB.Driver
   at MongoDB.Driver.Internal.DirectMongoServerProxy.Connect(TimeSpan timeout, ReadPreference readPreference)
   at MongoDB.Driver.Internal.DirectMongoServerProxy.ChooseServerInstance(ReadPreference readPreference)
   at MongoDB.Driver.MongoServer.AcquireConnection(ReadPreference readPreference)
   at MongoDB.Driver.MongoCollection.RunCommandAs[TCommandResult](IMongoCommand command, ReadPreference readPreference, IBsonSerializer resultSerializer, IBsonSerializationOptions resultSerializationOptions)
   at MongoDB.Driver.MongoCollection.RunCommandAs[TCommandResult](IMongoCommand command, ReadPreference readPreference)
   at MongoDB.Driver.MongoCollection.FindAndModify(FindAndModifyArgs args)
   at MongoDB.Driver.MongoCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.<>c__DisplayClass2c.<FindAndModify>b__2b()
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)

Nested Exception

Exception: System.Net.Sockets.SocketException
Message: No connection could be made because the target machine actively refused it 127.0.0.1:27017
Source: System
   at System.Net.Sockets.Socket.DoConnect(EndPoint endPointSnapshot, SocketAddress socketAddress)
   at System.Net.Sockets.Socket.Connect(EndPoint remoteEP)
   at System.Net.Sockets.TcpClient.Connect(IPEndPoint remoteEP)
   at MongoDB.Driver.Internal.MongoConnection.Open()
   at MongoDB.Driver.Internal.MongoConnection.SendMessage(BsonBuffer buffer, Int32 requestId)
   at MongoDB.Driver.Internal.MongoConnection.SendMessage(MongoRequestMessage message)
   at MongoDB.Driver.Operations.CommandOperation`1.Execute(MongoConnection connection)
   at MongoDB.Driver.MongoServerInstance.Ping(MongoConnection connection)
   at MongoDB.Driver.MongoServerInstance.Connect()
   at MongoDB.Driver.Internal.DirectMongoServerProxy.Connect(TimeSpan timeout, ReadPreference readPreference)



6832 15:59:10 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

5344 15:59:13 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #7 15:59:14 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #7 15:59:14 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
 388 15:59:23 INFO  [Path Analyzer](.) Running trail cleanup agent
 388 15:59:23 INFO  [Path Analyzer](.) Running trail cleanup on database
2436 15:59:23 INFO  [Experience Analytics]: Reduce agent found zero sites to process
1932 15:59:24 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Core.BackgroundService.Run()

3288 15:59:24 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

2896 15:59:24 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

5476 15:59:24 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

2288 15:59:24 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

6832 15:59:25 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

5344 15:59:28 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #13 15:59:28 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #13 15:59:28 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
ManagedPoolThread #10 15:59:39 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #10 15:59:39 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
1932 15:59:39 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Core.BackgroundService.Run()

5476 15:59:39 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

2896 15:59:39 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

2288 15:59:39 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

3288 15:59:39 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

6832 15:59:40 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

5344 15:59:43 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #2 15:59:45 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #7 15:59:49 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #7 15:59:49 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
2436 15:59:53 INFO  [Experience Analytics]: Reduce agent found zero sites to process
1932 15:59:54 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Core.BackgroundService.Run()

3288 15:59:54 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

5476 15:59:54 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

2288 15:59:54 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

2896 15:59:54 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

6832 15:59:55 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #8 15:59:55 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #11 15:59:56 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
5344 15:59:58 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #16 15:59:59 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #16 15:59:59 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
ManagedPoolThread #12 16:00:08 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #13 16:00:09 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #13 16:00:09 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
1932 16:00:09 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Core.BackgroundService.Run()

5476 16:00:09 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

2288 16:00:09 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

3288 16:00:09 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #0 16:00:10 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
6832 16:00:10 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #1 16:00:11 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #3 16:00:12 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #5 16:00:13 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
5344 16:00:13 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #6 16:00:14 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #9 16:00:15 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #14 16:00:16 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #15 16:00:17 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #10 16:00:19 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #10 16:00:19 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
ManagedPoolThread #17 16:00:19 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #18 16:00:20 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #19 16:00:21 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
2896 16:00:22 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
2896 16:00:22 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.HandleDatabaseException(ExceptionBehavior exceptionBehavior, Exception ex)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

Nested Exception

Exception: MongoDB.Driver.MongoConnectionException
Message: Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
Source: MongoDB.Driver
   at MongoDB.Driver.Internal.DirectMongoServerProxy.Connect(TimeSpan timeout, ReadPreference readPreference)
   at MongoDB.Driver.Internal.DirectMongoServerProxy.ChooseServerInstance(ReadPreference readPreference)
   at MongoDB.Driver.MongoServer.AcquireConnection(ReadPreference readPreference)
   at MongoDB.Driver.MongoCollection.RunCommandAs[TCommandResult](IMongoCommand command, ReadPreference readPreference, IBsonSerializer resultSerializer, IBsonSerializationOptions resultSerializationOptions)
   at MongoDB.Driver.MongoCollection.RunCommandAs[TCommandResult](IMongoCommand command, ReadPreference readPreference)
   at MongoDB.Driver.MongoCollection.FindAndModify(FindAndModifyArgs args)
   at MongoDB.Driver.MongoCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.<>c__DisplayClass2c.<FindAndModify>b__2b()
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)

Nested Exception

Exception: System.Net.Sockets.SocketException
Message: No connection could be made because the target machine actively refused it 127.0.0.1:27017
Source: System
   at System.Net.Sockets.Socket.DoConnect(EndPoint endPointSnapshot, SocketAddress socketAddress)
   at System.Net.Sockets.Socket.Connect(EndPoint remoteEP)
   at System.Net.Sockets.TcpClient.Connect(IPEndPoint remoteEP)
   at MongoDB.Driver.Internal.MongoConnection.Open()
   at MongoDB.Driver.Internal.MongoConnection.SendMessage(BsonBuffer buffer, Int32 requestId)
   at MongoDB.Driver.Internal.MongoConnection.SendMessage(MongoRequestMessage message)
   at MongoDB.Driver.Operations.CommandOperation`1.Execute(MongoConnection connection)
   at MongoDB.Driver.MongoServerInstance.Ping(MongoConnection connection)
   at MongoDB.Driver.MongoServerInstance.Connect()
   at MongoDB.Driver.Internal.DirectMongoServerProxy.Connect(TimeSpan timeout, ReadPreference readPreference)



2436 16:00:24 INFO  [Experience Analytics]: Reduce agent found zero sites to process
1932 16:00:24 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Core.BackgroundService.Run()

5476 16:00:24 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

2288 16:00:24 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

3288 16:00:24 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

6832 16:00:25 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

5344 16:00:28 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #7 16:00:29 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #7 16:00:29 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
Heartbeat 16:00:32 ERROR MongoDbDictionary.Store() has failed.
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Save(Object value)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbDictionary.Store(Object value)

2896 16:00:37 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #16 16:00:39 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #16 16:00:39 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
1932 16:00:39 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Core.BackgroundService.Run()

5476 16:00:39 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

2288 16:00:39 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

3288 16:00:39 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

6832 16:00:40 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

5344 16:00:43 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #2 16:00:46 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #10 16:00:49 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #10 16:00:49 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
2896 16:00:52 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

2436 16:00:54 INFO  [Experience Analytics]: Reduce agent found zero sites to process
5476 16:00:54 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

1932 16:00:54 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Core.BackgroundService.Run()

2288 16:00:54 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

3288 16:00:54 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

6832 16:00:55 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #11 16:00:57 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
5344 16:00:58 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #13 16:00:59 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #13 16:00:59 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
2896 16:01:07 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #10 16:01:09 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #10 16:01:09 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
1932 16:01:09 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Core.BackgroundService.Run()

5476 16:01:09 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

2288 16:01:09 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

3288 16:01:09 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

6832 16:01:10 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

5344 16:01:13 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #13 16:01:19 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #13 16:01:19 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
ManagedPoolThread #6 16:01:22 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #5 16:01:23 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
2436 16:01:24 INFO  [Experience Analytics]: Reduce agent found zero sites to process
ManagedPoolThread #19 16:01:24 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
1932 16:01:24 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Core.BackgroundService.Run()

5476 16:01:24 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

2288 16:01:24 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

3288 16:01:24 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #9 16:01:25 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
6832 16:01:25 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #14 16:01:26 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #0 16:01:27 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #15 16:01:28 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
5344 16:01:28 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #7 16:01:29 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #7 16:01:29 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
ManagedPoolThread #1 16:01:29 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #12 16:01:30 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #3 16:01:31 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
2896 16:01:32 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
2896 16:01:32 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.HandleDatabaseException(ExceptionBehavior exceptionBehavior, Exception ex)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

Nested Exception

Exception: MongoDB.Driver.MongoConnectionException
Message: Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
Source: MongoDB.Driver
   at MongoDB.Driver.Internal.DirectMongoServerProxy.Connect(TimeSpan timeout, ReadPreference readPreference)
   at MongoDB.Driver.Internal.DirectMongoServerProxy.ChooseServerInstance(ReadPreference readPreference)
   at MongoDB.Driver.MongoServer.AcquireConnection(ReadPreference readPreference)
   at MongoDB.Driver.MongoCollection.RunCommandAs[TCommandResult](IMongoCommand command, ReadPreference readPreference, IBsonSerializer resultSerializer, IBsonSerializationOptions resultSerializationOptions)
   at MongoDB.Driver.MongoCollection.RunCommandAs[TCommandResult](IMongoCommand command, ReadPreference readPreference)
   at MongoDB.Driver.MongoCollection.FindAndModify(FindAndModifyArgs args)
   at MongoDB.Driver.MongoCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.<>c__DisplayClass2c.<FindAndModify>b__2b()
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)

Nested Exception

Exception: System.Net.Sockets.SocketException
Message: No connection could be made because the target machine actively refused it 127.0.0.1:27017
Source: System
   at System.Net.Sockets.Socket.DoConnect(EndPoint endPointSnapshot, SocketAddress socketAddress)
   at System.Net.Sockets.Socket.Connect(EndPoint remoteEP)
   at System.Net.Sockets.TcpClient.Connect(IPEndPoint remoteEP)
   at MongoDB.Driver.Internal.MongoConnection.Open()
   at MongoDB.Driver.Internal.MongoConnection.SendMessage(BsonBuffer buffer, Int32 requestId)
   at MongoDB.Driver.Internal.MongoConnection.SendMessage(MongoRequestMessage message)
   at MongoDB.Driver.Operations.CommandOperation`1.Execute(MongoConnection connection)
   at MongoDB.Driver.MongoServerInstance.Ping(MongoConnection connection)
   at MongoDB.Driver.MongoServerInstance.Connect()
   at MongoDB.Driver.Internal.DirectMongoServerProxy.Connect(TimeSpan timeout, ReadPreference readPreference)



ManagedPoolThread #17 16:01:33 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #18 16:01:34 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #16 16:01:39 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #16 16:01:39 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
5476 16:01:39 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

1932 16:01:39 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Core.BackgroundService.Run()

2288 16:01:39 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

3288 16:01:39 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

6832 16:01:40 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

5344 16:01:43 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

2896 16:01:47 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #2 16:01:47 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #10 16:01:49 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #10 16:01:49 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
2436 16:01:54 INFO  [Experience Analytics]: Reduce agent found zero sites to process
5476 16:01:54 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

1932 16:01:54 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Core.BackgroundService.Run()

2288 16:01:54 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

3288 16:01:54 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

6832 16:01:55 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #11 16:01:58 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
5344 16:01:58 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #13 16:01:59 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #13 16:01:59 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
2896 16:02:02 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #10 16:02:09 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #10 16:02:09 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
1932 16:02:09 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Core.BackgroundService.Run()

5476 16:02:09 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

2288 16:02:09 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

3288 16:02:09 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

6832 16:02:10 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

5344 16:02:13 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

2896 16:02:17 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #13 16:02:19 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #13 16:02:19 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
2436 16:02:24 INFO  [Experience Analytics]: Reduce agent found zero sites to process
5476 16:02:24 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

1932 16:02:24 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Core.BackgroundService.Run()

2288 16:02:24 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

3288 16:02:24 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

6832 16:02:25 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

5344 16:02:28 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #7 16:02:29 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #7 16:02:29 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
2896 16:02:32 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #6 16:02:32 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #14 16:02:33 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #12 16:02:34 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #15 16:02:35 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #9 16:02:36 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #1 16:02:37 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #5 16:02:38 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #16 16:02:39 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #16 16:02:39 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
5476 16:02:39 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

1932 16:02:39 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #3 16:02:39 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
2288 16:02:39 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

3288 16:02:39 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #19 16:02:40 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
6832 16:02:40 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #0 16:02:41 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
Heartbeat 16:02:42 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
Heartbeat 16:02:42 ERROR MongoDbDictionary.Store() has failed.
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.HandleDatabaseException(ExceptionBehavior exceptionBehavior, Exception ex)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Save(Object value)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbDictionary.Store(Object value)

Nested Exception

Exception: MongoDB.Driver.MongoConnectionException
Message: Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
Source: MongoDB.Driver
   at MongoDB.Driver.Internal.DirectMongoServerProxy.Connect(TimeSpan timeout, ReadPreference readPreference)
   at MongoDB.Driver.Internal.DirectMongoServerProxy.ChooseServerInstance(ReadPreference readPreference)
   at MongoDB.Driver.MongoServer.AcquireConnection(ReadPreference readPreference)
   at MongoDB.Driver.MongoCollection.Update(IMongoQuery query, IMongoUpdate update, MongoUpdateOptions options)
   at MongoDB.Driver.MongoCollection.Save(Type nominalType, Object document, MongoInsertOptions options)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.<>c__DisplayClass3c.<Save>b__3b()
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)

Nested Exception

Exception: System.Net.Sockets.SocketException
Message: No connection could be made because the target machine actively refused it 127.0.0.1:27017
Source: System
   at System.Net.Sockets.Socket.DoConnect(EndPoint endPointSnapshot, SocketAddress socketAddress)
   at System.Net.Sockets.Socket.Connect(EndPoint remoteEP)
   at System.Net.Sockets.TcpClient.Connect(IPEndPoint remoteEP)
   at MongoDB.Driver.Internal.MongoConnection.Open()
   at MongoDB.Driver.Internal.MongoConnection.SendMessage(BsonBuffer buffer, Int32 requestId)
   at MongoDB.Driver.Internal.MongoConnection.SendMessage(MongoRequestMessage message)
   at MongoDB.Driver.Operations.CommandOperation`1.Execute(MongoConnection connection)
   at MongoDB.Driver.MongoServerInstance.Ping(MongoConnection connection)
   at MongoDB.Driver.MongoServerInstance.Connect()
   at MongoDB.Driver.Internal.DirectMongoServerProxy.Connect(TimeSpan timeout, ReadPreference readPreference)



ManagedPoolThread #18 16:02:43 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
5344 16:02:43 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #17 16:02:44 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
2896 16:02:47 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #2 16:02:48 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #10 16:02:49 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #10 16:02:49 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
2436 16:02:54 INFO  [Experience Analytics]: Reduce agent found zero sites to process
1932 16:02:54 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Core.BackgroundService.Run()

5476 16:02:54 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

2288 16:02:54 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

3288 16:02:54 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

6832 16:02:55 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

5344 16:02:58 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #13 16:02:59 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #13 16:02:59 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
ManagedPoolThread #11 16:02:59 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
2896 16:03:02 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #10 16:03:09 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #10 16:03:09 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
1932 16:03:09 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Core.BackgroundService.Run()

5476 16:03:09 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

2288 16:03:09 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

3288 16:03:09 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

6832 16:03:10 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

5344 16:03:13 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

2896 16:03:17 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #13 16:03:19 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #13 16:03:19 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
2436 16:03:24 INFO  [Experience Analytics]: Reduce agent found zero sites to process
1932 16:03:24 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Core.BackgroundService.Run()

5476 16:03:24 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

2288 16:03:24 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

3288 16:03:24 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

6832 16:03:25 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

5344 16:03:28 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #16 16:03:29 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #16 16:03:29 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
2896 16:03:32 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #7 16:03:39 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #7 16:03:39 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
1932 16:03:39 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Core.BackgroundService.Run()

5476 16:03:39 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

2288 16:03:39 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

3288 16:03:39 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

6832 16:03:40 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #9 16:03:43 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
5344 16:03:43 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #14 16:03:44 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #12 16:03:45 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #15 16:03:46 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #1 16:03:47 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #3 16:03:48 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #13 16:03:49 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #13 16:03:49 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
ManagedPoolThread #6 16:03:49 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #0 16:03:50 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #19 16:03:51 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #5 16:03:52 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #17 16:03:53 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
2436 16:03:54 INFO  [Experience Analytics]: Reduce agent found zero sites to process
1932 16:03:54 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Core.BackgroundService.Run()

5476 16:03:54 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

2288 16:03:54 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

3288 16:03:54 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

2896 16:03:54 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
2896 16:03:54 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.HandleDatabaseException(ExceptionBehavior exceptionBehavior, Exception ex)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

Nested Exception

Exception: MongoDB.Driver.MongoConnectionException
Message: Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
Source: MongoDB.Driver
   at MongoDB.Driver.Internal.DirectMongoServerProxy.Connect(TimeSpan timeout, ReadPreference readPreference)
   at MongoDB.Driver.Internal.DirectMongoServerProxy.ChooseServerInstance(ReadPreference readPreference)
   at MongoDB.Driver.MongoServer.AcquireConnection(ReadPreference readPreference)
   at MongoDB.Driver.MongoCollection.RunCommandAs[TCommandResult](IMongoCommand command, ReadPreference readPreference, IBsonSerializer resultSerializer, IBsonSerializationOptions resultSerializationOptions)
   at MongoDB.Driver.MongoCollection.RunCommandAs[TCommandResult](IMongoCommand command, ReadPreference readPreference)
   at MongoDB.Driver.MongoCollection.FindAndModify(FindAndModifyArgs args)
   at MongoDB.Driver.MongoCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.<>c__DisplayClass2c.<FindAndModify>b__2b()
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)

Nested Exception

Exception: System.Net.Sockets.SocketException
Message: No connection could be made because the target machine actively refused it 127.0.0.1:27017
Source: System
   at System.Net.Sockets.Socket.DoConnect(EndPoint endPointSnapshot, SocketAddress socketAddress)
   at System.Net.Sockets.Socket.Connect(EndPoint remoteEP)
   at System.Net.Sockets.TcpClient.Connect(IPEndPoint remoteEP)
   at MongoDB.Driver.Internal.MongoConnection.Open()
   at MongoDB.Driver.Internal.MongoConnection.SendMessage(BsonBuffer buffer, Int32 requestId)
   at MongoDB.Driver.Internal.MongoConnection.SendMessage(MongoRequestMessage message)
   at MongoDB.Driver.Operations.CommandOperation`1.Execute(MongoConnection connection)
   at MongoDB.Driver.MongoServerInstance.Ping(MongoConnection connection)
   at MongoDB.Driver.MongoServerInstance.Connect()
   at MongoDB.Driver.Internal.DirectMongoServerProxy.Connect(TimeSpan timeout, ReadPreference readPreference)



ManagedPoolThread #2 16:03:55 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
6832 16:03:55 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #18 16:03:56 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
5344 16:03:58 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #10 16:03:59 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #10 16:03:59 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
ManagedPoolThread #11 16:04:00 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #13 16:04:09 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #13 16:04:09 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
1932 16:04:09 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Core.BackgroundService.Run()

5476 16:04:09 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

2288 16:04:09 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

3288 16:04:09 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

2896 16:04:09 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

6832 16:04:10 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

5344 16:04:13 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

Heartbeat 16:04:16 INFO  Health.PrivateBytes: 857,186,304
Heartbeat 16:04:16 INFO  Health.CacheInstances: 116
Heartbeat 16:04:16 INFO  Health.CacheTotalCount: 21,161
Heartbeat 16:04:16 INFO  Health.CacheTotalSize: 84,531,740
ManagedPoolThread #10 16:04:19 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #10 16:04:19 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
 388 16:04:23 INFO  [Path Analyzer](.) Running trail cleanup agent
 388 16:04:23 INFO  [Path Analyzer](.) Running trail cleanup on database
2436 16:04:24 INFO  [Experience Analytics]: Reduce agent found zero sites to process
ManagedPoolThread #16 16:04:24 INFO  Job started: Sitecore.Tasks.TaskDatabaseAgent
ManagedPoolThread #16 16:04:24 INFO  Processing tasks (count: 0)
ManagedPoolThread #16 16:04:24 INFO  Job ended: Sitecore.Tasks.TaskDatabaseAgent (units processed: )
ManagedPoolThread #13 16:04:24 INFO  Job started: Core_Database_Agent
ManagedPoolThread #13 16:04:24 INFO  Scheduling.DatabaseAgent started. Database: core
ManagedPoolThread #13 16:04:24 INFO  Examining schedules (count: 0)
ManagedPoolThread #13 16:04:24 INFO  Job ended: Core_Database_Agent (units processed: )
ManagedPoolThread #7 16:04:24 INFO  Job started: Master_Database_Agent
ManagedPoolThread #7 16:04:24 INFO  Scheduling.DatabaseAgent started. Database: master
ManagedPoolThread #7 16:04:24 INFO  Examining schedules (count: 5)
ManagedPoolThread #7 16:04:24 INFO  Starting: __Task Schedule
ManagedPoolThread #7 16:04:24 INFO  Ended: __Task Schedule
ManagedPoolThread #7 16:04:24 INFO  Not due: Calculate Statistical Relevancy
ManagedPoolThread #7 16:04:24 INFO  Not due: Rebuild Suggested Tests Index
ManagedPoolThread #7 16:04:24 INFO  Not due: Suspend Corrupted Tests
ManagedPoolThread #7 16:04:24 INFO  Not due: Try Finish Test
ManagedPoolThread #7 16:04:24 INFO  Job ended: Master_Database_Agent (units processed: 5)
1932 16:04:24 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Core.BackgroundService.Run()

5476 16:04:24 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

2288 16:04:24 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

3288 16:04:24 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

2896 16:04:24 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

6832 16:04:25 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

5344 16:04:28 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #16 16:04:29 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #16 16:04:29 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
Heartbeat 16:04:32 ERROR MongoDbDictionary.Store() has failed.
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Save(Object value)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbDictionary.Store(Object value)

ManagedPoolThread #13 16:04:39 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #13 16:04:39 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
1932 16:04:39 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Core.BackgroundService.Run()

5476 16:04:39 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

2288 16:04:39 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

3288 16:04:39 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

2896 16:04:39 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

6832 16:04:40 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

5344 16:04:43 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #7 16:04:49 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #7 16:04:49 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
ManagedPoolThread #1 16:04:53 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
2436 16:04:54 INFO  [Experience Analytics]: Reduce agent found zero sites to process
1932 16:04:54 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Core.BackgroundService.Run()

5476 16:04:54 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

2288 16:04:54 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

3288 16:04:54 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

2896 16:04:54 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #19 16:04:54 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
6832 16:04:55 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #5 16:04:55 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #15 16:04:56 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #12 16:04:57 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #6 16:04:58 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
5344 16:04:58 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #10 16:04:59 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #10 16:04:59 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
ManagedPoolThread #0 16:04:59 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #9 16:05:00 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #3 16:05:01 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #14 16:05:02 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #2 16:05:03 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #18 16:05:04 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #11 16:05:05 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #17 16:05:06 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #8 16:05:07 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #7 16:05:09 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #7 16:05:09 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
1932 16:05:09 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Core.BackgroundService.Run()

5476 16:05:09 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

2288 16:05:09 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

3288 16:05:09 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

2896 16:05:09 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

6832 16:05:10 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

5344 16:05:13 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #10 16:05:19 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #10 16:05:19 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
2436 16:05:24 INFO  [Experience Analytics]: Reduce agent found zero sites to process
1932 16:05:24 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Core.BackgroundService.Run()

5476 16:05:24 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

2288 16:05:24 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

3288 16:05:24 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

2896 16:05:24 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

6832 16:05:25 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

5344 16:05:28 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #16 16:05:29 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #16 16:05:29 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
ManagedPoolThread #13 16:05:39 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #13 16:05:39 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
5476 16:05:39 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

1932 16:05:39 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Core.BackgroundService.Run()

2288 16:05:39 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

3288 16:05:39 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

2896 16:05:39 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

6832 16:05:40 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

5344 16:05:43 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #7 16:05:49 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #7 16:05:49 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
2436 16:05:54 INFO  [Experience Analytics]: Reduce agent found zero sites to process
1932 16:05:54 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Core.BackgroundService.Run()

5476 16:05:54 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

2288 16:05:54 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

3288 16:05:54 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

2896 16:05:54 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

6832 16:05:55 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

5344 16:05:58 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #10 16:05:59 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #10 16:05:59 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
ManagedPoolThread #12 16:06:04 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #1 16:06:05 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #5 16:06:06 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #6 16:06:07 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #15 16:06:08 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #19 16:06:09 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #7 16:06:09 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #7 16:06:09 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
1932 16:06:09 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Core.BackgroundService.Run()

5476 16:06:09 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

2288 16:06:09 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

3288 16:06:09 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #0 16:06:10 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
6832 16:06:10 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #14 16:06:11 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #3 16:06:12 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #9 16:06:13 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
5344 16:06:14 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #2 16:06:14 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #17 16:06:15 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #8 16:06:16 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
2896 16:06:17 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
2896 16:06:17 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.HandleDatabaseException(ExceptionBehavior exceptionBehavior, Exception ex)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

Nested Exception

Exception: MongoDB.Driver.MongoConnectionException
Message: Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
Source: MongoDB.Driver
   at MongoDB.Driver.Internal.DirectMongoServerProxy.Connect(TimeSpan timeout, ReadPreference readPreference)
   at MongoDB.Driver.Internal.DirectMongoServerProxy.ChooseServerInstance(ReadPreference readPreference)
   at MongoDB.Driver.MongoServer.AcquireConnection(ReadPreference readPreference)
   at MongoDB.Driver.MongoCollection.RunCommandAs[TCommandResult](IMongoCommand command, ReadPreference readPreference, IBsonSerializer resultSerializer, IBsonSerializationOptions resultSerializationOptions)
   at MongoDB.Driver.MongoCollection.RunCommandAs[TCommandResult](IMongoCommand command, ReadPreference readPreference)
   at MongoDB.Driver.MongoCollection.FindAndModify(FindAndModifyArgs args)
   at MongoDB.Driver.MongoCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.<>c__DisplayClass2c.<FindAndModify>b__2b()
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)

Nested Exception

Exception: System.Net.Sockets.SocketException
Message: No connection could be made because the target machine actively refused it 127.0.0.1:27017
Source: System
   at System.Net.Sockets.Socket.DoConnect(EndPoint endPointSnapshot, SocketAddress socketAddress)
   at System.Net.Sockets.Socket.Connect(EndPoint remoteEP)
   at System.Net.Sockets.TcpClient.Connect(IPEndPoint remoteEP)
   at MongoDB.Driver.Internal.MongoConnection.Open()
   at MongoDB.Driver.Internal.MongoConnection.SendMessage(BsonBuffer buffer, Int32 requestId)
   at MongoDB.Driver.Internal.MongoConnection.SendMessage(MongoRequestMessage message)
   at MongoDB.Driver.Operations.CommandOperation`1.Execute(MongoConnection connection)
   at MongoDB.Driver.MongoServerInstance.Ping(MongoConnection connection)
   at MongoDB.Driver.MongoServerInstance.Connect()
   at MongoDB.Driver.Internal.DirectMongoServerProxy.Connect(TimeSpan timeout, ReadPreference readPreference)



ManagedPoolThread #18 16:06:18 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #11 16:06:19 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #10 16:06:19 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #10 16:06:19 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
2436 16:06:24 INFO  [Experience Analytics]: Reduce agent found zero sites to process
1932 16:06:24 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Core.BackgroundService.Run()

5476 16:06:24 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

2288 16:06:24 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

3288 16:06:24 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

6832 16:06:25 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

5344 16:06:29 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #13 16:06:29 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #13 16:06:29 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
2896 16:06:32 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

Heartbeat 16:06:32 ERROR MongoDbDictionary.Store() has failed.
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Save(Object value)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbDictionary.Store(Object value)

ManagedPoolThread #16 16:06:39 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #16 16:06:39 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
1932 16:06:39 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Core.BackgroundService.Run()

5476 16:06:39 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

2288 16:06:39 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

3288 16:06:39 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

6832 16:06:40 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

5344 16:06:44 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

2896 16:06:47 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #10 16:06:49 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #10 16:06:49 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
2436 16:06:54 INFO  [Experience Analytics]: Reduce agent found zero sites to process
1932 16:06:54 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Core.BackgroundService.Run()

5476 16:06:54 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

3288 16:06:54 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

2288 16:06:54 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

6832 16:06:55 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

5344 16:06:59 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #16 16:06:59 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #16 16:06:59 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
2896 16:07:02 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #13 16:07:09 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #13 16:07:09 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
1932 16:07:09 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Core.BackgroundService.Run()

5476 16:07:09 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

3288 16:07:09 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

2288 16:07:09 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

6832 16:07:10 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #12 16:07:14 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #1 16:07:15 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #5 16:07:16 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
2896 16:07:17 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #19 16:07:17 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #14 16:07:18 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #3 16:07:19 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #16 16:07:19 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #16 16:07:19 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
ManagedPoolThread #6 16:07:20 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #15 16:07:21 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #0 16:07:22 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #9 16:07:23 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
2436 16:07:24 INFO  [Experience Analytics]: Reduce agent found zero sites to process
5344 16:07:24 ERROR Exception when executing agent aggregation/automationAggregator
Exception: MongoDB.Driver.MongoConnectionException
Message: Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
Source: MongoDB.Driver
   at MongoDB.Driver.Internal.DirectMongoServerProxy.Connect(TimeSpan timeout, ReadPreference readPreference)
   at MongoDB.Driver.Internal.DirectMongoServerProxy.ChooseServerInstance(ReadPreference readPreference)
   at MongoDB.Driver.MongoServer.AcquireConnection(ReadPreference readPreference)
   at MongoDB.Driver.MongoCursor`1.MongoCursorConnectionProvider.AcquireConnection()
   at MongoDB.Driver.Operations.QueryOperation`1.GetFirstBatch(IConnectionProvider connectionProvider)
   at MongoDB.Driver.Operations.QueryOperation`1.Execute(IConnectionProvider connectionProvider)
   at System.Linq.Buffer`1..ctor(IEnumerable`1 source)
   at System.Linq.Enumerable.ToArray[TSource](IEnumerable`1 source)
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

Nested Exception

Exception: System.Net.Sockets.SocketException
Message: No connection could be made because the target machine actively refused it 127.0.0.1:27017
Source: System
   at System.Net.Sockets.Socket.DoConnect(EndPoint endPointSnapshot, SocketAddress socketAddress)
   at System.Net.Sockets.Socket.Connect(EndPoint remoteEP)
   at System.Net.Sockets.TcpClient.Connect(IPEndPoint remoteEP)
   at MongoDB.Driver.Internal.MongoConnection.Open()
   at MongoDB.Driver.Internal.MongoConnection.SendMessage(BsonBuffer buffer, Int32 requestId)
   at MongoDB.Driver.Internal.MongoConnection.SendMessage(MongoRequestMessage message)
   at MongoDB.Driver.Operations.CommandOperation`1.Execute(MongoConnection connection)
   at MongoDB.Driver.MongoServerInstance.Ping(MongoConnection connection)
   at MongoDB.Driver.MongoServerInstance.Connect()
   at MongoDB.Driver.Internal.DirectMongoServerProxy.Connect(TimeSpan timeout, ReadPreference readPreference)


1932 16:07:24 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Core.BackgroundService.Run()

5476 16:07:24 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

2288 16:07:24 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

3288 16:07:24 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #2 16:07:25 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
6832 16:07:25 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #18 16:07:26 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #11 16:07:27 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #17 16:07:28 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #8 16:07:29 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #13 16:07:29 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #13 16:07:29 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
2896 16:07:32 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

5344 16:07:39 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #16 16:07:39 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #16 16:07:39 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
1932 16:07:39 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Core.BackgroundService.Run()

5476 16:07:39 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

2288 16:07:39 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

3288 16:07:39 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

6832 16:07:40 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

2896 16:07:47 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #10 16:07:49 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #10 16:07:49 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
2436 16:07:54 INFO  [Experience Analytics]: Reduce agent found zero sites to process
5344 16:07:54 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

1932 16:07:54 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Core.BackgroundService.Run()

5476 16:07:54 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

2288 16:07:54 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

3288 16:07:54 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

6832 16:07:55 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #7 16:07:59 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #7 16:07:59 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
2896 16:08:02 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

5344 16:08:09 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #10 16:08:09 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #10 16:08:09 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
1932 16:08:09 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Core.BackgroundService.Run()

5476 16:08:09 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

2288 16:08:09 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

3288 16:08:09 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

6832 16:08:10 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

2896 16:08:17 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #7 16:08:19 INFO  Job started: Sitecore.ListManagement.Analytics.UnlockContactListsAgent
ManagedPoolThread #7 16:08:19 INFO  Job ended: Sitecore.ListManagement.Analytics.UnlockContactListsAgent (units processed: )
7996 16:08:22 INFO  **************************************************
7996 16:08:22 WARN  Sitecore shutting down
7996 16:08:22 WARN  Shutdown message: Change in App_Offline.htm
HostingEnvironment initiated shutdown
Change in App_Offline.htm
Change in App_Offline.htm
ManagedPoolThread #19 16:08:24 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #1 16:08:25 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #5 16:08:26 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #14 16:08:27 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #9 16:08:28 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #12 16:08:29 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #0 16:08:30 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #15 16:08:31 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #3 16:08:32 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
Heartbeat 16:08:32 ERROR MongoDbDictionary.Store() has failed.
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Save(Object value)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbDictionary.Store(Object value)

ManagedPoolThread #6 16:08:33 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #2 16:08:34 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #17 16:08:35 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #8 16:08:36 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
5416 16:08:52 ERROR An error occurred while reading an automation state document related to contact {EB384A12-68E7-4E66-A15A-821C06F4F0B3} was found in the AutomationStates collection. Mongo collection returned null.
